"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[6747],{47139:(dt,it,S)=>{S.d(it,{y:()=>G});const X=new(S(82818).A);function G(D){if(null==D)return["",!1];if(!X.hasBidiChar(D))return[D,!1];let B;return B="rtl"===X.checkContextual(D)?"IDNNN":"ICNNN",[X.bidiTransform(D,B,"VLYSN"),!0]}},98894:(dt,it,S)=>{S.d(it,{Al:()=>_,Vb:()=>G,af:()=>h,rK:()=>r});var Z=S(10467),X=S(23098);const G="arial-unicode-ms",D="woff2",B=new Map,x=new Set;class P{constructor(M,I){this.fontFace=M,this.promise=I}}function _(d){return m.apply(this,arguments)}function m(){return(m=(0,Z.A)(function*(d){const M=function l(d){const M=e(d)+c(d);return(d.family||G)+(M.length>0?M:"-regular")}(d),I=r(d),A=B.get(M);if(A)return A.promise;const U=new FontFace(d.family,`url('${X.A.fontsUrl}/woff2/${I}.${D}') format('${D}')`,{style:d.style,weight:d.weight}),F=document.fonts;if(F.has(U)&&"loading"===U.status)return U.loaded;const N=U.load().then(()=>(F.add(U),U));return B.set(M,new P(U,N)),x.add(U),N})).apply(this,arguments)}function h(d){if(!d)return G;const M=d.toLowerCase().split(" ").join("-");switch(M){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return M}}function r(d){const M=e(d)+c(d);return h(d.family)+(M.length>0?M:"-regular")}function e(d){if(!d.weight)return"";switch(d.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}function c(d){if(!d.style)return"";switch(d.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}},72137:(dt,it,S)=>{S.d(it,{z:()=>B});var Z=S(77806),X=S(53262),G=S(61320),D=S(13682);class B{static fromOptimized(e,c,d=!1,M=!1,I=1){return(new x).initialize(e,c,d,M,I)}static fromJSON(e,c=!1,d=!1){const[M,I]=_(e);return(new m).initialize(M,I,c,d,1)}static fromOptimizedCIM(e,c,d=!1,M=!1,I=1){return(new h).initialize(e,c,d,M,I)}static fromJSONCIM(e,c=!1,d=!1,M=1){const[I,A]=_(e);return(new r).initialize(I,A,c,d,M)}static fromFeatureSetReader(e){const c=e.readGeometryForDisplay(),d=e.geometryType;return c&&d?this.fromOptimized(c,d):null}static fromFeatureSetReaderCIM(e){const c=e.readGeometryForDisplay(),d=e.geometryType;return c&&d?this.fromOptimizedCIM(c,d):null}static createEmptyOptimized(e,c=!1,d=!1,M=1){return(new x).initialize(new D.A,e,c,d,M)}static createEmptyJSON(e,c=!1,d=!1){return(new m).initialize([],e,c,d,1)}static createEmptyOptimizedCIM(e,c=!1,d=!1,M=1){return(new h).initialize(new D.A,e,c,d,M)}static createEmptyJSONCIM(e,c=!1,d=!1,M=1){return(new r).initialize([],e,c,d,M)}asJSON(){const e=(0,X.x)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:e.flat()}:"esriGeometryPoint"===this.geometryType?{x:e[0][0][0],y:e[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:e}:{paths:e}}getCurrentRingArea(){if(this.pathSize<3)return 0;let e,c,d=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,c=this.y;const M=e,I=c;for(;this.nextPoint();)d+=(e-this.x)*(c+this.y),e=this.x,c=this.y;return d+=(e-M)*(c+I),-.5*d}invertY(){this.yFactor*=-1}}class x extends B{constructor(){super(...arguments),this._end=-1}initialize(e,c,d,M,I){return this.hasZ=d,this.hasM=M,this.geometryType=c,this._stride=2+Number(d)+Number(M),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=I,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const c=this._pathOffset+e*this._stride;return c>=0&&c<this._end&&(this._pointOffset=c,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){return!(this.pathIndex>=this.totalSize-1||(this._pathIndex>=0&&(this._pathOffset+=this._stride*this.pathSize),this._pathIndex++,this._pointOffset=this._pathOffset-this._stride,this._end=this._pointOffset+this._stride+this._stride*this.pathSize,0))}prevPath(){return!(this.pathIndex<=0||(this._pathIndex--,this._end=this._pathOffset,this._pathOffset-=this._stride*this.pathSize,this._pointOffset=this._pathOffset-this._stride,0))}pathLength(){const e=this._end,c=this._stride,d=this._geometry.coords;let M=0;for(let I=this._pathOffset+c;I<e;I+=c){const F=d[I]-d[I-c],N=d[I+1]-d[I-c+1];M+=Math.sqrt(F*F+N*N)}return M}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let c=0;c<this._stride;++c)this._geometry.coords.push(e[c]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,c){this._geometry.coords.push(e,c),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const c of e)for(let d=0;d<this._stride;++d)this._geometry.coords.push(c[d]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const c=e.asOptimized();this._geometry.coords.push(...c.coords),this._geometry.lengths.push(...c.lengths)}asOptimized(){const e=this._geometry.clone();if(1!==this.yFactor)for(let c=1;c<e.coords.length;c+=this._stride)e.coords[c]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,c=this._pathOffset,d=this._end-this._stride;for(let M=0;M<this._stride;M++)if(e[c+M]!==e[d+M])return!1;return!0}clone(){return(new x).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.isPoint?1:this._geometry.lengths.reduce((e,c)=>e+c)}get pathSize(){const{lengths:e}=this._geometry;return this._geometry.isPoint?1:this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.isPoint?1:this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){return this._geometry.coords[this._pointOffset+(this.hasZ?3:2)]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function P(l){const e=[l.x,l.y];return l.z&&e.push(l.z),l.m&&e.push(l.m),e}function _(l){return(0,G.Bi)(l)?[l.rings,"esriGeometryPolygon"]:(0,G.Rg)(l)?[l.paths,"esriGeometryPolyline"]:(0,G.U9)(l)?[[l.points],"esriGeometryMultipoint"]:(0,G.ZC)(l)?[[[[l.xmin,l.ymin],[l.xmin,l.ymax],[l.xmax,l.ymax],[l.xmax,l.ymin],[l.xmin,l.ymin]]],"esriGeometryEnvelope"]:(0,G.fT)(l)?[[[P(l)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class m extends B{initialize(e,c,d,M,I){return this._paths=e,this.geometryType=c,this.hasZ=d,this.hasM=M,this._pathIndex=this._pointIndex=-1,this.yFactor=I,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return this._pathIndex=e,this._pointIndex=-1,e>=0&&e<this.totalSize&&(this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this.pathIndex>0&&(this._pointIndex=-1,this._pathIndex--,this._currentPath=this._paths[this._pathIndex],!0)}pathLength(){const e=this._currentPath.length,c=this._currentPath;let d=0;for(let M=1;M<e;M++){const I=c[M-1],A=c[M],N=A[0]-I[0],$=A[1]-I[1];d+=Math.sqrt(N*N+$*$)}return d}startPath(){this._paths.push([])}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,c){this._paths[this.totalSize-1].push([e,c])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const c=(0,X.x)(e);for(const d of c)this.pushPath(d)}asOptimized(){const e=new D.A;if("esriGeometryPoint"===this.geometryType)e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const c of this._paths){for(const d of c)e.coords.push(d[0]),e.coords.push(d[1]*this.yFactor),this.hasZ&&e.coords.push(d[2]),this.hasM&&e.coords.push(d[this._mIndex]);e.lengths.push(c.length)}return e}isClosed(){const e=this._currentPath[0],c=this._currentPath[this._currentPath.length-1];for(let d=0;d<e.length;d++)if(e[d]!==c[d])return!1;return!0}clone(){return(new m).initialize((0,Z.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map(e=>e.length).reduce((e,c)=>e+c)}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}}class h extends x{initialize(e,c,d,M,I){return super.initialize(e,c,d,M,I),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map(A=>new Set)),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=(new h).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}}class r extends m{initialize(e,c,d,M,I){return super.initialize(e,c,d,M,I)}clone(){return(new r).initialize((0,Z.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(e){this._paths[this.pathIndex][e][4]=1}getControlPointAt(e){return 1===this._paths[this.pathIndex][e][4]}}},13259:(dt,it,S)=>{S.d(it,{d:()=>P});var Z=S(51995),X=S(83065),G=S(39239),D=S(15268),B=S(62928);const x=222045e-19;function P(z){if(0===z.totalSize)return null;const b=(0,X.z8)(z);if(!b)return null;const v=4*(Math.abs(b[0])+Math.abs(b[2])+Math.abs(b[1])+Math.abs(b[3])+1)*x;let T=0,L=0;z.reset();for(let u=0;z.nextPath();u++){const p=z.getCurrentRingArea();p>L&&(L=p,T=u)}if(z.seekPath(T),0===z.pathSize)return null;z.seekPathStart();const R=(0,X.B$)(z);if(Math.abs(L)<=2*v*v)return[(R[0]+R[2])/2,(R[1]+R[3])/2];z.seekPathStart();const K=(0,G.w2)(z,(0,Z.vt)());if(null===K)return null;if(z.totalPoints<4)return K;const k=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],Y=[NaN,NaN,NaN,NaN],tt=[NaN,NaN,NaN,NaN];let ot=!1,q=m(K,z,!0);0===q.distance&&(ot=!0,k[0][0]=K[0],k[0][1]=K[1],q=m(K,z,!1)),Y[0]=q.distance,tt[0]=0;const lt=[NaN,NaN];let rt=!1,ct=.25,ut=-1,at=NaN;do{if(at=NaN,k[1]=f(z,M(R[0],R[2],ct),0,b),isNaN(k[1][0])||isNaN(k[1][1])||(q=m(k[1],z,!1),at=q.distance),!isNaN(at)&&at>v&&_(k[1],z))rt=!0,Y[1]=at,tt[1]=I(k[1],K);else if(!isNaN(at)&&at>ut&&(ut=at,lt[0]=k[1][0],lt[1]=k[1][1]),ct-=.01,ct<.1){if(!(ut>=0))break;rt=!0,Y[1]=ut,k[1][0]=lt[0],k[1][1]=lt[1],tt[1]=I(k[1],K)}}while(!rt);rt=!1,ct=.5,ut=-1;let ft=.01,Pt=1;do{if(at=NaN,k[2]=f(z,M(R[0],R[2],ct),0,b),isNaN(k[2][0])||isNaN(k[2][1])||(q=m(k[2],z,!1),at=q.distance),!isNaN(at)&&at>v&&_(k[2],z))rt=!0,Y[2]=at,tt[2]=I(k[2],K);else if(!isNaN(at)&&at>ut)ut=at,lt[0]=k[2][0],lt[1]=k[2][1];else if(at>ut&&(ut=at,lt[0]=k[2][0],lt[1]=k[2][1]),ct=.5+ft*Pt,ft+=.01,Pt*=-1,ct<.3||ct>.7){if(!(ut>=0))break;rt=!0,Y[2]=ut,k[2][0]=lt[0],k[2][1]=lt[1],tt[2]=I(k[2],K)}}while(!rt);rt=!1,ct=.75,ut=-1;do{if(at=NaN,k[3]=f(z,M(R[0],R[2],ct),0,b),isNaN(k[3][0])||isNaN(k[3][1])||(q=m(k[3],z,!1),at=q.distance),!isNaN(at)&&at>v&&_(k[3],z))rt=!0,Y[3]=at,tt[3]=I(k[3],K);else if(at>ut&&(ut=at,lt[0]=k[3][0],lt[1]=k[3][1]),ct+=.01,ct>.9){if(!(ut>=0))break;rt=!0,Y[3]=ut,k[3][0]=lt[0],k[3][1]=lt[1],tt[3]=I(k[3],K)}}while(!rt);const mt=[0,1,2,3],pt=ot?0:1;let yt;for(let u=pt;u<4;u++)for(let p=pt;p<3;p++){const y=tt[p],C=tt[p+1];A(y,C)>0&&(yt=mt[p],mt[p]=mt[p+1],mt[p+1]=yt,tt[p]=C,tt[p+1]=y)}let J=pt,o=0,n=0;for(let u=pt;u<4;u++){switch(u){case 0:n=2*Y[mt[u]];break;case 1:n=1.66666666*Y[mt[u]];break;case 2:n=1.33333333*Y[mt[u]];break;case 3:n=Y[mt[u]]}n>o&&(o=n,J=mt[u])}return k[J]}function _(z,b){let v,T,L,R,K=0;for(b.reset();b.nextPath()&&b.nextPoint();)for(v=b.x,T=b.y;b.nextPoint();v=L,T=R)L=b.x,R=b.y,T>z[1]!=R>z[1]&&((L-v)*(z[1]-T)-(R-T)*(z[0]-v)>0?K++:K--);return 0!==K}function m(z,b,v){if(v&&_(z,b))return{coord:z,distance:0};let T=1/0,L=0,R=0,K=[0,0],k=[0,0];const Y=[0,0];for(b.reset();b.nextPath()&&b.nextPoint();)if(!(b.pathSize<2))for(K[0]=b.x,K[1]=b.y;b.nextPoint();K=k){k=[b.x,b.y],(0,D.gR)(Y,z,K,k);const tt=I(z,Y);tt<T&&(T=tt,L=Y[0],R=Y[1])}return{coord:[L,R],distance:Math.sqrt(T)}}function f(z,b,v,T){const L=[b,0];let R=1/0,K=1/0,k=!1,Y=!1;const tt=[[b,T[1]-1],[b,T[3]+1]],ot=[0,0],q=[0,0],lt=[0,0],rt=[[0,0],[0,0]],ct=(0,Z.vt)();for(z.reset();z.nextPath()&&z.nextPoint();)if(!(z.pathSize<2))for(rt[0][0]=z.x,rt[0][1]=z.y;z.nextPoint();rt[0][0]=rt[1][0],rt[0][1]=rt[1][1]){if(rt[1][0]=z.x,rt[1][1]=z.y,null===g(ct,rt)||(q[0]=tt[0][0],q[1]=tt[0][1],lt[0]=tt[1][0],lt[1]=tt[1][1],0===c(ct,q,lt))||!(0,B.Ql)(tt[0],tt[1],rt[0],rt[1],ot))continue;const ut=ot[1];R>K?ut<R&&(R=ut,k=!0):ut<K&&(K=ut,Y=!0)}return k&&Y?L[1]=(R+K)/2:L[0]=L[1]=NaN,L}function g(z,b){if(b.length<2)return null;z||(z=(0,Z.vt)());const[v,T]=b[0],[L,R]=b[1];return z[0]=Math.min(v,L),z[1]=Math.min(T,R),z[2]=Math.max(v,L),z[3]=Math.max(T,R),z}const h=1,r=4,l=3,e=12;function c(z,b,v){let T=d(b,z),L=d(v,z);const R=z[0],K=z[1],k=z[2],Y=z[3];if(T&L)return 0;if(!(T|L))return 4;const tt=(T?1:0)|(L?2:0);do{const ot=v[0]-b[0],q=v[1]-b[1];if(ot>q)T&l?(T&h?(b[1]+=q*(R-b[0])/ot,b[0]=R):(b[1]+=q*(k-b[0])/ot,b[0]=k),T=d(b,z)):L&l?(L&h?(v[1]+=q*(R-v[0])/ot,v[0]=R):(v[1]+=q*(k-v[0])/ot,v[0]=k),L=d(v,z)):T?(T&r?(b[0]+=ot*(K-b[1])/q,b[1]=K):(b[0]+=ot*(Y-b[1])/q,b[1]=Y),T=d(b,z)):(L&r?(v[0]+=ot*(K-v[1])/q,v[1]=K):(v[0]+=ot*(Y-v[1])/q,v[1]=Y),L=d(v,z));else if(T&e?(T&r?(b[0]+=ot*(K-b[1])/q,b[1]=K):(b[0]+=ot*(Y-b[1])/q,b[1]=Y),T=d(b,z)):L&e?(L&r?(v[0]+=ot*(K-v[1])/q,v[1]=K):(v[0]+=ot*(Y-v[1])/q,v[1]=Y),L=d(v,z)):T?(T&h?(b[1]+=q*(R-b[0])/ot,b[0]=R):(b[1]+=q*(k-b[0])/ot,b[0]=k),T=d(b,z)):(L&h?(v[1]+=q*(R-v[0])/ot,v[0]=R):(v[1]+=q*(k-v[0])/ot,v[0]=k),L=d(v,z)),T&L)return 0}while(T|L);return tt}function d(z,b){return(z[0]<b[0]?1:0)|(z[0]>b[2]?1:0)<<1|(z[1]<b[1]?1:0)<<2|(z[1]>b[3]?1:0)<<3}function M(z,b,v){return z+(b-z)*v}function I(z,b){return(z[0]-b[0])*(z[0]-b[0])+(z[1]-b[1])*(z[1]-b[1])}function A(z,b){if(z<b)return-1;if(z>b)return 1;if(z===b)return 0;const v=isNaN(z),T=isNaN(b);return v<T?-1:v>T?1:0}},61245:(dt,it,S)=>{S.d(it,{Aq:()=>D,pC:()=>B,rx:()=>x});var Z=S(47961),X=S(76571);function D(P,_){P[4]=_}class B{constructor(_,m=!0,f=!0,g=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!m&&"esriGeometryPolygon"===_.geometryType||!f&&"esriGeometryPolyline"===_.geometryType?null:_,this.geomUnitsPerPoint=g,this.iterateMultiPath=!1,this.iteratePath=!1,this.internalPlacement=new X.W}next(){if(!this.geometryCursor)return null;const _=this.processMultiPath(this.geometryCursor);return this.iterateMultiPath&&_||(this.geometryCursor=null),_}processMultiPath(_){for(;this.iteratePath||_.pathIndex<_.totalSize-1;){this.iteratePath||_.nextPath(),this.iterateMultiPath=!0;const m=this.processPath(_);if(m)return m}return this.iterateMultiPath=!1,null}}class x{constructor(_,m,f,g=0){this.isClosed=!1,this._tileKey=null,this.inputGeometries=_,this.acceptPolygon=m,this.acceptPolyline=f,this.geomUnitsPerPoint=g,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let _=this.inputGeometries.next();for(;_&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===_.geometryType||"esriGeometryEnvelope"===_.geometryType,this.multiPathCursor=_,!this.multiPathCursor);)_=this.inputGeometries.next();if(!this.multiPathCursor)return null;this._tileKey&&this.isClippingRequired(this.multiPathCursor)&&(this.multiPathCursor.reset(),this.multiPathCursor=(0,Z.q)(this.multiPathCursor,256))}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const _=this.processPath(this.multiPathCursor);if(_)return _}this.multiPathCursor=null}}isClippingRequired(_){return!1}}},47961:(dt,it,S)=>{S.d(it,{k:()=>B,q:()=>x});var Z=S(72137),X=S(91766);const G=512;let D;class B{constructor(_){this._geometry=_}next(){const _=this._geometry;return this._geometry=null,_}}function x(P,_){D||(D=new X.O3(0,0,0,1));const m="esriGeometryPolygon"===P.geometryType,g=m?3:2;let h,r;for(D.reset(m?X.dC.Polygon:X.dC.LineString),D.setPixelMargin(_+1),D.setExtent(G);P.nextPath();)if(!(P.pathSize<g)){for(P.nextPoint(),h=P.x,r=-P.y,D.moveTo(h,r);P.nextPoint();)h=P.x,r=-P.y,D.lineTo(h,r);m&&D.close()}const l=D.result(!1);if(l){const e=Z.z.createEmptyOptimizedCIM(P.geometryType);for(const c of l){e.startPath();for(const d of c)e.pushXY(d.x,-d.y)}return e.reset(),e}return null}},91486:(dt,it,S)=>{S.d(it,{A:()=>b,c:()=>v});let Z=(()=>{class T{static local(){return null===T.instance&&(T.instance=new T),T.instance}execute(R,K,k,Y,tt){return new X(R,K,k)}}return T.instance=null,T})();class X{constructor(L,R,K){this._inputGeometries=L,this._angleTolerance=void 0!==R.angleTolerance?R.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let L=this._inputGeometries.next();for(;L;){if("esriGeometryPolygon"===L.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===L.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==L.geometryType){L=this._inputGeometries.next();continue}if(this._maxCosAngle)return L;this._isClosed=!0}for(;L.nextPath();)this._processPath(L);return L.reset(),L}return null}_processPath(L){if(L.nextPoint()){const R=L.x,K=L.y;let k=R,Y=K,tt=L.pathSize,ot=0,q=0,lt=0,rt=0,ct=0,ut=0;this._isClosed&&++tt;for(let at=1;L.nextPoint()||at<tt;++at){let ft,Pt;this._isClosed&&at===tt-1?(ft=R,Pt=K):(ft=L.x,Pt=L.y);const mt=ft-k,pt=Pt-Y,yt=Math.sqrt(mt*mt+pt*pt);at>1&&yt>0&&lt>0&&(ot*mt+q*pt)/yt/lt<=this._maxCosAngle&&L.setControlPointAt(at-1),1===at&&(rt=mt,ct=pt,ut=yt),yt>0&&(k=ft,Y=Pt,ot=mt,q=pt,lt=yt)}this._isClosed&&lt>0&&ut>0&&(ot*rt+q*ct)/ut/lt<=this._maxCosAngle&&L.setControlPointAt(0)}}}var G=S(47763),D=S(69630),B=S(71045),x=S(82854),P=S(65264),_=S(70614),m=S(88918);let f=(()=>{class T{static local(){return null===T.instance&&(T.instance=new T),T.instance}execute(R,K,k,Y,tt){return new g(R,K,k)}}return T.instance=null,T})();class g{constructor(L,R,K){this._inputGeometries=L,this._offsetX=void 0!==R.offsetX?R.offsetX*K:0,this._offsetY=void 0!==R.offsetY?R.offsetY*K:0}next(){let L=this._inputGeometries.next();for(;L;){if(L.totalSize>0)return this._move(L.clone(),this._offsetX,this._offsetY);L=this._inputGeometries.next()}return null}_move(L,R,K){for(;L.nextPath();)for(;L.nextPoint();)L.x=L.x+R,L.y=L.y+K;return L.reset(),L}}var h=S(3691);let r=(()=>{class T{static local(){return null===T.instance&&(T.instance=new T),T.instance}execute(R,K,k,Y,tt){return new l(R,K,k)}}return T.instance=null,T})();class l{constructor(L,R,K){this._inputGeometries=L,this._reverse=void 0===R.reverse||R.reverse}next(){let L=this._inputGeometries.next();for(;L;){if(!this._reverse)return L;if("esriGeometryPolyline"===L.geometryType)return e(L.clone());L=this._inputGeometries.next()}return null}}function e(T){for(;T.nextPath();)for(let L=0;L<T.pathSize/2;L++){T.seekInPath(L);const R=T.x,K=T.y;T.seekInPath(T.pathSize-L-1);const k=T.x,Y=T.y;T.x=R,T.y=K,T.seekInPath(L),T.x=k,T.y=Y}return T.reset(),T}var c=S(25867),d=S(39516),M=S(57249),I=S(2544),A=S(34572),U=S(56854),F=S(47942),N=S(53737),$=S(3688),z=S(68051);function b(T){if(!T)return null;switch(T.type){case"CIMGeometricEffectAddControlPoints":return Z.local();case"CIMGeometricEffectArrow":return G.B.local();case"CIMGeometricEffectBuffer":return D.s.local();case"CIMGeometricEffectControlMeasureLine":return B.v.local();case"CIMGeometricEffectCut":return x.y.local();case"CIMGeometricEffectDashes":return P.I.local();case"CIMGeometricEffectDonut":return _.O.local();case"CIMGeometricEffectJog":return m.U.local();case"CIMGeometricEffectMove":return f.local();case"CIMGeometricEffectOffset":return h.V.local();case"CIMGeometricEffectReverse":return r.local();case"CIMGeometricEffectRotate":return c.v.local();case"CIMGeometricEffectScale":return d.W.local();case"CIMGeometricEffectWave":return M.l.local()}return null}function v(T){if(!T)return null;switch(T.type){case"CIMMarkerPlacementAlongLineSameSize":return I.e.local();case"CIMMarkerPlacementAtExtremities":return A.y.local();case"CIMMarkerPlacementAtRatioPositions":return U.S.local();case"CIMMarkerPlacementInsidePolygon":return F.M.local();case"CIMMarkerPlacementOnLine":return N.R.local();case"CIMMarkerPlacementOnVertices":return $.A.local();case"CIMMarkerPlacementPolygonCenter":return z.L.local()}return null}},76571:(dt,it,S)=>{S.d(it,{W:()=>Z});class Z{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(D,B){this.tx=D,this.ty=B}setTranslateZ(D){this.tz=D}setRotateCS(D,B){this.rz=void 0,this.rzCos=D,this.rzSin=B}setRotate(D){this.rz=D,this.rzCos=void 0,this.rzSin=void 0}setRotateY(D){this.ry=D}setScale(D){this.s=D}setMeasure(D){this.m=D}}},91767:(dt,it,S)=>{S.d(it,{Rj:()=>lt,mx:()=>ot,CK:()=>q,IT:()=>Y,QF:()=>Pt});var Z=S(98894),X=S(3248),G=S(77806),D=S(35150),B=S(61591),x=S(67685),P=S(72137),_=S(51995),m=S(83065),f=S(39239),g=S(61320),h=S(47961);class r{applyColorSubstituition(o,n){if(!n)return o;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:u,height:p}=o,y=this._rasterizationCanvas,C=y.getContext("2d",{willReadFrequently:!0});o!==y&&(y.width=u,y.height=p,C.drawImage(o,0,0,u,p));const E=C.getImageData(0,0,u,p).data;if(n)for(const w of n)if(w&&w.oldColor&&4===w.oldColor.length&&w.newColor&&4===w.newColor.length){const[j,W,H,et]=w.oldColor,[st,Q,V,ht]=w.newColor;if(j===st&&W===Q&&H===V&&et===ht)continue;for(let nt=0;nt<E.length;nt+=4)j===E[nt]&&W===E[nt+1]&&H===E[nt+2]&&et===E[nt+3]&&(E[nt]=st,E[nt+1]=Q,E[nt+2]=V,E[nt+3]=ht)}const O=new ImageData(E,u,p);return C.putImageData(O,0,0),y}tintImageData(o,n){if(!n||n.length<4)return o;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:u,height:p}=o,y=this._rasterizationCanvas,C=y.getContext("2d",{willReadFrequently:!0});o!==y&&(y.width=u,y.height=p,C.drawImage(o,0,0,u,p));const E=C.getImageData(0,0,u,p),O=new Uint8Array(E.data),w=[n[0]/255,n[1]/255,n[2]/255,n[3]/255];for(let W=0;W<O.length;W+=4)O[W]*=w[0],O[W+1]*=w[1],O[W+2]*=w[2],O[W+3]*=w[3];const j=new ImageData(new Uint8ClampedArray(O.buffer),u,p);return C.putImageData(j,0,0),y}}var l=S(91486),e=S(76571),c=S(46988),d=S(65374);function M(J){const o=J.getFrame(0);if(o instanceof HTMLImageElement||o instanceof HTMLCanvasElement)return o;const n=document.createElement("canvas");n.width=J.width,n.height=J.height;const u=n.getContext("2d");return o instanceof ImageData?u.putImageData(o,0,0):u.drawImage(o,0,0),n}var I=S(9792),A=S(68448);function F(J){return`rgba(${J.slice(0,3).toString()},${J[3]})`}class N{constructor(o){o&&(this._textRasterizationCanvas=o)}rasterizeText(o,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const u=this._textRasterizationCanvas,p=u.getContext("2d",{willReadFrequently:!0});$(p,n),this._parameters=n,this._textLines=o.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:y,weight:C}=n.font;this._lineThroughWidthOffset=y&&"line-through"===y?.1*this._lineHeight:0;const E=null!=n.backgroundColor||null!=n.borderLine,O=E?A.y7:0,w=this._computeTextWidth(p,n)+2*O,j=this._lineHeight*this._textLines.length+2*O;if(u.width=w+2*this._lineThroughWidthOffset,u.height=j,0===u.width||0===u.height)return u.width=u.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:u};this._renderedLineHeight=Math.round(this._lineHeight*n.pixelRatio),this._renderedHaloSize=(0,x.Lz)(n.halo.size)*n.pixelRatio,this._renderedWidth=w*n.pixelRatio,this._renderedHeight=j*n.pixelRatio,this._lineThroughWidthOffset*=n.pixelRatio;const H=n.halo&&n.halo.color?n.halo.color:[0,0,0,0];this._fillStyle=F(n.color??[0,0,0,0]),this._haloStyle=function U(J){return`rgb(${J.slice(0,3).toString()})`}(H);const et=this._renderedLineHeight,st=this._renderedHaloSize;p.save(),p.clearRect(0,0,u.width,u.height),$(p,n);const Q=O*n.pixelRatio,V=function z(J,o){return"center"===J?.5*o:"right"===J?o:0}(p.textAlign,this._renderedWidth-2*Q)+st+Q,ht=st+Q,nt=st>0;let _t=this._lineThroughWidthOffset,gt=0;if(E){p.save();const St=n.backgroundColor??[0,0,0,0],Et=n.borderLine?.color??[0,0,0,0],vt=2*(0,x.Lz)(n.borderLine?.size??0);p.fillStyle=F(St),p.strokeStyle=F(Et),p.lineWidth=vt,p.fillRect(0,0,u.width,u.height),p.strokeRect(0,0,u.width,u.height),p.restore()}nt&&this._renderHalo(p,V,ht,_t,gt,n),gt+=ht,_t+=V;for(const St of this._textLines)nt?(p.globalCompositeOperation="destination-out",p.fillStyle="rgb(0, 0, 0)",p.fillText(St,_t,gt),p.globalCompositeOperation="source-over",p.fillStyle=this._fillStyle,p.fillText(St,_t,gt)):(p.fillStyle=this._fillStyle,p.fillText(St,_t,gt)),y&&"none"!==y&&this._renderDecoration(p,_t,gt,y,C),gt+=et;p.restore();const Mt=this._renderedWidth+2*this._lineThroughWidthOffset,bt=this._renderedHeight,Ct=p.getImageData(0,0,Mt,bt),xt=new Uint8Array(Ct.data);if(n.premultiplyColors){let St;for(let Et=0;Et<xt.length;Et+=4)St=xt[Et+3]/255,xt[Et]=xt[Et]*St,xt[Et+1]=xt[Et+1]*St,xt[Et+2]=xt[Et+2]*St}let wt,It;switch(n.horizontalAlignment){case"left":wt=-.5;break;case"right":wt=.5;break;default:wt=0}switch(n.verticalAlignment){case"bottom":It=-.5;break;case"top":It=.5;break;case"baseline":It=-1/6;break;default:It=0}return{size:[Mt,bt],image:new Uint32Array(xt.buffer),sdf:!1,simplePattern:!1,anchorX:wt,anchorY:It,canvas:u}}_renderHalo(o,n,u,p,y,C){const E=this._renderedWidth,O=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=E,this._haloRasterizationCanvas.height=O;const w=this._haloRasterizationCanvas,j=w.getContext("2d");j.clearRect(0,0,E,O),$(j,C);const{decoration:W,weight:H}=C.font;j.fillStyle=this._haloStyle,j.strokeStyle=this._haloStyle,j.lineJoin="round",this._renderHaloNative(j,n,u,W,H),o.globalAlpha=this._parameters.halo.color[3],o.drawImage(w,0,0,E,O,p,y,E,O),o.globalAlpha=1}_renderHaloNative(o,n,u,p,y){const C=this._renderedLineHeight,E=this._renderedHaloSize;for(const O of this._textLines){const w=2*E,j=5,W=.1;for(let H=0;H<j;H++){const et=(1-(j-1)*W+H*W)*w;o.lineWidth=et,o.strokeText(O,n,u),p&&"none"!==p&&this._renderDecoration(o,n,u,p,y,et)}u+=C}}computeTextSize(o,n){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const u=this._textRasterizationCanvas,p=u.getContext("2d");$(p,n),this._parameters=n,this._textLines=o.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const y=this._computeTextWidth(p,n),C=this._lineHeight*this._textLines.length;return u.width=y,u.height=C,[y*n.pixelRatio,C*n.pixelRatio]}_computeTextWidth(o,n){let u=0;for(const y of this._textLines)u=Math.max(u,o.measureText(y).width);const p=n.font;return("italic"===p.style||"oblique"===p.style||"string"==typeof p.weight&&("bold"===p.weight||"bolder"===p.weight)||"number"==typeof p.weight&&p.weight>600)&&(u+=.3*o.measureText("w").width),u+=2*(0,x.Lz)(this._parameters.halo.size),Math.round(u)}_computeLineHeight(){let o=1.275*this._parameters.size;const n=this._parameters.font.decoration;return n&&"underline"===n&&(o*=1.3),Math.round(o+2*(0,x.Lz)(this._parameters.halo.size))}_renderDecoration(o,n,u,p,y,C){const E=.9*this._lineHeight,O="bold"===y?.06:"bolder"===y?.09:.04;switch(o.textAlign){case"center":n-=this._renderedWidth/2;break;case"right":n-=this._renderedWidth}const w=o.textBaseline;if("underline"===p)switch(w){case"top":u+=E;break;case"middle":u+=E/2}else if("line-through"===p)switch(w){case"top":u+=E/1.5;break;case"middle":u+=E/3}const j=C?1.5*C:Math.ceil(E*O);o.save(),o.beginPath(),o.strokeStyle=o.fillStyle,o.lineWidth=j,o.moveTo(n-this._lineThroughWidthOffset,u),o.lineTo(n+this._renderedWidth+2*this._lineThroughWidthOffset,u),o.stroke(),o.restore()}}function $(J,o){const n=Math.max(o.size,.5),u=o.font,p=`${u.style} ${u.weight} ${(0,x.Lz)(n*o.pixelRatio).toFixed(1)}px ${u.family}, sans-serif`;let y;switch(J.font=p,J.textBaseline="top",o.horizontalAlignment){case"left":default:y="left";break;case"right":y="right";break;case"center":y="center"}J.textAlign=y}var b=S(32117),v=S(47669),T=S(42058),L=S(36741);const R=Math.PI/180;class Y{constructor(o){this._t=o}static createIdentity(){return new Y([1,0,0,0,1,0])}clone(){return new Y(this._t.slice())}transform(o){const n=this._t;return[n[0]*o[0]+n[1]*o[1]+n[2],n[3]*o[0]+n[4]*o[1]+n[5]]}static createScale(o,n){return new Y([o,0,0,0,n,0])}scale(o,n){const u=this._t;return u[0]*=o,u[1]*=o,u[2]*=o,u[3]*=n,u[4]*=n,u[5]*=n,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(o,n){return new Y([0,0,o,0,0,n])}translate(o,n){const u=this._t;return u[2]+=o,u[5]+=n,this}static createRotate(o){const n=Math.cos(o),u=Math.sin(o);return new Y([n,-u,0,u,n,0])}rotate(o){return Y.multiply(this,Y.createRotate(o),this)}angle(){const o=this._t[0],n=this._t[3],u=Math.sqrt(o*o+n*n);return[o/u,n/u]}static multiply(o,n,u){const p=o._t,y=n._t,E=p[1]*y[0]+p[4]*y[1],O=p[2]*y[0]+p[5]*y[1]+y[2],w=p[0]*y[3]+p[3]*y[4],j=p[1]*y[3]+p[4]*y[4],W=p[2]*y[3]+p[5]*y[4]+y[5],H=u._t;return H[0]=p[0]*y[0]+p[3]*y[1],H[1]=E,H[2]=O,H[3]=w,H[4]=j,H[5]=W,u}invert(){const o=this._t;let n=o[0]*o[4]-o[1]*o[3];return 0===n?new Y([0,0,0,0,0,0]):(n=1/n,new Y([o[4]*n,-o[1]*n,(o[1]*o[5]-o[2]*o[4])*n,-o[3]*n,o[0]*n,(o[2]*o[3]-o[0]*o[5])*n]))}}class tt{constructor(o,n){this._resourceManager=o,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new B.A(e.W,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(n||Y.createIdentity()),this._sizeTransfos.push(n?n.scaleRatio():1)}setTransform(o,n){this._transfos=[o||Y.createIdentity()],this._sizeTransfos=[n||(o?o.scaleRatio():1)]}setGeomUnitsPerPoint(o){this._geomUnitsPerPoint=o}transformPt(o){return this._transfos[this._transfos.length-1].transform(o)}transformSize(o){return o*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(o){return this._transfos[this._transfos.length-1].invert().transform(o)}reverseTransformSize(o){return o/this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformScalar(o){return o/this._transfos[this._transfos.length-1].scaleRatio()}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}prevGeomUnitsPerPoint(){return this._transfos.length>2?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(o,n){const u=n?o.scaleRatio():1;Y.multiply(o,this.back(),o),this._transfos.push(o),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*u)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(o,n,u){if(o)switch(o.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(o,n);break;case"CIMTextSymbol":this.drawTextSymbol(o,n,u)}}drawMultiLayerSymbol(o,n){if(!o||!n)return;const u=o.symbolLayers;if(!u)return;const p=o.effects;if(p&&p.length>0){const y=this.executeEffects(p,n);if(y){let C=y.next();for(;C;)this.drawSymbolLayers(u,C.asJSON()),C=y.next()}}else this.drawSymbolLayers(u,n)}executeEffects(o,n){const u=this._resourceManager.geometryEngine;let p=new h.k(P.z.fromJSONCIM(n));for(const y of o){const C=(0,l.A)(y);C&&(p=C.execute(p,y,this.geomUnitsPerPoint(),null,u))}return p}drawSymbolLayers(o,n){let u=o.length;for(;u--;){const p=o[u];if(!p||!1===p.enable)continue;const y=p.effects;if(y&&y.length>0){const C=this.executeEffects(y,n);if(C){let E=null;for(;(E=C.next())&&(this.drawSymbolLayer(p,E.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(p,n);if(this._earlyReturn)return}}drawSymbolLayer(o,n){switch(o.type){case"CIMSolidFill":this.drawSolidFill(n,o.color);break;case"CIMHatchFill":this.drawHatchFill(n,o);break;case"CIMPictureFill":this.drawPictureFill(n,o);break;case"CIMGradientFill":this.drawGradientFill(n,o);break;case"CIMSolidStroke":this.drawSolidStroke(n,o.color,o.width,o.capStyle,o.joinStyle,o.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(n,o);break;case"CIMGradientStroke":this.drawGradientStroke(n,o);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(o,n)}}drawHatchFill(o,n){const u=function rt(J,o,n){let u=(0,b.$w)(J.separation,c.D.CIMHatchFill.separation)*n,p=(0,b.$w)(J.rotation);if(0===u)return null;u<0&&(u=-u);let y=0;const C=.5*u;for(;y>C;)y-=u;for(;y<-C;)y+=u;const E=(0,_.vt)();(0,m.Rg)(E,o),E[0]-=C,E[1]-=C,E[2]+=C,E[3]+=C;const O=[[E[0],E[1]],[E[0],E[3]],[E[2],E[3]],[E[2],E[1]]];for(;p>180;)p-=180;for(;p<0;)p+=180;const w=Math.cos(p*R),j=Math.sin(p*R),W=-u*j,H=u*w;let et,st,Q,V;y=(0,b.$w)(J.offsetX)*n*j-(0,b.$w)(J.offsetY)*n*w,et=Q=Number.MAX_VALUE,st=V=-Number.MAX_VALUE;for(const Ct of O){const xt=Ct[0],wt=Ct[1],It=w*xt+j*wt,St=-j*xt+w*wt;et=Math.min(et,It),Q=Math.min(Q,St),st=Math.max(st,It),V=Math.max(V,St)}Q=Math.floor(Q/u)*u;let ht=w*et-j*Q-W*y/u,nt=j*et+w*Q-H*y/u,_t=w*st-j*Q-W*y/u,gt=j*st+w*Q-H*y/u;const Mt=1+Math.round((V-Q)/u),bt=[];for(let Ct=0;Ct<Mt;Ct++)ht+=W,nt+=H,_t+=W,gt+=H,bt.push([[ht,nt],[_t,gt]]);return{paths:bt}}(n,o,this.geomUnitsPerPoint());u&&(this.pushClipPath(o),this.drawMultiLayerSymbol(n.lineSymbol,u),this.popClipPath())}drawPictureFill(o,n){}drawGradientFill(o,n){}drawPictureStroke(o,n){}drawGradientStroke(o,n){}drawMarkerLayer(o,n){const u=o.markerPlacement;if(u){const p=(0,l.c)(u);if(p){const y="CIMMarkerPlacementInsidePolygon"===u.type||"CIMMarkerPlacementPolygonCenter"===u.type&&u.clipAtBoundary;y&&this.pushClipPath(n);const C=p.execute(P.z.fromJSONCIM(n),u,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(C){let E=null;for(;(E=C.next())&&(this.drawMarker(o,E),!this._earlyReturn););}y&&this.popClipPath()}}else{const p=this._placementPool.acquire();if((0,g.fT)(n))p.tx=n.x,p.ty=n.y,this.drawMarker(o,p);else if((0,g.Bi)(n)){const y=(0,f.l8)(n);y&&([p.tx,p.ty]=y,this.drawMarker(o,p))}else for(const y of n.points)if(p.tx=y[0],p.ty=y[1],this.drawMarker(o,p),this._earlyReturn)break;this._placementPool.release(p)}}drawMarker(o,n){switch(o.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(o,n);break;case"CIMVectorMarker":this.drawVectorMarker(o,n)}}drawPictureMarker(o,n){if(!o)return;const u=this._resourceManager.getResource(o.url),p=(0,b.$w)(o.size,c.D.CIMPictureMarker.size);if(null==u||p<=0)return;const y=u.width,C=u.height;if(!y||!C)return;const E=y/C,O=(0,b.$w)(o.scaleX,1),w=Y.createIdentity(),j=o.anchorPoint;if(j){let V=j.x,ht=j.y;"Absolute"!==o.anchorPointUnits&&(V*=p*E*O,ht*=p),w.translate(-V,-ht)}let W=(0,b.$w)(o.rotation);o.rotateClockwise&&(W=-W),this._mapRotation&&(W+=this._mapRotation),W&&w.rotate(W*R);let H=(0,b.$w)(o.offsetX),et=(0,b.$w)(o.offsetY);if(H||et){if(this._mapRotation){const V=R*this._mapRotation,ht=Math.cos(V),nt=Math.sin(V),_t=H*nt+et*ht;H=H*ht-et*nt,et=_t}w.translate(H,et)}const st=this.geomUnitsPerPoint();1!==st&&w.scale(st,st);const Q=n.getAngle();Q&&w.rotate(Q),w.translate(n.tx,n.ty),this.push(w,!1),this.drawImage(o,p),this.pop()}drawVectorMarker(o,n){if(!o)return;const u=o.markerGraphics;if(!u)return;const p=(0,b.$w)(o.size,c.D.CIMVectorMarker.size),y=o.frame,C=y?y.ymax-y.ymin:0,E=p&&C?p/C:1,O=Y.createIdentity();y&&O.translate(.5*-(y.xmax+y.xmin),.5*-(y.ymax+y.ymin));const w=o.anchorPoint;if(w){let Q=w.x,V=w.y;"Absolute"!==o.anchorPointUnits?y&&(Q*=y.xmax-y.xmin,V*=y.ymax-y.ymin):(Q/=E,V/=E),O.translate(-Q,-V)}1!==E&&O.scale(E,E);let j=(0,b.$w)(o.rotation);o.rotateClockwise&&(j=-j),this._mapRotation&&(j+=this._mapRotation),j&&O.rotate(j*R);let W=(0,b.$w)(o.offsetX),H=(0,b.$w)(o.offsetY);if(W||H){if(this._mapRotation){const Q=R*this._mapRotation,V=Math.cos(Q),ht=Math.sin(Q),nt=W*ht+H*V;W=W*V-H*ht,H=nt}O.translate(W,H)}const et=this.geomUnitsPerPoint();1!==et&&O.scale(et,et);const st=n.getAngle();st&&O.rotate(st),O.translate(n.tx,n.ty),this.push(O,o.scaleSymbolsProportionally);for(const Q of u){Q?.symbol&&Q.geometry||D.A.getLogger("esri.symbols.cim.CIMSymbolDrawHelper").error("Invalid marker graphic",Q);let V=Q.textString;if("number"==typeof V&&(V=V.toString()),this.drawSymbol(Q.symbol,Q.geometry,V),this._earlyReturn)break}this.pop()}drawTextSymbol(o,n,u){if(!o||!(0,g.fT)(n)||(0,b.$w)(o.height,c.D.CIMTextSymbol.height)<=0)return;const p=Y.createIdentity();let y=(0,b.$w)(o.angle);y=-y,y&&p.rotate(y*R);const C=(0,b.$w)(o.offsetX),E=(0,b.$w)(o.offsetY);(C||E)&&p.translate(C,E);const O=this.geomUnitsPerPoint();1!==O&&p.scale(O,O),p.translate(n.x,n.y),this.push(p,!1),this.drawText(o,u),this.pop()}}class ot extends tt{constructor(o,n){super(o,n),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new I.A(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,_.fA)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(o){if(o&&!(this._clipCount>0))if((0,g.Bi)(o))this._processPath(o.rings,0);else if((0,g.Rg)(o))this._processPath(o.paths,0);else if((0,g.ZC)(o)){const n=ft(o);n&&this._processPath(n.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(o,n,u){if(!o||this._clipCount>0||null==u||u<=0)return;const p=Math.max(.5*this.transformSize((0,b.$w)(u,c.D.CIMSolidStroke.width)),.25);if((0,g.Bi)(o))this._processPath(o.rings,p);else if((0,g.Rg)(o))this._processPath(o.paths,p);else if((0,g.ZC)(o)){const y=ft(o);y&&this._processPath(y.rings,p)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(o,n){(0,g.Bi)(n)&&o.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===o.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===o.markerPlacement.type&&o.markerPlacement.clipAtBoundary)?this._processPath(n.rings,0):super.drawMarkerLayer(o,n)}drawHatchFill(o,n){this.drawSolidFill(o)}drawPictureFill(o,n){this.drawSolidFill(o)}drawGradientFill(o,n){this.drawSolidFill(o)}drawPictureStroke(o,n){this.drawSolidStroke(o,null,n.width)}drawGradientStroke(o,n){this.drawSolidStroke(o,null,n.width)}pushClipPath(o){this.drawSolidFill(o),this._clipCount++}popClipPath(){this._clipCount--}drawImage(o,n){const{url:u}=o,p=(0,b.$w)(o.scaleX,1);let y=p*n,C=n;const E=this._resourceManager.getResource(u);if(null!=E){const O=E.height/E.width;y=p*(n?O>1?n:n/O:E.width),C=n?O>1?n*O:n:E.height}this._merge(this.transformPt([-y/2,-C/2]),0),this._merge(this.transformPt([-y/2,C/2]),0),this._merge(this.transformPt([y/2,-C/2]),0),this._merge(this.transformPt([y/2,C/2]),0)}drawText(o,n){if(!n||0===n.length)return;this._textRasterizer||(this._textRasterizer=new N);const u=mt(o);let[p,y]=this._textRasterizer.computeTextSize(n,u);p=(0,x.PN)(p),y=(0,x.PN)(y);let C=0;switch(o.horizontalAlignment){case"Left":C=p/2;break;case"Right":C=-p/2}let E=0;switch(o.verticalAlignment){case"Bottom":E=y/2;break;case"Top":E=-y/2;break;case"Baseline":E=y/6}this._merge(this.transformPt([-p/2+C,-y/2+E]),0),this._merge(this.transformPt([-p/2+C,y/2+E]),0),this._merge(this.transformPt([p/2+C,-y/2+E]),0),this._merge(this.transformPt([p/2+C,y/2+E]),0)}_processPath(o,n){if(o)for(const u of o){const p=u?u.length:0;if(p>1){this._merge(this.transformPt(u[0]),n);for(let y=1;y<p;y++)this._merge(this.transformPt(u[y]),n)}}}_merge(o,n){o[0]-n<this._xmin&&(this._xmin=o[0]-n),o[0]+n>this._xmax&&(this._xmax=o[0]+n),o[1]-n<this._ymin&&(this._ymin=o[1]-n),o[1]+n>this._ymax&&(this._ymax=o[1]+n)}}class q extends tt{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null}hitTest(o,n,u,p,y,C){const E=C*(0,x.Lz)(1);if(this.setTransform(),this.setGeomUnitsPerPoint(E),this._searchPoint=[(o[0]+o[2])/2,(o[1]+o[3])/2],this._searchDistPoint=(o[2]-o[0])/2/E,this._textInfo=p,this._mapRotation=n&&("CIMPointSymbol"===n.type&&"Map"!==n.angleAlignment||"CIMTextSymbol"===n.type)?y:0,!(0,X.A)("esri-mobile")){const w=(0,x.PN)(v._M*window.devicePixelRatio),j=(0,x.PN)(v.ie);("CIMLineSymbol"!==n?.type&&"CIMPolygonSymbol"!==n?.type||!n.symbolLayers?.some(b.jn))&&"CIMMeshSymbol"!==n?.type&&((0,b.YC)(n)??0)<j&&(this._searchDistPoint=w)}return this._earlyReturn=!1,this.drawSymbol(n,u),this._earlyReturn}drawSolidFill(o,n){this._hitTestFill(o)}drawHatchFill(o,n){this._hitTestFill(o)}drawPictureFill(o,n){this._hitTestFill(o)}drawGradientFill(o,n){this._hitTestFill(o)}drawSolidStroke(o,n,u,p,y,C){this._hitTestStroke(o,u)}drawPictureStroke(o,n){this._hitTestStroke(o,n.width)}drawGradientStroke(o,n){this._hitTestStroke(o,n.width)}drawMarkerLayer(o,n){o.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===o.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===o.markerPlacement.type&&o.markerPlacement.clipAtBoundary)?this._hitTestFill(n):super.drawMarkerLayer(o,n)}pushClipPath(o){}popClipPath(){}drawImage(o,n){const{url:u}=o,p=(0,b.$w)(o.scaleX,1),y=this._resourceManager.getResource(u);if(null==y||0===y.height||0===n)return;const C=n*this.geomUnitsPerPoint(),E=C*p*(y.width/y.height),O=this.reverseTransformPt(this._searchPoint),w=this._searchDistPoint;Math.abs(O[0])<E/2+w&&Math.abs(O[1])<C/2+w&&(this._earlyReturn=!0)}drawText(o,n){const u=this._textInfo;if(!u)return;const p=u.get(o);if(!p||!p.glyphMosaicItems.glyphs.length)return;const y=(0,L.hV)((0,b.$w)(o.height,c.D.CIMTextSymbol.height)),{lineGapType:C,lineGap:E}=o,O=C?Pt(C,(0,b.$w)(E),y):0,w="CIMBackgroundCallout"===o.callout?.type,j=(0,T.Tl)(p.glyphMosaicItems,{scale:y/v.eG,angle:0,xOffset:0,yOffset:0,horizontalAlignment:o.horizontalAlignment,verticalAlignment:o.verticalAlignment,maxLineWidth:(0,L.Lu)(o.lineWidth),lineHeight:v.DY*Math.max(.25,Math.min(O||1,4)),decoration:o.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:w}),W=this.reverseTransformPt(this._searchPoint),H=W[0],et=W[1];for(const st of j.glyphs)if(H>st.xTopLeft&&H<st.xBottomRight&&et>-st.yBottomRight&&et<-st.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(o){let n=null;if((0,g.ZC)(o))n=[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]];else if((0,g.Bi)(o))n=o.rings;else{if(!(0,g.Rg)(o))return;n=o.paths}const u=this.reverseTransformPt(this._searchPoint);(function ct(J,o){let n=0;for(const u of o){const p=u.length;for(let y=1;y<p;y++){const C=u[y-1],E=u[y];C[1]>J[1]!=E[1]>J[1]&&((E[0]-C[0])*(J[1]-C[1])-(E[1]-C[1])*(J[0]-C[0])>0?n++:n--)}}return 0!==n})(u,n)&&(this._earlyReturn=!0),!this._earlyReturn&&ut(u,n,this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}_hitTestStroke(o,n){let u=null;if((0,g.ZC)(o))u=[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]];else if((0,g.Bi)(o))u=o.rings;else{if(!(0,g.Rg)(o))return;u=o.paths}ut(this.reverseTransformPt(this._searchPoint),u,(0,b.$w)(n,c.D.CIMSolidStroke.width)*this.geomUnitsPerPoint()/2+this.reverseTransformScalar(this._searchDistPoint)*this.prevGeomUnitsPerPoint())&&(this._earlyReturn=!0)}}class lt extends tt{constructor(o,n,u,p){super(n,u),this._applyAdditionalRenderProps=p,this._colorSubstitutionHelper=new r,this._ctx=o}drawSolidFill(o,n){if(!o)return;if((0,g.Bi)(o))this._buildPath(o.rings,!0);else if((0,g.Rg)(o))this._buildPath(o.paths,!0);else if((0,g.ZC)(o))this._buildPath(ft(o).rings,!0);else{if(!(0,g.U9)(o))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const u=this._ctx;u.fillStyle="string"==typeof n?n:"rgba("+Math.round(n[0])+","+Math.round(n[1])+","+Math.round(n[2])+","+(n[3]??255)/255+")",u.fill("evenodd")}drawSolidStroke(o,n,u,p,y,C){if(!o||!n||0===u)return;if((0,g.Bi)(o))this._buildPath(o.rings,!0);else if((0,g.Rg)(o))this._buildPath(o.paths,!1);else{if(!(0,g.ZC)(o))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(ft(o).rings,!0)}const E=this._ctx;E.strokeStyle="string"==typeof n?n:"rgba("+Math.round(n[0])+","+Math.round(n[1])+","+Math.round(n[2])+","+(n[3]??255)/255+")",E.lineWidth=Math.max(this.transformSize(u),.5),this._setCapStyle(p),this._setJoinStyle(y),E.miterLimit=C,E.stroke()}pushClipPath(o){if(this._ctx.save(),(0,g.Bi)(o))this._buildPath(o.rings,!0);else if((0,g.Rg)(o))this._buildPath(o.paths,!0);else{if(!(0,g.ZC)(o))return;this._buildPath(ft(o).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(o,n){const{colorSubstitutions:u,url:p,tintColor:y}=o,C=(0,b.$w)(o.scaleX,1),E=this._resourceManager.getResource(p);if(null==E)return;let O=n*(E.width/E.height),w=n;n||(O=E.width,w=E.height);const j=(0,b.UE)(p)||"src"in E&&(0,b.UE)(E.src);let W="getFrame"in E?M(E):E;u&&(W=this._colorSubstitutionHelper.applyColorSubstituition(W,u)),this._applyAdditionalRenderProps&&!j&&y&&(W=this._colorSubstitutionHelper.tintImageData(W,y));const H=this.transformPt([0,0]),[et,st]=this.getTransformAngle(),Q=this.transformSize(1),V=this._ctx;V.save(),V.setTransform({m11:C*Q*et,m12:C*Q*st,m21:-Q*st,m22:Q*et,m41:H[0],m42:H[1]}),V.drawImage(W,-O/2,-w/2,O,w),V.restore()}drawText(o,n){if(!n||0===n.length)return;this._textRasterizer||(this._textRasterizer=new N);const u=mt(o);u.size*=this.transformSize((0,x.PN)(1));const p=this._textRasterizer.rasterizeText(n,u);if(!p)return;const{size:y,anchorX:C,anchorY:E,canvas:O}=p,w=y[0]*(C+.5),j=y[1]*(E-.5),W=this._ctx,H=this.transformPt([0,0]),[et,st]=this.getTransformAngle();W.save(),W.setTransform({m11:1*et,m12:1*st,m21:-1*st,m22:1*et,m41:H[0]-1*w,m42:H[1]+1*j}),W.drawImage(O,0,0),W.restore()}drawPictureFill(o,n){if(!o)return;let{colorSubstitutions:u,height:p,offsetX:y,offsetY:C,rotation:E,scaleX:O,tintColor:w,url:j}=n;const W=this._resourceManager.getResource(j);if(null==W)return;if((0,g.Bi)(o))this._buildPath(o.rings,!0);else if((0,g.Rg)(o))this._buildPath(o.paths,!0);else if((0,g.ZC)(o))this._buildPath(ft(o).rings,!0);else{if(!(0,g.U9)(o))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const H=this._ctx,et=(0,b.UE)(j)||"src"in W&&(0,b.UE)(W.src);let st,Q="getFrame"in W?M(W):W;if(u&&(Q=this._colorSubstitutionHelper.applyColorSubstituition(Q,u)),this._applyAdditionalRenderProps){et||w&&(Q=this._colorSubstitutionHelper.tintImageData(Q,w)),st=H.createPattern(Q,"repeat");const V=this.transformSize(1);E||(E=0),y?y*=V:y=0,C?C*=V:C=0,p&&(p*=V);const ht=p?p/W.height:1,nt=O&&p?O*p/W.width:1;if(0!==E||1!==ht||1!==nt||0!==y||0!==C){const _t=new DOMMatrix;_t.rotateSelf(0,0,-E).translateSelf(y,C).scaleSelf(nt,ht,1),st.setTransform(_t)}}else st=H.createPattern(Q,"repeat");H.save(),H.fillStyle=st,H.fill("evenodd"),H.restore()}drawPictureStroke(o,n){if(!o)return;let{colorSubstitutions:u,capStyle:p,joinStyle:y,miterLimit:C,tintColor:E,url:O,width:w}=n;const j=this._resourceManager.getResource(O);if(null==j)return;let W;if((0,g.Bi)(o))W=o.rings;else if((0,g.Rg)(o))W=o.paths;else{if(!(0,g.ZC)(o))return(0,g.U9)(o)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;W=ft(o).rings}w||(w=j.width);const H=(0,b.UE)(O)||"src"in j&&(0,b.UE)(j.src);let et="getFrame"in j?M(j):j;u&&(et=this._colorSubstitutionHelper.applyColorSubstituition(et,u)),this._applyAdditionalRenderProps&&(H||E&&(et=this._colorSubstitutionHelper.tintImageData(et,E)));const st=Math.max(this.transformSize((0,x.Lz)(w)),.5),Q=st/et.width,V=this._ctx,ht=V.createPattern(et,"repeat-y");let nt,_t;V.save(),this._setCapStyle(p),this._setJoinStyle(y),void 0!==C&&(V.miterLimit=C),V.lineWidth=st;for(let gt of W)if(gt=(0,G.o8)(gt),yt(gt),gt&&!(gt.length<=1)){nt=this.transformPt(gt[0]);for(let Mt=1;Mt<gt.length;Mt++){_t=this.transformPt(gt[Mt]);const bt=at(nt,_t),Ct=new DOMMatrix;Ct.translateSelf(0,nt[1]-st/2).scaleSelf(Q,Q,1).rotateSelf(0,0,90-bt),ht.setTransform(Ct),V.strokeStyle=ht,V.beginPath(),V.moveTo(nt[0],nt[1]),V.lineTo(_t[0],_t[1]),V.stroke(),nt=_t}}V.restore()}_buildPath(o,n){const u=this._ctx;if(u.beginPath(),o)for(const p of o){const y=p?p.length:0;if(y>1){let C=this.transformPt(p[0]);u.moveTo(C[0],C[1]);for(let E=1;E<y;E++)C=this.transformPt(p[E]),u.lineTo(C[0],C[1]);n&&u.closePath()}}}_setCapStyle(o){switch(o){case d.uT.Butt:this._ctx.lineCap="butt";break;case d.uT.Round:this._ctx.lineCap="round";break;case d.uT.Square:this._ctx.lineCap="square"}}_setJoinStyle(o){switch(o){case d.wd.Bevel:this._ctx.lineJoin="bevel";break;case d.wd.Round:this._ctx.lineJoin="round";break;case d.wd.Miter:this._ctx.lineJoin="miter"}}}function ut(J,o,n){for(const u of o){const p=u.length;for(let y=1;y<p;y++){const C=u[y-1],E=u[y];let O=(E[0]-C[0])*(E[0]-C[0])+(E[1]-C[1])*(E[1]-C[1]);if(0!==O&&(O=Math.sqrt(O),Math.abs(((E[0]-C[0])*(J[1]-C[1])-(E[1]-C[1])*(J[0]-C[0]))/O)<n)){const j=((E[0]-C[0])*(J[0]-C[0])+(E[1]-C[1])*(J[1]-C[1]))/O;if(j>-n&&j<O+n)return!0}}}return!1}function at(J,o){return 180/Math.PI*Math.atan2(o[1]-J[1],o[0]-J[0])}const ft=J=>J?{spatialReference:J.spatialReference,rings:[[[J.xmin,J.ymin],[J.xmin,J.ymax],[J.xmax,J.ymax],[J.xmax,J.ymin],[J.xmin,J.ymin]]]}:null,Pt=(J,o,n)=>{switch(J){case"ExtraLeading":return 1+o/n;case"Multiple":return o;case"Exact":return o/n}};function mt(J,o=1){const n=(0,b.DW)(J),u=(0,b._d)(J.fontStyleName),p=J.fontFamilyName??Z.Vb,{weight:y,style:C}=u,E=o*(J.height||5),O=(0,b.Bu)(J.horizontalAlignment),w=(0,b.Nl)(J.verticalAlignment),j=(0,b.pM)(J),W=(0,b.pM)(J.haloSymbol),H=null!=W?o*(J.haloSize??0):0,et="CIMBackgroundCallout"===J.callout?.type?J.callout.backgroundSymbol:null,st=(0,b.pM)(et),Q=(0,b.xo)(et),V=(0,b._1)(et);return{color:j,size:E,horizontalAlignment:O,verticalAlignment:w,font:{family:p,style:(0,b.pV)(C),weight:(0,b.Kn)(y),decoration:n},halo:{size:H||0,color:W,style:C},backgroundColor:st,borderLine:null!=Q&&null!=V?{size:Q,color:V}:null,pixelRatio:1,premultiplyColors:!0}}const pt=1e-4;function yt(J){let o,n,u,p,y,C=J[0],E=1;for(;E<J.length;)o=J[E][0]-C[0],n=J[E][1]-C[1],p=0!==o?n/o:Math.PI/2,void 0!==u&&p-u<=pt?(J.splice(E-1,1),C=y):(y=C,C=J[E],E++),u=p}},26747:(dt,it,S)=>{S.d(it,{BW:()=>ft,Sc:()=>K,Vb:()=>b,ll:()=>R,ni:()=>tt,wp:()=>k});var Z=S(47139),X=S(3248),G=S(77806),D=S(35150),B=S(40707),x=S(67685),P=S(51995),_=S(83065),m=S(9015),f=S(76571),g=S(91767),h=S(46988),r=S(65374),l=S(32117),e=S(91644),c=S(4139),d=S(47669),M=S(42058),I=S(36741);const A=Math.PI,U=A/2,F=Math.PI/180,N=96/72,z=()=>D.A.getLogger("esri.symbols.cim.CIMSymbolHelper");function b(o){let n;switch(o.type){case"cim":return o.data;case"web-style":return o;case"simple-marker":{const u=k.fromSimpleMarker(o);if(!u)throw new Error("InternalError: Cannot convert symbol to CIM");n=u;break}case"picture-marker":n=k.fromPictureMarker(o);break;case"simple-line":n=k.fromSimpleLineSymbol(o);break;case"simple-fill":n=k.fromSimpleFillSymbol(o);break;case"picture-fill":n=k.fromPictureFillSymbol(o);break;case"text":n=k.fromTextSymbol(o)}return{type:"CIMSymbolReference",symbol:n}}function v(o,n,u){switch(n.type){case"CIMSymbolReference":return v(o,n.symbol,u);case"CIMPointSymbol":null==u&&(u={x:0,y:0}),o.drawSymbol(n,u);break;case"CIMLineSymbol":null==u&&(u={paths:[[[0,0],[10,0]]]}),o.drawSymbol(n,u);break;case"CIMPolygonSymbol":null==u&&(u={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),o.drawSymbol(n,u);break;case"CIMTextSymbol":o.drawSymbol(n,{x:0,y:0});break;case"CIMVectorMarker":{const p=new f.W;o.drawMarker(n,p);break}}return o.envelope()}function T(o){if(!o)return 0;switch(o.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(o.offset);default:return 0}}function L(o){if(!o)return 0;switch(o.type){case"CIMGeometricEffectArrow":return Math.abs(.5*o.width);case"CIMGeometricEffectBuffer":return Math.abs(o.size);case"CIMGeometricEffectControlMeasureLine":return 500;case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(o.length);case"CIMGeometricEffectJog":return Math.abs(.5*o.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,l.$w)(o.offsetX)),Math.abs((0,l.$w)(o.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(o.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(o.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(o.fromWidth),Math.abs(o.toWidth));case"CIMGeometricEffectWave":return Math.abs(o.amplitude);case"CIMGeometricEffectDonut":return Math.abs(o.width)}}function R(o){if(!o)return 0;let n=0;for(const u of o)n+=L(u);return n}class K{static getSymbolInflateSize(n,u,p,y,C){return n||(n=[0,0,0,0]),u?this._getInflateSize(n,u,p,y,C):n}static safeSize(n){const u=Math.max(Math.abs(n[0]),Math.abs(n[2])),p=Math.max(Math.abs(n[1]),Math.abs(n[3]));return Math.sqrt(u*u+p*p)}static _vectorMarkerBounds(n,u,p,y){let C=!0;const E=(0,P.vt)();if(u?.markerGraphics)for(const O of u.markerGraphics){const w=[0,0,0,0];O.geometry&&((0,_.Rg)(E,O.geometry),w[0]=0,w[1]=0,w[2]=0,w[3]=0,this.getSymbolInflateSize(w,O.symbol,p,0,y),E[0]+=w[0],E[1]+=w[1],E[2]+=w[2],E[3]+=w[3],C?(n[0]=E[0],n[1]=E[1],n[2]=E[2],n[3]=E[3],C=!1):(n[0]=Math.min(n[0],E[0]),n[1]=Math.min(n[1],E[1]),n[2]=Math.max(n[2],E[2]),n[3]=Math.max(n[3],E[3])))}return n}static _getInflateSize(n,u,p,y,C){if(function Pt(o){return void 0!==o.symbolLayers}(u)){const E=this._getLayersInflateSize(n,u.symbolLayers,p,y,C),O=R(u.effects);return O>0&&(E[0]-=O,E[1]-=O,E[2]+=O,E[3]+=O),E}return this._getTextInflatedSize(n,u,C)}static _getLayersInflateSize(n,u,p,y,C){let E=!0;if(!u)return n;for(const O of u){if(!O)continue;let w=[0,0,0,0];switch(O.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{let H=O.width;null!=H&&(H/=O.capStyle===r.uT.Square||O.joinStyle===r.wd.Miter?1.4142135623730951:2,w[0]=-H,w[1]=-H,w[2]=H,w[3]=H);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const W=O;if("CIMVectorMarker"===O.type){const V=O;if(w=this._vectorMarkerBounds(w,V,p,C),V.frame){const ht=(V.frame.xmin+V.frame.xmax)/2,nt=(V.frame.ymin+V.frame.ymax)/2;if(w[0]-=ht,w[1]-=nt,w[2]-=ht,w[3]-=nt,null!=V.size){const _t=V.size/(V.frame.ymax-V.frame.ymin);w[0]*=_t,w[1]*=_t,w[2]*=_t,w[3]*=_t}}}else if("CIMPictureMarker"===O.type){const V=O,ht=p.getResource(V.url);let nt=1;if(null!=ht&&ht.height&&(nt=ht.width/ht.height),null!=W.size){const _t=W.size/2,gt=W.size*nt*V.scaleX/2;w=[-gt,-_t,gt,_t]}}else if(null!=W.size){const V=W.size/2;w=[-V,-V,V,V]}if(W.anchorPoint){let V,ht;"Absolute"===W.anchorPointUnits?(V=W.anchorPoint.x,ht=W.anchorPoint.y):(V=W.anchorPoint.x*(w[2]-w[0]),ht=W.anchorPoint.y*(w[3]-w[1]));const nt=1.25*Math.sqrt(V*V+ht*ht);w[0]-=nt,w[1]-=nt,w[2]+=nt,w[3]+=nt}let H=(0,l.$w)(W.rotation);if(W.rotateClockwise&&(H=-H),y&&(H-=y),H){const V=F*H,ht=Math.cos(V),nt=Math.sin(V),_t=(0,P.vt)([c.MG,c.MG,-c.MG,-c.MG]);(0,P.tK)(_t,[w[0]*ht-w[1]*nt,w[0]*nt+w[1]*ht]),(0,P.tK)(_t,[w[0]*ht-w[3]*nt,w[0]*nt+w[3]*ht]),(0,P.tK)(_t,[w[2]*ht-w[1]*nt,w[2]*nt+w[1]*ht]),(0,P.tK)(_t,[w[2]*ht-w[3]*nt,w[2]*nt+w[3]*ht]),w=_t}let et=(0,l.$w)(W.offsetX),st=(0,l.$w)(W.offsetY);if(y){const V=F*y,ht=Math.cos(V),nt=Math.sin(V),_t=et*nt+st*ht;et=et*ht-st*nt,st=_t}w[0]+=et,w[1]+=st,w[2]+=et,w[3]+=st;const Q=T(W.markerPlacement);Q>0&&(w[0]-=Q,w[1]-=Q,w[2]+=Q,w[3]+=Q);break}}const j=R(O.effects);j>0&&(w[0]-=j,w[1]-=j,w[2]+=j,w[3]+=j),E?(n[0]=w[0],n[1]=w[1],n[2]=w[2],n[3]=w[3],E=!1):(n[0]=Math.min(n[0],w[0]),n[1]=Math.min(n[1],w[1]),n[2]=Math.max(n[2],w[2]),n[3]=Math.max(n[3],w[3]))}return n}static _getTextInflatedSize(n,u,p){const y=(0,I.hV)(u.height??h.D.CIMTextSymbol.height);if(n[0]=-y/2,n[1]=-y/2,n[2]=y/2,n[3]=y/2,!p)return n;const C=p.get(u);if(!C||!C.glyphMosaicItems.glyphs.length)return n;const{lineGapType:E,lineGap:O}=u,w=E?(0,g.QF)(E,O??0,y):0,j="CIMBackgroundCallout"===u.callout?.type,W=(0,M.Tl)(C.glyphMosaicItems,{scale:y/d.eG,angle:(0,l.$w)(u.angle),xOffset:(0,l.$w)(u.offsetX),yOffset:(0,l.$w)(u.offsetY),horizontalAlignment:u.horizontalAlignment,verticalAlignment:u.verticalAlignment,maxLineWidth:(0,I.Lu)(u.lineWidth),lineHeight:d.DY*Math.max(.25,Math.min(w||1,4)),decoration:u.font.decoration||"none",useCIMAngleBehavior:!0,hasBackground:j}).boundsT;return n[0]=W.x-W.halfWidth,n[1]=-W.y-W.halfHeight,n[2]=W.x+W.halfWidth,n[3]=-W.y+W.halfHeight,n}}class k{static getEnvelope(n,u,p){if(!n)return null;const y=new g.mx(p);if(Array.isArray(n)){let C;for(const E of n)C?C.union(v(y,E,u)):C=v(y,E,u);return C}return v(y,n,u)}static getTextureAnchor(n,u){const p=this.getEnvelope(n,null,u);if(!p)return[0,0,0];const O=p.height*N+2;return[-(p.x+.5*p.width)*N/(p.width*N+2),-(p.y+.5*p.height)*N/O,O]}static rasterize(n,u,p,y,C=!0){const E=p||this.getEnvelope(u,null,y);if(!E)return[null,0,0,0,0];const O=(E.x+.5*E.width)*N,w=(E.y+.5*E.height)*N;n.width=E.width*N,n.height=E.height*N,p||(n.width+=2,n.height+=2);const j=n.getContext("2d",{willReadFrequently:!0}),W=g.IT.createScale(N,-N);W.translate(.5*n.width-O,.5*n.height+w);const H=new g.Rj(j,y,W);switch(u.type){case"CIMPointSymbol":H.drawSymbol(u,{type:"point",x:0,y:0});break;case"CIMVectorMarker":{const Q=new f.W;H.drawMarker(u,Q);break}}const et=j.getImageData(0,0,n.width,n.height),st=new Uint8Array(et.data);if(C){let Q;for(let V=0;V<st.length;V+=4)Q=st[V+3]/255,st[V]=st[V]*Q,st[V+1]=st[V+1]*Q,st[V+2]=st[V+2]*Q}return[st,n.width,n.height,-O/n.width,-w/n.height]}static fromTextSymbol(n){const{text:u}=n;return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:k.createCIMTextSymbolfromTextSymbol(n),textString:u}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(n){const{height:u,outline:p,width:y,xoffset:C,xscale:E,yoffset:O,yscale:w}=n,j=[],W={type:"CIMPolygonSymbol",symbolLayers:j};if(p){const V=J(p);V&&j.push(V)}let H=n.url;"esriPFS"===n.type&&n.imageData&&(H=n.imageData);const et="angle"in n?n.angle??0:0;return j.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.O$.Picture,tintColor:null,url:H,height:(u??0)*(w||1),width:(y??0)*(E||1),offsetX:(0,l.$w)(C),offsetY:(0,l.$w)(O),rotation:(0,l.$w)(-et),colorSubstitutions:null}),W}static fromSimpleFillSymbol(n){const{color:u,style:p,outline:y}=n,C=[],E={type:"CIMPolygonSymbol",symbolLayers:C};if(y){const O=J(y);O&&C.push(O)}if(p&&"solid"!==p&&"none"!==p&&"esriSFSSolid"!==p&&"esriSFSNull"!==p){const O={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:rt(u),capStyle:r.uT.Butt,joinStyle:r.wd.Miter,width:.75}]};let w=0;const j=(0,x.PN)(pt(p)?8:10);switch(p){case"vertical":case"esriSFSVertical":w=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":w=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":w=45;break;case"cross":case"esriSFSCross":w=0}C.push({type:"CIMHatchFill",lineSymbol:O,offsetX:0,offsetY:0,rotation:w,separation:j}),"cross"===p||"esriSFSCross"===p?C.push({type:"CIMHatchFill",lineSymbol:(0,G.o8)(O),offsetX:0,offsetY:0,rotation:90,separation:j}):"diagonal-cross"!==p&&"esriSFSDiagonalCross"!==p||C.push({type:"CIMHatchFill",lineSymbol:(0,G.o8)(O),offsetX:0,offsetY:0,rotation:45,separation:j})}else!p||"solid"!==p&&"esriSFSSolid"!==p||C.push({type:"CIMSolidFill",enable:!0,color:rt(u)});return E}static fromSimpleLineSymbol(n){const{cap:u,color:p,join:y,marker:C,miterLimit:E,style:O,width:w}=n;let j=null;"solid"!==O&&"none"!==O&&"esriSLSSolid"!==O&&"esriSLSNull"!==O&&(j=[{type:"CIMGeometricEffectDashes",dashTemplate:ft(O,u),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const W=[];if(C){let H;switch(C.placement){case"begin-end":H=r.$2.Both;break;case"begin":H=r.$2.JustBegin;break;case"end":H=r.$2.JustEnd;break;default:H=r.$2.None}const et=k.fromSimpleMarker(C,w,p).symbolLayers[0];et.markerPlacement={type:"CIMMarkerPlacementAtExtremities",placePerPart:!1,angleToLine:!0,offset:0,extremityPlacement:H,offsetAlongLine:0},W.push(et)}return W.push({type:"CIMSolidStroke",color:"none"!==O&&"esriSLSNull"!==O?rt(p):[0,0,0,0],capStyle:tt(u),joinStyle:ot(y),miterLimit:E,width:w,effects:j}),{type:"CIMLineSymbol",symbolLayers:W}}static fromPictureMarker(n){const{angle:u,height:p,width:y,xoffset:C,yoffset:E}=n;let O=n.url;return"esriPMS"===n.type&&n.imageData&&(O=n.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.O$.Picture,tintColor:null,url:O,size:p,width:y,offsetX:(0,l.$w)(C),offsetY:(0,l.$w)(E),rotation:(0,l.$w)(-u)}]}}static createCIMTextSymbolfromTextSymbol(n){const{angle:u,color:p,font:y,haloColor:C,haloSize:E,horizontalAlignment:O,kerning:w,lineWidth:j,text:W,verticalAlignment:H,xoffset:et,yoffset:st,backgroundColor:Q,borderLineColor:V,borderLineSize:ht}=n;let nt,_t,gt,Mt,bt,Ct;y&&(nt=y.family,_t=y.style,gt=y.weight,Mt=y.size,bt=y.decoration);let xt=!1;return W&&(xt=(0,Z.y)(W)[1]),(Q||ht)&&(Ct={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:rt(Q)},{type:"CIMSolidStroke",color:rt(V),width:ht}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMTextSymbol",angle:u,blockProgression:r.TZ.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:r.Y.Normal,fontEncoding:r.bj.Unicode,fontFamilyName:nt||"Arial",fontStyleName:ct(_t,gt),fontType:r.g7.Unspecified,haloSize:E,height:Mt,hinting:r.mU.Default,horizontalAlignment:q(O??"center"),kerning:w,letterWidth:100,ligatures:!0,lineGapType:"Multiple",lineWidth:j,offsetX:(0,l.$w)(et),offsetY:(0,l.$w)(st),strikethrough:"line-through"===bt,underline:"underline"===bt,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:rt(p)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:rt(C)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:xt?r.f0.RTL:r.f0.LTR,verticalAlignment:lt(H??"baseline"),verticalGlyphOrientation:r.vG.Right,wordSpacing:100,billboardMode3D:r.xn.FaceNearPlane,callout:Ct}}static createPictureMarkerRasterizationParam(n){const{angle:u,height:p,width:y,xoffset:C,yoffset:E}=n,O=n.url??n.source?.url??n.source?.imageData;return O?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:r.O$.Picture,tintColor:null,url:O,size:p,width:y,offsetX:(0,l.$w)(C),offsetY:(0,l.$w)(E),rotation:(0,l.$w)(-u)}}:null}static createPictureFillRasterizationParam(n){const{width:u,height:p,xoffset:y,yoffset:C,url:E}=n;return E?{type:"sprite-rasterization-param",overrides:[],resource:{type:"CIMPictureFill",scaleX:1,textureFilter:r.O$.Picture,tintColor:null,url:E,width:u,height:p,offsetX:(0,l.$w)(y),offsetY:(0,l.$w)(C),rotation:0}}:null}static fromSimpleMarker(n,u,p){const{style:y}=n,C=n.color??p;if("path"===y||"esriSMSPath"===y){const H=[];if("outline"in n&&n.outline){const Q=n.outline;H.push({type:"CIMSolidStroke",enable:!0,width:Q.width,color:rt(Q.color),path:n.path})}H.push({type:"CIMSolidFill",enable:!0,color:rt(C),path:n.path});const[et,st]=mt("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:-(0,l.$w)(n.angle),size:(0,l.$w)(n.size||6),offsetX:(0,l.$w)(n.xoffset),offsetY:(0,l.$w)(n.yoffset),scaleSymbolsProportionally:!1,frame:et,markerGraphics:[{type:"CIMMarkerGraphic",geometry:st,symbol:{type:"CIMPolygonSymbol",symbolLayers:H}}]}]}}const E=[];let O,w,j=n.size;if("outline"in n&&n.outline&&"none"!==n.outline.style&&"esriSLSNull"!==n.outline.style){const H=n.outline,et="solid"!==H.style&&"esriSLSSolid"!==H.style;[O,w]=et?mt(y,n.size):mt(y);const st=H.width??e.A7.width;if(et){const ht=st/n.size,nt=(O.xmax-O.xmin)*ht/2,_t=(O.ymax-O.ymin)*ht/2;O.xmin-=nt,O.xmax+=nt,O.ymin-=_t,O.ymax+=_t,j&&(j+=st)}const Q="cross"!==n.style&&"x"!==n.style||"dot"===n?.outline.style||"short-dot"===n?.outline.style?r.yS.HalfGap:r.yS.FullPattern,V=et?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:ft(H.style,null).map(ht=>H.width&&H.width>0?ht*H.width:ht),lineDashEnding:Q,controlPointEnding:r.yS.FullPattern}]:void 0;E.push({type:"CIMSolidStroke",capStyle:et?r.uT.Round:r.uT.Butt,enable:!0,width:st,color:rt(H.color),effects:V})}else!u||"line-marker"!==n.type||"cross"!==n.style&&"x"!==n.style?[O,w]=mt(y):([O,w]=mt(y),E.push({type:"CIMSolidStroke",enable:!0,width:u,color:rt(C)}));E.push({type:"CIMSolidFill",enable:!0,color:rt(C)});const W={type:"CIMPolygonSymbol",symbolLayers:E};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,l.$w)(-n.angle),size:(0,l.$w)(j||6*u),offsetX:(0,l.$w)(n.xoffset),offsetY:(0,l.$w)(n.yoffset),scaleSymbolsProportionally:!1,frame:O,markerGraphics:[{type:"CIMMarkerGraphic",geometry:w,symbol:W}]}]}}static fromCIMHatchFill(n,u){const p=u*(n.separation??h.D.CIMHatchFill.separation),y=p/2,C=(0,G.o8)(n.lineSymbol);C.symbolLayers?.forEach(w=>{switch(w.type){case"CIMSolidStroke":null!=w.width&&(w.width*=u),w.effects?.forEach(j=>{"CIMGeometricEffectDashes"===j.type&&(j.dashTemplate=j.dashTemplate.map(H=>H*u))});break;case"CIMVectorMarker":{null!=w.size&&(w.size*=u);const j=w.markerPlacement;null!=j&&"placementTemplate"in j&&(j.placementTemplate=j.placementTemplate.map(W=>W*u));break}}});let E=this._getLineSymbolPeriod(C)||4;for(;E<4;)E*=2;const O=E/2;return{type:"CIMVectorMarker",frame:{xmin:-O,xmax:O,ymin:-y,ymax:y},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-O,0],[O,0]]]},symbol:C}],size:p}}static fetchResources(n,u,p,y=null){return n&&u&&Y(n,C=>{(function yt(o,n,u){if(o.effects&&null==n.geometryEngine){if(n.geometryEnginePromise)return void u.push(n.geometryEnginePromise);(0,l.yH)(o.effects)&&(n.geometryEnginePromise=(0,l._H)(),u.push(n.geometryEnginePromise),n.geometryEnginePromise.then(p=>n.geometryEngine=p))}})(C,u,p),"url"in C&&C.url&&p.push(u.fetchResource(C.url,{signal:y}))}),p}static fetchFonts(n,u,p){if(n&&u)if("symbolLayers"in n&&n.symbolLayers){for(const y of n.symbolLayers)if("CIMVectorMarker"===y.type&&y.markerGraphics)for(const C of y.markerGraphics)C?.symbol&&k.fetchFonts(C.symbol,u,p)}else if("CIMTextSymbol"===n.type){const{fontFamilyName:y,fontStyleName:C}=n;if(!y||"calcitewebcoreicons"===y.toLowerCase())return;const{style:E,weight:O}=(0,l._d)(C),w=(0,l.DW)(n),j=new m.A({family:y,style:E,weight:O,decoration:w});p.push(u.loadFont(j).catch(()=>{z().error(`Unsupported font ${y} in CIM symbol`)}))}}static _getLineSymbolPeriod(n){if(n){const u=this._getEffectsRepeat(n.effects);if(u)return u;if(n.symbolLayers)for(const p of n.symbolLayers)if(p){const y=this._getEffectsRepeat(p.effects);if(y)return y;switch(p.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const C=this._getPlacementRepeat(p.markerPlacement);if(C)return C}}}}return 0}static _getEffectsRepeat(n){if(n)for(const u of n)if(u)switch(u.type){case"CIMGeometricEffectDashes":{const p=u.dashTemplate;if(p&&p.length){let y=0;for(const C of p)y+=C;return 1&p.length&&(y*=2),y}break}case"CIMGeometricEffectWave":return u.period;default:z().error(`unsupported geometric effect type ${u.type}`)}return 0}static _getPlacementRepeat(n){if(n)switch(n.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const u=n.placementTemplate;if(u&&u.length){let p=0;for(const y of u)p+=+y;return 1&u.length&&(p*=2),p}break}}return 0}static fromCIMInsidePolygon(n){const u=n.markerPlacement,p={...n};p.markerPlacement=null,p.anchorPoint=null;const y=Math.abs(u.stepX),C=Math.abs(u.stepY),E=(u.randomness??100)/100;let O,w,j,W;if("Random"===u.gridType){const H=(0,x.PN)(d.yv),et=Math.max(Math.floor(H/y),1),st=Math.max(Math.floor(H/C),1);O=et*y/2,w=st*C/2,j=2*w;const Q=new B.A(u.seed),V=E*y/1.5,ht=E*C/1.5;W=[];for(let nt=0;nt<et;nt++)for(let _t=0;_t<st;_t++){const gt=nt*y-O+V*(.5-Q.getFloat()),Mt=_t*C-w+ht*(.5-Q.getFloat());W.push({x:gt,y:Mt}),0===nt&&W.push({x:gt+2*O,y:Mt}),0===_t&&W.push({x:gt,y:Mt+2*w})}}else!0===u.shiftOddRows?(O=y/2,w=C,j=2*C,W=[{x:-O,y:0},{x:O,y:0},{x:0,y:w},{x:0,y:-w}]):(O=y/2,w=C/2,j=C,W=[{x:-y,y:0},{x:0,y:-C},{x:-y,y:-C},{x:0,y:0},{x:y,y:0},{x:0,y:C},{x:y,y:C},{x:-y,y:C},{x:y,y:-C}]);return{type:"CIMVectorMarker",frame:{xmin:-O,xmax:O,ymin:-w,ymax:w},markerGraphics:W.map(H=>({type:"CIMMarkerGraphic",geometry:H,symbol:{type:"CIMPointSymbol",symbolLayers:[p]}})),size:j}}}function Y(o,n){if(o)switch(o.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const u=o.symbolLayers;if(!u)return;for(const p of u)if(n(p),"CIMVectorMarker"===p.type){const y=p.markerGraphics;if(!y)continue;for(const C of y)if(C){const E=C.symbol;E&&Y(E,n)}}break}}}const tt=o=>{if(!o)return r.uT.Butt;switch(o){case"butt":return r.uT.Butt;case"square":return r.uT.Square;case"round":return r.uT.Round}},ot=o=>{if(!o)return r.wd.Miter;switch(o){case"miter":return r.wd.Miter;case"round":return r.wd.Round;case"bevel":return r.wd.Bevel}},q=o=>{if(null==o)return"Center";switch(o){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},lt=o=>{if(null==o)return"Center";switch(o){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},rt=o=>{if(!o)return[0,0,0,0];const{r:n,g:u,b:p,a:y}=o;return[n,u,p,255*y]},ct=(o,n)=>{const u=ut(n),p=at(o);return u&&p?`${u}-${p}`:`${u}${p}`},ut=o=>{if(!o)return"";switch(o.toLowerCase()){case"bold":case"bolder":return"bold"}return""},at=o=>{if(!o)return"";switch(o.toLowerCase()){case"italic":case"oblique":return"italic"}return""},ft=(o,n)=>{const u=(0,X.A)("safari")?.001:0,p="butt"===n;switch(o){case"dash":case"esriSLSDash":return p?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return p?[4,3,1,3]:[3,4,u,4];case"dot":case"esriSLSDot":return p?[1,3]:[u,4];case"long-dash":case"esriSLSLongDash":return p?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return p?[8,3,1,3]:[7,4,u,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return p?[8,3,1,3,1,3]:[7,4,u,4,u,4];case"short-dash":case"esriSLSShortDash":return p?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return p?[4,1,1,1]:[3,2,u,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return p?[4,1,1,1,1,1]:[3,2,u,2,u,2];case"short-dot":case"esriSLSShortDot":return p?[1,1]:[u,2];case"solid":case"esriSLSSolid":case"none":return z().error("Unexpected: style does not require rasterization"),[0,0];default:return z().error(`Tried to rasterize SLS, but found an unexpected style: ${o}!`),[0,0]}},mt=(o,n=100)=>{const u=n/2;let p,y;const C=o;if("circle"===C||"esriSMSCircle"===C){let O=Math.acos(1-.25/u),w=Math.ceil(A/O/4);0===w&&(w=1),O=U/w,w*=4;const j=[];j.push([u,0]);for(let W=1;W<w;W++)j.push([u*Math.cos(W*O),-u*Math.sin(W*O)]);j.push([u,0]),p={rings:[j]},y={xmin:-u,ymin:-u,xmax:u,ymax:u}}else if("cross"===C||"esriSMSCross"===C)p={paths:[[[0,u],[0,-u]],[[u,0],[-u,0]]]},y={xmin:-u,ymin:-u,xmax:u,ymax:u};else if("diamond"===C||"esriSMSDiamond"===C)p={rings:[[[-u,0],[0,u],[u,0],[0,-u],[-u,0]]]},y={xmin:-u,ymin:-u,xmax:u,ymax:u};else if("square"===C||"esriSMSSquare"===C)p={rings:[[[-u,-u],[-u,u],[u,u],[u,-u],[-u,-u]]]},y={xmin:-u,ymin:-u,xmax:u,ymax:u};else if("x"===C||"esriSMSX"===C)p={paths:[[[u,u],[-u,-u]],[[u,-u],[-u,u]]]},y={xmin:-u,ymin:-u,xmax:u,ymax:u};else if("triangle"===C||"esriSMSTriangle"===C){const E=.5773502691896257*n,O=-E,w=2/3*n,j=w-n;p={rings:[[[O,j],[0,w],[E,j],[O,j]]]},y={xmin:O,ymin:j,xmax:E,ymax:w}}else"arrow"===C&&(p={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},y={xmin:-u,ymin:-u,xmax:u,ymax:u});return[y,p]},pt=o=>"vertical"===o||"horizontal"===o||"cross"===o||"esriSFSCross"===o||"esriSFSVertical"===o||"esriSFSHorizontal"===o;function J(o){if(!o)return null;let n=null;const{cap:u,color:p,join:y,miterLimit:C,style:E,width:O}=o;return"solid"!==E&&"none"!==E&&"esriSLSSolid"!==E&&"esriSLSNull"!==E&&(n=[{type:"CIMGeometricEffectDashes",dashTemplate:ft(E,u),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==E&&"none"!==E?rt(p):[0,0,0,0],capStyle:tt(u),joinStyle:ot(y),miterLimit:C,width:O,effects:n}}},67311:(dt,it,S)=>{S.d(it,{I:()=>D,U:()=>G});var Z=S(72137),X=S(65374);const G=.03;class D{constructor(x=0,P=!1){}isEmpty(x){if(!x.nextPoint())return!0;let P,_,m,f;for(P=x.x,_=x.y;x.nextPoint();P=_,_=f)if(m=x.x,f=x.y,m!==P||f!==_)return x.seekPathStart(),!1;return x.seekPathStart(),!0}normalize(x){const P=Math.sqrt(x[0]*x[0]+x[1]*x[1]);0!==P&&(x[0]/=P,x[1]/=P)}getLength(x,P,_,m){const f=_-x,g=m-P;return Math.sqrt(f*f+g*g)}getSegLength(x){const[[P,_],[m,f]]=x;return this.getLength(P,_,m,f)}getCoord2D(x,P,_,m,f){return[x+(_-x)*f,P+(m-P)*f]}getSegCoord2D(x,P){const[[_,m],[f,g]]=x;return this.getCoord2D(_,m,f,g,P)}getAngle(x,P,_,m,f){return Math.atan2(m-P,_-x)}getAngleCS(x,P,_,m,f){const g=_-x,h=m-P,r=Math.sqrt(g*g+h*h);return r>0?[g/r,h/r]:[1,0]}getSegAngleCS(x,P){const[[_,m],[f,g]]=x;return this.getAngleCS(_,m,f,g,P)}cut(x,P,_,m,f,g){return[f<=0?[x,P]:this.getCoord2D(x,P,_,m,f),g>=1?[_,m]:this.getCoord2D(x,P,_,m,g)]}getSubCurve(x,P,_){const m=Z.z.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(m,x,P,_)?m:null}appendSubCurve(x,P,_,m){x.startPath(),P.seekPathStart();let f=0,g=!0;if(!P.nextPoint())return!1;let h=P.x,r=P.y;for(;P.nextPoint();){const l=this.getLength(h,r,P.x,P.y);if(0!==l){if(g){if(f+l>_){let c=1,d=!1;f+l>=m&&(c=(m-f)/l,d=!0);const M=this.cut(h,r,P.x,P.y,(_-f)/l,c);if(M&&x.pushPoints(M),d)break;g=!1}}else{if(f+l>m){const e=this.cut(h,r,P.x,P.y,0,(m-f)/l);e&&x.pushPoint(e[1]);break}x.pushXY(P.x,P.y)}f+=l,h=P.x,r=P.y}else h=P.x,r=P.y}return!0}getCIMPointAlong(x,P){if(!x.nextPoint())return null;let _,m,f,g,h=0;for(_=x.x,m=x.y;x.nextPoint();_=f,m=g){f=x.x,g=x.y;const r=this.getLength(_,m,f,g);if(0!==r){if(h+r>P)return this.getCoord2D(_,m,f,g,(P-h)/r);h+=r}}return null}offset(x,P,_,m,f){if(!x||x.length<2)return null;let g=0,h=x[g++],r=g;for(;g<x.length;){const d=x[g];d[0]===h[0]&&d[1]===h[1]||(g!==r&&(x[r]=x[g]),h=x[r++]),g++}const l=x[0][0]===x[r-1][0]&&x[0][1]===x[r-1][1];if(l&&--r,r<(l?3:2))return null;const e=[];h=l?x[r-1]:null;let c=x[0];for(let d=0;d<r;d++){const M=d===r-1?l?x[0]:null:x[d+1];if(h)if(M){const I=[M[0]-c[0],M[1]-c[1]];this.normalize(I);const A=[c[0]-h[0],c[1]-h[1]];this.normalize(A);const U=A[0]*I[1]-A[1]*I[0],F=A[0]*I[0]+A[1]*I[1];if(0===U&&1===F){c=M;continue}if(U>=0==P<=0){if(F<1){const N=[I[0]-A[0],I[1]-A[1]];this.normalize(N);const $=Math.sqrt((1+F)/2);if($>1/m){const z=-Math.abs(P)/$;e.push([c[0]-N[0]*z,c[1]-N[1]*z])}}}else switch(_){case X.xw.Mitered:{const N=Math.sqrt((1+F)/2);if(N>0&&1/N<m){const $=[I[0]-A[0],I[1]-A[1]];this.normalize($);const z=Math.abs(P)/N;e.push([c[0]-$[0]*z,c[1]-$[1]*z]);break}}case X.xw.Bevelled:e.push([c[0]+A[1]*P,c[1]-A[0]*P]),e.push([c[0]+I[1]*P,c[1]-I[0]*P]);break;case X.xw.Rounded:if(F<1){e.push([c[0]+A[1]*P,c[1]-A[0]*P]);const N=Math.floor(2.5*(1-F));if(N>0){const $=1/N;let z=$;for(let b=1;b<N;b++,z+=$){const v=[A[1]*(1-z)+I[1]*z,-A[0]*(1-z)-I[0]*z];this.normalize(v),e.push([c[0]+v[0]*P,c[1]+v[1]*P])}}e.push([c[0]+I[1]*P,c[1]-I[0]*P])}break;default:if(U<0)e.push([c[0]+(A[1]+A[0])*P,c[1]+(A[1]-A[0])*P]),e.push([c[0]+(I[1]-I[0])*P,c[1]-(I[0]+I[1])*P]);else{const N=Math.sqrt((1+Math.abs(F))/2),$=[I[0]-A[0],I[1]-A[1]];this.normalize($);const z=P/N;e.push([c[0]-$[0]*z,c[1]-$[1]*z])}}}else{const I=[c[0]-h[0],c[1]-h[1]];this.normalize(I),e.push([c[0]+I[1]*P,c[1]-I[0]*P])}else{const I=[M[0]-c[0],M[1]-c[1]];this.normalize(I),e.push([c[0]+I[1]*P,c[1]-I[0]*P])}h=c,c=M}return e.length<(l?3:2)?null:(l&&e.push([e[0][0],e[0][1]]),e)}}},61116:(dt,it,S)=>{S.d(it,{VA:()=>D,YQ:()=>x,Z1:()=>_,ps:()=>B});var x,m,Z=S(72137),X=S(67311);class D{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(f,g,h=!0){if(this._setEmpty(),!f||0===f.length)return!1;for(let r=0;r<f.length;r++){let l=Math.abs(f[r]);h&&l<1e-7&&(l=1e-7),this._values.push(l),this._length+=l}return g&&1&f.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(f){const g=this._values?this._values.length:0;for(let h=0;h<g;++h)this._values[h]*=f;this._length*=f,this.extPtGap*=f,this.ctrlPtGap*=f}addValue(f){this._length+=f,this._values.push(f)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class B{constructor(){this.pt=null,this.ca=0,this.sa=0}}(m=x||(x={}))[m.FAIL=0]="FAIL",m[m.END=1]="END",m[m.CONTINUE=2]="CONTINUE";class P{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(f){f.segment=this.segment,f.segmentLength=this.segmentLength,f.abscissa=this.abscissa,f.isPathEnd=this.isPathEnd,f.isPartEnd=this.isPartEnd}}class _ extends X.I{constructor(f=0,g=!1){super(f,g),this._tolerance=X.U,this._currentPosition=new P}updateTolerance(f){this._tolerance=X.U*f}init(f,g,h=!0){return h?(this._patternLength=g.length(),this._partExtPtGap=g.extPtGap,this._partCtrlPtGap=g.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=f,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(f,g=x.FAIL){const h=new P;return!!this._nextPosition(f,h,null,g)&&(h.copyTo(this._currentPosition),!0)}curPointAndAngle(f){f.pt=this._getPoint(this._currentPosition);const[g,h]=this._getAngleCS(this._currentPosition);f.ca=g,f.sa=h}nextPointAndAngle(f,g,h=x.FAIL){const r=new P;if(!this._nextPosition(f,r,null,h))return!1;r.copyTo(this._currentPosition),g.pt=this._getPoint(r);const[l,e]=this._getAngleCS(r);return g.ca=l,g.sa=e,!0}nextCurve(f){if(0===f)return null;const g=Z.z.createEmptyOptimizedCIM("esriGeometryPolyline");g.startPath(),g.nextPath();const h=new P;return this._nextPosition(f,h,g,x.END)?(h.copyTo(this._currentPosition),g):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(f){return this._pathCursor.seekInPath(f),[this._pathCursor.x,this._pathCursor.y]}getSeg(f){return[this.getPt(f),this.getPt(f+1)]}_nextPosition(f,g,h,r){if(this._currentPosition.isPathEnd)return!1;let l=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(l/=this._currentPosition.segmentLength),this._currentPosition.copyTo(g);g.abscissa+f*this._partLengthRatio>g.segmentLength+this._tolerance;){if(h){if(0===h.pathSize)if(0===l){const c=g.segment[0];h.pushXY(c[0],c[1])}else h.pushPoint(this.getSegCoord2D(g.segment,l));const e=g.segment[1];h.pushXY(e[0],e[1])}if(l=0,f-=(g.segmentLength-g.abscissa)/this._partLengthRatio,this._partSegCount)g.segment=this._nextSegment(),g.segmentLength=this.getSegLength(g.segment),g.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return r!==x.FAIL&&(g.segmentLength=this.getSegLength(g.segment),g.isPartEnd=!0,r===x.END?(g.abscissa=g.segmentLength,g.isPathEnd=!0):g.abscissa=g.segmentLength+f,!0);this._currentPosition.copyTo(g)}}if(g.abscissa+=f*this._partLengthRatio,h){0===h.pathSize&&h.pushPoint(0===l?g.segment[0]:this.getSegCoord2D(g.segment,l));const e=g.abscissa/g.segmentLength;h.pushPoint(1===e?g.segment[1]:this.getSegCoord2D(g.segment,e))}return this._partSegCount||Math.abs(g.abscissa-g.segmentLength)<this._tolerance&&(g.isPathEnd=this._partIsLast,g.isPartEnd=!0),!0}_getPoint(f){return this.getSegCoord2D(this._currentPosition.segment,f.segmentLength<=0?0:f.abscissa/f.segmentLength)}_getAngleCS(f){return this.getSegAngleCS(this._currentPosition.segment,f.segmentLength<=0?0:f.abscissa/f.segmentLength)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let f=this._partSegCount;for(;f;)this._previousSegment(),--f;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const g=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(g);let h=g+this._partSegCount+1;if(h>=this._pathCursor.pathSize&&(h=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(h),this._patternLength>0){const r=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,l=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let e=Math.round((this._partLength-(r+l))/this._patternLength);e<=0&&(e=r+l>0?0:1),this._partLengthRatio=this._partLength/(r+l+e*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}},9792:(dt,it,S)=>{S.d(it,{A:()=>Z});class Z{constructor(G=0,D=0,B=0,x=0){this.x=G,this.y=D,this.width=B,this.height=x}static fromExtent(G){return new Z(G.xmin,-G.ymax,G.xmax-G.xmin,G.ymax-G.ymin)}get isEmpty(){return this.width<=0||this.height<=0}union(G){this.x=Math.min(this.x,G.x),this.y=Math.min(this.y,G.y),this.width=Math.max(this.width,G.width),this.height=Math.max(this.height,G.height)}}},47763:(dt,it,S)=>{S.d(it,{B:()=>m});var Z=S(72137),X=S(53262),G=S(61245),D=S(67311),B=S(65374);const x=1.7320508075688772,_=B.oF.OpenEnded;let m=(()=>{class g{static local(){return null===g.instance&&(g.instance=new g),g.instance}execute(r,l,e,c,d){return new f(r,l,e)}}return g.instance=null,g})();class f extends G.rx{constructor(h,r,l){super(h,!1,!0),this._curveHelper=new D.I,this._width=(void 0!==r.width?r.width:5)*l,this._arrowType=void 0!==r.geometricEffectArrowType?r.geometricEffectArrowType:void 0!==r.arrowType?r.arrowType:_,this._offsetFlattenError=D.U*l}processPath(h){const r=Z.z.createEmptyOptimizedCIM(h.geometryType);switch(this._arrowType){case B.oF.OpenEnded:default:this._constructSimpleArrow(r,h,!0);break;case B.oF.Block:this._constructSimpleArrow(r,h,!1);break;case B.oF.Crossed:this._constructCrossedArrow(r,h)}return r}_constructSimpleArrow(h,r,l){const e=r.pathLength();let c=this._width;e<2*c&&(c=e/2);const d=this._curveHelper.getSubCurve(r,0,e-c);if(!d||!d.nextPath())return;d.seekPathStart();const M=c/2;if(this._curveHelper.isEmpty(d))return;const I=(0,X.A)(d),A=this._constructOffset(I,-M);if(!A)return;const U=this._constructOffset(I,M);if(!U)return;const F=this._constructArrowBasePoint(A,-M/2);if(!F)return;const N=this._constructArrowBasePoint(U,M/2);if(!N)return;r.seekInPath(r.pathSize-1);const $=[r.x,r.y];h.pushPath(U),h.nextPath(),h.nextPoint(),h.setControlPoint(),h.pushPoint(N),h.nextPoint(),h.setControlPoint(),h.pushPoint($),h.nextPoint(),h.setControlPoint(),h.pushPoint(F),h.nextPoint(),h.setControlPoint(),h.pushPoints(A.reverse()),h.setControlPoint(),l||(h.setControlPointAt(0),h.setControlPointAt(h.pathSize-1),h.pushPoint(U[0])),h.reset()}_constructCrossedArrow(h,r){const l=r.pathLength();let e=this._width;l<e*(1+x+1)&&(e=l/(1+x+1)),r.seekPathStart();const c=this._curveHelper.getSubCurve(r,0,l-e*(1+x));if(!c)return;c.nextPath();const d=e/2;if(this._curveHelper.isEmpty(c))return;const M=(0,X.A)(c),I=this._constructOffset(M,d);if(!I)return;const A=this._constructOffset(M,-d);if(!A)return;const U=this._curveHelper.getSubCurve(r,0,l-e);if(!U||(U.nextPath(),this._curveHelper.isEmpty(U)))return;const F=(0,X.A)(U),N=this._constructOffset(F,d);if(!N)return;const $=this._constructOffset(F,-d);if(!$)return;const z=N[N.length-1],b=this._constructArrowBasePoint(N,d/2);if(!b)return;const v=$[$.length-1],T=this._constructArrowBasePoint($,-d/2);if(!T)return;r.seekInPath(r.pathSize-1);const L=[r.x,r.y];h.pushPath(I),h.nextPath(),h.nextPoint(),h.setControlPoint(),h.pushPoint(v),h.nextPoint(),h.setControlPoint(),h.pushPoint(T),h.nextPoint(),h.setControlPoint(),h.pushPoint(L),h.nextPoint(),h.setControlPoint(),h.pushPoint(b),h.nextPoint(),h.setControlPoint(),h.pushPoint(z),h.nextPoint(),h.setControlPoint(),h.pushPoints(A.reverse()),h.nextPoint(),h.setControlPoint(),h.reset()}_constructOffset(h,r){return this._curveHelper.offset(h,r,B.xw.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(h,r){if(!h||h.length<2)return null;const l=h[h.length-2],e=h[h.length-1],c=[e[0]-l[0],e[1]-l[1]];return this._curveHelper.normalize(c),[e[0]+c[1]*r,e[1]-c[0]*r]}}},69630:(dt,it,S)=>{S.d(it,{s:()=>_}),S(21152);var X=S(72137),G=S(53262),D=S(47961),B=S(67311),x=S(65374),P=S(32034);let _=(()=>{class f{static local(){return null===f.instance&&(f.instance=new f),f.instance}execute(h,r,l,e,c,d){return new m(h,r,l,e,c,d)}}return f.instance=null,f})();class m{constructor(g,h,r,l,e,c){this._inputGeometries=g,this._tileKey=l,this._geometryEngine=e,this._curveHelper=new B.I,this._size=(void 0!==h.size?h.size:1)*r,this._maxInflateSize=c*r,this._offsetFlattenError=B.U*r}next(){let g;for(;g=this._inputGeometries.next();){if(0===this._size)return g;if("esriGeometryEnvelope"===g.geometryType)if(this._size>0){const e=X.z.createEmptyOptimizedCIM(g.geometryType),c=(0,G.x)(g)[0],d=this._curveHelper.offset(c,this._size,x.xw.Rounded,4,this._offsetFlattenError);if(d)return e.pushPath(d),e}else if(this._size<0){const e=g.asJSON();if(Math.min(e.xmax-e.xmin,e.ymax-e.ymin)+2*this._size>0)return X.z.fromJSONCIM({xmin:e.xmin-this._size,xmax:e.xmax+this._size,ymin:e.ymin-this._size,ymax:e.ymax+this._size})}const h=this._geometryEngine;if(null==h)return null;const r=this._tileKey?(0,D.q)(g,this._maxInflateSize):g;if(!r)continue;const l=h.buffer(P.A.WebMercator,r.asJSON(),this._size,1);return l?X.z.fromJSONCIM(l):null}return null}}},71045:(dt,it,S)=>{S.d(it,{v:()=>B});var Z=S(72137),X=S(53262),G=S(61245),D=S(65374);let B=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(m,f,g,h,r){return new x(m,f,g)}}return P.instance=null,P})();class x{constructor(_,m,f){this._defaultPointSize=20,this._inputGeometries=_,this._geomUnitsPerPoint=f,this._rule=m.rule??D.uQ.FullGeometry,this._defaultSize=this._defaultPointSize*f}next(){let _;for(;_=this._inputGeometries.next();){const m=this._processGeom((0,X.x)(_));if(m?.length)return Z.z.fromJSONCIM({paths:m})}return null}_clone(_){return[_[0],_[1]]}_mid(_,m){return[(_[0]+m[0])/2,(_[1]+m[1])/2]}_mix(_,m,f,g){return[_[0]*m+f[0]*g,_[1]*m+f[1]*g]}_add(_,m){return[_[0]+m[0],_[1]+m[1]]}_add2(_,m,f){return[_[0]+m,_[1]+f]}_sub(_,m){return[_[0]-m[0],_[1]-m[1]]}_dist(_,m){return Math.sqrt((_[0]-m[0])*(_[0]-m[0])+(_[1]-m[1])*(_[1]-m[1]))}_norm(_){return Math.sqrt(_[0]*_[0]+_[1]*_[1])}_normalize(_,m=1){const f=m/this._norm(_);_[0]*=f,_[1]*=f}_leftPerpendicular(_){const f=_[0];_[0]=-_[1],_[1]=f}_leftPerp(_){return[-_[1],_[0]]}_rightPerpendicular(_){const f=-_[0];_[0]=_[1],_[1]=f}_rightPerp(_){return[_[1],-_[0]]}_dotProduct(_,m){return _[0]*m[0]+_[1]*m[1]}_crossProduct(_,m){return _[0]*m[1]-_[1]*m[0]}_rotateDirect(_,m,f){const h=_[0]*f+_[1]*m;_[0]=_[0]*m-_[1]*f,_[1]=h}_makeCtrlPt(_){const m=[_[0],_[1]];return(0,G.Aq)(m,1),m}_addAngledTicks(_,m,f,g){const h=this._sub(f,m);this._normalize(h);const r=this._crossProduct(h,this._sub(g,m));let l;l=r>0?this._rightPerp(h):this._leftPerp(h);const e=Math.abs(r)/2,c=[];c.push([m[0]+(l[0]-h[0])*e,m[1]+(l[1]-h[1])*e]),c.push(m),c.push(f),c.push([f[0]+(l[0]+h[0])*e,f[1]+(l[1]+h[1])*e]),_.push(c)}_addBezier2(_,m,f,g,h){if(0==h--)return void _.push(g);const r=this._mid(m,f),l=this._mid(f,g),e=this._mid(r,l);this._addBezier2(_,m,r,e,h),this._addBezier2(_,e,l,g,h)}_addBezier3(_,m,f,g,h,r){if(0==r--)return void _.push(h);const l=this._mid(m,f),e=this._mid(f,g),c=this._mid(g,h),d=this._mid(l,e),M=this._mid(e,c),I=this._mid(d,M);this._addBezier3(_,m,l,d,I,r),this._addBezier3(_,I,M,c,h,r)}_add90DegArc(_,m,f,g,h){const r=h??this._crossProduct(this._sub(f,m),this._sub(g,m))>0,l=this._mid(m,f),e=this._sub(l,m);r?this._leftPerpendicular(e):this._rightPerpendicular(e),l[0]+=e[0],l[1]+=e[1],this._addBezier3(_,m,this._mix(m,.33333,l,.66667),this._mix(f,.33333,l,.66667),f,4)}_addArrow(_,m,f){const g=m[0],h=m[1],r=m[m.length-1],l=this._sub(g,h),e=this._norm(l);this._normalize(l);const c=Math.abs(this._crossProduct(l,this._sub(r,h)));let d=this._dotProduct(l,this._sub(r,h));d<.05*e?d=.05*e:d>.95*e&&(d=.95*e);const M=.5*c,I=this._leftPerp(l),A=[h[0]+l[0]*d,h[1]+l[1]*d],U=m.length-1,F=[];F.push(f?[-I[0],-I[1]]:I);let N=[-l[0],-l[1]];for(let $=1;$<U-1;$++){const z=this._sub(m[$+1],m[$]);this._normalize(z);const b=this._dotProduct(z,N),v=this._crossProduct(z,N),T=Math.sqrt((1+b)/2),L=this._sub(z,N);this._normalize(L),L[0]/=T,L[1]/=T,F.push(v<0?[-L[0],-L[1]]:L),N=z}F.push(this._rightPerp(N));for(let $=F.length-1;$>0;$--)_.push([m[$][0]+F[$][0]*M,m[$][1]+F[$][1]*M]);_.push([A[0]+F[0][0]*M,A[1]+F[0][1]*M]),_.push([A[0]+F[0][0]*c,A[1]+F[0][1]*c]),_.push(g),_.push([A[0]-F[0][0]*c,A[1]-F[0][1]*c]),_.push([A[0]-F[0][0]*M,A[1]-F[0][1]*M]);for(let $=1;$<F.length;$++)_.push([m[$][0]-F[$][0]*M,m[$][1]-F[$][1]*M])}_cp2(_,m,f){return _.length>=2?_[1]:this._add2(_[0],m*this._defaultSize,f*this._defaultSize)}_cp3(_,m,f,g){if(_.length>=3)return _[2];const h=this._mix(_[0],1-f,m,f),r=this._sub(m,_[0]);return this._normalize(r),this._rightPerpendicular(r),[h[0]+r[0]*g*this._defaultSize,h[1]+r[1]*g*this._defaultSize]}_arrowPath(_){if(_.length>2)return _;const m=_[0],f=this._cp2(_,-4,0),g=this._sub(m,f);this._normalize(g);const h=this._rightPerp(g);return[m,f,[m[0]+(h[0]-g[0])*this._defaultSize,m[1]+(h[1]-g[1])*this._defaultSize]]}_arrowLastSeg(_){const m=_[0],f=this._cp2(_,-4,0);let g;if(_.length>=3)g=_[_.length-1];else{const h=this._sub(m,f);this._normalize(h);const r=this._rightPerp(h);g=[m[0]+(r[0]-h[0])*this._defaultSize,m[1]+(r[1]-h[1])*this._defaultSize]}return[f,g]}_processGeom(_){if(!_)return null;const m=[];for(const f of _){if(!f||0===f.length)continue;const g=f.length;let h=f[0];switch(this._rule){case D.uQ.PerpendicularFromFirstSegment:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,4),e=[];e.push(l),e.push(this._mid(h,r)),m.push(e);break}case D.uQ.ReversedFirstSegment:{const r=this._cp2(f,0,-1);m.push([r,h]);break}case D.uQ.PerpendicularToSecondSegment:{if(f.length<3)return[];const r=this._cp2(f,-4,1),l=this._cp3(f,r,.882353,-1.94),e=[];e.push(this._mid(r,l)),e.push(h),m.push(e);break}case D.uQ.SecondSegmentWithTicks:{if(f.length<3)return[];const r=this._cp2(f,-4,1),l=this._cp3(f,r,.882353,-1.94),e=this._sub(l,r);let c;c=this._crossProduct(e,this._sub(h,r))>0?this._rightPerp(e):this._leftPerp(e);const d=[];d.push([r[0]+(c[0]-e[0])/3,r[1]+(c[1]-e[1])/3]),d.push(r),d.push(l),d.push([l[0]+(c[0]+e[0])/3,l[1]+(c[1]+e[1])/3]),m.push(d);break}case D.uQ.DoublePerpendicular:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,3),e=this._mid(h,r),c=this._sub(e,l);this._normalize(c);const d=this._crossProduct(c,this._sub(h,l));this._leftPerpendicular(c);const M=[];M.push(h),M.push([l[0]+c[0]*d,l[1]+c[1]*d]),m.push(M);const I=[];I.push([l[0]-c[0]*d,l[1]-c[1]*d]),I.push(r),m.push(I);break}case D.uQ.OppositeToFirstSegment:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,3),e=this._mid(h,r),c=this._sub(e,l);this._normalize(c);const d=this._crossProduct(c,this._sub(h,l));this._leftPerpendicular(c);const M=[];M.push([l[0]+c[0]*d,l[1]+c[1]*d]),M.push([l[0]-c[0]*d,l[1]-c[1]*d]),m.push(M);break}case D.uQ.TriplePerpendicular:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,4),e=this._mid(h,r),c=this._sub(e,l);this._normalize(c);const d=this._crossProduct(c,this._sub(h,l));this._leftPerpendicular(c);const M=[];M.push([l[0]+c[0]*d*.8,l[1]+c[1]*d*.8]),M.push([e[0]+.8*(h[0]-e[0]),e[1]+.8*(h[1]-e[1])]),m.push(M),m.push([l,e]);const I=[];I.push([l[0]-c[0]*d*.8,l[1]-c[1]*d*.8]),I.push([e[0]+.8*(r[0]-e[0]),e[1]+.8*(r[1]-e[1])]),m.push(I);break}case D.uQ.HalfCircleFirstSegment:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,4),e=this._mid(h,r);let c=this._sub(r,h);const d=Math.cos(Math.PI/18),M=Math.sin(Math.PI/18),I=Math.sqrt((1+d)/2),A=Math.sqrt((1-d)/2),U=[];let F;this._crossProduct(c,this._sub(l,h))>0?(U.push(h),c=this._sub(h,e),F=r):(U.push(r),c=this._sub(r,e),F=h),this._rotateDirect(c,I,A),c[0]/=I,c[1]/=I;for(let N=1;N<=18;N++)U.push(this._add(e,c)),this._rotateDirect(c,d,M);U.push(F),m.push(U);break}case D.uQ.HalfCircleSecondSegment:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,1,-1);let e=this._sub(h,r);this._normalize(e);const c=this._crossProduct(e,this._sub(l,r))/2;this._leftPerpendicular(e);const d=[r[0]+e[0]*c,r[1]+e[1]*c];e=this._sub(r,d);const M=Math.cos(Math.PI/18);let I=Math.sin(Math.PI/18);c>0&&(I=-I);const A=[r];for(let U=1;U<=18;U++)this._rotateDirect(e,M,I),A.push(this._add(d,e));m.push(A);break}case D.uQ.HalfCircleExtended:{const r=this._cp2(f,0,-2),l=this._cp3(f,r,1,-1);let e;if(g>=4)e=f[3];else{const U=this._sub(h,r);e=this._add(l,U)}const c=this._dist(r,l)/2/.75,d=this._sub(r,h);this._normalize(d,c);const M=this._sub(l,e);this._normalize(M,c),m.push([e,l]);const A=[this._clone(l)];this._addBezier3(A,l,this._add(l,M),this._add(r,d),r,4),A.push(h),m.push(A);break}case D.uQ.OpenCircle:{const r=this._cp2(f,-2,0),l=this._sub(r,h),e=Math.cos(Math.PI/18),c=-Math.sin(Math.PI/18),d=[r];for(let M=1;M<=33;M++)this._rotateDirect(l,e,c),d.push(this._add(h,l));m.push(d);break}case D.uQ.CoverageEdgesWithTicks:{const r=this._cp2(f,0,-1);let l,e;if(g>=3)l=f[2];else{const I=this._sub(r,h),A=this._leftPerp(I);l=[h[0]+A[0]-.25*I[0],h[1]+A[1]-.25*I[1]]}if(g>=4)e=f[3];else{const I=this._mid(h,r),A=this._sub(h,r);this._normalize(A),this._leftPerpendicular(A);const U=this._crossProduct(A,this._sub(l,I));this._rightPerpendicular(A),e=[l[0]+A[0]*U*2,l[1]+A[1]*U*2]}const c=this._sub(r,h);let d,M;d=this._crossProduct(c,this._sub(l,h))>0?this._rightPerp(c):this._leftPerp(c),M=[],M.push(l),M.push(h),M.push([h[0]+(d[0]-c[0])/3,h[1]+(d[1]-c[1])/3]),m.push(M),d=this._crossProduct(c,this._sub(e,r))>0?this._rightPerp(c):this._leftPerp(c),M=[],M.push([r[0]+(d[0]+c[0])/3,r[1]+(d[1]+c[1])/3]),M.push(r),M.push(e),m.push(M);break}case D.uQ.GapExtentWithDoubleTicks:{const r=this._cp2(f,0,2),l=this._cp3(f,r,0,1);let e;if(g>=4)e=f[3];else{const c=this._sub(r,h);e=this._add(l,c)}this._addAngledTicks(m,h,r,this._mid(l,e)),this._addAngledTicks(m,l,e,this._mid(h,r));break}case D.uQ.GapExtentMidline:{const r=this._cp2(f,2,0),l=this._cp3(f,r,0,1);let e;if(g>=4)e=f[3];else{const d=this._sub(r,h);e=this._add(l,d)}const c=[];c.push(this._mid(h,l)),c.push(this._mid(r,e)),m.push(c);break}case D.uQ.Chevron:{const r=this._cp2(f,-1,-1);let l;if(g>=3)l=f[2];else{const e=this._sub(r,h);this._leftPerpendicular(e),l=this._add(h,e)}m.push([r,this._makeCtrlPt(h),l]);break}case D.uQ.PerpendicularWithArc:{const r=this._cp2(f,0,-2),l=this._cp3(f,r,.5,-1),e=this._sub(r,h),c=this._norm(e);e[0]/=c,e[1]/=c;const d=this._crossProduct(e,this._sub(l,h));let M=this._dotProduct(e,this._sub(l,h));M<.05*c?M=.05*c:M>.95*c&&(M=.95*c);const I=[h[0]+e[0]*M,h[1]+e[1]*M];let A=this._leftPerp(e),U=[];if(U.push([I[0]-A[0]*d,I[1]-A[1]*d]),U.push([I[0]+A[0]*d,I[1]+A[1]*d]),m.push(U),g>=4){const z=f[3];let b=this._dotProduct(e,this._sub(z,h));b<.1*c?b=.1*c:b>.9*c&&(b=.9*c);const v=[h[0]+e[0]*b,h[1]+e[1]*b],T=this._crossProduct(e,this._sub(z,h)),L=[];L.push([v[0]-A[0]*T,v[1]-A[1]*T]),L.push([v[0]+A[0]*T,v[1]+A[1]*T]),m.push(L)}const F=[r[0]+A[0]*d,r[1]+A[1]*d];A=this._sub(r,F);const N=Math.cos(Math.PI/18);let $=Math.sin(Math.PI/18);d<0&&($=-$),U=[h,r];for(let z=1;z<=9;z++)this._rotateDirect(A,N,$),U.push(this._add(F,A));m.push(U);break}case D.uQ.ClosedHalfCircle:{const r=this._cp2(f,2,0),l=this._mid(h,r),e=this._sub(r,l),c=Math.cos(Math.PI/18),d=Math.sin(Math.PI/18),M=[h,r];for(let I=1;I<=18;I++)this._rotateDirect(e,c,d),M.push(this._add(l,e));m.push(M);break}case D.uQ.TripleParallelExtended:{const r=this._cp2(f,0,-2),l=this._cp3(f,r,1,-2),e=this._mid(h,r),c=this._sub(l,r);this._normalize(c);const d=Math.abs(this._crossProduct(c,this._sub(e,r)))/2,M=this._dist(r,l),I=[r,h];I.push([h[0]+c[0]*M*.5,h[1]+c[1]*M*.5]),m.push(I);const A=[];A.push([e[0]-c[0]*d,e[1]-c[1]*d]),A.push([e[0]+c[0]*M*.375,e[1]+c[1]*M*.375]),(0,G.Aq)(A[A.length-1],1),A.push([e[0]+c[0]*M*.75,e[1]+c[1]*M*.75]),m.push(A),m.push([r,l]);break}case D.uQ.ParallelWithTicks:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._sub(l,r);this._normalize(e);const c=this._crossProduct(e,this._sub(l,h));this._leftPerpendicular(e),this._addAngledTicks(m,h,r,l),this._addAngledTicks(m,this._mix(h,1,e,c),this._mix(r,1,e,c),this._mid(h,r));break}case D.uQ.Parallel:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._sub(r,h);this._normalize(e);const c=this._leftPerp(e),d=this._crossProduct(e,this._sub(l,h));let M=[h,r];m.push(M),M=[],M.push([h[0]+c[0]*d,h[1]+c[1]*d]),M.push([r[0]+c[0]*d,r[1]+c[1]*d]),m.push(M);break}case D.uQ.PerpendicularToFirstSegment:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._mid(h,r),c=this._sub(r,h);this._normalize(c);const d=this._crossProduct(c,this._sub(l,h));this._leftPerpendicular(c);const M=[];M.push([e[0]-c[0]*d*.25,e[1]-c[1]*d*.25]),M.push([e[0]+c[0]*d*1.25,e[1]+c[1]*d*1.25]),m.push(M);break}case D.uQ.ParallelOffset:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._sub(r,h);this._normalize(e);const c=this._crossProduct(e,this._sub(l,h));this._leftPerpendicular(e);const d=[];d.push([h[0]-e[0]*c,h[1]-e[1]*c]),d.push([r[0]-e[0]*c,r[1]-e[1]*c]),m.push(d);const M=[];M.push([h[0]+e[0]*c,h[1]+e[1]*c]),M.push([r[0]+e[0]*c,r[1]+e[1]*c]),m.push(M);break}case D.uQ.OffsetOpposite:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._sub(r,h);this._normalize(e);const c=this._crossProduct(e,this._sub(l,h));this._leftPerpendicular(e);const d=[];d.push([h[0]-e[0]*c,h[1]-e[1]*c]),d.push([r[0]-e[0]*c,r[1]-e[1]*c]),m.push(d);break}case D.uQ.OffsetSame:{const r=this._cp2(f,3,0),l=this._cp3(f,r,.5,-1),e=this._sub(r,h);this._normalize(e);const c=this._crossProduct(e,this._sub(l,h));this._leftPerpendicular(e);const d=[];d.push([h[0]+e[0]*c,h[1]+e[1]*c]),d.push([r[0]+e[0]*c,r[1]+e[1]*c]),m.push(d);break}case D.uQ.CircleWithArc:{let r=this._cp2(f,3,0);const l=this._cp3(f,r,.5,-1);let e,c;if(g>=4)e=f[3],c=this._crossProduct(this._sub(e,r),this._sub(l,r))>0;else{e=r,c=this._crossProduct(this._sub(e,h),this._sub(l,h))>0;const U=24*this._geomUnitsPerPoint,F=this._sub(e,h);this._normalize(F,U);const N=Math.sqrt(2)/2;this._rotateDirect(F,N,c?N:-N),r=this._add(h,F)}const d=this._sub(r,h),M=Math.cos(Math.PI/18),I=Math.sin(Math.PI/18),A=[r];for(let U=1;U<=36;U++)this._rotateDirect(d,M,I),A.push(this._add(h,d));this._add90DegArc(A,r,e,l,c),(0,G.Aq)(A[A.length-8],1),m.push(A);break}case D.uQ.DoubleJog:{let r,l=this._cp2(f,-3,1),e=this._cp3(f,l,-1,-.5);if(g>=4)r=f[3];else{const $=h;h=l,r=e;const z=this._dist(h,$),b=this._dist(r,$);let v=30*this._geomUnitsPerPoint;.5*z<v&&(v=.5*z),.5*b<v&&(v=.5*b),l=this._mix(h,v/z,$,(z-v)/z),e=this._mix(r,v/b,$,(b-v)/b)}const c=this._mid(h,l),d=this._mid(r,e),M=this._dist(h,l),I=this._dist(e,r);let A=Math.min(M,I)/8;A=Math.min(A,24*this._geomUnitsPerPoint);const U=Math.cos(Math.PI/4);let F=this._sub(h,l);this._normalize(F,A),this._crossProduct(F,this._sub(r,l))>0?this._rotateDirect(F,U,-U):this._rotateDirect(F,U,U);let N=[];N.push(l),N.push(this._add(c,F)),N.push(this._sub(c,F)),N.push(h),m.push(N),F=this._sub(r,e),this._normalize(F,A),this._crossProduct(F,this._sub(h,e))<0?this._rotateDirect(F,U,U):this._rotateDirect(F,U,-U),N=[],N.push(e),N.push(this._add(d,F)),N.push(this._sub(d,F)),N.push(r),m.push(N);break}case D.uQ.PerpendicularOffset:{const r=this._cp2(f,-4,1),l=this._cp3(f,r,.882353,-1.94),e=this._sub(l,r);this._crossProduct(e,this._sub(h,r))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const c=[e[0]/8,e[1]/8],d=this._sub(this._mid(r,l),c);m.push([d,h]);break}case D.uQ.LineExcludingLastSegment:{const r=this._arrowPath(f),l=[];let e=r.length-2;for(;e--;)l.push(r[e]);m.push(l);break}case D.uQ.MultivertexArrow:{const r=this._arrowPath(f),l=[];this._addArrow(l,r,!1),m.push(l);break}case D.uQ.CrossedArrow:{const r=this._arrowPath(f),l=[];this._addArrow(l,r,!0),m.push(l);break}case D.uQ.ChevronArrow:{const[r,l]=this._arrowLastSeg(f),e=10*this._geomUnitsPerPoint,c=this._sub(h,r),d=this._norm(c);this._normalize(c);const M=this._crossProduct(c,this._sub(l,r));let I=this._dotProduct(c,this._sub(l,r));I<.05*d?I=.05*d:I>.95*d-e&&(I=.95*d-e);const A=[r[0]+c[0]*I,r[1]+c[1]*I],U=this._leftPerp(c),F=[];F.push([A[0]+U[0]*M+c[0]*e,A[1]+U[1]*M+c[1]*e]),F.push(h),F.push([A[0]-U[0]*M+c[0]*e,A[1]-U[1]*M+c[1]*e]),m.push(F);break}case D.uQ.ChevronArrowOffset:{const[r,l]=this._arrowLastSeg(f),e=this._sub(h,r),c=this._norm(e);this._normalize(e);const d=this._crossProduct(e,this._sub(l,r));let M=this._dotProduct(e,this._sub(l,r));M<.05*c?M=.05*c:M>.95*c&&(M=.95*c);const I=[r[0]+e[0]*M,r[1]+e[1]*M];this._leftPerpendicular(e);const A=[];A.push([I[0]+e[0]*d*.5,I[1]+e[1]*d*.5]),A.push(this._mid(I,h)),A.push([I[0]-e[0]*d*.5,I[1]-e[1]*d*.5]),m.push(A);break}case D.uQ.PartialFirstSegment:{const[r,l]=this._arrowLastSeg(f),e=this._sub(h,r),c=this._norm(e);this._normalize(e);let d=this._dotProduct(e,this._sub(l,r));d<.05*c?d=.05*c:d>.95*c&&(d=.95*c),m.push([r,[r[0]+e[0]*d,r[1]+e[1]*d]]);break}case D.uQ.Arch:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,1),e=this._sub(h,r),c=this._mix(l,1,e,.55),d=this._mix(l,1,e,-.55),M=[h];this._addBezier2(M,h,c,l,4),this._addBezier2(M,l,d,r,4),m.push(M);break}case D.uQ.CurvedParallelTicks:{const r=this._cp2(f,-4,1),l=this._cp3(f,r,.882353,-1.94),e=this._sub(l,r);this._crossProduct(e,this._sub(h,r))>0?this._rightPerpendicular(e):this._leftPerpendicular(e);const c=[e[0]/8,e[1]/8],d=this._sub(this._mid(r,l),c),M=this._sub(this._mix(r,.75,l,.25),c),I=this._sub(this._mix(r,.25,l,.75),c),A=[r];this._addBezier2(A,r,M,d,3),this._addBezier2(A,d,I,l,3),m.push(A);for(let U=0;U<8;U++){const F=A[2*U+1],N=[this._clone(F)];N.push(this._add(F,[e[0]/4,e[1]/4])),m.push(N)}break}case D.uQ.Arc90Degrees:{const r=this._cp2(f,0,-1),l=this._cp3(f,r,.5,1),e=[r];this._add90DegArc(e,r,h,l),m.push(e);break}case D.uQ.TipWithPerpendicularAndTicks:{const[r,l]=this._arrowLastSeg(f),e=10*this._geomUnitsPerPoint,c=this._sub(h,r),d=this._norm(c);this._normalize(c);let M=this._crossProduct(c,this._sub(l,r)),I=this._dotProduct(c,this._sub(l,r));I<.05*d?I=.05*d:I>.95*d-e&&(I=.95*d-e);const A=this._leftPerp(c),U=[h[0]-c[0]*e,h[1]-c[1]*e],F=.5*Math.max(d-I-e,e);M=Math.abs(M);const N=[];N.push([U[0]+A[0]*(M+F)-c[0]*F,U[1]+A[1]*(M+F)-c[1]*F]),N.push([U[0]+A[0]*M,U[1]+A[1]*M]),N.push([U[0]-A[0]*M,U[1]-A[1]*M]),N.push([U[0]-A[0]*(M+F)-c[0]*F,U[1]-A[1]*(M+F)-c[1]*F]),m.push(N),m.push([U,h]);break}default:m.push(f)}}return m}}},82854:(dt,it,S)=>{S.d(it,{y:()=>D});var Z=S(72137),X=S(61245),G=S(67311);let D=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,m,f,g,h){return new B(_,m,f)}}return x.instance=null,x})();class B extends X.rx{constructor(P,_,m){super(P,!0,!0),this._curveHelper=new G.I,this._beginCut=(void 0!==_.beginCut?_.beginCut:1)*m,this._endCut=(void 0!==_.endCut?_.endCut:1)*m,this._middleCut=(void 0!==_.middleCut?_.middleCut:0)*m,this._invert=void 0!==_.invert&&_.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(P){const{_beginCut:_,_endCut:m,_middleCut:f}=this,g=P.pathLength(),h=Z.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==_||0!==m||0!==f)if(_+m+f>=g)for(h.startPath();P.nextPoint();)h.pushXY(P.x,P.y);else this._curveHelper.appendSubCurve(h,P,0,_),this._curveHelper.appendSubCurve(h,P,.5*(g-f),.5*(g+f)),this._curveHelper.appendSubCurve(h,P,g-m,m)}else if(0===_&&0===m&&0===f)for(h.startPath();P.nextPoint();)h.pushXY(P.x,P.y);else _+m+f<g&&(0===f?this._curveHelper.appendSubCurve(h,P,_,g-m):(this._curveHelper.appendSubCurve(h,P,_,.5*(g-f)),this._curveHelper.appendSubCurve(h,P,.5*(g+f),g-m)));return 0===h.totalSize?null:h}}},65264:(dt,it,S)=>{S.d(it,{I:()=>m});var Z=S(72137),X=S(53262),G=S(15268),D=S(61245),B=S(65374),x=S(61116),P=S(32117);let m=(()=>{class g{static local(){return null===g.instance&&(g.instance=new g),g.instance}execute(r,l,e,c,d){return new f(r,l,e,c)}}return g.instance=null,g})();class f extends D.rx{constructor(h,r,l,e){super(h,!0,!0),this._firstCurve=null,this._walker=new x.Z1,this._walker.updateTolerance(l),this._endings=r.lineDashEnding,this._customDashPos=-(r.offsetAlongLine??0)*l,this._offsetAtEnd=(r.customEndingOffset??0)*l,this._tileKey=e;let c=(0,P.K3)(r).dashTemplate;c.length%2&&(c=[...c,...c]);let M=0;for(let I=0;I<c.length;I++){let A=Math.abs(c[I]);A<1e-7&&(A=1e-7),M+=A}this._patternLength=M,this._numOfDashesPerPattern=c.length/2,this._pattern=new x.VA,this._pattern.init(c,!0),this._pattern.scale(l)}processPath(h){if(0===this._pattern.length()){this.iteratePath=!1;const e=(0,X.A)(h);return Z.z.fromJSONCIM({paths:[e]})}if(!this.iteratePath){let e=!0;switch(this._endings){case B.yS.HalfPattern:case B.yS.HalfGap:default:this._pattern.extPtGap=0;break;case B.yS.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case B.yS.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case B.yS.NoConstraint:this.isClosed||(e=!1);break;case B.yS.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const c=h.pathLength();if(this._pattern.isEmpty()||c<.1*this._pattern.length()){const d=(0,X.A)(h);return Z.z.fromJSONCIM({paths:[d]})}if(!this._walker.init(h,this._pattern,e)){const d=(0,X.A)(h);return Z.z.fromJSONCIM({paths:[d]})}}let r;if(this.iteratePath)r=this._pattern.nextValue();else{let e;switch(this._endings){case B.yS.HalfPattern:default:e=.5*this._pattern.firstValue();break;case B.yS.HalfGap:e=.5*-this._pattern.lastValue();break;case B.yS.FullGap:e=-this._pattern.lastValue();break;case B.yS.FullPattern:e=0;break;case B.yS.NoConstraint:case B.yS.Custom:e=-this._customDashPos}let c=e/this._pattern.length();c-=Math.floor(c),e=c*this._pattern.length(),this._pattern.reset(),r=this._pattern.nextValue();let d=!1;for(;e>=r;)e-=r,r=this._pattern.nextValue(),d=!d;r-=e,d?(this._walker.nextPosition(r),r=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(r),r=this._pattern.nextValue(),this._walker.nextPosition(r),r=this._pattern.nextValue())}let l=this._walker.nextCurve(r);if(l)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)l.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else r=this._pattern.nextValue(),!this._walker.nextPosition(r)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(l.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,l=this._firstCurve,this._firstCurve=null;return l?.reset(),l}isClippingRequired(h){const r=(0,X.x)(h);let l=0;for(const e of r)l+=(0,G.Yl)(e);return Math.round(this._numOfDashesPerPattern*(l/this._patternLength))>1e3}}},70614:(dt,it,S)=>{S.d(it,{O:()=>x}),S(21152);var X=S(72137),G=S(47961),B=(S(65374),S(32034));let x=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(f,g,h,r,l,e){return new P(f,g,h,r,l,e)}}return _.instance=null,_})();class P{constructor(m,f,g,h,r,l){this._inputGeometries=m,this._tileKey=h,this._geometryEngine=r,this._maxInflateSize=l*g,this._width=(void 0!==f.width?f.width:2)*g,this._option=f.option}next(){let m;for(;m=this._inputGeometries.next();){if("esriGeometryEnvelope"===m.geometryType&&this._width>0){const f=m.asJSON();return Math.min(f.xmax-f.xmin,f.ymax-f.ymin)-2*this._width<0?m:X.z.fromJSONCIM({paths:[[[f.xmin+this._width,f.ymin+this._width],[f.xmax-this._width,f.ymin+this._width],[f.xmax-this._width,f.ymax-this._width],[f.xmin+this._width,f.ymax-this._width],[f.xmin+this._width,f.ymin+this._width]],[[f.xmin,f.ymin],[f.xmin,f.ymax],[f.xmax,f.ymax],[f.xmax,f.ymin],[f.xmin,f.ymin]]]})}if("esriGeometryPolygon"===m.geometryType){if(0===this._width)return m.clone();const f=this._geometryEngine;if(null==f)return null;const g=this._tileKey?(0,G.q)(m,this._maxInflateSize):m.clone();if(!g)continue;const h=f.buffer(B.A.WebMercator,g.asJSON(),-this._width,1);if(h)for(const r of h.rings)if(r){g.startPath();for(const l of r.reverse())g.pushXY(l[0],g.yFactor*l[1])}return g}}return null}}},88918:(dt,it,S)=>{S.d(it,{U:()=>D});var Z=S(72137),X=S(61245),G=S(67311);let D=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,m,f,g,h){return new B(_,m,f)}}return x.instance=null,x})();class B extends X.rx{constructor(P,_,m){super(P,!1,!0),this._curveHelper=new G.I,this._length=(void 0!==_.length?_.length:20)*m,this._angle=void 0!==_.angle?_.angle:225,this._position=void 0!==_.position?_.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(P){const _=Z.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(P))return null;P.seekInPath(0);const m=P.x,f=P.y;P.seekInPath(P.pathSize-1);const g=P.x,h=P.y;this._curveHelper.normalize([g-m,h-f]);const l=m+(g-m)*this._position/100,e=f+(h-f)*this._position/100,c=Math.cos((90-this._angle)/180*Math.PI);let d=Math.sin((90-this._angle)/180*Math.PI);return this._mirror&&(d=-d),this._mirror=!this._mirror,_.pushPath([[m,f],[l-this._length/2*c,e-this._length/2*d],[l+this._length/2*c,e+this._length/2*d],[g,h]]),_}}},3691:(dt,it,S)=>{S.d(it,{V:()=>f}),S(21152);var X=S(72137),G=S(53262),D=S(61320),B=S(47961),x=S(67311),P=S(65374),_=S(32034);let f=(()=>{class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(l,e,c,d,M,I){return new g(l,e,c,d,M,I)}}return h.instance=null,h})();class g{constructor(r,l,e,c,d,M){this._inputGeometries=r,this._tileKey=c,this._geometryEngine=d,this._curveHelper=new x.I,this._offset=(l.offset??1)*e,this._method=l.method,this._maxInflateSize=Math.max(Math.abs(M*e),10),this._option=l.option,this._offsetFlattenError=x.U*e}next(){let r;for(;r=this._inputGeometries.next();){if(0===this._offset)return r.clone();if("esriGeometryEnvelope"===r.geometryType){if(this._method===P.xw.Rounded&&this._offset>0){const M=(0,G.A)(r),I=this._curveHelper.offset(M,-this._offset,this._method,4,this._offsetFlattenError);if(I){const A=X.z.createEmptyOptimizedCIM(r.geometryType);return A.pushPath(I),A}return null}const d=r.asJSON();if((0,D.ZC)(d)&&Math.min(d.xmax-d.xmin,d.ymax-d.ymin)+2*this._offset>0)return X.z.fromJSONCIM({xmin:d.xmin-this._offset,xmax:d.xmax+this._offset,ymin:d.ymin-this._offset,ymax:d.ymax+this._offset})}const l=this._geometryEngine;if(null==l)continue;const e=this._tileKey?(0,B.q)(r,this._maxInflateSize):r.clone();if(!e)continue;const c=l.offset(_.A.WebMercator,e.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return c?X.z.fromJSONCIM(c):null}return null}}},25867:(dt,it,S)=>{S.d(it,{v:()=>X});var Z=S(83065);let X=(()=>{class D{static local(){return null===D.instance&&(D.instance=new D),D.instance}execute(x,P,_,m,f){return new G(x,P,_)}}return D.instance=null,D})();class G{constructor(B,x,P){this._inputGeometries=B,this._rotateAngle=void 0!==x.angle?x.angle*Math.PI/180:0}next(){let B=this._inputGeometries.next();for(;B;){if(0===this._rotateAngle||"esriGeometryPoint"===B.geometryType)return B;if(B.totalSize>0){const x=(0,Z.z8)(B),P=(x[2]+x[0])/2,_=(x[3]+x[1])/2;return B.reset(),this._rotate(B.clone(),P,_)}B=this._inputGeometries.next()}return null}_rotate(B,x,P){const _=Math.cos(this._rotateAngle),m=Math.sin(this._rotateAngle);for(;B.nextPath();)for(;B.nextPoint();){const f=B.x-x,g=B.y-P;B.x=x+f*_-g*m,B.y=P+f*m+g*_}return B.reset(),B}}},39516:(dt,it,S)=>{S.d(it,{W:()=>X});var Z=S(83065);let X=(()=>{class D{static local(){return null===D.instance&&(D.instance=new D),D.instance}execute(x,P,_,m,f){return new G(x,P,_)}}return D.instance=null,D})();class G{constructor(B,x,P){this._inputGeometries=B,this._xFactor=void 0!==x.xScaleFactor?x.xScaleFactor:1.15,this._yFactor=void 0!==x.yScaleFactor?x.yScaleFactor:1.15}next(){const B=this._inputGeometries.next();if(B){if(1===this._xFactor&&1===this._yFactor||"esriGeometryPoint"===B.geometryType)return B;if(B.totalSize>0){const x=(0,Z.z8)(B),P=(x[2]+x[0])/2,_=(x[3]+x[1])/2;return B.reset(),this._scaleCursor(B.clone(),P,_)}}return null}_scaleCursor(B,x,P){for(;B.nextPath();)for(;B.nextPoint();)B.x=x+(B.x-x)*this._xFactor,B.y=P+(B.y-P)*this._yFactor;return B.reset(),B}}},57249:(dt,it,S)=>{S.d(it,{l:()=>D});var Z=S(72137),X=S(65374),G=S(61116);let D=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,m,f,g,h){return new B(_,m,f)}}return x.instance=null,x})();class B{constructor(P,_,m){this._inputGeometries=P,this._height=(void 0!==_.amplitude?_.amplitude:2)*m,this._period=(void 0!==_.period?_.period:3)*m,this._style=_.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new G.VA,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new G.Z1,this._walker.updateTolerance(m)}next(){let P=this._inputGeometries.next();for(;P;){if(0===this._height||0===this._period)return P;const _=this._processGeom(P);if(_)return _;P=this._inputGeometries.next()}return null}_processGeom(P){const _=Z.z.createEmptyOptimizedCIM(P.geometryType);for(;P.nextPath();){_.startPath();const m=P.pathLength();if(this._walker.init(P,this._pattern))switch(this._style){case X.WE.Sinus:default:this._constructCurve(_,m,!1);break;case X.WE.Square:this._constructSquare(_,m);break;case X.WE.Triangle:this._constructTriangle(_,m);break;case X.WE.Random:this._constructCurve(_,m,!0)}else for(;P.nextPoint();)_.pushXY(P.x,P.y)}return _}_constructCurve(P,_,m){let f=Math.round(_/this._period);0===f&&(f=1);const r=this._period/16,l=1/(16*f+1),e=2*Math.PI*_/(_/f),c=2*Math.PI*Math.random(),d=2*Math.PI*Math.random(),M=2*Math.PI*Math.random(),I=.75-Math.random()/2,A=.75-Math.random()/2,U=new G.ps;this._walker.curPointAndAngle(U),P.pushPoint(U.pt);let F=0;for(;;){if(!this._walker.nextPointAndAngle(r,U)){P.pushPoint(this._walker.getPathEnd());break}{const N=F;let $;if(F+=l,m){const z=this._height/2*(1+.3*Math.sin(I*e*N+c));$=z*Math.sin(e*N+d),$+=z*Math.sin(A*e*N+M),$/=2}else $=.5*this._height*Math.sin(.5*e*N);P.pushXY(U.pt[0]-$*U.sa,U.pt[1]+$*U.ca)}}}_constructSquare(P,_){Math.round(_/this._period);let m=!0;for(;;){let f=!1;if(this._walker.curPositionIsValid()){const g=new G.ps;this._walker.curPointAndAngle(g);const h=new G.ps;if(this._walker.nextPointAndAngle(this._period,h)){const r=new G.ps;this._walker.nextPointAndAngle(this._period,r)&&(m?(P.pushPoint(g.pt),m=!1):P.pushPoint(g.pt),P.pushXY(g.pt[0]-this._height/2*g.sa,g.pt[1]+this._height/2*g.ca),P.pushXY(h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca),P.pushXY(h.pt[0]+this._height/2*h.sa,h.pt[1]-this._height/2*h.ca),P.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),f=!0)}}if(!f){P.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(P,_){Math.round(_/this._period);let m=!0;for(;;){let f=!1;if(this._walker.curPositionIsValid()){const g=new G.ps;this._walker.curPointAndAngle(g);const h=new G.ps;if(this._walker.nextPointAndAngle(this._period/2,h)){const r=new G.ps;this._walker.nextPointAndAngle(this._period,r)&&(this._walker.nextPosition(this._period/2)&&(m?(P.pushPoint(g.pt),m=!1):P.pushPoint(g.pt),P.pushXY(h.pt[0]-this._height/2*h.sa,h.pt[1]+this._height/2*h.ca),P.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca)),f=!0)}}if(!f){P.pushPoint(this._walker.getPathEnd());break}}}}},2544:(dt,it,S)=>{S.d(it,{e:()=>D});var Z=S(61245),X=S(65374),G=S(61116);let D=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,m,f,g,h){return new B(_,m,f)}}return x.instance=null,x})();class B extends Z.pC{constructor(P,_,m){super(P),this._geometryWalker=new G.Z1,this._geometryWalker.updateTolerance(m),this._angleToLine=_.angleToLine??!0,this._offset=(_.offset?_.offset:0)*m,this._originalEndings=_.endings,this._offsetAtEnd=(_.customEndingOffset?_.customEndingOffset:0)*m,this._position=-(_.offsetAlongLine?_.offsetAlongLine:0)*m,this._pattern=new G.VA,this._pattern.init(_.placementTemplate,!1),this._pattern.scale(m),this._endings=this._originalEndings}processPath(P){if(this._pattern.isEmpty())return null;let _;if(this.iteratePath)_=this._pattern.nextValue();else{this._endings=this._originalEndings===X.e_.WithFullGap&&this.isClosed?X.e_.WithMarkers:this._originalEndings,this._pattern.extPtGap=0;let f,g=!0;switch(this._endings){case X.e_.NoConstraint:f=-this._position,f=this._adjustPosition(f),g=!1;break;case X.e_.WithHalfGap:default:f=-this._pattern.lastValue()/2;break;case X.e_.WithFullGap:f=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case X.e_.WithMarkers:f=0;break;case X.e_.Custom:f=-this._position,f=this._adjustPosition(f),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(P,this._pattern,g))return null;this._pattern.reset();let h=0;for(;f>h;)f-=h,h=this._pattern.nextValue();h-=f,_=h,this.iteratePath=!0}const m=new G.ps;return this._geometryWalker.nextPointAndAngle(_,m)?this._endings===X.e_.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===X.e_.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(m.pt[0]-this._offset*m.sa,m.pt[1]+this._offset*m.ca),this._angleToLine&&this.internalPlacement.setRotateCS(m.ca,m.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(P){let _=P/this._pattern.length();return _-=Math.floor(_),_*this._pattern.length()}}},34572:(dt,it,S)=>{S.d(it,{y:()=>D});var Z=S(61245),X=S(67311),G=S(65374);let D=(()=>{class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(_,m,f,g,h){return new B(_,m,f)}}return x.instance=null,x})();class B extends Z.pC{constructor(P,_,m){super(P,!1,!0),this._curveHelper=new X.I,this._placePerPart=_.placePerPart??!1,this._angleToLine=void 0===_.angleToLine||_.angleToLine,this._offset=void 0!==_.offset?_.offset*m:0,this._type=_.extremityPlacement,this._position=void 0!==_.offsetAlongLine?_.offsetAlongLine*m:0,this._beginProcessed=!1}processMultiPath(P){return this._placePerPart?super.processMultiPath(P):this.processPath(P)}processPath(P){let _;switch(this._type){case G.$2.Both:default:this._beginProcessed?(_=this._atExtremities(P,this._position,!1),this._beginProcessed=!1,this.iterateMultiPath=!1,this.iteratePath=!1):(_=this._atExtremities(P,this._position,!0),this._beginProcessed=!0,this.iterateMultiPath=!0,this.iteratePath=!0);break;case G.$2.JustBegin:_=this._atExtremities(P,this._position,!0);break;case G.$2.JustEnd:_=this._atExtremities(P,this._position,!1);case G.$2.None:}return _}_atExtremities(P,_,m){if(this._placePerPart||P.seekPath(m?0:P.totalSize-1),m||P.seekPathEnd(),m?P.nextPoint():P.prevPoint()){let f=0,[g,h]=[0,0],[r,l]=[P.x,P.y];for(;m?P.nextPoint():P.prevPoint();){g=r,h=l,r=P.x,l=P.y;const e=this._curveHelper.getLength(g,h,r,l);if(f+e>_){const c=(_-f)/e,[d,M]=this._curveHelper.getAngleCS(g,h,r,l,c),I=this._curveHelper.getCoord2D(g,h,r,l,c);return this.internalPlacement.setTranslate(I[0]-this._offset*M,I[1]+this._offset*d),this._angleToLine&&this.internalPlacement.setRotateCS(-d,-M),this.internalPlacement}f+=e}}return null}}},56854:(dt,it,S)=>{S.d(it,{S:()=>G});var Z=S(61245),X=S(61116);let G=(()=>{class B{static local(){return null===B.instance&&(B.instance=new B),B.instance}execute(P,_,m,f,g){return new D(P,_,m)}}return B.instance=null,B})();class D extends Z.pC{constructor(x,P,_){super(x),this._walker=new X.Z1,this._walker.updateTolerance(_),this._angleToLine=void 0===P.angleToLine||P.angleToLine,this._offset=void 0!==P.offset?P.offset*_:0,this._beginGap=void 0!==P.beginPosition?P.beginPosition*_:0,this._endGap=void 0!==P.endPosition?P.endPosition*_:0,this._flipFirst=void 0===P.flipFirst||P.flipFirst,this._pattern=new X.VA,this._pattern.init(P.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(x){if(this._pattern.isEmpty())return null;let P;if(this.iteratePath){const h=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+h;P=r-this._prevPos,this._prevPos=r}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=x.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(x,this._pattern,!1))return null;this._pattern.reset();const h=this._pattern.nextValue()*this._subPathLen,r=this._beginGap+h;P=r-this._prevPos,this._prevPos=r,this.iteratePath=!0}const _=new X.ps;if(!this._walker.nextPointAndAngle(P,_,X.YQ.END))return this.iteratePath=!1,null;let f,g;return this.internalPlacement.setTranslate(_.pt[0]-this._offset*_.sa,_.pt[1]+this._offset*_.ca),this._angleToLine?(f=_.ca,g=_.sa):(f=1,g=0),this._isFirst&&this._flipFirst&&(f=-f,g=-g),this.internalPlacement.setRotateCS(f,g),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}},47942:(dt,it,S)=>{S.d(it,{M:()=>_});var Z=S(40707),X=S(76571),G=S(65374);const D=512,x=24,P=1e-6;let _=(()=>{class h{static local(){return null===h.instance&&(h.instance=new h),h.instance}execute(l,e,c,d,M){return new m(l,e,c,d,M)}}return h.instance=null,h})();class m{constructor(r,l,e,c,d){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(l.stepX??16)*e,this._stepY=Math.abs(l.stepY??16)*e,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=l.gridType??G.Q1.Fixed,this._gridType===G.Q1.Random)this._randomLCG=new Z.A(1*(l.seed??13)),this._randomness=(l.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues();else{if(this._randomness=0,this._gridAngle=l.gridAngle??0,this._shiftOddRows=l.shiftOddRows??!1,this._offsetX=(l.offsetX??0)*e,this._offsetY=(l.offsetY??0)*e,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=c){const[M,I,A,U]=c.split("/"),F=parseFloat(M),N=parseFloat(I),$=parseFloat(A),z=parseFloat(U);this._graphicOriginX=-(z*2**F+$)*D,this._graphicOriginY=N*D,this._testInsidePolygon=!0}this._internalPlacement=new X.W,this._calculateMinMax(r),this._geometryCursor=r}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!m._randValues){m._randValues=[];for(let r=0;r<x;r++)for(let l=0;l<x;l++)m._randValues.push(this._randomLCG.getFloat()),m._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(r){let l,e,c,d,M,I,A,U,F,N,$,z,b,v;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,A=U=b=$=Number.MAX_VALUE,F=N=v=z=-Number.MAX_VALUE;const T=1!==this._cosAngle;for(r.reset();r.nextPath();)for(;r.nextPoint();)I=r.x,M=r.y,l=I-this._graphicOriginX-this._offsetX,e=M-this._graphicOriginY-this._offsetY,T?(c=this._cosAngle*l-this._sinAngle*e,d=this._sinAngle*l+this._cosAngle*e):(c=l,d=e),A=Math.min(A,c),F=Math.max(F,c),U=Math.min(U,d),N=Math.max(N,d),$=Math.min($,M),z=Math.max(z,M),b=Math.min(b,I),v=Math.max(v,I);if($=$!==Number.MAX_VALUE?$:-D-this._stepY,z=z!==-Number.MAX_VALUE?z:this._stepY,b=b!==Number.MAX_VALUE?b:-this._stepX,v=v!==-Number.MAX_VALUE?v:D+this._stepX,this._verticalSubdivision=z-$>=v-b,this._polygonMin=this._verticalSubdivision?$:b,this._testInsidePolygon){let K=0-this._graphicOriginX-this._offsetX-this._stepX,k=D-this._graphicOriginX-this._offsetX+this._stepX,Y=-D-this._graphicOriginY-this._offsetY-this._stepY,tt=0-this._graphicOriginY-this._offsetY+this._stepY;if(T){const ot=[[K,Y],[K,tt],[k,Y],[k,tt]];K=Y=Number.MAX_VALUE,k=tt=-Number.MAX_VALUE;for(const q of ot){const lt=this._cosAngle*q[0]-this._sinAngle*q[1],rt=this._sinAngle*q[0]+this._cosAngle*q[1];K=Math.min(K,lt),k=Math.max(k,lt),Y=Math.min(Y,rt),tt=Math.max(tt,rt)}}A=A!==Number.MAX_VALUE?Math.max(A,K):K,U=U!==Number.MAX_VALUE?Math.max(U,Y):Y,F=F!==-Number.MAX_VALUE?Math.min(F,k):k,N=N!==-Number.MAX_VALUE?Math.min(N,tt):tt}this._xMin=Math.round(A/this._stepX),this._xMax=Math.round(F/this._stepX),this._yMin=Math.round(U/this._stepY),this._yMax=Math.round(N/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(r,b,v,$,z)}_buildAccelerationMap(r,l,e,c,d){r.reset();const M=new Map,I=this._verticalSubdivision,A=I?d-c:e-l;let U=Math.ceil(A/10);if(U<=1)return;const F=Math.floor(A/U);let N,$,z,b,v,T,L,R,K,k,Y;for(U++,this._delta=F,I?(K=-D-2*this._stepY,k=2*this._stepY,Y=c):(K=-2*this._stepX,k=D+2*this._stepX,Y=l);r.nextPath();)if(!(r.pathSize<2)&&r.nextPoint())for(N=r.x,$=r.y;r.nextPoint();N=z,$=b){if(z=r.x,b=r.y,I){if($===b||$<K&&b<K||$>k&&b>k)continue;v=Math.min($,b),T=Math.max($,b)}else{if(N===z||N<K&&z<K||N>k&&z>k)continue;v=Math.min(N,z),T=Math.max(N,z)}for(;v<T;)L=Math.floor((v-Y)/F),g(L,N,$,z,b,M),v+=F;R=Math.floor((T-Y)/F),R>L&&g(R,N,$,z,b,M)}this._accelerationMap=M}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let r=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(r+=.5*this._stepX);const l=this._currentY*this._stepY+this._offsetY;let e,c;if(this._currentX++,this._gridType===G.Q1.Random){const d=(this._currentX%x+x)%x,M=(this._currentY%x+x)%x;e=this._graphicOriginX+r+this._stepX*this._randomness*(.5-m._randValues[M*x+d])*2/3,c=this._graphicOriginY+l+this._stepY*this._randomness*(.5-m._randValues[M*x+d+1])*2/3}else e=this._graphicOriginX+this._cosAngle*r+this._sinAngle*l,c=this._graphicOriginY-this._sinAngle*r+this._cosAngle*l;if(!this._testInsidePolygon||this._isInsidePolygon(e,c,this._geometryCursor))return this._internalPlacement.setTranslate(e,c),this._internalPlacement}}_isInsidePolygon(r,l,e){if(null==this._accelerationMap)return function f(h,r,l){let e,c,d,M,I=0;for(h+=P,r+=P,l.reset();l.nextPath();)if(l.nextPoint())for(e=l.x,c=l.y;l.nextPoint();e=d,c=M)d=l.x,M=l.y,c>r!=M>r&&((d-e)*(r-c)-(M-c)*(h-e)>0?I++:I--);return 0!==I}(r,l,e);r+=P,l+=P;const c=this._verticalSubdivision,M=Math.floor(((c?l:r)-this._polygonMin)/this._delta),I=this._accelerationMap.get(M);if(!I)return!1;let A,U,F,N=0;for(const $ of I){if(A=$[0],U=$[1],c){if(A[1]>l==U[1]>l)continue;F=(U[0]-A[0])*(l-A[1])-(U[1]-A[1])*(r-A[0])}else{if(A[0]>r==U[0]>r)continue;F=(U[1]-A[1])*(r-A[0])-(U[0]-A[0])*(l-A[1])}F>0?N++:N--}return 0!==N}}function g(h,r,l,e,c,d){let M=d.get(h);M||(M=[],d.set(h,M)),M.push([[r,l],[e,c]])}},53737:(dt,it,S)=>{S.d(it,{R:()=>B});var Z=S(61245),X=S(67311),G=S(65374);let B=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(m,f,g,h,r){return new x(m,f,g)}}return P.instance=null,P})();class x extends Z.pC{constructor(_,m,f){super(_),this._curveHelper=new X.I,this._angleToLine=void 0===m.angleToLine||m.angleToLine,this._offset=void 0!==m.offset?m.offset*f:0,this._relativeTo=m.relativeTo,this._position=void 0!==m.startPointOffset?m.startPointOffset*f:0,this._epsilon=.001*f}processPath(_){const m=this._position;if(this._relativeTo===G.ip.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),_.nextPoint()){let[g,h]=[_.x,_.y],[r,l]=[0,0];for(;_.nextPoint();){r=_.x,l=_.y;const e=this._curveHelper.getLength(g,h,r,l);if(e<this._epsilon){g=r,h=l;continue}const c=.5+this._position/e,[d,M]=this._curveHelper.getAngleCS(g,h,r,l,c),I=this._curveHelper.getCoord2D(g,h,r,l,c);return this.internalPlacement.setTranslate(I[0]-this._offset*M,I[1]+this._offset*d),this._angleToLine&&this.internalPlacement.setRotateCS(d,M),this.internalPlacement}}return this.iteratePath=!1,null}return this.onLine(_,m,this._relativeTo===G.ip.LineEnd)}onLine(_,m,f){let g,h=!1;switch(this._relativeTo){case G.ip.LineMiddle:default:_.seekPathStart(),g=_.pathLength()/2+m;break;case G.ip.LineBeginning:g=m;break;case G.ip.LineEnd:g=m,h=!0}f?_.seekPathEnd():_.seekPathStart();let r=0;if(f?_.prevPoint():_.nextPoint()){let[l,e]=[_.x,_.y],[c,d]=[0,0];for(;f?_.prevPoint():_.nextPoint();){c=_.x,d=_.y;const M=this._curveHelper.getLength(l,e,c,d);if(r+M>g){const I=(g-r)/M,[A,U]=this._curveHelper.getAngleCS(l,e,c,d,I),F=this._curveHelper.getCoord2D(l,e,c,d,I),N=h?-this._offset:this._offset;return this.internalPlacement.setTranslate(F[0]-N*U,F[1]+N*A),this._angleToLine&&(h?this.internalPlacement.setRotateCS(-A,-U):this.internalPlacement.setRotateCS(A,U)),this.internalPlacement}l=c,e=d,r+=M}}return null}}},3688:(dt,it,S)=>{S.d(it,{A:()=>D});var Z=S(61245),X=S(67311);let D=(()=>{class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(m,f,g,h,r){return new B(m,f,g)}}return P.instance=null,P})();class B extends Z.pC{constructor(_,m,f){super(_),this._curveHelper=new X.I,this._angleToLine=void 0===m.angleToLine||m.angleToLine,this._offset=void 0!==m.offset?m.offset*f:0,this._endPoints=void 0===m.placeOnEndPoints||m.placeOnEndPoints,this._controlPoints=void 0===m.placeOnControlPoints||m.placeOnControlPoints,this._regularVertices=void 0===m.placeOnRegularVertices||m.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(_){if(this.iteratePath||(this._preparePath(_),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const m=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(m[2]);let f=m[0],g=m[1];if(0!==this._offset){const h=Math.cos(m[2]),r=Math.sin(m[2]);f-=this._offset*r,g+=this._offset*h}return this.internalPlacement.setTranslate(f,g),this._tagIterator++,this.internalPlacement}_preparePath(_){this._tags.length=0,this._tagIterator=0,_.seekPathStart();const m=_.isClosed();let f=0,g=!1,h=0,r=0;if(_.seekPathStart(),_.nextPoint()){let l=_.x,e=_.y,c=_.getControlPoint(),d=!0,M=_.nextPoint();for(;M;){const I=_.x,A=_.y,U=_.getControlPoint();(this._angleToLine||0!==this._offset)&&(h=this._curveHelper.getAngle(l,e,I,A,0)),d?(d=!1,m?(f=h,g=c):(this._endPoints||this._controlPoints&&c)&&this._tags.push([l,e,h])):c?this._controlPoints&&this._tags.push([l,e,x(r,h)]):this._regularVertices&&this._tags.push([l,e,x(r,h)]),(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(l,e,I,A,1)),M=_.nextPoint(),M||(m?U||g?this._controlPoints&&this._tags.push([I,A,x(r,f)]):this._regularVertices&&this._tags.push([I,A,x(r,f)]):(this._endPoints||this._controlPoints&&U)&&this._tags.push([I,A,r])),l=I,e=A,c=U}}this._tagIterator=0}}function x(P,_){const m=Math.PI;for(;Math.abs(_-P)>m+2e-15;)_-P>m?_-=2*m:_+=2*m;return(P+_)/2}},68051:(dt,it,S)=>{S.d(it,{L:()=>x});var Z=S(83065),X=S(39239),G=S(13259),D=S(76571),B=S(65374);let x=(()=>{class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(f,g,h,r,l){return new P(f,g,h)}}return _.instance=null,_})();class P{constructor(m,f,g){this._geometryCursor=m,this._offsetX=void 0!==f.offsetX?f.offsetX*g:0,this._offsetY=void 0!==f.offsetY?f.offsetY*g:0,this._method=void 0!==f.method?f.method:B.YI.OnPolygon,this._internalPlacement=new D.W}next(){const m=this._geometryCursor;return this._geometryCursor=null,m?this._polygonCenter(m):null}_polygonCenter(m){let f=!1;switch(this._method){case B.YI.CenterOfMass:{const g=(0,X.TP)(m);g&&(this._internalPlacement.setTranslate(g[0]+this._offsetX,g[1]+this._offsetY),f=!0)}break;case B.YI.BoundingBoxCenter:{const g=(0,Z.z8)(m);g&&(this._internalPlacement.setTranslate((g[2]+g[0])/2+this._offsetX,(g[3]+g[1])/2+this._offsetY),f=!0)}break;default:{const g=(0,G.d)(m);null!==g&&(this._internalPlacement.setTranslate(g[0]+this._offsetX,g[1]+this._offsetY),f=!0)}}return f?this._internalPlacement:null}}},30365:(dt,it,S)=>{S.d(it,{Dy:()=>m,UD:()=>x,fO:()=>P,gy:()=>D,iT:()=>_,xy:()=>B});var Z=S(35150);const X=()=>Z.A.getLogger("esri.views.2d.engine.webgl.alignmentUtils");var G,D,h;function B(h){if(!h)return G.Center;switch(h){case"Left":case"left":return G.Left;case"Right":case"right":return G.Right;case"Justify":return X().warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),G.Center;case"Center":case"center":return G.Center}}function x(h){if(!h)return D.Center;switch(h){case"Top":case"top":return D.Top;case"Center":case"middle":return D.Center;case"Baseline":case"baseline":return D.Baseline;case"Bottom":case"bottom":return D.Bottom}}function P(h){switch(h){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return["right","bottom"];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return["center","bottom"];case"above-right":case"esriServerPointLabelPlacementAboveRight":return["left","bottom"];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return["right","middle"];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return["center","middle"];case"center-right":case"esriServerPointLabelPlacementCenterRight":return["left","middle"];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return["right","top"];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return["center","top"];case"below-right":case"esriServerPointLabelPlacementBelowRight":return["left","top"];default:return console.debug(`Found invalid placement type ${h}`),["center","middle"]}}function _(h){switch(h){case G.Right:case"right":return-1;case G.Center:case"center":return 0;case G.Left:case"left":return 1;default:return console.debug(`Found invalid horizontal alignment ${h}`),0}}function m(h){switch(h){case D.Top:case"top":return 1;case D.Center:case"middle":return 0;case D.Bottom:case D.Baseline:case"baseline":case"bottom":return-1;default:return console.debug(`Found invalid vertical alignment ${h}`),0}}(h=G||(G={}))[h.Left=-1]="Left",h[h.Center=0]="Center",h[h.Right=1]="Right",function(h){h[h.Top=1]="Top",h[h.Center=0]="Center",h[h.Bottom=-1]="Bottom",h[h.Baseline=2]="Baseline"}(D||(D={}))},42058:(dt,it,S)=>{S.d(it,{Tl:()=>z});var Z=S(76329),X=S(3672),G=S(83953),D=S(88532),B=S(30365),x=S(68973),P=S(21260);const _=22,m=4,f=_+m,g=_-6,h=3,r=Math.PI/180;class c{constructor(v,T,L,R){this._rotationT=(0,X.vt)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const K=L.rect,k=new Float32Array(8);v*=R,T*=R;const Y=L.code?K.width*R:L.metrics.width,tt=L.code?K.height*R:L.metrics.height;this.width=Y,this.height=tt,k[0]=v,k[1]=T,k[2]=v+Y,k[3]=T,k[4]=v,k[5]=T+tt,k[6]=v+Y,k[7]=T+tt,this._data=k,this._setTextureCoords(K),this._scale=R,this._mosaic=L,this.x=v,this.y=T,this.maxOffset=Math.max(v+Y,T+tt)}get mosaic(){return this._mosaic}set angle(v){this._angle=v,(0,Z.$0)(this._rotationT,-v),this._setOffsets()}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:v,width:T}=this._mosaic.metrics,L=T*this._scale,R=Math.abs(v)*this._scale,K=new Float32Array(8);K[0]=this.x,K[1]=this.y,K[2]=this.x+L,K[3]=this.y,K[4]=this.x,K[5]=this.y+R,K[6]=this.x+L,K[7]=this.y+R;const k=(0,Z.lw)((0,X.vt)(),this._rotationT,this._transform);(0,X.gb)(K,K,k);let Y=1/0,tt=1/0,ot=0,q=0;for(let at=0;at<4;at++){const ft=K[2*at],Pt=K[2*at+1];Y=Math.min(Y,ft),tt=Math.min(tt,Pt),ot=Math.max(ot,ft),q=Math.max(q,Pt)}const lt=ot-Y,rt=q-tt;this._bounds=new P.A(Y+lt/2,tt+rt/2,lt,rt)}return this._bounds}setTransform(v){this._transform=v,this._offsets=null}_setOffsets(){this._offsets||(this._offsets={topLeft:[0,0],topRight:[0,0],bottomLeft:[0,0],bottomRight:[0,0]});const v=(0,Z.lw)((0,X.vt)(),this._rotationT,this._transform);this._offsets.topLeft[0]=this._data[0],this._offsets.topLeft[1]=this._data[1],this._offsets.topRight[0]=this._data[2],this._offsets.topRight[1]=this._data[3],this._offsets.bottomLeft[0]=this._data[4],this._offsets.bottomLeft[1]=this._data[5],this._offsets.bottomRight[0]=this._data[6],this._offsets.bottomRight[1]=this._data[7],(0,G.l0)(this._offsets.topLeft,this._offsets.topLeft,v),(0,G.l0)(this._offsets.topRight,this._offsets.topRight,v),(0,G.l0)(this._offsets.bottomLeft,this._offsets.bottomLeft,v),(0,G.l0)(this._offsets.bottomRight,this._offsets.bottomRight,v)}_setTextureCoords({x:v,y:T,width:L,height:R}){this._texcoords={topLeft:[v,T],topRight:[v+L,T],bottomLeft:[v,T+R],bottomRight:[v+L,T+R]}}}const d=(b,v)=>({code:0,page:0,sdf:!0,rect:new x.A(0,0,11,8),textureBinding:v,metrics:{advance:0,height:4,width:b,left:0,top:0}});function M(b,v){return b.forEach(T=>(0,G.l0)(T,T,v)),{topLeft:b[0],topRight:b[1],bottomLeft:b[2],bottomRight:b[3]}}class I{constructor(v,T,L){this._rotation=0,this._decorate(v,T,L),this.glyphs=v,this.bounds=this._createBounds(v),this.isMultiline=T.length>1,this._hasRotation=0!==L.angle,this._transform=this._createGlyphTransform(this.bounds,L),this._borderLineSizePx=L.borderLineSizePx,(L.borderLineSizePx||L.hasBackground)&&([this.bounds,this.textBox]=this.shapeBackground(this._transform));for(const R of v)R.setTransform(this._transform)}setRotation(v){if(0===v&&0===this._rotation)return;this._rotation=v;const T=this._transform,L=(0,Z.$0)((0,X.vt)(),v);(0,Z.lw)(T,L,T);for(const R of this.glyphs)R.setTransform(this._transform)}_decorate(v,T,L){if(!L.decoration||"none"===L.decoration||!v.length)return;const R=L.scale,K="underline"===L.decoration?f:g,k=v[0].textureBinding;for(const Y of T)v.push(new c(Y.startX*R,Y.startY*R+K*R,d((Y.width+Y.glyphWidthEnd)*R,k),1))}shapeBackground(v){const L=(1.5+(this._borderLineSizePx||0))/2,R=this._borderLineSizePx?L:0,{xmin:K,ymin:k,xmax:Y,ymax:tt,x:ot,y:q,width:lt,height:rt}=this.bounds,ct=[K-8,k-8],ut=[Y+8,k-8],at=[K-8,tt+8],ft=[Y+8,tt+8],Pt=M([[ct[0]-L,ct[1]-L],[ut[0]+L,ut[1]-L],[ct[0]+R,ct[1]+R],[ut[0]-R,ut[1]+R]],v),mt=M([[at[0]+R,at[1]-R],[ft[0]-R,ft[1]-R],[at[0]-L,at[1]+L],[ft[0]+L,ft[1]+L]],v),pt=M([[ct[0]-L,ct[1]-L],[ct[0]+R,ct[1]+R],[at[0]-L,at[1]+L],[at[0]+R,at[1]-R]],v),yt=M([[ut[0]-R,ut[1]+R],[ut[0]+L,ut[1]-L],[ft[0]-R,ft[1]-R],[ft[0]+L,ft[1]+L]],v),J={main:M([ct,ut,at,ft],v),top:Pt,bot:mt,left:pt,right:yt};return[new P.A(ot,q,lt+2*L,rt+2*L),J]}get boundsT(){const v=this.bounds,T=(0,G.hZ)((0,D.vt)(),v.x,v.y);if((0,G.l0)(T,T,this._transform),this._hasRotation){const L=Math.max(v.width,v.height);return new P.A(T[0],T[1],L,L)}return new P.A(T[0],T[1],v.width,v.height)}_createBounds(v){let T=1/0,L=1/0,R=0,K=0;for(const tt of v)T=Math.min(T,tt.xTopLeft),L=Math.min(L,tt.yTopLeft),R=Math.max(R,tt.xBottomRight),K=Math.max(K,tt.yBottomRight);const k=R-T,Y=K-L;return new P.A(T+k/2,L+Y/2,k,Y)}_createGlyphTransform(v,T){const L=r*T.angle,R=(0,X.vt)(),K=(0,D.vt)();return(0,Z.Tl)(R,R,(0,G.hZ)(K,T.xOffset,-T.yOffset)),T.useCIMAngleBehavior?(0,Z.e$)(R,R,L):((0,Z.Tl)(R,R,(0,G.hZ)(K,v.x,v.y)),(0,Z.e$)(R,R,L),(0,Z.Tl)(R,R,(0,G.hZ)(K,-v.x,-v.y))),R}}class A{constructor(v,T,L,R,K,k){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(T,L)),this.end=Math.max(0,Math.max(T,L)),this.end<v.length&&(this.glyphWidthEnd=v[this.end].metrics.width),this.width=R,this.yMin=K,this.yMax=k}}const U=b=>10===b,F=b=>32===b;function z(b,v){const T=v.scale,L=new Array,{glyphs:R,isRightToLeft:K}=b,k=function N(b,v,T){const L=new Array,K=T.maxLineWidth*(1/T.scale),k=v?b.length-1:0,Y=v?-1:b.length,tt=v?-1:1;let ot=k,q=0,lt=0,rt=ot,ct=rt,ut=0,at=1/0,ft=0;for(;ot!==Y;){const{code:mt,metrics:pt}=b[ot],yt=Math.abs(pt.top);U(mt)||F(mt)||(at=Math.min(at,yt),ft=Math.max(ft,yt+pt.height)),U(mt)?(ot!==k&&(L.push(new A(b,rt,ot-tt,q,at,ft)),at=1/0,ft=0),q=0,rt=ot+tt,ct=ot+tt,lt=0):F(mt)?(ct=ot+tt,lt=0,ut=pt.advance,q+=pt.advance):q>K?(ct!==rt?(q-=ut,L.push(new A(b,rt,ct-2*tt,q-lt,at,ft)),at=1/0,ft=0,rt=ct,q=lt):(L.push(new A(b,rt,ot-tt,q,at,ft)),at=1/0,ft=0,rt=ot,ct=ot,q=0),q+=pt.advance,lt+=pt.advance):(q+=pt.advance,lt+=pt.advance),ot+=tt}const Pt=new A(b,rt,ot-tt,q,at,ft);return Pt.start>=0&&Pt.end<b.length&&L.push(Pt),L}(R,K,v),Y=k.length?function $(b,v){let T=0;for(let K=0;K<b.length;K++){const{width:k}=b[K];T=Math.max(k,T)}const R=b[0].yMin;return{x:0,y:R,height:b[b.length-1].yMax+v.lineHeight*(b.length-1)+("underline"===v.decoration?m:0)-R,width:T}}(k,v):{x:0,y:0,height:0,width:0},tt=(0,B.xy)(v.horizontalAlignment),ot=(0,B.UD)(v.verticalAlignment),q=ot===B.gy.Baseline?1:0,rt=(1-q)*-Y.y+Y.height/2*(q?0:ot-1)+(q?1:0)*-_;for(let ct=0;ct<k.length;ct++){const{start:ut,end:at,width:ft}=k[ct];let Pt=-1*(tt+1)*(ft/2)-h;const mt=ct*v.lineHeight+rt-h;k[ct].startX=Pt,k[ct].startY=mt;for(let pt=ut;pt<=at;pt++){const yt=R[pt];if(U(yt.code))continue;const J=new c(Pt+yt.metrics.left,mt-yt.metrics.top,yt,T);Pt+=yt.metrics.advance,L.push(J)}}return new I(L,k,v)}},36741:(dt,it,S)=>{S.d(it,{DF:()=>g,Lu:()=>r,RA:()=>P,hV:()=>h});var Z=S(67685),X=S(55861),B=(S(51995),S(58701),S(47669));const P=50;function g(l){if(!l)return null;const{xmin:e,ymin:c,xmax:d,ymax:M,spatialReference:I}=l;return new X.A({rings:[[[e,c],[e,M],[d,M],[d,c],[e,c]]],spatialReference:I})}function h(l){return(0,Z.PN)(Math.round((0,Z.Lz)(l)))}function r(l){const e=(0,Z.PN)(B.GR),c=(0,Z.PN)(B.cp);return Math.max(e,Math.min(l||c,c))}}}]);