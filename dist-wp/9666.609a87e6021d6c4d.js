"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[9666],{69666:(se,W,D)=>{D.r(W),D.d(W,{registerFunctions:()=>Te});var C=D(10467),K=D(61299),R=D(45369),P=D(53787),l=D(55279),le=D(63145),v=D(2044),oe=D(42970),t=D(42686),ue=D(32832),T=D(36455),j=D(888),fe=D(93571),ce=D(53437),de=D(62138),me=D(6491),ye=D(58314),X=D(7981),J=D(97089),Z=D(59118),_e=D(56492),F=D(40013),B=D(35940),N=D(29141),Y=D(73874);function H(s,n,i){return z.apply(this,arguments)}function z(){return(z=(0,C.A)(function*(s,n,i){const _=s.getVariables();if(_.length>0){const h=[];for(let e=0;e<_.length;e++){const a={name:_[e]};h.push(yield n.evaluateIdentifier(i,a))}const f={};for(let e=0;e<_.length;e++)f[_[e]]=h[e];return s.parameters=f,s}return s})).apply(this,arguments)}function m(s,n,i=null){for(const _ in s)if(_.toLowerCase()===n.toLowerCase())return s[_];return i}function q(s){if(null===s)return null;const n={type:m(s,"type",""),name:m(s,"name","")};if("range"===n.type)n.range=m(s,"range",[]);else{n.codedValues=[];for(const i of m(s,"codedValues",[]))n.codedValues.push({name:m(i,"name",""),code:m(i,"code",null)})}return n}function G(s){if(null===s)return null;const n={},i=m(s,"wkt");null!==i&&(n.wkt=i);const _=m(s,"wkid");return null!==_&&(n.wkid=_),n}function ee(s){if(null===s)return null;const n={hasZ:m(s,"hasz",!1),hasM:m(s,"hasm",!1)},i=m(s,"spatialreference");null!=i&&(n.spatialReference=G(i));const _=m(s,"x",null);if(null!==_)return n.x=_,n.y=m(s,"y",null),n.hasZ&&(n.z=m(s,"z",null)),n.hasM&&(n.m=m(s,"m",null)),n;const h=m(s,"rings",null);if(null!==h)return n.rings=h,n;const f=m(s,"paths",null);if(null!==f)return n.paths=f,n;const e=m(s,"points",null);if(null!==e)return n.points=e,n;for(const a of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const o=m(s,a,null);null!==o&&(n[a]=o)}return n}function S(s){return"utc"===s?.toLowerCase()?"UTC":"unknown"===s?.toLowerCase()?"Unknown":s}function Te(s){"async"===s.mode&&(s.functions.timezone=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,1,2,n,i),(0,t.n)(e[0])||(0,t.m)(e[0]))return"Unknown";if((0,t.u)(e[0])){if(yield e[0].load(),1===e.length||null===e[1])return S(e[0].datesInUnknownTimezone?"unknown":e[0].dateFieldsTimeZone);if(!(e[1]instanceof P.A)||!1===e[1].hasField("type"))throw new l.D$(n,l.TX.InvalidParameter,i);const y=e[1].field("type");if(!1===(0,t.c)(y))throw new l.D$(n,l.TX.InvalidParameter,i);switch((0,t.j)(y).toLowerCase()){case"preferredtimezone":return S(e[0].preferredTimeZone);case"editfieldsinfo":return S(e[0].editFieldsInfo?.timeZone??null);case"timeinfo":return S(e[0].timeInfo?.timeZone??null);case"field":if(e[1].hasField("fieldname")&&(0,t.c)(e[1].field("fieldname")))return S(e[0].fieldTimeZone((0,t.j)(e[1].field("fieldname"))))}throw new l.D$(n,l.TX.InvalidParameter,i)}const a=(0,t.l)(e[0],(0,t.N)(n));if(null===a)return null;const o=a.timeZone;return"system"===o?K.lY.systemTimeZoneCanonicalName:"utc"===o.toLowerCase()?"UTC":"unknown"===o.toLowerCase()?"Unknown":o});return function(h,f,e){return _.apply(this,arguments)}}())},s.functions.sqltimestamp=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){(0,t.H)(e,1,3,n,i);const a=e[0];if((0,t.k)(a)){if(1===e.length)return a.toSQLWithKeyword();if(2===e.length)return a.changeTimeZone((0,t.j)(e[1])).toSQLWithKeyword();throw new l.D$(n,l.TX.InvalidParameter,i)}if((0,t.m)(a))return a.toSQLWithKeyword();if((0,t.u)(a)){if(3!==e.length)throw new l.D$(n,l.TX.InvalidParameter,i);yield a.load();const o=(0,t.j)(e[1]);if((0,t.m)(e[2]))return e[2].toSQLWithKeyword();if(!1===(0,t.k)(e[2]))throw new l.D$(n,l.TX.InvalidParameter,i);const y=a.fieldTimeZone(o);return null===y?e[2].toSQLWithKeyword():e[2].changeTimeZone(y).toSQLWithKeyword()}throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"sqltimestamp",min:2,max:4}),s.functions.featuresetbyid=function(n,i){return s.standardFunctionAsync(n,i,(_,h,f)=>{if((0,t.H)(f,2,4,n,i),(0,t.s)(f[0])){const e=(0,t.j)(f[1]);let a=(0,t.K)(f[2],null);const o=(0,t.h)((0,t.K)(f[3],!0));if(null===a&&(a=["*"]),!1===(0,t.o)(a))throw new l.D$(n,l.TX.InvalidParameter,i);return f[0].featureSetById(e,o,a)}throw new l.D$(n,l.TX.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyid",min:2,max:4}),s.functions.getfeatureset=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,1,2,n,i),(0,t.r)(e[0])){let a=(0,t.K)(e[1],"datasource");return null===a&&(a="datasource"),a=(0,t.j)(a).toLowerCase(),(0,v.convertToFeatureSet)(e[0].fullSchema(),a,n.lrucache,n.interceptor,n.spatialReference??null)}throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"getfeatureset",min:1,max:2}),s.functions.featuresetbyportalitem=function(n,i){return s.standardFunctionAsync(n,i,(_,h,f)=>{if((0,t.H)(f,2,5,n,i),null===f[0])throw new l.D$(n,l.TX.PortalRequired,i);if(f[0]instanceof R.A){const p=(0,t.j)(f[1]),d=(0,t.j)(f[2]);let r=(0,t.K)(f[3],null);const u=(0,t.h)((0,t.K)(f[4],!0));if(null===r&&(r=["*"]),!1===(0,t.o)(r))throw new l.D$(n,l.TX.InvalidParameter,i);let c;return c=n.services?.portal?n.services.portal:Y.A.getDefault(),c=(0,ue.R)(f[0],c),(0,v.constructFeatureSetFromPortalItem)(p,d,n.spatialReference??null,r,u,c,n.lrucache,n.interceptor)}if(!1===(0,t.c)(f[0]))throw new l.D$(n,l.TX.PortalRequired,i);const e=(0,t.j)(f[0]),a=(0,t.j)(f[1]);let o=(0,t.K)(f[2],null);const y=(0,t.h)((0,t.K)(f[3],!0));if(null===o&&(o=["*"]),!1===(0,t.o)(o))throw new l.D$(n,l.TX.InvalidParameter,i);return(0,v.constructFeatureSetFromPortalItem)(e,a,n.spatialReference??null,o,y,n.services?.portal??Y.A.getDefault(),n.lrucache,n.interceptor)})},s.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),s.functions.featuresetbyname=function(n,i){return s.standardFunctionAsync(n,i,(_,h,f)=>{if((0,t.H)(f,2,4,n,i),(0,t.s)(f[0])){const e=(0,t.j)(f[1]);let a=(0,t.K)(f[2],null);const o=(0,t.h)((0,t.K)(f[3],!0));if(null===a&&(a=["*"]),!1===(0,t.o)(a))throw new l.D$(n,l.TX.InvalidParameter,i);return f[0].featureSetByName(e,o,a)}throw new l.D$(n,l.TX.InvalidParameter,i)})},s.signatures.push({name:"featuresetbyname",min:2,max:4}),s.functions.featureset=function(n,i){return s.standardFunction(n,i,(_,h,f)=>{(0,t.H)(f,1,1,n,i);const e={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",hasM:!1,hasZ:!1,fields:[]},featureSet:{geometryType:"",features:[]}};if((0,t.c)(f[0])){const a=JSON.parse(f[0]);void 0!==a.layerDefinition?(e.layerDefinition=a.layerDefinition,e.featureSet=a.featureSet,a.layerDefinition.spatialReference&&(e.layerDefinition.spatialReference=a.layerDefinition.spatialReference)):(e.featureSet.features=a.features,e.featureSet.geometryType=a.geometryType,e.layerDefinition.geometryType=e.featureSet.geometryType,e.layerDefinition.objectIdField=a.objectIdFieldName??"",e.layerDefinition.typeIdField=a.typeIdFieldName,e.layerDefinition.globalIdField=a.globalIdFieldName,e.layerDefinition.fields=a.fields,a.spatialReference&&(e.layerDefinition.spatialReference=a.spatialReference))}else{if(!(f[0]instanceof P.A))throw new l.D$(n,l.TX.InvalidParameter,i);{const a=JSON.parse(f[0].castToText(!0)),o=m(a,"layerdefinition");if(null!==o){e.layerDefinition.geometryType=m(o,"geometrytype",""),e.featureSet.geometryType=e.layerDefinition.geometryType,e.layerDefinition.globalIdField=m(o,"globalidfield",""),e.layerDefinition.objectIdField=m(o,"objectidfield",""),e.layerDefinition.typeIdField=m(o,"typeidfield",""),e.layerDefinition.hasZ=!0===m(o,"hasz",!1),e.layerDefinition.hasM=!0===m(o,"hasm",!1);const y=m(o,"spatialreference");y&&(e.layerDefinition.spatialReference=G(y));const p=[];for(const r of m(o,"fields",[])){const u={name:m(r,"name",""),alias:m(r,"alias",""),type:m(r,"type",""),nullable:m(r,"nullable",!0),editable:m(r,"editable",!0),length:m(r,"length",null),domain:q(m(r,"domain"))};p.push(u)}e.layerDefinition.fields=p;const d=m(a,"featureset");if(d){const r={};for(const u of p)r[u.name.toLowerCase()]=u.name;for(const u of m(d,"features",[])){const c={},w=m(u,"attributes",{});for(const A in w)c[r[A.toLowerCase()]]=w[A];e.featureSet.features.push({attributes:c,geometry:ee(m(u,"geometry"))})}}}else{e.layerDefinition.hasZ=!0===m(a,"hasz",!1),e.layerDefinition.hasM=!0===m(a,"hasm",!1),e.layerDefinition.geometryType=m(a,"geometrytype",""),e.featureSet.geometryType=e.layerDefinition.geometryType,e.layerDefinition.objectIdField=m(a,"objectidfieldname",""),e.layerDefinition.typeIdField=m(a,"typeidfieldname","");const y=m(a,"spatialreference");y&&(e.layerDefinition.spatialReference=G(y));const p=[],d=m(a,"fields",null);if(!(0,t.o)(d))throw new l.D$(n,l.TX.InvalidParameter,i);for(const c of d){const w={name:m(c,"name",""),alias:m(c,"alias",""),type:m(c,"type",""),nullable:m(c,"nullable",!0),editable:m(c,"editable",!0),length:m(c,"length",null),domain:q(m(c,"domain"))};p.push(w)}e.layerDefinition.fields=p;const r={};for(const c of p)r[c.name.toLowerCase()]=c.name;let u=m(a,"features",null);if((0,t.o)(u))for(const c of u){const w={},A=m(c,"attributes",{});for(const E in A)w[r[E.toLowerCase()]]=A[E];e.featureSet.features.push({attributes:w,geometry:ee(m(c,"geometry",null))})}else u=null,e.featureSet.features=u}}}if(!1===function De(s){return!!s.layerDefinition&&!!s.featureSet&&!1!==function pe(s,n){for(const i of n)if(i===s)return!0;return!1}(s.layerDefinition.geometryType,["",null,"esriGeometryNull","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&!1!==(0,t.o)(s.layerDefinition.fields)&&!1!==(0,t.o)(s.featureSet.features)}(e))throw new l.D$(n,l.TX.InvalidParameter,i);return e.layerDefinition.geometryType||(e.layerDefinition.geometryType="esriGeometryNull"),me.A.create(e,n.spatialReference)})},s.signatures.push({name:"featureset",min:1,max:1}),s.functions.filter=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,i),(0,t.o)(e[0])||(0,t.q)(e[0])){const a=[];let o,y=e[0];if(y instanceof oe.A&&(y=y.toArray()),!(0,t.i)(e[1]))throw new l.D$(n,l.TX.InvalidParameter,i);o=e[1].createFunction(n);for(const p of y){const d=o(p);(0,_e.$X)(d)?!0===(yield d)&&a.push(p):!0===d&&a.push(p)}return a}if((0,t.u)(e[0])){const a=yield e[0].load(),o=F.WhereClause.create(e[1],a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC),y=o.getVariables();if(y.length>0){const p=[];for(let r=0;r<y.length;r++){const u={name:y[r]};p.push(yield s.evaluateIdentifier(n,u))}const d={};for(let r=0;r<y.length;r++)d[y[r]]=p[r];return o.parameters=d,new j.A({parentfeatureset:e[0],whereclause:o})}return new j.A({parentfeatureset:e[0],whereclause:o})}throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"filter",min:2,max:2}),s.functions.orderby=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,i),(0,t.u)(e[0])){const a=new ye.A(e[1]);return new fe.A({parentfeatureset:e[0],orderbyclause:a})}throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"orderby",min:2,max:2}),s.functions.top=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,i),(0,t.u)(e[0]))return new ce.A({parentfeatureset:e[0],topnum:e[1]});if((0,t.o)(e[0]))return(0,t.g)(e[1])>=e[0].length?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));if((0,t.q)(e[0]))return(0,t.g)(e[1])>=e[0].length()?e[0].slice(0):e[0].slice(0,(0,t.g)(e[1]));throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"top",min:2,max:2}),s.functions.first=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,1,1,n,i),(0,t.u)(e[0])){const a=yield e[0].first(h.abortSignal);if(null!==a){const o=le.A.createFromGraphicLikeObject(a.geometry,a.attributes,e[0],n.timeZone);return o._underlyingGraphic=a,o}return a}return(0,t.o)(e[0])?0===e[0].length?null:e[0][0]:(0,t.q)(e[0])?0===e[0].length()?null:e[0].get(0):null});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"first",min:1,max:1}),s.functions.attachments=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){(0,t.H)(e,1,2,n,i);const a={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(e.length>1)if(e[1]instanceof P.A){if(e[1].hasField("minsize")&&(a.minsize=(0,t.g)(e[1].field("minsize"))),e[1].hasField("metadata")&&(a.returnMetadata=(0,t.h)(e[1].field("metadata"))),e[1].hasField("maxsize")&&(a.maxsize=(0,t.g)(e[1].field("maxsize"))),e[1].hasField("types")){const o=(0,t.a1)(e[1].field("types"),!1);o.length>0&&(a.types=o)}}else if(null!==e[1])throw new l.D$(n,l.TX.InvalidParameter,i);if((0,t.r)(e[0])){let o=e[0]._layer;return o instanceof B.default&&(o=(0,v.constructFeatureSet)(o,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===o||!1===(0,t.u)(o)?[]:(yield o.load(),o.queryAttachments(e[0].field(o.objectIdField),a.minsize,a.maxsize,a.types,a.returnMetadata))}if(null===e[0])return[];throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"attachments",min:1,max:2}),s.functions.featuresetbyrelationshipname=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){(0,t.H)(e,2,4,n,i);const a=e[0],o=(0,t.j)(e[1]);let y=(0,t.K)(e[2],null);const p=(0,t.h)((0,t.K)(e[3],!0));if(null===y&&(y=["*"]),!1===(0,t.o)(y))throw new l.D$(n,l.TX.InvalidParameter,i);if(null===e[0])return null;if(!(0,t.r)(e[0]))throw new l.D$(n,l.TX.InvalidParameter,i);let d=a._layer;if(d instanceof B.default&&(d=(0,v.constructFeatureSet)(d,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===d||!1===(0,t.u)(d))return null;d=yield d.load();const r=d.relationshipMetaData().filter(E=>E.name===o);if(0===r.length)return null;if(null!=r[0].relationshipTableId&&r[0].relationshipTableId>-1)return(0,v.constructFeatureSetFromRelationship)(d,r[0],a.field(d.objectIdField),d.spatialReference,y,p,n.lrucache,n.interceptor);let u=d.serviceUrl();if(!u)return null;u="/"===u.charAt(u.length-1)?u+r[0].relatedTableId.toString():u+"/"+r[0].relatedTableId.toString();const c=yield(0,v.constructFeatureSetFromUrl)(u,d.spatialReference,y,p,n.lrucache,n.interceptor);yield c.load();let w=c.relationshipMetaData();if(w=w.filter(E=>E.id===r[0].id),!1===a.hasField(r[0].keyField)||null===a.field(r[0].keyField)){const E=yield d.getFeatureByObjectId(a.field(d.objectIdField),[r[0].keyField]);if(E){const x=F.WhereClause.create(w[0].keyField+"= @id",c.getFieldsIndex(),c.dateFieldsTimeZoneDefaultUTC);return x.parameters={id:E.attributes[r[0].keyField]},c.filter(x)}return new de.A({parentfeatureset:c})}const A=F.WhereClause.create(w[0].keyField+"= @id",c.getFieldsIndex(),c.dateFieldsTimeZoneDefaultUTC);return A.parameters={id:a.field(r[0].keyField)},c.filter(A)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),s.functions.featuresetbyassociation=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){(0,t.H)(e,2,3,n,i);const a=e[0],o=(0,t.j)((0,t.K)(e[1],"")).toLowerCase(),y=(0,t.c)(e[2])?(0,t.j)(e[2]):null;if(null===e[0])return null;if(!(0,t.r)(e[0]))throw new l.D$(n,l.TX.InvalidParameter,i);let p=a._layer;if(p instanceof B.default&&(p=(0,v.constructFeatureSet)(p,n.spatialReference,["*"],!0,n.lrucache,n.interceptor)),null===p||!1===(0,t.u)(p))return null;yield p.load();const d=p.serviceUrl(),r=yield(0,v.constructAssociationMetaDataFeatureSetFromUrl)(d,n.spatialReference);let u=null,c=null,w=!1;if(null!==y&&""!==y&&void 0!==y){for(const I of r.terminals)I.terminalName===y&&(c=I.terminalId);null===c&&(w=!0)}const A=r.associations.getFieldsIndex(),E=A.get("TOGLOBALID").name,x=A.get("FROMGLOBALID").name,k=A.get("TOTERMINALID").name,V=A.get("FROMTERMINALID").name,b=A.get("FROMNETWORKSOURCEID").name,U=A.get("TONETWORKSOURCEID").name,O=A.get("ASSOCIATIONTYPE").name,ge=A.get("ISCONTENTVISIBLE").name,Ie=A.get("OBJECTID").name;for(const I of p.fields)if("global-id"===I.type){u=a.field(I.name);break}let L=null,ne=new T.Gr(new N.A({name:"percentalong",alias:"percentalong",type:"double"}),F.WhereClause.create("0",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),te=new T.Gr(new N.A({name:"side",alias:"side",type:"string"}),F.WhereClause.create("''",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));const $="globalid",ae="globalId",re={};for(const I in r.lkp)re[I]=r.lkp[I].sourceId;const M=new T.bV(new N.A({name:"classname",alias:"classname",type:"string"}),null,re);let g="";switch(o){case"midspan":{g=`((${E}='${u}') OR ( ${x}='${u}')) AND (${O} IN (5))`,M.codefield=F.WhereClause.create(`CASE WHEN (${E}='${u}') THEN ${b} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const I=(0,X.ke)(T.a.findField(r.associations.fields,x));I.name=$,I.alias=$,L=new T.Gr(I,F.WhereClause.create(`CASE WHEN (${x}='${u}') THEN ${E} ELSE ${x} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),ne=r.unVersion>=4?new T.IO(T.a.findField(r.associations.fields,A.get("PERCENTALONG").name)):new T.Gr(new N.A({name:"percentalong",alias:"percentalong",type:"double"}),F.WhereClause.create("0",r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"junctionedge":{g=`((${E}='${u}') OR ( ${x}='${u}')) AND (${O} IN (4,6))`,M.codefield=F.WhereClause.create(`CASE WHEN (${E}='${u}') THEN ${b} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const I=(0,X.ke)(T.a.findField(r.associations.fields,x));I.name=$,I.alias=$,L=new T.Gr(I,F.WhereClause.create(`CASE WHEN (${x}='${u}') THEN ${E} ELSE ${x} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC)),te=new T.Gr(new N.A({name:"side",alias:"side",type:"string"}),F.WhereClause.create(`CASE WHEN (${O}=4) THEN 'from' ELSE 'to' END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"connected":{let I=`${E}='@T'`,ie=`${x}='@T'`;null!==c&&(I+=` AND ${k}=@A`,ie+=` AND ${V}=@A`),g="(("+I+") OR ("+ie+"))",g=(0,t.T)(g,"@T",u??""),I=(0,t.T)(I,"@T",u??""),null!==c&&(I=(0,t.T)(I,"@A",c.toString()),g=(0,t.T)(g,"@A",c.toString())),M.codefield=F.WhereClause.create("CASE WHEN "+I+` THEN ${b} ELSE ${U} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC);const Q=(0,X.ke)(T.a.findField(r.associations.fields,x));Q.name=$,Q.alias=$,L=new T.Gr(Q,F.WhereClause.create("CASE WHEN "+I+` THEN ${x} ELSE ${E} END`,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC));break}case"container":g=`${E}='${u}' AND ${O} = 2`,null!==c&&(g+=` AND ${k} = `+c.toString()),M.codefield=b,g="( "+g+" )",L=new T.p8(T.a.findField(r.associations.fields,x),$,$);break;case"content":g=`(${x}='${u}' AND ${O} = 2)`,null!==c&&(g+=` AND ${V} = `+c.toString()),M.codefield=U,g="( "+g+" )",L=new T.p8(T.a.findField(r.associations.fields,E),$,$);break;case"structure":g=`(${E}='${u}' AND ${O} = 3)`,null!==c&&(g+=` AND ${k} = `+c.toString()),M.codefield=b,g="( "+g+" )",L=new T.p8(T.a.findField(r.associations.fields,x),$,ae);break;case"attached":g=`(${x}='${u}' AND ${O} = 3)`,null!==c&&(g+=` AND ${V} = `+c.toString()),M.codefield=U,g="( "+g+" )",L=new T.p8(T.a.findField(r.associations.fields,E),$,ae);break;default:throw new l.D$(n,l.TX.InvalidParameter,i)}return w&&(g="1 <> 1"),new T.a({parentfeatureset:r.associations,adaptedFields:[new T.IO(T.a.findField(r.associations.fields,Ie)),new T.IO(T.a.findField(r.associations.fields,ge)),L,te,M,ne],extraFilter:g?F.WhereClause.create(g,r.associations.getFieldsIndex(),r.associations.dateFieldsTimeZoneDefaultUTC):null})});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"featuresetbyassociation",min:2,max:6}),s.functions.groupby=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,3,3,n,i),!(0,t.u)(e[0]))throw new l.D$(n,l.TX.InvalidParameter,i);const a=yield e[0].load(),o=[],y=[];let p=!1,d=[];if((0,t.c)(e[1]))d.push(e[1]);else if(e[1]instanceof P.A)d.push(e[1]);else if((0,t.o)(e[1]))d=e[1];else{if(!(0,t.q)(e[1]))throw new l.D$(n,l.TX.InvalidParameter,i);d=e[1].toArray()}for(const r of d)if((0,t.c)(r)){const u=F.WhereClause.create((0,t.j)(r),a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC),c=!0===(0,J.DA)(u)?(0,t.j)(r):"%%%%FIELDNAME";o.push({name:c,expression:u}),"%%%%FIELDNAME"===c&&(p=!0)}else{if(!(r instanceof P.A))throw new l.D$(n,l.TX.InvalidParameter,i);{const u=r.hasField("name")?r.field("name"):"%%%%FIELDNAME",c=r.hasField("expression")?r.field("expression"):"";if("%%%%FIELDNAME"===u&&(p=!0),!u)throw new l.D$(n,l.TX.InvalidParameter,i);o.push({name:u,expression:F.WhereClause.create(c||u,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC)})}}if(d=[],(0,t.c)(e[2]))d.push(e[2]);else if((0,t.o)(e[2]))d=e[2];else if((0,t.q)(e[2]))d=e[2].toArray();else{if(!(e[2]instanceof P.A))throw new l.D$(n,l.TX.InvalidParameter,i);d.push(e[2])}for(const r of d){if(!(r instanceof P.A))throw new l.D$(n,l.TX.InvalidParameter,i);{const u=r.hasField("name")?r.field("name"):"",c=r.hasField("statistic")?r.field("statistic"):"",w=r.hasField("expression")?r.field("expression"):"";if(!u||!c||!w)throw new l.D$(n,l.TX.InvalidParameter,i);y.push({name:u,statistic:c.toLowerCase(),expression:F.WhereClause.create(w,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC)})}}if(p){const r={};for(const c of a.fields)r[c.name.toLowerCase()]=1;for(const c of o)"%%%%FIELDNAME"!==c.name&&(r[c.name.toLowerCase()]=1);for(const c of y)"%%%%FIELDNAME"!==c.name&&(r[c.name.toLowerCase()]=1);let u=0;for(const c of o)if("%%%%FIELDNAME"===c.name){for(;1===r["field_"+u.toString()];)u++;r["field_"+u.toString()]=1,c.name="FIELD_"+u.toString()}}for(const r of o)yield H(r.expression,s,n);for(const r of y)yield H(r.expression,s,n);return e[0].groupby(o,y)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"groupby",min:3,max:3}),s.functions.distinct=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.u)(e[0])){(0,t.H)(e,2,2,n,i);const a=yield e[0].load(),o=[];let y=[];if((0,t.c)(e[1]))y.push(e[1]);else if(e[1]instanceof P.A)y.push(e[1]);else if((0,t.o)(e[1]))y=e[1];else{if(!(0,t.q)(e[1]))throw new l.D$(n,l.TX.InvalidParameter,i);y=e[1].toArray()}let p=!1;for(const d of y)if((0,t.c)(d)){const r=F.WhereClause.create((0,t.j)(d),a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC),u=!0===(0,J.DA)(r)?(0,t.j)(d):"%%%%FIELDNAME";o.push({name:u,expression:r}),"%%%%FIELDNAME"===u&&(p=!0)}else{if(!(d instanceof P.A))throw new l.D$(n,l.TX.InvalidParameter,i);{const r=d.hasField("name")?d.field("name"):"%%%%FIELDNAME",u=d.hasField("expression")?d.field("expression"):"";if("%%%%FIELDNAME"===r&&(p=!0),!r)throw new l.D$(n,l.TX.InvalidParameter,i);o.push({name:r,expression:F.WhereClause.create(u||r,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC)})}}if(p){const d={};for(const u of a.fields)d[u.name.toLowerCase()]=1;for(const u of o)"%%%%FIELDNAME"!==u.name&&(d[u.name.toLowerCase()]=1);let r=0;for(const u of o)if("%%%%FIELDNAME"===u.name){for(;1===d["field_"+r.toString()];)r++;d["field_"+r.toString()]=1,u.name="FIELD_"+r.toString()}}for(const d of o)yield H(d.expression,s,n);return e[0].groupby(o,[])}return function he(s){if(1===s.length){if((0,t.o)(s[0]))return(0,Z.t)("distinct",s[0],-1);if((0,t.q)(s[0]))return(0,Z.t)("distinct",s[0].toArray(),-1)}return(0,Z.t)("distinct",s,-1)}(e)});return function(h,f,e){return _.apply(this,arguments)}}())},s.functions.getfeaturesetinfo=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,1,1,n,i),!(0,t.u)(e[0]))return null;const a=yield e[0].getFeatureSetInfo();return a?P.A.convertObjectToArcadeDictionary({layerId:a.layerId,layerName:a.layerName,itemId:a.itemId,serviceLayerUrl:a.serviceLayerUrl,webMapLayerId:a.webMapLayerId??null,webMapLayerTitle:a.webMapLayerTitle??null,className:null,objectClassId:null},(0,t.N)(n),!1,!1):null});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"getfeaturesetinfo",min:1,max:1}),s.functions.filterbysubtypecode=function(n,i){return s.standardFunctionAsync(n,i,function(){var _=(0,C.A)(function*(h,f,e){if((0,t.H)(e,2,2,n,i),(0,t.u)(e[0])){const a=yield e[0].load();if(!(0,t.O)(e[1]))throw new l.D$(n,l.TX.InvalidParameter,i);if(a.subtypeField){const p=F.WhereClause.create(`${a.subtypeField}= ${e[1]}`,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC);return new j.A({parentfeatureset:e[0],whereclause:p})}if(null===a.typeIdField||""===a.typeIdField)throw new l.D$(n,l.TX.FeatureSetDoesNotHaveSubtypes,i);const y=F.WhereClause.create(`${a.typeIdField}= ${e[1]}`,a.getFieldsIndex(),a.dateFieldsTimeZoneDefaultUTC);return new j.A({parentfeatureset:e[0],whereclause:y})}throw new l.D$(n,l.TX.InvalidParameter,i)});return function(h,f,e){return _.apply(this,arguments)}}())},s.signatures.push({name:"filterbysubtypecode",min:2,max:2}))}},32832:(se,W,D)=>{D.d(W,{R:()=>K});var C=D(73874);function K(R,P){return null===R?P:new C.A({url:R.field("url")})}}}]);