"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[4204],{94204:(I,m,e)=>{e.r(m),e.d(m,{default:()=>A});var t=e(8189),O=e(31178),M=e(35150),P=(e(3248),e(40707),e(5922),e(76576)),a=e(29459),s=e(10467),l=e(17715),v=e(56492),E=e(63484),u=e(85211);const i=Symbol(),y=U=>{let g=class extends U{constructor(){var c;super(...arguments),c=this,this.layerViews=new O.A,this._debouncedUpdate=(0,v.sg)((0,s.A)(function*(){const{layer:C,parent:S}=c,d=S?.footprintLayerView;let p=[];const f=c._createQuery();if(f&&d){const{features:h}=yield d.queryFeatures(f);c.suspended||(p=h.map(D=>C.acquireLayer(D)))}c.removeHandles(i),c.addHandles(p,i)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some(c=>c.updating)}enableLayerUpdates(){return(0,l.vE)([this._updatingHandles.addWhen(()=>!1===this.parent?.footprintLayerView?.dataUpdating,()=>this.updateLayers()),this._updatingHandles.add(()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended],()=>this.updateLayers()),(0,l.hA)(()=>this.removeHandles(i))])}updateLayers(){this.suspended?this.removeHandles(i):this._updatingHandles.addPromise((0,v.QZ)(this._debouncedUpdate()).catch(c=>{M.A.getLogger(this).error(c)}))}_createQuery(){const c=this.parent?.footprintLayerView,C=this.layer?.parent;if(!c||!C||C.destroyed)return null;const{layer:{maximumVisibleSublayers:S},view:{scale:d}}=this,{itemTypeField:p,itemSourceField:f,itemNameField:h,minScaleField:D,maxScaleField:T,objectIdField:Z,orderBy:w}=C,V=(0,E.m)(`${D} IS NULL OR ${d} <= ${D} OR ${D} = 0`,`${T} IS NULL OR ${d} >= ${T}`),B=w?.find(j=>j.field&&!j.valueExpression),R=c.createQuery();if(R.returnGeometry=!1,R.num=S,R.outFields=[Z,f,h],R.where=(0,E.m)(R.where,V),null!=this.unsupportedItemTypes){const j=`${p} NOT IN (${this.unsupportedItemTypes.map(W=>`'${W}'`)})`;R.where=(0,E.m)(R.where,j)}return B?.field&&(R.orderByFields=[`${B.field} ${"descending"===B.order?"DESC":"ASC"}`],R.outFields.push(B.field)),R}};return(0,t._)([(0,u.MZ)({readOnly:!0})],g.prototype,"creatingLayerViews",null),(0,t._)([(0,u.MZ)()],g.prototype,"layer",void 0),(0,t._)([(0,u.MZ)()],g.prototype,"layerViews",void 0),(0,t._)([(0,u.MZ)({readOnly:!0})],g.prototype,"unsupportedItemTypes",void 0),(0,t._)([(0,u.MZ)()],g.prototype,"parent",void 0),(0,t._)([(0,u.MZ)({readOnly:!0})],g.prototype,"isUpdating",null),g=(0,t._)([(0,P.$)("esri.views.layers.CatalogDynamicGroupLayerView")],g),g};var n=e(41474);let _=class extends(y((0,a.e)(n.A))){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new O.A}attach(){this.addAttachHandles([this.layerViews.on("after-changes",()=>this._updateStageChildren()),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(U){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((U,g)=>this.container.addChildAt(U.container,g))}};_=(0,t._)([(0,P.$)("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],_);const A=_},29459:(I,m,e)=>{e.d(m,{e:()=>C});var i,t=e(8189),O=e(31178),M=e(5605),L=e(5922),o=e(48900),r=e(85211),l=(e(3248),e(35150),e(40707),e(76576)),v=e(88766),E=e(60746),u=e(66727);let y=i=class extends u.A{constructor(S){super(S),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new i({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,t._)([(0,r.MZ)({type:[Number,String],json:{write:!0}})],y.prototype,"left",void 0),(0,t._)([(0,r.MZ)({type:[Number,String],json:{write:!0}})],y.prototype,"right",void 0),(0,t._)([(0,r.MZ)({type:[Number,String],json:{write:!0}})],y.prototype,"top",void 0),(0,t._)([(0,r.MZ)({type:[Number,String],json:{write:!0}})],y.prototype,"bottom",void 0),y=i=(0,t._)([(0,l.$)("esri.views.layers.support.ClipRect")],y);const n=y;var _=e(75644);let A=class extends u.A{constructor(S){super(S),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,t._)([(0,r.MZ)({type:[[[Number]]],json:{write:!0}})],A.prototype,"path",void 0),A=(0,t._)([(0,l.$)("esri.views.layers.support.Path")],A);const U=A;var g=e(6558);const c=O.A.ofType({key:"type",base:null,typeMap:{rect:n,path:U,geometry:_.A}}),C=S=>{let d=class extends S{constructor(){super(...arguments),this.attached=!1,this.clips=new c,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const p=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&p&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new L.A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new v.m),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,o.wB)(()=>this.suspended,h=>{this.container&&(this.container.visible=!h)},o.pc),(0,o.wB)(()=>this.updateSuspended,h=>{this.view&&!h&&this.updateRequested&&this.view.requestUpdate()},o.pc),(0,o.wB)(()=>this.layer?.opacity??1,h=>{this.container&&(this.container.opacity=h)},o.pc),(0,o.wB)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",h=>{this.container&&(this.container.blendMode=h)},o.pc),(0,o.wB)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,h=>{this.container&&(this.container.effect=h)},o.pc),(0,o.wB)(()=>this.highlightOptions,h=>this.container.highlightOptions=h,o.pc),(0,o.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},o.pc),(0,o.wB)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:h,scaleRange:D})=>{const T=(0,g.E5)(D,h);T!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=T)},o.pc)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(h=>{h===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const p=this.view?.spatialReference;return null==p||this.supportsSpatialReference(p)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(p){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",p),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(p))):this.updateRequested=!1}hitTest(p,f){return Promise.resolve(null)}supportsSpatialReference(p){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const p=super.getSuspendInfo(),f=!this.spatialReferenceSupported;return f&&(p.spatialReferenceNotSupported=f),p}addAttachHandles(p){this.addHandles(p,"attach")}};return(0,t._)([(0,r.MZ)()],d.prototype,"attached",void 0),(0,t._)([(0,r.MZ)({type:c,set(p){const f=(0,M.V)(p,this._get("clips"),c);this._set("clips",f)}})],d.prototype,"clips",void 0),(0,t._)([(0,r.MZ)()],d.prototype,"container",void 0),(0,t._)([(0,r.MZ)({type:E.A})],d.prototype,"highlightOptions",void 0),(0,t._)([(0,r.MZ)()],d.prototype,"moving",void 0),(0,t._)([(0,r.MZ)({readOnly:!0})],d.prototype,"spatialReferenceSupported",null),(0,t._)([(0,r.MZ)({readOnly:!0})],d.prototype,"updateParameters",void 0),(0,t._)([(0,r.MZ)()],d.prototype,"updateRequested",void 0),(0,t._)([(0,r.MZ)()],d.prototype,"updating",null),(0,t._)([(0,r.MZ)()],d.prototype,"view",void 0),(0,t._)([(0,r.MZ)()],d.prototype,"_visibleAtCurrentScale",void 0),(0,t._)([(0,r.MZ)({readOnly:!0})],d.prototype,"visibleAtCurrentScale",null),d=(0,t._)([(0,l.$)("esri.views.2d.layers.LayerView2D")],d),d}},41474:(I,m,e)=>{e.d(m,{A:()=>y});var t=e(8189),O=e(98877),M=e(42425),L=e(3046),o=e(35150),r=e(11432),P=e(64261),a=e(85211),v=(e(3248),e(40707),e(76576)),E=e(56985),u=e(6558);let i=class extends((0,L.sA)((0,P.g)(M.A.EventedMixin(O.A)))){constructor(n){super(n),this._updatingHandles=new E.U,this.layer=null,this.parent=null}initialize(){this.when().catch(n=>{if("layerview:create-error"!==n.name){const _=this.layer&&this.layer.id||"no id",A=this.layer?.title||"no title";o.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${A}', id: '${_}')`,n)}})}destroy(){this._updatingHandles=(0,r.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(n){this._overrideIfSome("visible",n)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const n=this.view.timeExtent,_=this.layer?.visibilityTimeExtent;return!n||!_||!n.intersection(_).isEmpty}canResume(){const n=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,u.g7)(n)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const n=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(n.viewNotReady=!0),this.layer&&this.layer.loaded||(n.layerNotLoaded=!0),(0,u.g7)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(n.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(n.outsideVisibilityTimeExtent=!0),this.visible||(n.layerInvisible=!0),n}isUpdating(){return!1}};(0,t._)([(0,a.MZ)()],i.prototype,"view",void 0),(0,t._)([(0,a.MZ)()],i.prototype,"fullOpacity",null),(0,t._)([(0,a.MZ)()],i.prototype,"layer",void 0),(0,t._)([(0,a.MZ)()],i.prototype,"parent",void 0),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"suspended",null),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"suspendInfo",null),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"legendEnabled",null),(0,t._)([(0,a.MZ)({type:Boolean,readOnly:!0})],i.prototype,"updating",null),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"updatingProgress",null),(0,t._)([(0,a.MZ)()],i.prototype,"updateSuspended",null),(0,t._)([(0,a.MZ)()],i.prototype,"visible",null),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"visibleAtCurrentScale",null),(0,t._)([(0,a.MZ)({readOnly:!0})],i.prototype,"visibleAtCurrentTimeExtent",null),i=(0,t._)([(0,v.$)("esri.views.layers.LayerView")],i);const y=i},66727:(I,m,e)=>{e.d(m,{A:()=>s});var t=e(8189),O=e(71065),M=e(85211),P=(e(3248),e(35150),e(40707),e(76576));let a=class extends O.oY{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,t._)([(0,M.MZ)({readOnly:!0})],a.prototype,"version",null),a=(0,t._)([(0,P.$)("esri.views.layers.support.ClipArea")],a);const s=a},75644:(I,m,e)=>{e.d(m,{A:()=>n});var u,t=e(8189),M=(e(21152),e(85211)),P=(e(3248),e(35150),e(40707),e(76576)),a=e(68643),s=e(61320),l=e(66727),v=e(28067),E=e(55861);const i={base:a.A,key:"type",typeMap:{extent:v.A,polygon:E.A}};let y=u=class extends l.A{constructor(_){super(_),this.type="geometry",this.geometry=null}clone(){return new u({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,t._)([(0,M.MZ)({types:i,json:{read:s.rS,write:!0}})],y.prototype,"geometry",void 0),y=u=(0,t._)([(0,P.$)("esri.views.layers.support.Geometry")],y);const n=y},6558:(I,m,e)=>{function t(s){return s&&"function"==typeof s.highlight}function L(s,l){if(l&&s){const{minScale:v,maxScale:E}=s;if(function o(s,l){return null!=s&&s>0||null!=l&&l>0}(v,E))return function M(s,l,v){return null==s||s>=v&&(0===l||s<=l)}(l,v,E)}return!0}function r(s){return!s?.minScale||!s.maxScale||s.minScale>=s.maxScale}e.d(m,{E5:()=>L,Of:()=>t,g7:()=>r})}}]);