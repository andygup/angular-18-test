"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[1852],{1852:(oe,E,i)=>{i.r(E),i.d(E,{default:()=>pe});var T=i(10467),s=i(8189),Z=i(92165),B=i(89563),I=i(5922),m=i(77806),L=i(35150),Y=i(39693),O=i(89221),Q=i(56492),V=i(45272),u=i(85211),H=(i(3248),i(17221)),C=i(76576),q=i(50305),j=i(95478),$=i(94376),N=i(25936),k=i(23e3),U=i(17049),D=i(85551),G=i(33036),A=i(46406),M=i(55739),R=i(15463),K=i(71065);i(40707);let r=class extends K.oY{constructor(o){super(o),this.field=null,this.type=null}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}};(0,s._)([(0,u.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],r.prototype,"field",void 0),(0,s._)([(0,u.MZ)({readOnly:!0,nonNullable:!0,json:{read:!1}})],r.prototype,"type",void 0),r=(0,s._)([(0,C.$)("esri.layers.pointCloudFilters.PointCloudFilter")],r);const l=r;var d;let p=d=class extends l{constructor(o){super(o),this.requiredClearBits=null,this.requiredSetBits=null,this.type="bitfield"}clone(){return new d({field:this.field,requiredClearBits:(0,m.o8)(this.requiredClearBits),requiredSetBits:(0,m.o8)(this.requiredSetBits)})}};(0,s._)([(0,u.MZ)({type:[M.jz],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredSetBits}}}}})],p.prototype,"requiredClearBits",void 0),(0,s._)([(0,u.MZ)({type:[M.jz],json:{write:{enabled:!0,overridePolicy(){return{enabled:!0,isRequired:!this.requiredClearBits}}}}})],p.prototype,"requiredSetBits",void 0),(0,s._)([(0,R.e)({pointCloudBitfieldFilter:"bitfield"})],p.prototype,"type",void 0),p=d=(0,s._)([(0,C.$)("esri.layers.pointCloudFilters.PointCloudBitfieldFilter")],p);const h=p;var g;let v=g=class extends l{constructor(o){super(o),this.includedReturns=[],this.type="return"}clone(){return new g({field:this.field,includedReturns:(0,m.o8)(this.includedReturns)})}};(0,s._)([(0,u.MZ)({type:[["firstOfMany","last","lastOfMany","single"]],json:{write:{enabled:!0,isRequired:!0}}})],v.prototype,"includedReturns",void 0),(0,s._)([(0,R.e)({pointCloudReturnFilter:"return"})],v.prototype,"type",void 0),v=g=(0,s._)([(0,C.$)("esri.layers.pointCloudFilters.PointCloudReturnFilter")],v);const x=v;var z;let S=z=class extends l{constructor(o){super(o),this.mode="exclude",this.type="value",this.values=[]}clone(){return new z({field:this.field,mode:this.mode,values:(0,m.o8)(this.values)})}};(0,s._)([(0,u.MZ)({type:["exclude","include"],json:{write:{enabled:!0,isRequired:!0}}})],S.prototype,"mode",void 0),(0,s._)([(0,R.e)({pointCloudValueFilter:"value"})],S.prototype,"type",void 0),(0,s._)([(0,u.MZ)({type:[Number],json:{write:{enabled:!0,isRequired:!0}}})],S.prototype,"values",void 0),S=z=(0,s._)([(0,C.$)("esri.layers.pointCloudFilters.PointCloudValueFilter")],S);const ne={key:"type",base:l,typeMap:{value:S,bitfield:h,return:x}};var J,X=i(22329),W=i(29141),ie=i(3404),_=i(26025),se=i(49873),ee=i(63115);let F=J=class extends ee.A{constructor(o){super(o),this.type="point-cloud-rgb",this.field=null}clone(){return new J({...this.cloneProperties(),field:(0,m.o8)(this.field)})}};(0,s._)([(0,R.e)({pointCloudRGBRenderer:"point-cloud-rgb"})],F.prototype,"type",void 0),(0,s._)([(0,u.MZ)({type:String,json:{write:!0}})],F.prototype,"field",void 0),F=J=(0,s._)([(0,C.$)("esri.renderers.PointCloudRGBRenderer")],F);const le=F;var ae=i(87862),de=i(87701);const te={key:"type",base:ee.A,typeMap:{"point-cloud-class-breaks":se.A,"point-cloud-rgb":le,"point-cloud-stretch":ae.A,"point-cloud-unique-value":de.A},errorContext:"renderer"};var w=i(73812),ue=i(41843);const re=(0,ie.p)();let f=class extends((0,A.w6)((0,N.b)((0,U.q)((0,D.A)((0,G.j)((0,Y.P)((0,k.d)((0,$.p)(j.A))))))))){constructor(...o){super(...o),this.operationalLayerType="PointCloudLayer",this.popupEnabled=!0,this.popupTemplate=null,this.opacity=1,this.filters=[],this.fields=null,this.fieldsIndex=null,this.outFields=null,this.path=null,this.legendEnabled=!0,this.renderer=null,this.type="point-cloud"}normalizeCtorArgs(o,a){return"string"==typeof o?{url:o,...a}:o}get defaultPopupTemplate(){return this.attributeStorageInfo?this.createPopupTemplate():null}getFieldDomain(o){const a=this.fieldsIndex.get(o);return a?.domain?a.domain:null}readServiceFields(o,a,c){return Array.isArray(o)?o.map(y=>{const P=new W.A;return"FieldTypeInteger"===y.type&&((y=(0,m.o8)(y)).type="esriFieldTypeInteger"),P.read(y,c),P}):Array.isArray(a.attributeStorageInfo)?a.attributeStorageInfo.map(y=>new W.A({name:y.name,type:"ELEVATION"===y.name?"double":"integer"})):null}set elevationInfo(o){this._set("elevationInfo",o),this._validateElevationInfo()}writeRenderer(o,a,c,y){(0,O.sM)("layerDefinition.drawingInfo.renderer",o.write({},y),a)}load(o){const a=null!=o?o.signal:null,c=this.loadFromPortal({supportedTypes:["Scene Service"]},o).catch(Q.QP).then(()=>this._fetchService(a));return this.addResolvingPromise(c),Promise.resolve(this)}createPopupTemplate(o){const a=(0,ue.tn)(this,o);return a&&(this._formatPopupTemplateReturnsField(a),this._formatPopupTemplateRGBField(a)),a}_formatPopupTemplateReturnsField(o){const a=this.fieldsIndex.get("RETURNS");if(!a)return;const c=o.fieldInfos?.find(P=>P.fieldName===a.name);if(!c)return;const y=new _.A({name:"pcl-returns-decoded",title:a.alias||a.name,expression:`\n        var returnValue = $feature.${a.name};\n        return (returnValue % 16) + " / " + Floor(returnValue / 16);\n      `});o.expressionInfos=[...o.expressionInfos||[],y],c.fieldName="expression/pcl-returns-decoded"}_formatPopupTemplateRGBField(o){const a=this.fieldsIndex.get("RGB");if(!a)return;const c=o.fieldInfos?.find(P=>P.fieldName===a.name);if(!c)return;const y=new _.A({name:"pcl-rgb-decoded",title:a.alias||a.name,expression:`\n        var rgb = $feature.${a.name};\n        var red = Floor(rgb / 65536, 0);\n        var green = Floor((rgb - (red * 65536)) / 256,0);\n        var blue = rgb - (red * 65536) - (green * 256);\n\n        return "rgb(" + red + "," + green + "," + blue + ")";\n      `});o.expressionInfos=[...o.expressionInfos||[],y],c.fieldName="expression/pcl-rgb-decoded"}queryCachedStatistics(o,a){var c=this;return(0,T.A)(function*(){if(yield c.load(a),!c.attributeStorageInfo)throw new I.A("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const y=c.fieldsIndex.get(o);if(!y)throw new I.A("pointcloudlayer:field-unexisting",`Field '${o}' does not exist on the layer`);for(const P of c.attributeStorageInfo)if(P.name===y.name){const fe=(0,V.fj)(c.parsedUrl?.path??"",`./statistics/${P.key}`);return(0,B.A)(fe,{query:{f:"json",...c.customParameters,token:c.apiKey},responseType:"json",signal:a?a.signal:null}).then(ce=>ce.data)}throw new I.A("pointcloudlayer:no-cached-statistics","Cached statistics for this attribute are not available")})()}saveAs(o,a){var c=this;return(0,T.A)(function*(){return c._debouncedSaveOperations(A.Xh.SAVE_AS,{...a,getTypeKeywords:()=>c._getTypeKeywords(),portalItemLayerType:"point-cloud"},o)})()}save(){var o=this;return(0,T.A)(function*(){const a={getTypeKeywords:()=>o._getTypeKeywords(),portalItemLayerType:"point-cloud"};return o._debouncedSaveOperations(A.Xh.SAVE,a)})()}validateLayer(o){if(o.layerType&&"PointCloud"!==o.layerType)throw new I.A("pointcloudlayer:layer-type-not-supported","PointCloudLayer does not support this layer type",{layerType:o.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new I.A("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"});if(this.version.major>2)throw new I.A("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x-2.x"})}hasCachedStatistics(o){return null!=this.attributeStorageInfo&&this.attributeStorageInfo.some(a=>a.name===o)}_getTypeKeywords(){return["PointCloud"]}_validateElevationInfo(){const o=this.elevationInfo;(0,w.XF)(L.A.getLogger(this),(0,w.B)("Point cloud layers","absolute-height",o)),(0,w.XF)(L.A.getLogger(this),(0,w.tW)("Point cloud layers",o))}};(0,s._)([(0,u.MZ)({type:["PointCloudLayer"]})],f.prototype,"operationalLayerType",void 0),(0,s._)([(0,u.MZ)(X.M6)],f.prototype,"popupEnabled",void 0),(0,s._)([(0,u.MZ)({type:Z.A,json:{name:"popupInfo",write:!0}})],f.prototype,"popupTemplate",void 0),(0,s._)([(0,u.MZ)({readOnly:!0,json:{read:!1}})],f.prototype,"defaultPopupTemplate",null),(0,s._)([(0,u.MZ)({readOnly:!0,json:{write:!1,read:!1,origins:{"web-document":{write:!1,read:!1}}}})],f.prototype,"opacity",void 0),(0,s._)([(0,u.MZ)({type:["show","hide"]})],f.prototype,"listMode",void 0),(0,s._)([(0,u.MZ)({types:[ne],json:{origins:{service:{read:{source:"filters"}}},name:"layerDefinition.filters",write:!0}})],f.prototype,"filters",void 0),(0,s._)([(0,u.MZ)({type:[W.A]})],f.prototype,"fields",void 0),(0,s._)([(0,u.MZ)(re.fieldsIndex)],f.prototype,"fieldsIndex",void 0),(0,s._)([(0,H.w)("service","fields",["fields","attributeStorageInfo"])],f.prototype,"readServiceFields",null),(0,s._)([(0,u.MZ)(re.outFields)],f.prototype,"outFields",void 0),(0,s._)([(0,u.MZ)({readOnly:!0})],f.prototype,"attributeStorageInfo",void 0),(0,s._)([(0,u.MZ)(X.Yj)],f.prototype,"elevationInfo",null),(0,s._)([(0,u.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0},"portal-item":{read:!0,write:!0}},read:!1}})],f.prototype,"path",void 0),(0,s._)([(0,u.MZ)(X.fV)],f.prototype,"legendEnabled",void 0),(0,s._)([(0,u.MZ)({types:te,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:{target:{"layerDefinition.drawingInfo.renderer":{types:te},"layerDefinition.drawingInfo.transparency":{type:Number}}}}})],f.prototype,"renderer",void 0),(0,s._)([(0,q.K)("renderer")],f.prototype,"writeRenderer",null),(0,s._)([(0,u.MZ)({json:{read:!1},readOnly:!0})],f.prototype,"type",void 0),f=(0,s._)([(0,C.$)("esri.layers.PointCloudLayer")],f);const pe=f},73812:(oe,E,i)=>{i.d(E,{$7:()=>D,B:()=>U,M7:()=>M,XF:()=>A,tW:()=>G,w7:()=>m}),i(82663);var s=i(82575);function m(t,r){return function B(t,r){return r?.mode?r.mode:function Z(t){return t?R:K}(t).mode}(null!=t&&t.hasZ,r)}function U(t,r,l){return l&&l.mode!==r?`${t} only support ${r} elevation mode`:null}function D(t,r,l){return l?.mode===r?`${t} do not support ${r} elevation mode`:null}function G(t,r){return null!=r?.featureExpressionInfo&&"0"!==r.featureExpressionInfo.expression?`${t} do not support featureExpressionInfo`:null}function A(t,r){r&&t.warn(".elevationInfo=",r)}function M(t){return(t?.offset??0)*(0,s.Ao)(t?.unit)}const R={mode:"absolute-height",offset:0},K={mode:"on-the-ground",offset:null}}}]);