"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[2734],{84149:(se,O,s)=>{s.d(O,{I:()=>t});var g=s(64662);class t{constructor(p){this._allocator=p,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,g.d)(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const p=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*f);this._items.length=Math.min(p,this._items.length),this._itemsPtr=0}_grow(){for(let p=0;p<Math.max(8,Math.min(this._items.length,f));p++)this._items.push(this._allocator())}}const f=1024},16590:(se,O,s)=>{s.d(O,{g:()=>j});var g=s(25866),t=s(11817),f=s(23234);function j(y,m,S,I){if((0,t.canProjectWithoutEngine)(y.spatialReference,S))return Z[0]=y.x,Z[1]=y.y,Z[2]=y.z??I??0,(0,f.projectBuffer)(Z,y.spatialReference,0,m,S,0,1);const i=(0,t.tryProjectWithZConversion)(y,S);return!!i&&(m[0]=i?.x,m[1]=i?.y,m[2]=i?.z??I??0,!0)}const Z=(0,g.vt)()},13305:(se,O,s)=>{s.r(O),s.d(O,{default:()=>nt});var g=s(10467),t=s(8189),f=s(31178),j=s(2993),p=s(5922),c=s(77806),Z=s(4879),y=s(35150),m=s(39693),S=s(56492),I=s(45272),i=s(85211),T=(s(3248),s(17221)),u=s(76576),ne=s(32034),Ze=s(95478),Ie=s(81098),Be=s(92165),Oe=(s(79122),s(70176),s(92089),s(9826),s(15317),s(38582),s(96128),s(13318),s(85718),s(36156)),le=s(89563),xe=s(49976),ae=s(55098),de=s(64261),ye=(s(40707),s(15463)),Le=s(28067),ue=s(35940),je=s(3046),Te=s(55739),B=s(22329);let h=class extends((0,je.sA)(m.L)){constructor(e){super(e),this.title="",this.id=-1,this.modelName=null,this.isEmpty=null,this.legendEnabled=!0,this.visible=!0,this.opacity=1}readTitle(e,r){return"string"==typeof r.alias?r.alias:"string"==typeof r.name?r.name:""}readIdOnlyOnce(e){return-1!==this.id?this.id:"number"==typeof e?e:-1}};(0,t._)([(0,i.MZ)({type:String,json:{origins:{"web-scene":{write:!0},"portal-item":{write:!0}}}})],h.prototype,"title",void 0),(0,t._)([(0,T.w)("service","title",["alias","name"])],h.prototype,"readTitle",null),(0,t._)([(0,i.MZ)()],h.prototype,"layer",void 0),(0,t._)([(0,i.MZ)({type:Te.jz,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],h.prototype,"id",void 0),(0,t._)([(0,T.w)("service","id")],h.prototype,"readIdOnlyOnce",null),(0,t._)([(0,i.MZ)((0,B.Qo)(String))],h.prototype,"modelName",void 0),(0,t._)([(0,i.MZ)((0,B.Qo)(Boolean))],h.prototype,"isEmpty",void 0),(0,t._)([(0,i.MZ)({type:Boolean,nonNullable:!0})],h.prototype,"legendEnabled",void 0),(0,t._)([(0,i.MZ)({type:Boolean,json:{name:"visibility",write:!0}})],h.prototype,"visible",void 0),(0,t._)([(0,i.MZ)({type:Number,json:{write:!0}})],h.prototype,"opacity",void 0),h=(0,t._)([(0,u.$)("esri.layers.buildingSublayers.BuildingSublayer")],h);const pe=h;var Pe=s(75783),Ee=s(3404),Re=s(73258),we=s(86300),Ue=s(27834),C=s(10581),Ce=s(87086),Ne=s(41843),De=s(88485),Qe=s(10401),ce=s(64935);const he=(0,Ee.p)();let l=class extends(ae.A.LoadableMixin((0,de.g)(pe))){constructor(e){super(e),this.type="building-component",this.nodePages=null,this.materialDefinitions=[],this.textureSetDefinitions=[],this.geometryDefinitions=[],this.indexInfo=null,this.serviceUpdateTimeStamp=null,this.store=null,this.attributeStorageInfo=[],this.fields=[],this.associatedLayer=null,this.outFields=null,this.listMode="show",this.renderer=null,this.definitionExpression=null,this.popupEnabled=!0,this.popupTemplate=null,this.layerType="3d-object"}get parsedUrl(){return this.layer?{path:`${this.layer.parsedUrl?.path}/sublayers/${this.id}`,query:this.layer.parsedUrl?.query}:{path:""}}get fieldsIndex(){return new Re.A(this.fields)}readAssociatedLayer(e,r){const n=this.layer.associatedFeatureServiceItem,a=r.associatedLayerID;return null!=n&&"number"==typeof a?new ue.default({portalItem:n,customParameters:this.customParameters,layerId:a}):null}get objectIdField(){if(null!=this.fields)for(const e of this.fields)if("oid"===e.type)return e.name;return null}get displayField(){return null!=this.associatedLayer?this.associatedLayer.displayField:void 0}get apiKey(){return this.layer.apiKey}get customParameters(){return this.layer.customParameters}get fullExtent(){return this.layer.fullExtent}get spatialReference(){return this.layer.spatialReference}get version(){return this.layer.version}get elevationInfo(){return this.layer.elevationInfo}get minScale(){return this.layer.minScale}get maxScale(){return this.layer.maxScale}get effectiveScaleRange(){return this.layer.effectiveScaleRange}get defaultPopupTemplate(){return this.createPopupTemplate()}load(e){const r=null!=e?e.signal:null,n=this._fetchService(r).then(()=>{this.indexInfo=(0,Ue.F)(this.parsedUrl.path,this.rootNode,this.nodePages,this.customParameters,this.apiKey,y.A.getLogger(this),r)});return this.addResolvingPromise(n),Promise.resolve(this)}createPopupTemplate(e){return(0,Ne.tn)(this,e)}_fetchService(e){var r=this;return(0,g.A)(function*(){const n=(yield(0,le.A)(r.parsedUrl.path,{query:{f:"json",...r.customParameters,token:r.apiKey},responseType:"json",signal:e})).data;r.read(n,{origin:"service",url:r.parsedUrl})})()}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){const n=this.getFeatureType(r?.feature)?.domains?.[e];return n&&"inherited"!==n.type?n:this.getField(e)?.domain??null}getFeatureType(e){return e&&null!=this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return null!=this.associatedLayer?this.associatedLayer.types??[]:[]}get typeIdField(){return null!=this.associatedLayer?this.associatedLayer.typeIdField:null}get geometryType(){return"3d-object"===this.layerType?"mesh":"point"}get profile(){return"3d-object"===this.layerType?"mesh-pyramids":"points"}get capabilities(){const e=null!=this.associatedLayer&&this.associatedLayer.capabilities?this.associatedLayer.capabilities:Pe.P,{query:r,data:{supportsZ:n,supportsM:a,isVersioned:v}}=e;return{query:r,data:{supportsZ:n,supportsM:a,isVersioned:v}}}createQuery(){const e=new Ce.A;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e}queryExtent(e,r){return this._getAssociatedLayerForQuery().then(n=>n.queryExtent(e||this.createQuery(),r))}queryFeatureCount(e,r){return this._getAssociatedLayerForQuery().then(n=>n.queryFeatureCount(e||this.createQuery(),r))}queryFeatures(e,r){return this._getAssociatedLayerForQuery().then(n=>n.queryFeatures(e||this.createQuery(),r)).then(n=>{if(n?.features)for(const a of n.features)a.layer=this.layer,a.sourceLayer=this;return n})}queryObjectIds(e,r){return this._getAssociatedLayerForQuery().then(n=>n.queryObjectIds(e||this.createQuery(),r))}queryCachedAttributes(e,r){var n=this;return(0,g.A)(function*(){const a=(0,we.hL)(n.fieldsIndex,yield(0,ce.TO)(n,(0,ce.D8)(n)));return(0,Qe.s1)(n.parsedUrl.path,n.attributeStorageInfo,e,r,a,n.apiKey,n.customParameters)})()}queryCachedFeature(e,r){var n=this;return(0,g.A)(function*(){const a=yield n.queryCachedAttributes(e,[r]);if(!a||0===a.length)throw new p.A("scenelayer:feature-not-in-cached-data","Feature not found in cached data");return new Ie.A({attributes:a[0],layer:n,sourceLayer:n})})()}getFieldUsageInfo(e){return this.fieldsIndex.has(e)?{supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1}:{supportsLabelingInfo:!1,supportsRenderer:!0,supportsPopupTemplate:!0,supportsLayerQuery:null!=this.associatedLayer}}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return null!=e&&e.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}_loadAssociatedLayerForQuery(){var e=this;return(0,g.A)(function*(){if(yield e.load(),null==e.associatedLayer)throw new p.A("buildingscenelayer:query-not-available","BuildingSceneLayer component layer queries are not available without an associated feature layer",{layer:e});try{yield e.associatedLayer.load()}catch(r){throw new p.A("buildingscenelayer:query-not-available","BuildingSceneLayer associated feature layer could not be loaded",{layer:e,error:r})}return e.associatedLayer})()}};(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"parsedUrl",null),(0,t._)([(0,i.MZ)({type:C.W4,readOnly:!0})],l.prototype,"nodePages",void 0),(0,t._)([(0,i.MZ)({type:[C.uV],readOnly:!0})],l.prototype,"materialDefinitions",void 0),(0,t._)([(0,i.MZ)({type:[C.Ot],readOnly:!0})],l.prototype,"textureSetDefinitions",void 0),(0,t._)([(0,i.MZ)({type:[C.L0],readOnly:!0})],l.prototype,"geometryDefinitions",void 0),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"serviceUpdateTimeStamp",void 0),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"store",void 0),(0,t._)([(0,i.MZ)({type:String,readOnly:!0,json:{read:{source:"store.rootNode"}}})],l.prototype,"rootNode",void 0),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"attributeStorageInfo",void 0),(0,t._)([(0,i.MZ)(he.fields)],l.prototype,"fields",void 0),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"fieldsIndex",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:ue.default})],l.prototype,"associatedLayer",void 0),(0,t._)([(0,T.w)("service","associatedLayer",["associatedLayerID"])],l.prototype,"readAssociatedLayer",null),(0,t._)([(0,i.MZ)(he.outFields)],l.prototype,"outFields",void 0),(0,t._)([(0,i.MZ)({type:String,readOnly:!0})],l.prototype,"objectIdField",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:String,json:{read:!1}})],l.prototype,"displayField",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:String})],l.prototype,"apiKey",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:String})],l.prototype,"customParameters",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:Le.A})],l.prototype,"fullExtent",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:ne.A})],l.prototype,"spatialReference",null),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"version",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:De.A})],l.prototype,"elevationInfo",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:Number})],l.prototype,"minScale",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:Number})],l.prototype,"maxScale",null),(0,t._)([(0,i.MZ)({readOnly:!0,type:Number})],l.prototype,"effectiveScaleRange",null),(0,t._)([(0,i.MZ)({type:["hide","show"],json:{write:!0}})],l.prototype,"listMode",void 0),(0,t._)([(0,i.MZ)({types:Oe.X,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],l.prototype,"renderer",void 0),(0,t._)([(0,i.MZ)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],l.prototype,"definitionExpression",void 0),(0,t._)([(0,i.MZ)(B.M6)],l.prototype,"popupEnabled",void 0),(0,t._)([(0,i.MZ)({type:Be.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],l.prototype,"popupTemplate",void 0),(0,t._)([(0,i.MZ)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],l.prototype,"normalReferenceFrame",void 0),(0,t._)([(0,i.MZ)({readOnly:!0,json:{read:!1}})],l.prototype,"defaultPopupTemplate",null),(0,t._)([(0,i.MZ)()],l.prototype,"types",null),(0,t._)([(0,i.MZ)()],l.prototype,"typeIdField",null),(0,t._)([(0,i.MZ)({json:{write:!1}}),(0,ye.e)(new xe.J({"3DObject":"3d-object",Point:"point"}))],l.prototype,"layerType",void 0),(0,t._)([(0,i.MZ)()],l.prototype,"geometryType",null),(0,t._)([(0,i.MZ)()],l.prototype,"profile",null),(0,t._)([(0,i.MZ)({readOnly:!0,json:{read:!1}})],l.prototype,"capabilities",null),(0,t._)([(0,i.MZ)({readOnly:!0})],l.prototype,"statisticsInfo",void 0),l=(0,t._)([(0,u.$)("esri.layers.buildingSublayers.BuildingComponentSublayer")],l);const X=l;var Y,$e=s(96996);const ge={type:f.A,readOnly:!0,json:{origins:{service:{read:{source:"sublayers",reader:ve}}},read:!1}};function ve(e,r,n){if(e&&Array.isArray(e))return new f.A(e.map(a=>{const v=function Ke(e){return"group"===e.layerType?b:X}(a);if(v){const U=new v;return U.read(a,n),U}return n?.messages&&a&&n.messages.push(new $e.A("building-scene-layer:unsupported-sublayer-type","Building scene sublayer of type '"+(a.type||"unknown")+"' are not supported",{definition:a,context:n})),null}))}let b=Y=class extends pe{constructor(e){super(e),this.type="building-group",this.listMode="show",this.sublayers=null}loadAll(){return(0,Z.L)(this,e=>Y.forEachSublayer(this.sublayers,r=>{"building-group"!==r.type&&e(r)}))}};var e;(0,t._)([(0,i.MZ)({type:["hide","show","hide-children"],json:{write:!0}})],b.prototype,"listMode",void 0),(0,t._)([(0,i.MZ)(ge)],b.prototype,"sublayers",void 0),b=Y=(0,t._)([(0,u.$)("esri.layers.buildingSublayers.BuildingGroupSublayer")],b),(e=b||(b={})).sublayersProperty=ge,e.readSublayers=ve,e.forEachSublayer=function r(n,a){n.forEach(v=>{a(v),"building-group"===v.type&&r(v.sublayers,a)})};const x=b;var Ve=s(94376),We=s(25936),Xe=s(23e3),Ye=s(17049),Ge=s(85551),Je=s(33036),G=s(46406),He=s(86537),F=s(71065),ze=s(43085);let N=class extends F.oY{constructor(){super(...arguments),this.type=null}};(0,t._)([(0,i.MZ)({type:String,readOnly:!0,json:{write:!0}})],N.prototype,"type",void 0),N=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterAuthoringInfo")],N);const fe=N;var J;let P=J=class extends F.oY{constructor(){super(...arguments),this.filterType=null,this.filterValues=null}clone(){return new J({filterType:this.filterType,filterValues:(0,c.o8)(this.filterValues)})}};var H;(0,t._)([(0,i.MZ)({type:String,json:{write:!0}})],P.prototype,"filterType",void 0),(0,t._)([(0,i.MZ)({type:[String],json:{write:!0}})],P.prototype,"filterValues",void 0),P=J=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterAuthoringInfoType")],P);const qe=f.A.ofType(P);let D=H=class extends F.oY{clone(){return new H({filterTypes:(0,c.o8)(this.filterTypes)})}};var z;(0,t._)([(0,i.MZ)({type:qe,json:{write:!0}})],D.prototype,"filterTypes",void 0),D=H=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterAuthoringInfoBlock")],D);const et=f.A.ofType(D);let E=z=class extends fe{constructor(){super(...arguments),this.type="checkbox"}clone(){return new z({filterBlocks:(0,c.o8)(this.filterBlocks)})}};(0,t._)([(0,i.MZ)({type:["checkbox"]})],E.prototype,"type",void 0),(0,t._)([(0,i.MZ)({type:et,json:{write:!0}})],E.prototype,"filterBlocks",void 0),E=z=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterAuthoringInfoCheckbox")],E);const me=E;let Q=class extends F.oY{};(0,t._)([(0,i.MZ)({readOnly:!0,json:{read:!1}})],Q.prototype,"type",void 0),Q=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterMode")],Q);const $=Q;var k;let K=k=class extends ${constructor(){super(...arguments),this.type="solid"}clone(){return new k}};(0,t._)([(0,i.MZ)({type:["solid"],readOnly:!0,json:{write:!0}})],K.prototype,"type",void 0),K=k=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterModeSolid")],K);const q=K;var _,tt=s(91033);let R=_=class extends ${constructor(){super(...arguments),this.type="wire-frame",this.edges=null}clone(){return new _({edges:(0,c.o8)(this.edges)})}};(0,t._)([(0,ye.e)({wireFrame:"wire-frame"})],R.prototype,"type",void 0),(0,t._)([(0,i.MZ)(tt.J)],R.prototype,"edges",void 0),R=_=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterModeWireFrame")],R);const Me=R;var ee;let V=ee=class extends ${constructor(){super(...arguments),this.type="x-ray"}clone(){return new ee}};(0,t._)([(0,i.MZ)({type:["x-ray"],readOnly:!0,json:{write:!0}})],V.prototype,"type",void 0),V=ee=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterModeXRay")],V);const Se=V;var te;const rt={nonNullable:!0,types:{key:"type",base:$,typeMap:{solid:q,"wire-frame":Me,"x-ray":Se}},json:{read:e=>{switch(e?.type){case"solid":return q.fromJSON(e);case"wireFrame":return Me.fromJSON(e);case"x-ray":return Se.fromJSON(e);default:return}},write:{enabled:!0,isRequired:!0}}};let L=te=class extends F.oY{constructor(){super(...arguments),this.filterExpression=null,this.filterMode=new q,this.title=""}clone(){return new te({filterExpression:this.filterExpression,filterMode:(0,c.o8)(this.filterMode),title:this.title})}};var re;(0,t._)([(0,i.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],L.prototype,"filterExpression",void 0),(0,t._)([(0,i.MZ)(rt)],L.prototype,"filterMode",void 0),(0,t._)([(0,i.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],L.prototype,"title",void 0),L=te=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilterBlock")],L);const st=f.A.ofType(L);let A=re=class extends F.oY{constructor(){super(...arguments),this.description=null,this.filterBlocks=null,this.id=(0,ze.lk)(),this.name=null}clone(){return new re({description:this.description,filterBlocks:(0,c.o8)(this.filterBlocks),id:this.id,name:this.name,filterAuthoringInfo:(0,c.o8)(this.filterAuthoringInfo)})}};(0,t._)([(0,i.MZ)({type:String,json:{write:!0}})],A.prototype,"description",void 0),(0,t._)([(0,i.MZ)({type:st,json:{write:{enabled:!0,isRequired:!0}}})],A.prototype,"filterBlocks",void 0),(0,t._)([(0,i.MZ)({types:{key:"type",base:fe,typeMap:{checkbox:me}},json:{read:e=>"checkbox"===e?.type?me.fromJSON(e):null,write:!0}})],A.prototype,"filterAuthoringInfo",void 0),(0,t._)([(0,i.MZ)({type:String,constructOnly:!0,json:{write:{enabled:!0,isRequired:!0}}})],A.prototype,"id",void 0),(0,t._)([(0,i.MZ)({type:String,json:{write:{enabled:!0,isRequired:!0}}})],A.prototype,"name",void 0),A=re=(0,t._)([(0,u.$)("esri.layers.support.BuildingFilter")],A);const ot=A;let M=class extends F.oY{constructor(){super(...arguments),this.fieldName=null,this.modelName=null,this.label=null,this.min=null,this.max=null,this.mostFrequentValues=null,this.subLayerIds=null}};(0,t._)([(0,i.MZ)({type:String})],M.prototype,"fieldName",void 0),(0,t._)([(0,i.MZ)({type:String})],M.prototype,"modelName",void 0),(0,t._)([(0,i.MZ)({type:String})],M.prototype,"label",void 0),(0,t._)([(0,i.MZ)({type:Number})],M.prototype,"min",void 0),(0,t._)([(0,i.MZ)({type:Number})],M.prototype,"max",void 0),(0,t._)([(0,i.MZ)({json:{read:e=>Array.isArray(e)&&(e.every(r=>"string"==typeof r)||e.every(r=>"number"==typeof r))?e.slice():null}})],M.prototype,"mostFrequentValues",void 0),(0,t._)([(0,i.MZ)({type:[Number]})],M.prototype,"subLayerIds",void 0),M=(0,t._)([(0,u.$)("esri.layers.support.BuildingSummaryStatistics.BuildingFieldStatistics")],M);let w=class extends(ae.A.LoadableMixin((0,de.g)(F.oY))){constructor(){super(...arguments),this.url=null}get fields(){return this.loaded||"loading"===this.loadStatus?this._get("fields"):(y.A.getLogger(this).error("building summary statistics are not loaded"),null)}load(e){return this.addResolvingPromise(this._fetchService(null!=e?e.signal:null)),Promise.resolve(this)}_fetchService(e){var r=this;return(0,g.A)(function*(){const n=(yield(0,le.A)(r.url,{query:{f:"json"},responseType:"json",signal:e})).data;r.read(n,{origin:"service"})})()}};(0,t._)([(0,i.MZ)({constructOnly:!0,type:String})],w.prototype,"url",void 0),(0,t._)([(0,i.MZ)({readOnly:!0,type:[M],json:{read:{source:"summary"}}})],w.prototype,"fields",null),w=(0,t._)([(0,u.$)("esri.layers.support.BuildingSummaryStatistics")],w);const be=w;var W=s(73812);const Fe=f.A.ofType(ot),Ae=(0,c.o8)(x.sublayersProperty),ie=Ae.json?.origins;ie&&(ie["web-scene"]={type:[X],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}},ie["portal-item"]={type:[X],write:{enabled:!0,overridePolicy:()=>({enabled:!1})}});let d=class extends((0,G.w6)((0,We.b)((0,Ye.q)((0,Ge.A)((0,Je.j)((0,m.P)((0,Xe.d)((0,Ve.p)(Ze.A))))))))){constructor(e){super(e),this.operationalLayerType="BuildingSceneLayer",this.allSublayers=new j.A({getCollections:()=>[this.sublayers],getChildrenFunction:r=>"building-group"===r.type?r.sublayers:null}),this.sublayers=null,this._sublayerOverrides=null,this.filters=new Fe,this.activeFilterId=null,this.summaryStatistics=null,this.outFields=null,this.legendEnabled=!0,this.type="building-scene"}normalizeCtorArgs(e){return"string"==typeof e?{url:e}:e??{}}destroy(){this.allSublayers.destroy()}readSublayers(e,r,n){const a=x.readSublayers(e,r,n);return x.forEachSublayer(a,v=>v.layer=this),this._sublayerOverrides&&(this.applySublayerOverrides(a,this._sublayerOverrides),this._sublayerOverrides=null),a}applySublayerOverrides(e,{overrides:r,context:n}){x.forEachSublayer(e,a=>a.read(r.get(a.id),n))}readSublayerOverrides(e,r){const n=new Map;for(const a of e)null!=a&&"object"==typeof a&&"number"==typeof a.id?n.set(a.id,a):r.messages?.push(new p.A("building-scene-layer:invalid-sublayer-override","Invalid value for sublayer override. Not an object or no id specified.",{value:a}));return{overrides:n,context:r}}writeSublayerOverrides(e,r,n){const a=[];x.forEachSublayer(this.sublayers,v=>{const U=v.write({},n);Object.keys(U).length>1&&a.push(U)}),a.length>0&&(r.sublayers=a)}writeUnappliedOverrides(e,r){r.sublayers=[],e.overrides.forEach(n=>{r.sublayers.push((0,c.o8)(n))})}write(e,r){return e=super.write(e,r),!r||"web-scene"!==r.origin&&"portal-item"!==r.origin||(this.sublayers?this.writeSublayerOverrides(this.sublayers,e,r):this._sublayerOverrides&&this.writeUnappliedOverrides(this._sublayerOverrides,e)),e}read(e,r){if(super.read(e,r),r&&("web-scene"===r.origin||"portal-item"===r.origin)&&null!=e&&Array.isArray(e.sublayers)){const n=this.readSublayerOverrides(e.sublayers,r);this.sublayers?this.applySublayerOverrides(this.sublayers,n):this._sublayerOverrides=n}}readSummaryStatistics(e,r){if("string"==typeof r.statisticsHRef){const n=(0,I.fj)(this.parsedUrl?.path,r.statisticsHRef);return new be({url:n})}return null}set elevationInfo(e){this._set("elevationInfo",e),this._validateElevationInfo()}load(e){const r=null!=e?e.signal:null,n=this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(S.QP).then(()=>this._fetchService(r)).then(()=>this._fetchAssociatedFeatureService(r));return this.addResolvingPromise(n),Promise.resolve(this)}loadAll(){return(0,Z.g)(this,e=>{x.forEachSublayer(this.sublayers,r=>{"building-group"!==r.type&&e(r)}),this.summaryStatistics&&e(this.summaryStatistics)})}saveAs(e,r){var n=this;return(0,g.A)(function*(){return n._debouncedSaveOperations(G.Xh.SAVE_AS,{...r,getTypeKeywords:()=>n._getTypeKeywords(),portalItemLayerType:"building-scene"},e)})()}save(){var e=this;return(0,g.A)(function*(){const r={getTypeKeywords:()=>e._getTypeKeywords(),portalItemLayerType:"building-scene"};return e._debouncedSaveOperations(G.Xh.SAVE,r)})()}validateLayer(e){if(!e.layerType||"Building"!==e.layerType)throw new p.A("buildingscenelayer:layer-type-not-supported","BuildingSceneLayer does not support this layer type",{layerType:e.layerType})}_getTypeKeywords(){return["Building"]}_fetchAssociatedFeatureService(e){var r=this;return(0,g.A)(function*(){try{const{portalItem:n}=yield(0,He.L)(`${r.url}/layers/${r.layerId}`,{sceneLayerItem:r.portalItem,customParameters:r.customParameters,apiKey:r.apiKey,signal:e});r.associatedFeatureServiceItem=n}catch(n){y.A.getLogger(r).warn("Associated feature service item could not be loaded",n)}})()}_validateElevationInfo(){const e=this.elevationInfo,r="Building scene layers";(0,W.XF)(y.A.getLogger(this),(0,W.B)(r,"absolute-height",e)),(0,W.XF)(y.A.getLogger(this),(0,W.tW)(r,e))}};(0,t._)([(0,i.MZ)({type:["BuildingSceneLayer"]})],d.prototype,"operationalLayerType",void 0),(0,t._)([(0,i.MZ)({readOnly:!0})],d.prototype,"allSublayers",void 0),(0,t._)([(0,i.MZ)(Ae)],d.prototype,"sublayers",void 0),(0,t._)([(0,T.w)("service","sublayers")],d.prototype,"readSublayers",null),(0,t._)([(0,i.MZ)({type:Fe,nonNullable:!0,json:{write:!0}})],d.prototype,"filters",void 0),(0,t._)([(0,i.MZ)({type:String,json:{write:!0}})],d.prototype,"activeFilterId",void 0),(0,t._)([(0,i.MZ)({readOnly:!0,type:be})],d.prototype,"summaryStatistics",void 0),(0,t._)([(0,T.w)("summaryStatistics",["statisticsHRef"])],d.prototype,"readSummaryStatistics",null),(0,t._)([(0,i.MZ)({type:[String],json:{read:!1}})],d.prototype,"outFields",void 0),(0,t._)([(0,i.MZ)(B.Fm)],d.prototype,"fullExtent",void 0),(0,t._)([(0,i.MZ)(B.fV)],d.prototype,"legendEnabled",void 0),(0,t._)([(0,i.MZ)({type:["show","hide","hide-children"]})],d.prototype,"listMode",void 0),(0,t._)([(0,i.MZ)((0,B.Qo)(ne.A))],d.prototype,"spatialReference",void 0),(0,t._)([(0,i.MZ)(B.Yj)],d.prototype,"elevationInfo",null),(0,t._)([(0,i.MZ)({json:{read:!1},readOnly:!0})],d.prototype,"type",void 0),(0,t._)([(0,i.MZ)()],d.prototype,"associatedFeatureServiceItem",void 0),d=(0,t._)([(0,u.$)("esri.layers.BuildingSceneLayer")],d);const nt=d}}]);