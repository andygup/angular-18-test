"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[3027],{78698:(ie,G,p)=>{p.d(G,{A:()=>N,J:()=>P});var S=p(1119);function P(E,Z){let B;if("string"==typeof E)B=(0,S.Wm)(E+`-seed(${Z})`);else{let C=12;B=E^Z;do{B=107*(B>>8^B)+C|0}while(0!=--C)}return(1+B/(1<<31))/2}function N(E){return Math.floor(P(E,z)*T)}const z=53290320,T=10},93027:(ie,G,p)=>{p.d(G,{o:()=>Ne});var S=p(10467),P=p(8137),N=p(16006),z=p(13494),T=p(58096),E=p(82870),Z=p(79184),B=p(76740),C=p(7610),ve=p(99046),ye=p(60797),J=p(67685),Y=p(76329),K=p(3672),I=p(83953),ae=p(88532),D=p(45475),X=p(31732),H=p(13682),oe=p(30365),k=p(53212),xe=p(21260),V=p(23855),j=p(84289);function le(o,e,r){return o[0]=e[0]-r[0],o[1]=e[1]-r[1],o}function he(o,e){return Math.sqrt(o*o+e*e)}function ce(o){const e=he(o[0],o[1]);o[0]/=e,o[1]/=e}function Me(o,e){return he(o[0]-e[0],o[1]-e[1])}function ue(o){return o.length-1}function _e(o,e,r=1){let[s,t]=function Pe(o,e){return o[e+1]}(o,e);return[s,t]=[Math.round(s),Math.round(t)],Math.sqrt(s*s+t*t)*r}class F{constructor(e,r,s,t,n){this._segments=e,this._index=r,this._distance=s,this._xStart=t,this._yStart=n,this._done=!1}static create(e){return new F(e,0,0,e[0][0],e[0][1])}clone(){return new F(this._segments,this._index,this._distance,this.xStart,this.yStart)}equals(e){return this._index===e._index||e._index===this._index-1&&(0===this._distance||1===e._distance)||e._index===this._index+1&&(1===this._distance||0===e._distance)}leq(e){return this._index<e._index||this._index===e._index&&this._distance<=e._distance}geq(e){return this._index>e._index||this._index===e._index&&this._distance>=e._distance}get _segment(){return this._segments[this._index+1]}get angle(){const e=this.dy;let s=Math.acos((0*e+-1*-this.dx)/(1*this.length));return e>0&&(s=2*Math.PI-s),s}get xStart(){return this._xStart}get yStart(){return this._yStart}get x(){return this.xStart+this.distance*this.dx}get y(){return this.yStart+this.distance*this.dy}get dx(){return this._segment[0]}get dy(){return this._segment[1]}get xMidpoint(){return this.xStart+.5*this.dx}get yMidpoint(){return this.yStart+.5*this.dy}get xEnd(){return this.xStart+this.dx}get yEnd(){return this.yStart+this.dy}get length(){const{dx:e,dy:r}=this;return Math.sqrt(e*e+r*r)}get remainingLength(){return this.length*(1-this._distance)}get backwardLength(){return this.length*this._distance}get distance(){return this._distance}get done(){return this._done}hasPrev(){return this._index-1>=0}hasNext(){return this._index+1<ue(this._segments)}next(){return this.hasNext()?(this._xStart+=this.dx,this._yStart+=this.dy,this._distance=0,this._index+=1,this):null}prev(){return this.hasPrev()?(this._index-=1,this._xStart-=this.dx,this._yStart-=this.dy,this._distance=1,this):(this._done=!0,null)}_seekBackwards(e,r){const s=this.backwardLength;if(e<=s)return this._distance=(s-e)/this.length,this;let t=this.backwardLength;for(;this.prev();){if(t+this.length>e)return this._seekBackwards(e-t);t+=this.length}return this._distance=0,r?this:null}seek(e,r=!1){if(e<0)return this._seekBackwards(Math.abs(e),r);if(e<=this.remainingLength)return this._distance=(this.backwardLength+e)/this.length,this;let s=this.remainingLength;for(;this.next();){if(s+this.length>e)return this.seek(e-s,r);s+=this.length}return this._distance=1,r?this:null}}function q(o,e,r,s=!0){const t=function de(o){let e=0;for(let r=0;r<ue(o);r++)e+=_e(o,r);return e}(o),n=F.create(o),i=t/2;if(!s)return n.seek(i),void(Math.abs(n.x)<j.s&&Math.abs(n.y)<j.s&&r(n.clone(),0,i+0*e,t));const c=Math.max((t-e)/2,0),h=Math.floor(c/e);n.seek(i-h*e);for(let l=-h;l<=h;l++)Math.abs(n.x)<j.s&&Math.abs(n.y)<j.s&&r(n.clone(),l,i+l*e,t),n.seek(e)}function te(o,e){const r=e;for(let s=0;s<o.length;s++){let t=o[s];Ie(t,r);const n=[];n.push(t[0]);for(let i=1;i<t.length;i++){const[c,h]=t[i-1],[d,l]=t[i];n.push([d-c,l-h])}o[s]=n,t=n}return o}function Ie(o,e){if(e<=0)return;const s=o.length;if(s<3)return;const t=[];let n=0;t.push(0);for(let a=1;a<s;a++)n+=Me(o[a],o[a-1]),t.push(n);e=Math.min(e,.2*n);const i=[];i.push(o[0][0]),i.push(o[0][1]);const c=o[s-1][0],h=o[s-1][1],d=le([0,0],o[0],o[1]);ce(d),o[0][0]+=e*d[0],o[0][1]+=e*d[1],le(d,o[s-1],o[s-2]),ce(d),o[s-1][0]+=e*d[0],o[s-1][1]+=e*d[1];for(let a=1;a<s;a++)t[a]+=e;t[s-1]+=e;const l=.5*e;for(let a=1;a<s-1;a++){let u=0,g=0,x=0;for(let m=a-1;m>=0&&!(t[m+1]<t[a]-l);m--){const f=l+t[m+1]-t[a],v=t[m+1]-t[m],y=t[a]-t[m]<l?1:f/v;if(Math.abs(y)<1e-6)break;const M=y*y,A=y*f-.5*M*v,b=y*v/e,_=o[m+1],L=o[m][0]-_[0],w=o[m][1]-_[1];u+=b/A*(_[0]*y*f+.5*M*(f*L-v*_[0])-M*y*v*L/3),g+=b/A*(_[1]*y*f+.5*M*(f*w-v*_[1])-M*y*v*w/3),x+=b}for(let m=a+1;m<s&&!(t[m-1]>t[a]+l);m++){const f=l-t[m-1]+t[a],v=t[m]-t[m-1],y=t[m]-t[a]<l?1:f/v;if(Math.abs(y)<1e-6)break;const M=y*y,A=y*f-.5*M*v,b=y*v/e,_=o[m-1],L=o[m][0]-_[0],w=o[m][1]-_[1];u+=b/A*(_[0]*y*f+.5*M*(f*L-v*_[0])-M*y*v*L/3),g+=b/A*(_[1]*y*f+.5*M*(f*w-v*_[1])-M*y*v*w/3),x+=b}i.push(u/x),i.push(g/x)}i.push(c),i.push(h);for(let a=0,u=0;a<s;a++)o[a][0]=i[u++],o[a][1]=i[u++]}var me=p(98522),R=p(3991);const be=(0,ye.Bj)(o=>{let e=0;if(0===o)return 1/0;for(;!(o%2);)e++,o/=2;return e});class we extends R.G8{constructor(){super(...arguments),this._zoomLevel=0}_write(e,r,s,t){if(this._zoomLevel=t||0,null!=s)throw new Error("InternalError: EffectGeometry not support for LabelMeshWriter");switch(r.geometryType){case"esriGeometryPoint":{const n=r.readXForDisplay(),i=r.readYForDisplay();return this._writePoint(e,n,i,r)}case"esriGeometryEnvelope":case"esriGeometryPolygon":case"esriGeometryMultipoint":{const n=r.readCentroidForDisplay();if(!n)return;const[i,c]=n.coords;return this._writePoint(e,i,c,r)}case"esriGeometryPolyline":this._writeLines(e,r)}}_writePoint(e,r,s,t){const n=this._getShaping();if(!n)return;let i=this._getPointReferenceBounds();i||(i={offsetX:0,offsetY:0,size:0});const c=n.boundsT,h=(0,oe.xy)(this.evaluatedMeshParams.horizontalAlignment),d=(0,oe.UD)(this.evaluatedMeshParams.verticalAlignment),l=this.evaluatedMeshParams.scaleInfo?.maxScale??0,a=this.evaluatedMeshParams.scaleInfo?.minScale??0,u=(0,k.Q4)(t.getDisplayId());e.metricStart(new V.f(u,r,s,h,d,l,a,i)),e.metricBoxWrite(c),this._writeGlyphs(e,t.getDisplayId(),r,s,n,0,i),e.metricEnd()}_getPointReferenceBounds(){if(!this._references)return null;for(const e of this._references){const r=e.getBoundsInfo();if(r)return r}return null}_writeLines(e,r){const{scaleInfo:s,verticalAlignment:t}=this.evaluatedMeshParams,n=this.evaluatedMeshParams.repeatLabelDistance||128,i=this._getShaping("middle");if(!i)return;const c=(d,l,a,u)=>this._placeSubdivGlyphs(d,l,a,u),h=(i.bounds.width+n)/2;this._current={out:e,id:r.getDisplayId(),shaping:i,zoomRange:(0,me.My)(s,this.getTileInfo()),referenceBounds:this._getPointReferenceBounds()||{offsetX:0,offsetY:0,size:0},offsetDirection:null},this._verticalPlacement="bottom"===t?"above":"top"===t?"below":null,this._verticalPlacement?this._writeAboveAndBelowAlong(r,c,h):this._writeCenterAlong(r,c,h)}_writeAboveAndBelowAlong(e,r,s){const{repeatLabel:t,fontSize:n}=this.evaluatedMeshParams,{shaping:i}=this._current,c=(0,J.Lz)(n),h=e.readGeometryForDisplay();if(!h)return;const d=new H.A;(0,X.kz)(d,h,!1,!1,"esriGeometryPolyline",1);const l=fe(new H.A,d,c),a=fe(new H.A,d,-c),u=(0,X.zv)(a,"esriGeometryPolyline",!1,!1),x=te((0,X.zv)(l,"esriGeometryPolyline",!1,!1).paths,i.bounds.width),m=te(u.paths,i.bounds.width);this._current.offsetDirection="above";for(const f of x)q(f,s,r,!!t);this._current.offsetDirection="below";for(const f of m)q(f,s,r,!!t)}_writeCenterAlong(e,r,s){const{repeatLabel:t}=this.evaluatedMeshParams,{shaping:n}=this._current,i=te(e.readLegacyGeometryForDisplay().paths,n.bounds.width);for(const c of i)q(c,s,r,!!t)}_placeSubdivGlyphs(e,r,s,t){const{allowOverrun:n,labelPosition:i,repeatLabelDistance:c}=this.evaluatedMeshParams,h=this._current.zoomRange[0],d=be(r),l=this._current.shaping.bounds.width/2,a=Math.sqrt(c||128)/2,u=Math.min(s,t-s),g=this._current.shaping.isMultiline?R.GJ:Math.log2(u/(a+l/2)),x=0===r?g:Math.min(d,g),m=Math.max(h,this._zoomLevel+1-x),f=this._zoomLevel-m,v=this._current.shaping.bounds.width/2*2**f;this._current.shaping.isMultiline?0===r&&this._placeStraight(e,m):n&&f<0?this._placeStraightAlong(e,h):"parallel"===i?this._placeStraightAlong(e,m):"curved"===i&&this._placeCurved(e,m,v)}_placeStraight(e,r){const{out:s,id:t,shaping:n,referenceBounds:i}=this._current,{x:c,y:h}=e,d=(0,k.Q4)(t);s.metricStart(new V.f(d,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),s.metricBoxWrite(n.boundsT);const u=e.angle*(180/Math.PI)%360,g=(e.angle*(180/Math.PI)+180)%360;this._writeGlyphs(s,t,c,h,n,0,i,{clipAngle:u,mapAligned:!0,isLineLabel:!0,minZoom:r}),this._writeGlyphs(s,t,c,h,n,0,i,{clipAngle:g,mapAligned:!0,isLineLabel:!0,minZoom:r}),s.metricEnd()}_placeCurved(e,r,s){const{out:t,id:n}=this._current,i=e.clone(),c=e.angle*(180/Math.PI)%360,h=(e.angle*(180/Math.PI)+180)%360,d=(0,k.Q4)(n);t.metricStart(new V.f(d,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||(this._placeFirst(i,r,1,c),this._placeBack(e,i,r,s,1,c),this._placeForward(e,i,r,s,1,c)),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||(this._placeFirst(i,r,0,h),this._placeBack(e,i,r,s,0,h),this._placeForward(e,i,r,s,0,h)),t.metricEnd()}_placeStraightAlong(e,r){const{out:s,id:t,shaping:n,zoomRange:i,referenceBounds:c}=this._current,{boxBorderLineColor:h,boxBackgroundColor:d}=this.evaluatedMeshParams,l=e.clone(),a=e.angle*(180/Math.PI)%360,u=(e.angle*(180/Math.PI)+180)%360;if(n.glyphs.length>0&&(h||d)){const f=Math.max(r,i[0],0),v=Math.min(R.GJ,i[1]),y=(0,Y.$0)((0,K.vt)(),-e.angle),M={minZoom:f,maxZoom:v,clipAngle:a,mapAligned:!0,isLineLabel:!0},A=(0,J.Lz)(this.evaluatedMeshParams.offsetX),b=(0,J.Lz)(this.evaluatedMeshParams.offsetY);if(!this._verticalPlacement||this._verticalPlacement===this._current.offsetDirection){const _=(0,ae.fA)(A,-1*b),[L,w]=n.shapeBackground((0,Y.Tl)((0,K.vt)(),y,_));s.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding);const O=2*Math.max(L.width,L.height);s.recordBounds(e.x+L.x,e.y+L.y,O,O),this._writeTextBox(s,t,e.x,e.y,w,c,M),s.recordEnd()}if(!this._verticalPlacement||this._verticalPlacement!==this._current.offsetDirection){const _=(0,ae.fA)(A,b),[L,w]=n.shapeBackground((0,Y.Tl)((0,K.vt)(),y,_));M.clipAngle=u,s.recordStart(this.instanceId,this.attributeLayout,n.glyphs[0].textureBinding);const O=2*Math.max(L.width,L.height);s.recordBounds(e.x+L.x,e.y+L.y,O,O),this._writeTextBox(s,t,e.x,e.y,w,c,M),s.recordEnd()}}const g=(0,k.Q4)(t);s.metricStart(new V.f(g,e.x,e.y,0,0,this.evaluatedMeshParams.scaleInfo?.maxScale??0,this.evaluatedMeshParams.scaleInfo?.minScale??0,null)),this._verticalPlacement&&this._verticalPlacement!==this._current.offsetDirection||this._placeFirst(l,r,1,a,!0),this._verticalPlacement&&this._verticalPlacement===this._current.offsetDirection||this._placeFirst(l,r,0,u,!0),s.metricEnd()}_placeBack(e,r,s,t,n,i){const c=e.clone();let h=e.backwardLength+0;for(;c.prev()&&!(h>=t);)this._placeOnSegment(c,r,h,s,-1,n,i),h+=c.length+0}_placeForward(e,r,s,t,n,i){const c=e.clone();let h=e.remainingLength+0;for(;c.next()&&!(h>=t);)this._placeOnSegment(c,r,h,s,1,n,i),h+=c.length+0}_placeFirst(e,r,s,t,n=!1){const{out:i,id:c,shaping:h,zoomRange:d,referenceBounds:l}=this._current,a=h.glyphs;for(const u of a){const g=u.x>h.bounds.x?s:1-s,x=g*e.remainingLength+(1-g)*e.backwardLength,m=Math.abs(u.x+u.width/2-h.bounds.x),f=Math.max(0,this._zoomLevel+Math.log2(m/(x+0))),v=Math.max(r,n?0:f);u.maxZoom=Math.min(d[1],R.GJ),u.angle=e.angle+(1-s)*Math.PI,u.minZoom=Math.max(d[0],v),this._writeLineGlyph(i,c,e.x,e.y,h.bounds,u,t,l,!0),s&&this._isVisible(u.minZoom,u.maxZoom)&&i.metricBoxWrite(u.bounds)}}_placeOnSegment(e,r,s,t,n,i,c){const{out:h,id:d,shaping:l,referenceBounds:a}=this._current,u=l.glyphs,m={x:e.x+s*-n*(e.dx/e.length),y:e.y+s*-n*(e.dy/e.length)};for(const f of u){const v=f.x>l.bounds.x?i:1-i;if(!(v&&1===n||!v&&-1===n))continue;const y=Math.abs(f.x+f.width/2-l.bounds.x),M=Math.max(0,this._zoomLevel+Math.log2(y/s)-.1),A=Math.max(t,this._zoomLevel+Math.log2(y/(s+e.length+0)));if(0!==M&&(f.angle=e.angle+(1-i)*Math.PI,f.minZoom=A,f.maxZoom=M,this._writeLineGlyph(h,d,m.x,m.y,l.bounds,f,c,a,!0),i&&this._isVisible(f.minZoom,f.maxZoom))){const b=f.bounds,w=new xe.A(b.center[0]+(e.x-r.x),b.center[1]+(e.y-r.y),b.width,b.height);h.metricBoxWrite(w)}}}_writeLineGlyph(e,r,s,t,n,i,c,h,d){const l=s+n.x,a=t+n.y,u=2*(this.evaluatedMeshParams.minPixelBuffer?this.evaluatedMeshParams.minPixelBuffer/this._textMeshTransformProps.fontSize:1),g=Math.max(n.width,n.height)*u;e.recordStart(this.instanceId,this.attributeLayout,i.textureBinding),e.recordBounds(l,a,g,g);const{texcoords:x,offsets:m}=i;this._writeQuad(e,r,s,t,{texcoords:x,offsets:m,fontSize:this._textMeshTransformProps.fontSize,color:(0,me.Jb)(this.evaluatedMeshParams.color),isBackground:!1,referenceBounds:h,minZoom:Math.max(this._current.zoomRange[0],i.minZoom),maxZoom:Math.min(this._current.zoomRange[1],i.maxZoom),clipAngle:c,mapAligned:d,isLineLabel:!0}),e.recordEnd()}_isVisible(e,r){const s=this._zoomLevel;return e<=s&&s<=r}}function fe(o,e,r){const{coords:s,lengths:t}=e,n=(0,D.vt)(),i=(0,D.vt)(),c=(0,D.vt)(),h=(0,D.vt)(),d=(0,D.vt)(),l=(0,D.vt)();let u=0;for(let g=0;g<t.length;g++){const x=t[g];for(let m=0;m<x;m++){const f=2*(m+u-1),v=2*(m+u),y=2*(m+u+1);m>0?(0,I.hZ)(n,s[f],s[f+1]):(0,I.hZ)(n,0,0),(0,I.hZ)(i,s[v],s[v+1]),m<x-1?(0,I.hZ)(c,s[y],s[y+1]):(0,I.hZ)(c,0,0),0===m?(0,I.hZ)(h,0,0):((0,I.jb)(h,i,n),(0,I.S8)(h,h),(0,I.hZ)(h,h[1],-h[0])),m===x-1?(0,I.hZ)(d,0,0):((0,I.jb)(d,c,i),(0,I.S8)(d,d),(0,I.hZ)(d,d[1],-d[0])),(0,I.WQ)(l,h,d),(0,I.S8)(l,l);const M=l[0]*d[0]+l[1]*d[1];0!==M&&(0,I.hs)(l,l,M),(0,I.hs)(l,l,r),o.coords.push(i[0]+l[0],i[1]+l[1])}o.lengths.push(x),u+=x}return o}var Se=p(26248),Ae=p(26689),ze=p(37121),Q=p(89952),Ee=p(5922),Be=p(77806),De=p(35150),We=p(78698),Ge=p(1416),Te=p(9908);function $(o,e){return se.apply(this,arguments)}function se(){return(se=(0,S.A)(function*(o,e,r=!1){const{defaultValue:s,valueExpressionInfo:t,value:n}=e;if(t){const{expression:i}=t,c=yield o.createComputedField({expression:i},r);return c?{...e,computed:c,defaultValue:s}:null}return{...e,computed:new Te.G(n),defaultValue:s}})).apply(this,arguments)}function pe(o,e){return re.apply(this,arguments)}function re(){return(re=(0,S.A)(function*(o,e){const{defaultValue:r,valueExpressionInfo:s}=e,{expression:t}=s,n=yield o.createComputedField({expression:t});return n?{...e,computed:n,defaultValue:r}:null})).apply(this,arguments)}const ge=o=>"boolean"!=typeof o&&"number"!=typeof o&&"valueExpressionInfo"in o;class ne{static create(e,r,s){return(0,S.A)(function*(){const t={},n=new Map,i=new Map,c=new Map,h=new Map,d=new Map;for(const l in s){const a=s[l];if(null!=a&&"object"==typeof a)if(Array.isArray(a)){if("object"==typeof a[0])throw new Error(`InternalError: Cannot handle ${l}. Nested array params are not supported`);t[l]=a}else if("valueExpressionInfo"in a){if(a.value){t[l]=a.value;continue}const u=yield pe(e,a);if(!u){t[l]=a.defaultValue;continue}n.set(l,u),t[l]=null}else switch(a.type){case"cim-effect-infos":if(a.effectInfos.some(u=>u.overrides.length)){i.set(l,{effects:yield Promise.all(a.effectInfos.map(function(){var u=(0,S.A)(function*(g){const x=g.overrides.map(m=>$(e,m));return{effect:g.effect,compiledOverrides:(yield Promise.all(x)).filter(Q.Ru)}});return function(g){return u.apply(this,arguments)}}()))});break}t[l]=a.effectInfos.map(u=>u.effect);break;case"cim-marker-placement-param":a.overrides.length&&c.set(l,{placementInfo:a,compiledOverrides:(yield Promise.all(a.overrides.map(u=>$(e,u)))).filter(Q.Ru)}),t[l]=a.placement;break;case"text-rasterization-param":{if(a.overrides.length){const g=a.overrides.map(x=>$(e,x,a.useLegacyLabelEvaluationRules));h.set(l,{compiledOverrides:(yield Promise.all(g)).filter(Q.Ru),rasterizationParam:a,objectIdToResourceId:new Map});continue}const u={type:"cim-rasterization-info",resource:a.resource};t[l]=(yield r.fetchResourceImmediate(u))??null;break}case"sprite-rasterization-param":{if(a.overrides.length){const g=a.overrides.map(x=>$(e,x));h.set(l,{compiledOverrides:(yield Promise.all(g)).filter(Q.Ru),rasterizationParam:a,objectIdToResourceId:new Map});continue}if("animated"===a.resource.type){h.set(l,{compiledOverrides:[],rasterizationParam:a,objectIdToResourceId:new Map});continue}const u={type:"cim-rasterization-info",resource:a.resource};t[l]=(yield r.fetchResourceImmediate(u))??null;break}case"cim-marker-transform-param":{const{params:u}=a;if(u.some(e=>{for(const r in e)if(ge(e[r]))return!0;return!1})){const g={compiledMarkerInfos:[]};yield Promise.all(u.map(function(){var x=(0,S.A)(function*(m){const f={props:{}};for(const v in m)if(ge(m[v])){const y=yield pe(e,m[v]);f.compiledExpressionMap||(f.compiledExpressionMap=new Map),y&&f.compiledExpressionMap.set(v,y)}else f.props[v]=m[v];g.compiledMarkerInfos.push(f)});return function(m){return x.apply(this,arguments)}}())),d.set(l,g)}else t[l]={type:"cim-marker-transform-info",infos:u};break}default:t[l]=a}else t[l]=a}return new ne(s,t,n,i,c,h,d)})()}constructor(e,r,s,t,n,i,c){this.inputMeshParams=e,this._resolvedMeshParams=r,this._dynamicProperties=s,this._dynamicEffectProperties=t,this._dynamicPlacementProperties=n,this._dynamicAsyncProperties=i,this._dynamicTransformProperties=c,this.evaluator=h=>h}get hasDynamicProperties(){return!!(this._dynamicProperties.size||this._dynamicAsyncProperties.size||this._dynamicEffectProperties.size||this._dynamicTransformProperties.size||this._dynamicPlacementProperties.size)}get evaluatedMeshParams(){return this._evaluatedMeshParams||(this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams)),this._evaluatedMeshParams}enqueueRequest(e,r,s){for(const t of this._dynamicAsyncProperties.values()){const n=(0,Be.o8)(t.rasterizationParam.resource);"animated"===t.rasterizationParam.resource.type&&t.rasterizationParam.resource.randomizeStartTime&&(n.primitiveName="__RESERVED__PRIMITIVE__NAME__",n.startGroup=(0,We.A)(r.getObjectId()||0));for(const{primitiveName:c,propertyName:h,computed:d,defaultValue:l,valueExpressionInfo:a}of t.compiledOverrides)try{(0,Ge.Ph)(n,"animated"===t.rasterizationParam.resource.type?n.primitiveName:c,h,d,r,s,l)}catch(u){De.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.techniques.mesh.MeshWriterInputEvaluator").errorOnce(new Ee.A("invalid-arcade-expression",`Encountered an error when evaluating the arcade expression '${a?.expression}' (primitive: '${c}', property: '${h}')`,u))}const i=e.enqueueRequest({type:"cim-rasterization-info",resource:n});t.objectIdToResourceId.set(r.getObjectId(),i)}}evaluateMeshParams(e,r,s){for(const[t,n]of this._dynamicProperties.entries())this._resolvedMeshParams[t]=n.computed.readWithDefault(r,s,n.defaultValue);for(const[t,n]of this._dynamicPlacementProperties.entries())for(const{computed:i,defaultValue:c,propertyName:h}of n.compiledOverrides){const d=i.readWithDefault(r,s,c);n.placementInfo.placement[h]=d,this._resolvedMeshParams[t]=n.placementInfo.placement}for(const[t,n]of this._dynamicEffectProperties.entries())for(const i of n.effects){for(const{computed:c,defaultValue:h,propertyName:d}of i.compiledOverrides){const l=c.readWithDefault(r,s,h);i.effect[d]=l}this._resolvedMeshParams[t]=n.effects.map(c=>c.effect)}for(const[t,n]of this._dynamicTransformProperties.entries()){const i={type:"cim-marker-transform-info",infos:[]};for(const c of n.compiledMarkerInfos){const h={...c.props};if(c.compiledExpressionMap)for(const[d,l]of c.compiledExpressionMap){const a=l.computed.readWithDefault(r,s,l.defaultValue);h[d]="number"==typeof a||"boolean"==typeof a?a:l.defaultValue}i.infos.push(h)}this._resolvedMeshParams[t]=i}for(const[t,n]of this._dynamicAsyncProperties.entries()){const i=n.objectIdToResourceId.get(r.getObjectId());if(null==i)continue;const c=e.getResource(i);this._resolvedMeshParams[t]=c}return this._evaluatedMeshParams=this.evaluator(this._resolvedMeshParams),this.evaluatedMeshParams}}var Oe=p(8052);class Ne{createMeshWriter(e,r,s,t){var n=this;return(0,S.A)(function*(){const i=n._getMeshWriter(t.techniqueType),c=yield ne.create(e,r,t.inputParams),h=new i(t.id,c,t.optionalAttributes,s);return yield h.loadDependencies(),h})()}_getMeshWriter(e){switch(e){case P.N.Fill:return E.Y;case P.N.DotDensity:return N.k;case P.N.ComplexFill:return z.KE;case P.N.PatternFill:return B.m;case P.N.OutlineFill:return Z.w0;case P.N.PatternOutlineFill:return C.Q;case P.N.ComplexOutlineFill:return T.O;case P.N.Marker:return ze.H;case P.N.PieChart:return Oe.v;case P.N.Text:return R.G8;case P.N.Line:return Se.Bw;case P.N.TexturedLine:return Ae.K;case P.N.Heatmap:return ve.h;case P.N.Label:return we;case P.N.Test:throw new Error("Internal Error: Found invalid mesh writer")}}}},9908:(ie,G,p)=>{p.d(G,{G:()=>P});var S=p(32197);class P extends S.L{constructor(z){super(),this._value=z}resize(z){}read(z,T){return this._value}readWithDefault(z,T,E){return this._value}referencesScale(){return!1}referencesGeometry(){return!1}}}}]);