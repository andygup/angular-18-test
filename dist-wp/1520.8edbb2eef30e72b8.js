"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[1520],{29459:(N,_,t)=>{t.d(_,{e:()=>nt});var a,e=t(8189),P=t(31178),D=t(5605),C=t(5922),l=t(48900),n=t(85211),u=(t(3248),t(35150),t(40707),t(76576)),R=t(88766),U=t(60746),S=t(66727);let O=a=class extends S.A{constructor(b){super(b),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new a({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,e._)([(0,n.MZ)({type:[Number,String],json:{write:!0}})],O.prototype,"left",void 0),(0,e._)([(0,n.MZ)({type:[Number,String],json:{write:!0}})],O.prototype,"right",void 0),(0,e._)([(0,n.MZ)({type:[Number,String],json:{write:!0}})],O.prototype,"top",void 0),(0,e._)([(0,n.MZ)({type:[Number,String],json:{write:!0}})],O.prototype,"bottom",void 0),O=a=(0,e._)([(0,u.$)("esri.views.layers.support.ClipRect")],O);const h=O;var T=t(75644);let j=class extends S.A{constructor(b){super(b),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,e._)([(0,n.MZ)({type:[[[Number]]],json:{write:!0}})],j.prototype,"path",void 0),j=(0,e._)([(0,u.$)("esri.views.layers.support.Path")],j);const z=j;var rt=t(6558);const I=P.A.ofType({key:"type",base:null,typeMap:{rect:h,path:z,geometry:T.A}}),nt=b=>{let m=class extends b{constructor(){super(...arguments),this.attached=!1,this.clips=new I,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const p=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&p&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new C.A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new R.m),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,l.wB)(()=>this.suspended,E=>{this.container&&(this.container.visible=!E)},l.pc),(0,l.wB)(()=>this.updateSuspended,E=>{this.view&&!E&&this.updateRequested&&this.view.requestUpdate()},l.pc),(0,l.wB)(()=>this.layer?.opacity??1,E=>{this.container&&(this.container.opacity=E)},l.pc),(0,l.wB)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",E=>{this.container&&(this.container.blendMode=E)},l.pc),(0,l.wB)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,E=>{this.container&&(this.container.effect=E)},l.pc),(0,l.wB)(()=>this.highlightOptions,E=>this.container.highlightOptions=E,l.pc),(0,l.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},l.pc),(0,l.wB)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:E,scaleRange:ot})=>{const Y=(0,rt.E5)(ot,E);Y!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=Y)},l.pc)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(E=>{E===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const p=this.view?.spatialReference;return null==p||this.supportsSpatialReference(p)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(p){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",p),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(p))):this.updateRequested=!1}hitTest(p,w){return Promise.resolve(null)}supportsSpatialReference(p){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const p=super.getSuspendInfo(),w=!this.spatialReferenceSupported;return w&&(p.spatialReferenceNotSupported=w),p}addAttachHandles(p){this.addHandles(p,"attach")}};return(0,e._)([(0,n.MZ)()],m.prototype,"attached",void 0),(0,e._)([(0,n.MZ)({type:I,set(p){const w=(0,D.V)(p,this._get("clips"),I);this._set("clips",w)}})],m.prototype,"clips",void 0),(0,e._)([(0,n.MZ)()],m.prototype,"container",void 0),(0,e._)([(0,n.MZ)({type:U.A})],m.prototype,"highlightOptions",void 0),(0,e._)([(0,n.MZ)()],m.prototype,"moving",void 0),(0,e._)([(0,n.MZ)({readOnly:!0})],m.prototype,"spatialReferenceSupported",null),(0,e._)([(0,n.MZ)({readOnly:!0})],m.prototype,"updateParameters",void 0),(0,e._)([(0,n.MZ)()],m.prototype,"updateRequested",void 0),(0,e._)([(0,n.MZ)()],m.prototype,"updating",null),(0,e._)([(0,n.MZ)()],m.prototype,"view",void 0),(0,e._)([(0,n.MZ)()],m.prototype,"_visibleAtCurrentScale",void 0),(0,e._)([(0,n.MZ)({readOnly:!0})],m.prototype,"visibleAtCurrentScale",null),m=(0,e._)([(0,u.$)("esri.views.2d.layers.LayerView2D")],m),m}},81520:(N,_,t)=>{t.r(_),t.d(_,{default:()=>gt});var e=t(10467),P=t(8189),D=t(68677),C=t(81098),n=(t(47280),t(11432)),g=t(48900),o=t(85211),U=(t(3248),t(35150),t(40707),t(76576)),S=t(36819),a=t(43470),O=t(9096),T=(t(21152),t(40611)),j=t(86807),z=t(67685),rt=t(45475),I=t(11817),nt=t(63888),b=t(75644),m=t(32788),p=t(50915),w=t(26136),E=t(4931),ot=t(45513),Y=t(55861),at=t(1749);class ct extends nt.q{constructor(s){super(),this.element=s,this._handles=new j.A,this.isWrapAround=!1,this.perspectiveTransform=(0,rt.vt)(),this.wrapAroundShift=0,this.clipGeometry=null,this._handles.add((0,g.z7)(()=>this.element,()=>{const r=this.element;this.ready(),r&&this._handles.add((0,T.on)(r,"play",()=>this.requestRender()))},g.Vh))}getMesh(s){throw new Error("Method not implemented.")}destroy(){this._handles.destroy(),this.texture=(0,n.WD)(this.texture),this._vao&&(this._vao.dispose(),this._vao=null),this._vbo&&(this._vbo.dispose(),this._vbo=null),this.texture&&(this.texture.dispose(),this.texture=null)}get textureSize(){if(!this.texture)return[1,1];const s=this.texture.descriptor;return[s.width,s.height]}get dvsMat3(){return this.parent.dvsMat3}beforeRender(s){const r=this.element;if(null==r)return;const{context:v}=s,{videoWidth:c,videoHeight:y}=r;if(0!==c&&0!==y){if(this.texture)r.paused||this.texture.setData(r);else{const f=new E.R;f.wrapMode=p.pF.CLAMP_TO_EDGE,f.preMultiplyAlpha=!0,f.width=c,f.height=y,this.texture=new w.g(v,f,r)}r.paused||(this.texture.generateMipmap(),this.requestRender()),super.beforeRender(s)}}_createTransforms(){return null}updateDrawCoords(s,r,v,c){const y=this.element,f=this._getFrameInfo();if(!y||!f)return;this._initializeData(s,f,v);const{controlPoints:A,horizon:L}=f,x=Math.sqrt(A.length),V=x,{x:M,y:G}=s,K=this._vertices,X=A[x-1],ft=A[(V-1)*x],Et=A[(V-1)*x+x-1],Q=(0,I.project)(L?L[0].mapPoint:A[0].mapPoint,v),q=(0,I.project)(L?L[1].mapPoint:X.mapPoint,v),H=(0,I.project)(ft.mapPoint,v),k=(0,I.project)(Et.mapPoint,v);this.clipGeometry=L?new b.A({geometry:Y.A.fromJSON({rings:[[[H.x,H.y],[k.x,k.y],[q.x,q.y],[Q.x,Q.y],[H.x,H.y]]],spatialReference:v})}):null;for(let B=0;B<A.length;B++){const et=A[B],{sourcePoint:st,mapPoint:it}=et;if(null==st||null==it)continue;const $=(0,I.project)(it,v);K[2*B+0]=$.x-M,K[2*B+1]=$.y-G}let tt=r;if(c){const B=Math.min(Q.x,q.x,H.x,k.x),et=Math.max(Q.x,q.x,H.x,k.x),{worldWidth:st,xBounds:it}=c,[$,pt]=it;B<$&&et>$?tt=st:et>pt&&B<pt&&(tt=-st)}this.wrapAroundShift=tt,this.isWrapAround=0!==tt}getVAO(s,r,v){if(null==this._vertices)return null;const c=this._vertices;if(this._vao)this._vbo.setData(c);else{this._vbo=m.g.createVertex(s,p._U.DYNAMIC_DRAW,c);const y=m.g.createVertex(s,p._U.STATIC_DRAW,this._texCoords);this._ibo=m.g.createIndex(s,p._U.DYNAMIC_DRAW,this._indices),this._vao=new ot.Z(s,v,r,{geometry:this._vbo,tex:y},this._ibo)}return this._vao}draw(s){s.drawElements(p.WR.TRIANGLE_STRIP,this._indices.length,s.gl.UNSIGNED_SHORT,0)}_initializeData(s,r,v){if(null!=this._vertices&&null!=this._indices)return;const{controlPoints:c}=r,y=Math.sqrt(c.length),f=y,A=new Float32Array(2*c.length),L=new Uint16Array(2*c.length);for(let M=0;M<c.length;M++){const G=c[M],{sourcePoint:K,mapPoint:J}=G;if(null==K||null==J)continue;const X=(0,I.project)(J,v);A[2*M+0]=X.x-s.x,A[2*M+1]=X.y-s.y,L[2*M+0]=K.x,L[2*M+1]=K.y}const x=new Uint16Array(f*y+(f-2)*(y+2));let V=0;for(let M=0;M<f;M++){for(let G=0;G<y;G++)x[V++]=M*y+G,x[V++]=(M+1)*y+G;M<f-2&&(x[V++]=(M+1)*y+(y-1),x[V++]=(M+1)*y)}this._vertices=A,this._texCoords=L,this._indices=x}_getFrameInfo(){if(!this.groundControlPoints)return null;const s=this._getFrameControlPoints(),r=this.frameHorizonPoints;let v=null;if(r){const f=r.endX,A=r.endY;v=[{sourcePoint:(0,z.tc)(r.startX,r.startY),mapPoint:new at.A(r.startLongitude,r.startLatitude)},{sourcePoint:(0,z.tc)(f,A),mapPoint:new at.A(r.endLongitude,r.endLatitude)}]}return{controlPoints:s,horizon:v}}_getFrameControlPoints(){const s=this.groundControlPoints,r=s?.length;if(!r)return[];const v=new Array(r);for(let c=0;c<r;c++){const{x:y,y:f,lat:A,lon:L}=s[c];v[c]={sourcePoint:(0,z.tc)(y,-f),mapPoint:new at.A(L,A)}}return v}}var dt=t(29459),yt=t(57052),ut=t(13031),mt=t(41474),vt=t(88521),lt=t(55417),ht=t(46602);const Z=new D.A([255,127,0]);let W=class extends((0,dt.e)(mt.A)){constructor(){super(...arguments),this._graphicsLayer=new S.A,this._frameOutlineGraphic=new C.A({symbol:new vt.A({outline:{type:"simple-line",color:Z}})}),this._sensorTrailGraphic=new C.A({symbol:new lt.A({color:Z})}),this._lineOfSightGraphic=new C.A({symbol:new lt.A({color:Z})}),this._sensorLocationGraphic=new C.A({symbol:new ht.A({color:Z})}),this._frameCenterGraphic=new C.A({symbol:new ht.A({color:Z})}),this._overlayContainer=null,this.layer=null,this.symbolColor=Z,this.visibleTelemetryElements=null}destroy(){this._graphicsLayer=(0,n.pR)(this._graphicsLayer)}initialize(){this.addHandles((0,g.wB)(()=>this.symbolColor,()=>{this._frameOutlineGraphic.symbol.outline.color=this.symbolColor,this._sensorTrailGraphic.symbol.color=this.symbolColor,this._lineOfSightGraphic.symbol.color=this.symbolColor,this._sensorLocationGraphic.symbol.color=this.symbolColor,this._frameCenterGraphic.symbol.color=this.symbolColor},g.Vh)),this._graphicsLayer.graphics.addMany([this._frameOutlineGraphic,this._sensorTrailGraphic,this._lineOfSightGraphic,this._sensorLocationGraphic,this._frameCenterGraphic]),this.visibleTelemetryElements=new a.A({frameCenter:this.layer.telemetryDisplay?.frameCenter??!0,frameOutline:this.layer.telemetryDisplay?.frameOutline??!0,lineOfSight:this.layer.telemetryDisplay?.lineOfSight??!0,sensorLocation:this.layer.telemetryDisplay?.sensorLocation??!0,sensorTrail:this.layer.telemetryDisplay?.sensorTrail??!0})}attach(){this._overlayContainer=new O.A,this.container.addChild(this._overlayContainer),this._addOverlayMultipoint(),this.graphicsView=new ut.A({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this._graphicsLayer.graphics,container:new yt.A(this.view.featuresTilingScheme)}),this.container.addChild(this.graphicsView.container),this.addAttachHandles(this._graphicsLayer.on("graphic-update",this.graphicsView.graphicUpdateHandler)),this.addAttachHandles([(0,g.wB)(()=>[this.layer.telemetryDisplay?.frameCenter,this.layer.telemetryDisplay?.frameOutline,this.layer.telemetryDisplay?.sensorLocation,this.layer.telemetryDisplay?.sensorTrail,this.layer.telemetryDisplay?.lineOfSight],()=>this._updateVisibleTelemetryElements(),g.Vh),(0,g.wB)(()=>[this.layer.telemetry,this.visibleTelemetryElements?.frameCenter,this.visibleTelemetryElements?.frameOutline,this.visibleTelemetryElements?.sensorLocation,this.visibleTelemetryElements?.sensorTrail,this.visibleTelemetryElements?.lineOfSight],()=>this._updateGraphicGeometries(),g.Vh)])}detach(){this._overlayContainer.removeAllChildren(),this.container.removeAllChildren(),this.graphicsView=(0,n.pR)(this.graphicsView)}supportsSpatialReference(d){return!0}moveEnd(){}viewChange(){this.graphicsView.viewChange()}update(d){this.graphicsView.processUpdate(d)}isUpdating(){return!this.graphicsView||this.graphicsView.updating}_updateVisibleTelemetryElements(){this.visibleTelemetryElements&&this.layer.telemetryDisplay&&(this.visibleTelemetryElements.frameCenter=this.layer.telemetryDisplay.frameCenter,this.visibleTelemetryElements.frameOutline=this.layer.telemetryDisplay.frameOutline,this.visibleTelemetryElements.lineOfSight=this.layer.telemetryDisplay.lineOfSight,this.visibleTelemetryElements.sensorLocation=this.layer.telemetryDisplay.sensorLocation,this.visibleTelemetryElements.sensorTrail=this.layer.telemetryDisplay.sensorTrail)}_updateGraphicGeometries(){const{telemetry:d}=this.layer,{visibleTelemetryElements:s}=this;d&&s&&(this._frameOutlineGraphic.geometry=s.frameOutline&&d.frameOutline?this.layer.telemetry.frameOutline:null,this._sensorTrailGraphic.geometry=s.sensorTrail&&d.sensorTrail?this.layer.telemetry.sensorTrail:null,this._lineOfSightGraphic.geometry=s.lineOfSight&&d.lineOfSight?this.layer.telemetry.lineOfSight:null,this._sensorLocationGraphic.geometry=s.sensorLocation&&d.sensorLocation?this.layer.telemetry.sensorLocation:null,this._frameCenterGraphic.geometry=s.frameCenter&&d.frameCenter?this.layer.telemetry.frameCenter:null)}_addOverlayMultipoint(){var d=this;return(0,e.A)(function*(){if(!d.layer.videoElement)return;const s=new ct(d.layer.videoElement);d.addAttachHandles([(0,g.wB)(()=>[d.layer.frameHorizonPoints,d.layer.groundControlPoints],()=>{s.frameHorizonPoints=d.layer.frameHorizonPoints,s.groundControlPoints=d.layer.groundControlPoints},g.Vh)]),d._overlayContainer.addChild(s),d.view.stage.requestRender()})()}};(0,P._)([(0,o.MZ)()],W.prototype,"graphicsView",void 0),(0,P._)([(0,o.MZ)()],W.prototype,"layer",void 0),(0,P._)([(0,o.MZ)()],W.prototype,"symbolColor",void 0),(0,P._)([(0,o.MZ)({type:a.A})],W.prototype,"visibleTelemetryElements",void 0),W=(0,P._)([(0,U.$)("esri.views.2d.layers.VideoLayerView2D")],W);const gt=W},41474:(N,_,t)=>{t.d(_,{A:()=>O});var e=t(8189),P=t(98877),D=t(42425),C=t(3046),l=t(35150),n=t(11432),g=t(64261),o=t(85211),R=(t(3248),t(40707),t(76576)),U=t(56985),S=t(6558);let a=class extends((0,C.sA)((0,g.g)(D.A.EventedMixin(P.A)))){constructor(h){super(h),this._updatingHandles=new U.U,this.layer=null,this.parent=null}initialize(){this.when().catch(h=>{if("layerview:create-error"!==h.name){const T=this.layer&&this.layer.id||"no id",j=this.layer?.title||"no title";l.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${j}', id: '${T}')`,h)}})}destroy(){this._updatingHandles=(0,n.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(h){this._overrideIfSome("visible",h)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const h=this.view.timeExtent,T=this.layer?.visibilityTimeExtent;return!h||!T||!h.intersection(T).isEmpty}canResume(){const h=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,S.g7)(h)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const h=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(h.viewNotReady=!0),this.layer&&this.layer.loaded||(h.layerNotLoaded=!0),(0,S.g7)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(h.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(h.outsideVisibilityTimeExtent=!0),this.visible||(h.layerInvisible=!0),h}isUpdating(){return!1}};(0,e._)([(0,o.MZ)()],a.prototype,"view",void 0),(0,e._)([(0,o.MZ)()],a.prototype,"fullOpacity",null),(0,e._)([(0,o.MZ)()],a.prototype,"layer",void 0),(0,e._)([(0,o.MZ)()],a.prototype,"parent",void 0),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"suspended",null),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"suspendInfo",null),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"legendEnabled",null),(0,e._)([(0,o.MZ)({type:Boolean,readOnly:!0})],a.prototype,"updating",null),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"updatingProgress",null),(0,e._)([(0,o.MZ)()],a.prototype,"updateSuspended",null),(0,e._)([(0,o.MZ)()],a.prototype,"visible",null),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"visibleAtCurrentScale",null),(0,e._)([(0,o.MZ)({readOnly:!0})],a.prototype,"visibleAtCurrentTimeExtent",null),a=(0,e._)([(0,R.$)("esri.views.layers.LayerView")],a);const O=a},66727:(N,_,t)=>{t.d(_,{A:()=>i});var e=t(8189),P=t(71065),D=t(85211),g=(t(3248),t(35150),t(40707),t(76576));let o=class extends P.oY{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,e._)([(0,D.MZ)({readOnly:!0})],o.prototype,"version",null),o=(0,e._)([(0,g.$)("esri.views.layers.support.ClipArea")],o);const i=o},75644:(N,_,t)=>{t.d(_,{A:()=>h});var S,e=t(8189),D=(t(21152),t(85211)),g=(t(3248),t(35150),t(40707),t(76576)),o=t(68643),i=t(61320),u=t(66727),R=t(28067),U=t(55861);const a={base:o.A,key:"type",typeMap:{extent:R.A,polygon:U.A}};let O=S=class extends u.A{constructor(T){super(T),this.type="geometry",this.geometry=null}clone(){return new S({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,e._)([(0,D.MZ)({types:a,json:{read:i.rS,write:!0}})],O.prototype,"geometry",void 0),O=S=(0,e._)([(0,g.$)("esri.views.layers.support.Geometry")],O);const h=O},6558:(N,_,t)=>{function e(i){return i&&"function"==typeof i.highlight}function C(i,u){if(u&&i){const{minScale:R,maxScale:U}=i;if(function l(i,u){return null!=i&&i>0||null!=u&&u>0}(R,U))return function D(i,u,R){return null==i||i>=R&&(0===u||i<=u)}(u,R,U)}return!0}function n(i){return!i?.minScale||!i.maxScale||i.minScale>=i.maxScale}t.d(_,{E5:()=>C,Of:()=>e,g7:()=>n})}}]);