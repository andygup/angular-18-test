"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[1812],{94268:(Qt,Mt,L)=>{L.d(Mt,{a:()=>Y,b:()=>ht,c:()=>jt,f:()=>ot,g:()=>Tt,j:()=>Zt,n:()=>$}),L(3248),L(35150);var Z=L(69287),lt=L(92771),X=L(28714),dt=L(25866),H=L(53781),at=L(89141),Q=L(85952),C=L(41510),gt=L(55703),K=L(99608),Et=L(19741);const Rt=jt();function jt(){return(0,at.vt)()}const rn=H.e,Lt=H.e;function Y(j,z){return(0,H.c)(z,j)}function ht(j){return j[3]}function Tt(j){return j}function ot(j,z,x,J){return(0,at.fA)(j,z,x,J)}function Nt(j,z,x){if(null==z||!ut(j,z,ct))return!1;let{t0:J,t1:y}=ct;if((J<0||y<J&&y>0)&&(J=y),J<0)return!1;if(x){const{origin:q,direction:vt}=z;x[0]=q[0]+vt[0]*J,x[1]=q[1]+vt[1]*J,x[2]=q[2]+vt[2]*J}return!0}const ct={t0:0,t1:0};function ut(j,z,x){const{origin:J,direction:y}=z,q=sn;q[0]=J[0]-j[0],q[1]=J[1]-j[1],q[2]=J[2]-j[2];const vt=y[0]*y[0]+y[1]*y[1]+y[2]*y[2];if(0===vt)return!1;const yt=2*(y[0]*q[0]+y[1]*q[1]+y[2]*q[2]),Kt=yt*yt-4*vt*(q[0]*q[0]+q[1]*q[1]+q[2]*q[2]-j[3]*j[3]);if(Kt<0)return!1;const Yt=Math.sqrt(Kt);return x.t0=(-yt-Yt)/(2*vt),x.t1=(-yt+Yt)/(2*vt),!0}const sn=(0,dt.vt)();function Zt(j,z){return Nt(j,z,null)}function en(j,z,x){const J=Et.rq.get(),y=Et.Rc.get();(0,X.b)(J,z.origin,z.direction);const q=ht(j);(0,X.b)(x,J,z.origin),(0,X.j)(x,x,1/(0,X.l)(x)*q);const vt=Ut(j,z.origin),yt=(0,K.g7)(z.origin,x);return(0,lt.$0)(y,yt+vt,J),(0,X.h)(x,x,y),x}function Dt(j,z,x){const J=(0,X.f)(Et.rq.get(),z,j),y=(0,X.j)(Et.rq.get(),J,j[3]/(0,X.l)(J));return(0,X.g)(x,y,j)}function Ut(j,z){const x=(0,X.f)(Et.rq.get(),z,j),J=(0,X.l)(x),y=ht(j),q=y+Math.abs(y-J);return(0,Z.XM)(y/q)}const xt=(0,dt.vt)();function Jt(j,z,x,J){const y=(0,X.f)(xt,z,j);switch(x){case C._.X:{const q=(0,Z.jU)(y,xt)[2];return(0,X.s)(J,-Math.sin(q),Math.cos(q),0)}case C._.Y:{const q=(0,Z.jU)(y,xt),vt=q[1],yt=q[2],Kt=Math.sin(vt);return(0,X.s)(J,-Kt*Math.cos(yt),-Kt*Math.sin(yt),Math.cos(vt))}case C._.Z:return(0,X.n)(J,y);default:return}}function kt(j,z){const x=(0,X.f)(qt,z,j);return(0,X.l)(x)-j[3]}function $(j,z){const x=(0,X.a)(j,z),J=ht(j);return x<=J*J}const qt=(0,dt.vt)(),dn=jt();Object.freeze(Object.defineProperty({__proto__:null,NullSphere:Rt,altitudeAt:kt,angleToSilhouette:Ut,axisAt:Jt,clear:function et(j){j[0]=j[1]=j[2]=j[3]=0},closestPoint:function $t(j,z,x){return Nt(j,z,x)?x:((0,gt.oC)(z,j,x),Dt(j,x,x))},closestPointOnSilhouette:en,containsPoint:$,copy:Y,create:jt,distanceToSilhouette:function Xt(j,z){const x=(0,X.f)(Et.rq.get(),z,j),J=(0,X.q)(x);return Math.sqrt(Math.abs(J-j[3]*j[3]))},elevate:function St(j,z,x){return j!==x&&(x[0]=j[0],x[1]=j[1],x[2]=j[2]),x[3]=j[3]+z,x},equals:Lt,exactEquals:rn,fromCenterAndRadius:function it(j,z){return(0,at.fA)(j[0],j[1],j[2],z)},fromRadius:function k(j,z){return j[0]=j[1]=j[2]=0,j[3]=z,j},fromValues:ot,getCenter:Tt,getRadius:ht,intersectLine:function Ft(j,z,x){const J=(0,gt.Cr)(z,x);if(!ut(j,J,ct))return[];const{origin:y,direction:q}=J,{t0:vt,t1:yt}=ct,Kt=Yt=>{const tn=(0,dt.vt)();return(0,X.u)(tn,y,q,Yt),Dt(j,tn,tn)};return Math.abs(vt-yt)<(0,Q.FD)()?[Kt(vt)]:[Kt(vt),Kt(yt)]},intersectRay:Nt,intersectRayClosestSilhouette:function hn(j,z,x){if(Nt(j,z,x))return x;const J=en(j,z,Et.rq.get());return(0,X.g)(x,z.origin,(0,X.j)(Et.rq.get(),z.direction,(0,X.r)(z.origin,J)/(0,X.l)(z.direction))),x},intersectsRay:Zt,projectPoint:Dt,setAltitudeAt:function zt(j,z,x,J){const y=kt(j,z),q=Jt(j,z,C._.Z,qt),vt=(0,X.j)(qt,q,x-y);return(0,X.g)(J,z,vt)},setExtent:function Pt(j,z,x){return j!==x&&Y(j,x),x},tmpSphere:dn,union:function mn(j,z,x=(0,at.vt)()){const J=(0,X.r)(j,z),y=j[3],q=z[3];return J+q<y?((0,H.c)(x,j),x):J+y<q?((0,H.c)(x,z),x):((0,X.o)(x,j,z,(J+q-y)/(2*J)),x[3]=(J+y+q)/2,x)},wrap:function D(j){return j}},Symbol.toStringTag,{value:"Module"}))},84149:(Qt,Mt,L)=>{L.d(Mt,{I:()=>st});var ft=L(64662);class st{constructor(X){this._allocator=X,this._items=[],this._itemsPtr=0,this._grow()}get(){return 0===this._itemsPtr&&(0,ft.d)(()=>this._reset()),this._itemsPtr===this._items.length&&this._grow(),this._items[this._itemsPtr++]}_reset(){const X=Math.min(3*Math.max(8,this._itemsPtr),this._itemsPtr+3*Z);this._items.length=Math.min(X,this._items.length),this._itemsPtr=0}_grow(){for(let X=0;X<Math.max(8,Math.min(this._items.length,Z));X++)this._items.push(this._allocator())}}const Z=1024},32954:(Qt,Mt,L)=>{function ft(){return[1,0,0,0,1,0,0,0,1]}function Z(H,at,Q,C,gt,K,Et,Rt,jt){return[H,at,Q,C,gt,K,Et,Rt,jt]}L.d(Mt,{fA:()=>Z,vt:()=>ft,zK:()=>X});const X=[1,0,0,0,1,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:X,clone:function st(H){return[H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8]]},create:ft,createView:function lt(H,at){return new Float64Array(H,at,9)},fromValues:Z},Symbol.toStringTag,{value:"Module"}))},62789:(Qt,Mt,L)=>{function ft(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function st(H){return[H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13],H[14],H[15]]}L.d(Mt,{o8:()=>st,vt:()=>ft,zK:()=>X});const X=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:X,clone:st,create:ft,createView:function lt(H,at){return new Float64Array(H,at,16)},fromValues:function Z(H,at,Q,C,gt,K,Et,Rt,jt,rn,Lt,Y,it,D,et,k){return[H,at,Q,C,gt,K,Et,Rt,jt,rn,Lt,Y,it,D,et,k]}},Symbol.toStringTag,{value:"Module"}))},14214:(Qt,Mt,L)=>{function ft(){return[0,0,0,1]}function st(H){return[H[0],H[1],H[2],H[3]]}L.d(Mt,{o8:()=>st,vt:()=>ft,zK:()=>X});const X=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:X,clone:st,create:ft,createView:function lt(H,at){return new Float64Array(H,at,4)},fromValues:function Z(H,at,Q,C){return[H,at,Q,C]}},Symbol.toStringTag,{value:"Module"}))},71548:(Qt,Mt,L)=>{L.d(Mt,{Cr:()=>C,_I:()=>K,vt:()=>dt});var ft=L(69287),st=L(84149),Z=L(28714),lt=L(25866),X=L(19741);function dt(D){return D?{origin:(0,lt.o8)(D.origin),vector:(0,lt.o8)(D.vector)}:{origin:(0,lt.vt)(),vector:(0,lt.vt)()}}function C(D,et,k=dt()){return(0,Z.c)(k.origin,D),(0,Z.f)(k.vector,et,D),k}function K(D,et,k){return function Rt(D,et,k,ht,Tt){const{vector:ot,origin:St}=D,Pt=(0,Z.f)(X.rq.get(),et,St),Nt=(0,Z.m)(ot,Pt)/(0,Z.q)(ot);return(0,Z.j)(Tt,ot,(0,ft.qE)(Nt,k,ht)),(0,Z.g)(Tt,Tt,D.origin)}(D,et,0,1,k)}(0,lt.vt)(),(0,lt.vt)(),new st.I(()=>dt())},22515:(Qt,Mt,L)=>{L.d(Mt,{vt:()=>St,lU:()=>$t,Qj:()=>ut}),L(69287);var st=L(28714),Z=L(25866);function St(A=cn){return[A[0],A[1],A[2],A[3]]}function ut(A){return A}function $t(A,p,b,S=0,U=Math.floor(b*(1/3)),rt=Math.floor(b*(2/3))){if(b<3)return!1;p(Ut,S);let tt=U,Ot=!1;for(;tt<b-1&&!Ot;)p(xt,tt),tt++,Ot=!(0,st.e)(Ut,xt);if(!Ot)return!1;for(tt=Math.max(tt,rt),Ot=!1;tt<b&&!Ot;)p(Jt,tt),tt++,(0,st.f)(kt,Ut,xt),(0,st.n)(kt,kt),(0,st.f)(zt,xt,Jt),(0,st.n)(zt,zt),Ot=!(0,st.e)(Ut,Jt)&&!(0,st.e)(xt,Jt)&&Math.abs((0,st.m)(kt,zt))<Xt;return Ot?(function en(A,p,b,S=St()){const U=b[0]-p[0],rt=b[1]-p[1],tt=b[2]-p[2],Ot=A[0]-p[0],It=A[1]-p[1],wt=A[2]-p[2],Wt=rt*wt-tt*It,bt=tt*Ot-U*wt,pt=U*It-rt*Ot,At=Wt*Wt+bt*bt+pt*pt,Ht=Math.abs(At-1)>1e-5&&At>1e-12?1/Math.sqrt(At):1;S[0]=Wt*Ht,S[1]=bt*Ht,S[2]=pt*Ht,S[3]=-(S[0]*A[0]+S[1]*A[1]+S[2]*A[2])}(Ut,xt,Jt,A),!0):(0!==S||1!==U||2!==rt)&&$t(A,p,b,0,1,2)}L(53781),L(99608),L(19741),(0,Z.vt)(),(0,Z.vt)(),(0,Z.vt)(),(0,Z.vt)(),(0,Z.vt)();const Xt=.99619469809,Ut=(0,Z.vt)(),xt=(0,Z.vt)(),Jt=(0,Z.vt)(),kt=(0,Z.vt)(),zt=(0,Z.vt)(),cn=[0,0,1,0];var Vt,A;(A=Vt||(Vt={}))[A.NONE=0]="NONE",A[A.CLAMP=1]="CLAMP",A[A.INFINITE_MIN=4]="INFINITE_MIN",A[A.INFINITE_MAX=8]="INFINITE_MAX"},55703:(Qt,Mt,L)=>{L.d(Mt,{Cr:()=>gt,LV:()=>Q,fA:()=>K,oC:()=>Rt,vt:()=>dt}),L(89952);var st=L(84149),Z=L(28714),lt=L(25866);function dt(Y){return Y?H((0,lt.o8)(Y.origin),(0,lt.o8)(Y.direction)):H((0,lt.vt)(),(0,lt.vt)())}function H(Y,it){return{origin:Y,direction:it}}function Q(Y,it){const D=rn.get();return D.origin=Y,D.direction=it,D}function gt(Y,it,D=dt()){return(0,Z.c)(D.origin,Y),(0,Z.f)(D.direction,it,Y),D}function K(Y,it,D=dt()){return(0,Z.c)(D.origin,Y),(0,Z.c)(D.direction,it),D}function Rt(Y,it,D){const et=(0,Z.m)(Y.direction,(0,Z.f)(D,it,Y.origin));return(0,Z.g)(D,Y.origin,(0,Z.j)(D,Y.direction,et)),D}L(19741);const rn=new st.I(()=>dt());(0,lt.vt)()},99608:(Qt,Mt,L)=>{L.d(Mt,{g7:()=>dt});var ft=L(69287),st=L(28714),Z=L(25866);function dt(C,gt){const K=(0,st.m)(C,gt)/((0,st.l)(C)*(0,st.l)(gt));return-(0,ft.XM)(K)}(0,Z.vt)(),(0,Z.vt)()},19741:(Qt,Mt,L)=>{L.d(Mt,{Rc:()=>Rt,J8:()=>jt,rq:()=>gt}),L(3248);var st=L(64662),Z=L(32954),lt=L(62789),X=L(14214),dt=L(45475),H=L(25866),at=L(89141);class Q{constructor(Lt){this._create=Lt,this._items=new Array,this._itemsPtr=0}get(){return 0===this._itemsPtr&&(0,st.d)(()=>this._reset()),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const Lt=2*this._itemsPtr;this._items.length>Lt&&(this._items.length=Lt),this._itemsPtr=0}static createVec2f64(){return new Q(dt.vt)}static createVec3f64(){return new Q(H.vt)}static createVec4f64(){return new Q(at.vt)}static createMat3f64(){return new Q(Z.vt)}static createMat4f64(){return new Q(lt.vt)}static createQuatf64(){return new Q(X.vt)}get test(){}}Q.createVec2f64();const gt=Q.createVec3f64(),Rt=(Q.createVec4f64(),Q.createMat3f64(),Q.createMat4f64()),jt=Q.createQuatf64()},31812:(Qt,Mt,L)=>{L.r(Mt),L.d(Mt,{default:()=>Nn});var zt,$,v,ft=L(10467),st=L(8189),Z=L(56492),at=(L(35150),L(3248),L(40707),L(5922),L(76576)),Q=L(28714),C=L(25866),gt=L(71548),K=L(94268),Et=L(61591),Rt=L(12438),jt=L(84149),Y=(L(92771),L(53781),L(89141)),it=L(55703);function D(v){return v?{ray:(0,it.vt)(v.ray),c0:v.c0,c1:v.c1}:{ray:(0,it.vt)(),c0:0,c1:Number.MAX_VALUE}}function Dt(v,l){for(let T=0;T<qt;T++){const E=v[T];if(E[0]*l[0]+E[1]*l[1]+E[2]*l[2]+E[3]>=l[3])return!1}return!0}new jt.I(()=>D()),L(22515),L(19741),(v=zt||(zt={}))[v.LEFT=0]="LEFT",v[v.RIGHT=1]="RIGHT",v[v.BOTTOM=2]="BOTTOM",v[v.TOP=3]="TOP",v[v.NEAR=4]="NEAR",v[v.FAR=5]="FAR",function(v){v[v.NEAR_BOTTOM_LEFT=0]="NEAR_BOTTOM_LEFT",v[v.NEAR_BOTTOM_RIGHT=1]="NEAR_BOTTOM_RIGHT",v[v.NEAR_TOP_RIGHT=2]="NEAR_TOP_RIGHT",v[v.NEAR_TOP_LEFT=3]="NEAR_TOP_LEFT",v[v.FAR_BOTTOM_LEFT=4]="FAR_BOTTOM_LEFT",v[v.FAR_BOTTOM_RIGHT=5]="FAR_BOTTOM_RIGHT",v[v.FAR_TOP_RIGHT=6]="FAR_TOP_RIGHT",v[v.FAR_TOP_LEFT=7]="FAR_TOP_LEFT"}($||($={}));const qt=6;(0,Y.fA)(-1,-1,-1,1),(0,Y.fA)(1,-1,-1,1),(0,Y.fA)(1,1,-1,1),(0,Y.fA)(-1,1,-1,1),(0,Y.fA)(-1,-1,1,1),(0,Y.fA)(1,-1,1,1),(0,Y.fA)(1,1,1,1),(0,Y.fA)(-1,1,1,1),new jt.I(D),function Zt(){(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)(),(0,C.vt)()}();var x=L(65388);class J{get bounds(){return this._root.bounds}get halfSize(){return this._root.halfSize}get root(){return this._root.node}get maximumObjectsPerNode(){return this._maximumObjectsPerNode}get maximumDepth(){return this._maximumDepth}get objectCount(){return this._objectCount}constructor(l,T){this.objectToBoundingSphere=l,this._maximumObjectsPerNode=10,this._maximumDepth=20,this._degenerateObjects=new Set,this._root=new y,this._objectCount=0,T&&(void 0!==T.maximumObjectsPerNode&&(this._maximumObjectsPerNode=T.maximumObjectsPerNode),void 0!==T.maximumDepth&&(this._maximumDepth=T.maximumDepth))}destroy(){this._degenerateObjects.clear(),y.clearPool(),It[0]=null,Ht.prune(),an.prune()}add(l,T=l.length){this._objectCount+=T,this._grow(l,T);const E=y.acquire();for(let P=0;P<T;P++){const W=l[P];this._isDegenerate(W)?this._degenerateObjects.add(W):(E.init(this._root),this._add(W,E))}y.release(E)}remove(l,T=null){this._objectCount-=l.length;const E=y.acquire();for(const P of l){const W=T??(0,K.a)(this.objectToBoundingSphere(P),In);U(W[3])?(E.init(this._root),yt(P,W,E)):this._degenerateObjects.delete(P)}y.release(E),this._shrink()}update(l,T){if(!U(T[3])&&this._isDegenerate(l))return;const E=function wt(v){return It[0]=v,It}(l);this.remove(E,T),this.add(E)}forEachAlongRay(l,T,E){const P=(0,it.LV)(l,T);q(this._root,W=>{if(!function Yt(v,l){return fn((0,K.g)(l.bounds),2*-l.halfSize,pt),fn((0,K.g)(l.bounds),2*l.halfSize,At),(0,x.O_)(v.origin,v.direction,pt,At)}(P,W))return!1;const w=W.node;return w.terminals.forAll(nt=>{this._intersectsObject(P,nt)&&E(nt)}),null!==w.residents&&w.residents.forAll(nt=>{this._intersectsObject(P,nt)&&E(nt)}),!0})}forEachAlongRayWithVerticalOffset(l,T,E,P){const W=(0,it.LV)(l,T);q(this._root,w=>{if(!function tn(v,l,T){return fn((0,K.g)(l.bounds),2*-l.halfSize,pt),fn((0,K.g)(l.bounds),2*l.halfSize,At),T.applyToMinMax(pt,At),(0,x.O_)(v.origin,v.direction,pt,At)}(W,w,P))return!1;const nt=w.node;return nt.terminals.forAll(V=>{this._intersectsObjectWithOffset(W,V,P)&&E(V)}),null!==nt.residents&&nt.residents.forAll(V=>{this._intersectsObjectWithOffset(W,V,P)&&E(V)}),!0})}forEach(l){q(this._root,T=>{const E=T.node;return E.terminals.forAll(l),null!==E.residents&&E.residents.forAll(l),!0}),this._degenerateObjects.forEach(l)}forEachDegenerateObject(l){this._degenerateObjects.forEach(l)}findClosest(l,T,E,P=(()=>!0),W=1/0){let w=1/0,nt=1/0,V=null;const _t=b(l,T),Bt=mt=>{if(--W,!P(mt))return;const Gt=this.objectToBoundingSphere(mt);if(!Dt(E,Gt))return;const nn=S(l,T,(0,K.g)(Gt)),ln=nn-Gt[3];ln<w&&(w=ln,nt=nn+Gt[3],V=mt)};return vt(this._root,mt=>{if(W<=0||!Dt(E,mt.bounds)||((0,Q.j)(bt,_t,mt.halfSize),(0,Q.g)(bt,bt,(0,K.g)(mt.bounds)),S(l,T,bt)>nt))return!1;const Gt=mt.node;return Gt.terminals.forAll(nn=>Bt(nn)),null!==Gt.residents&&Gt.residents.forAll(nn=>Bt(nn)),!0},l,T),V}forEachInDepthRange(l,T,E,P,W,w,nt){let V=-1/0,_t=1/0;const Bt={setRange:Ct=>{E===J.DepthOrder.FRONT_TO_BACK?(V=Math.max(V,Ct.near),_t=Math.min(_t,Ct.far)):(V=Math.max(V,-Ct.far),_t=Math.min(_t,-Ct.near))}};Bt.setRange(P);const mt=S(T,E,l),Gt=b(T,E),nn=b(T,-E),ln=Ct=>{if(!nt(Ct))return;const un=this.objectToBoundingSphere(Ct),_n=(0,K.g)(un),Pn=S(T,E,_n)-mt;Pn-un[3]>_t||Pn+un[3]<V||!Dt(w,un)||W(Ct,Bt)};vt(this._root,Ct=>{if(!Dt(w,Ct.bounds)||((0,Q.j)(bt,Gt,Ct.halfSize),(0,Q.g)(bt,bt,(0,K.g)(Ct.bounds)),S(T,E,bt)-mt>_t)||((0,Q.j)(bt,nn,Ct.halfSize),(0,Q.g)(bt,bt,(0,K.g)(Ct.bounds)),S(T,E,bt)-mt<V))return!1;const un=Ct.node;return un.terminals.forAll(_n=>ln(_n)),null!==un.residents&&un.residents.forAll(_n=>ln(_n)),!0},T,E)}forEachNode(l){q(this._root,T=>l(T.node,T.bounds,T.halfSize,T.depth))}forEachNeighbor(l,T){const E=(0,K.b)(T),P=(0,K.g)(T),W=V=>{const _t=this.objectToBoundingSphere(V),Bt=(0,K.b)(_t),mt=E+Bt;return!((0,Q.a)((0,K.g)(_t),P)-mt*mt<=0)||l(V)};let w=!0;const nt=V=>{w&&(w=W(V))};q(this._root,V=>{const _t=(0,K.b)(V.bounds),Bt=E+_t;if((0,Q.a)((0,K.g)(V.bounds),P)-Bt*Bt>0)return!1;const mt=V.node;return mt.terminals.forAll(nt),w&&null!==mt.residents&&mt.residents.forAll(nt),w}),w&&this.forEachDegenerateObject(nt)}_intersectsObject(l,T){const E=this.objectToBoundingSphere(T);return!(E[3]>0)||(0,K.j)(E,l)}_intersectsObjectWithOffset(l,T,E){const P=this.objectToBoundingSphere(T);return!(P[3]>0)||(0,K.j)(E.applyToBoundingSphere(P),l)}_add(l,T){T.advanceTo(this.objectToBoundingSphere(l))?T.node.terminals.push(l):(T.node.residents.push(l),T.node.residents.length>this._maximumObjectsPerNode&&T.depth<this._maximumDepth&&this._split(T))}_split(l){const T=l.node.residents;l.node.residents=null;for(let E=0;E<T.length;E++){const P=y.acquire().init(l);this._add(T.at(E),P),y.release(P)}}_grow(l,T){if(0!==T&&(A(l,T,E=>this.objectToBoundingSphere(E),on),U(on[3])&&!this._fitsInsideTree(on)))if(cn(this._root.node))(0,K.a)(on,this._root.bounds),this._root.halfSize=1.25*this._root.bounds[3],this._root.updateBoundsRadiusFromHalfSize();else{const E=this._rootBoundsForRootAsSubNode(on);this._placingRootViolatesMaxDepth(E)?this._rebuildTree(on,E):this._growRootAsSubNode(E),y.release(E)}}_rebuildTree(l,T){(0,Q.c)((0,K.g)(vn),(0,K.g)(T.bounds)),vn[3]=T.halfSize,A([l,vn],2,P=>P,Mn);const E=y.acquire().init(this._root);this._root.initFrom(null,Mn,Mn[3]),this._root.increaseHalfSize(1.25),q(E,P=>(this.add(P.node.terminals.data,P.node.terminals.length),null!==P.node.residents&&this.add(P.node.residents.data,P.node.residents.length),!0)),y.release(E)}_placingRootViolatesMaxDepth(l){const T=Math.log(l.halfSize/this._root.halfSize)*Math.LOG2E;let E=0;return q(this._root,P=>(E=Math.max(E,P.depth),E+T<=this._maximumDepth)),E+T>this._maximumDepth}_rootBoundsForRootAsSubNode(l){const T=l[3],E=l;let P=-1/0;const W=this._root.bounds,w=this._root.halfSize;for(let V=0;V<3;V++){const Bt=E[V]+T-(W[V]+w),mt=Math.max(0,Math.ceil((W[V]-w-(E[V]-T))/(2*w))),Gt=Math.max(0,Math.ceil(Bt/(2*w)))+1,nn=2**Math.ceil(Math.log(mt+Gt)*Math.LOG2E);P=Math.max(P,nn),gn[V].min=mt,gn[V].max=Gt}for(let V=0;V<3;V++){let _t=gn[V].min,Bt=gn[V].max;const mt=(P-(_t+Bt))/2;_t+=Math.ceil(mt),Bt+=Math.floor(mt),Wt[V]=W[V]-w-_t*w*2+(Bt+_t)*w}const nt=P*w;return Wt[3]=nt*Ot,y.acquire().initFrom(null,Wt,nt,0)}_growRootAsSubNode(l){const T=this._root.node;(0,Q.c)((0,K.g)(on),(0,K.g)(this._root.bounds)),on[3]=this._root.halfSize,this._root.init(l),l.advanceTo(on,null,!0),l.node.children=T.children,l.node.residents=T.residents,l.node.terminals=T.terminals}_shrink(){for(;;){const l=this._findShrinkIndex();if(-1===l)break;this._root.advance(l),this._root.depth=0}}_findShrinkIndex(){if(0!==this._root.node.terminals.length||this._root.isLeaf())return-1;let l=null;const T=this._root.node.children;let E=0,P=0;for(;P<T.length&&null==l;)E=P++,l=T[E];for(;P<T.length;)if(T[P++])return-1;return E}_isDegenerate(l){return!U(this.objectToBoundingSphere(l)[3])}_fitsInsideTree(l){const T=this._root.bounds,E=this._root.halfSize;return l[3]<=E&&l[0]>=T[0]-E&&l[0]<=T[0]+E&&l[1]>=T[1]-E&&l[1]<=T[1]+E&&l[2]>=T[2]-E&&l[2]<=T[2]+E}toJSON(){const{maximumDepth:l,maximumObjectsPerNode:T,_objectCount:E}=this,P=this._nodeToJSON(this._root.node);return{maximumDepth:l,maximumObjectsPerNode:T,objectCount:E,root:{bounds:this._root.bounds,halfSize:this._root.halfSize,depth:this._root.depth,node:P}}}_nodeToJSON(l){const T=l.children.map(W=>W?this._nodeToJSON(W):null),E=l.residents?.map(W=>this.objectToBoundingSphere(W)),P=l.terminals?.map(W=>this.objectToBoundingSphere(W));return{children:T,residents:E,terminals:P}}static fromJSON(l){const T=new J(E=>E,{maximumDepth:l.maximumDepth,maximumObjectsPerNode:l.maximumObjectsPerNode});return T._objectCount=l.objectCount,T._root.initFrom(l.root.node,l.root.bounds,l.root.halfSize,l.root.depth),T}}class y{constructor(){this.bounds=(0,K.c)(),this.halfSize=0,this.initFrom(null,null,0,0)}init(l){return this.initFrom(l.node,l.bounds,l.halfSize,l.depth)}initFrom(l,T,E,P=this.depth){return this.node=l??y.createEmptyNode(),T&&(0,K.a)(T,this.bounds),this.halfSize=E,this.depth=P,this}increaseHalfSize(l){this.halfSize*=l,this.updateBoundsRadiusFromHalfSize()}updateBoundsRadiusFromHalfSize(){this.bounds[3]=this.halfSize*Ot}advance(l){let T=this.node.children[l];T||(T=y.createEmptyNode(),this.node.children[l]=T),this.node=T,this.halfSize/=2,this.depth++;const E=rt[l];return this.bounds[0]+=E[0]*this.halfSize,this.bounds[1]+=E[1]*this.halfSize,this.bounds[2]+=E[2]*this.halfSize,this.updateBoundsRadiusFromHalfSize(),this}advanceTo(l,T,E=!1){for(;;){if(this.isTerminalFor(l))return T&&T(this,-1),!0;if(this.isLeaf()){if(!E)return T&&T(this,-1),!1;this.node.residents=null}const P=this._childIndex(l);T&&T(this,P),this.advance(P)}}isLeaf(){return null!=this.node.residents}isTerminalFor(l){return l[3]>this.halfSize/2}_childIndex(l){const T=this.bounds;return(T[0]<l[0]?1:0)+(T[1]<l[1]?2:0)+(T[2]<l[2]?4:0)}static createEmptyNode(){return{children:[null,null,null,null,null,null,null,null],terminals:new Rt.A({shrink:!0}),residents:new Rt.A({shrink:!0})}}static acquire(){return y._pool.acquire()}static release(l){y._pool.release(l)}static clearPool(){y._pool.prune()}}function q(v,l){let T=y.acquire().init(v);const E=[T];for(;0!==E.length;){if(T=E.pop(),l(T)&&!T.isLeaf())for(let P=0;P<T.node.children.length;P++)T.node.children[P]&&E.push(y.acquire().init(T).advance(P));y.release(T)}}function vt(v,l,T,E=J.DepthOrder.FRONT_TO_BACK){let P=y.acquire().init(v);const W=[P];for(function p(v,l,T){if(!an.length)for(let E=0;E<8;++E)an.push({index:0,distance:0});for(let E=0;E<8;++E){const P=rt[E];an.data[E].index=E,an.data[E].distance=S(v,l,P)}an.sort((E,P)=>E.distance-P.distance);for(let E=0;E<8;++E)T[E]=an.data[E].index}(T,E,An);0!==W.length;){if(P=W.pop(),l(P)&&!P.isLeaf())for(let w=7;w>=0;--w){const nt=An[w];P.node.children[nt]&&W.push(y.acquire().init(P).advance(nt))}y.release(P)}}function yt(v,l,T){Ht.clear();const E=T.advanceTo(l,(P,W)=>{Ht.push(P.node),Ht.push(W)})?T.node.terminals:T.node.residents;if(E.removeUnordered(v),0===E.length)for(let P=Ht.length-2;P>=0&&Kt(Ht.data[P],Ht.data[P+1]);P-=2);}function Kt(v,l){return l>=0&&(v.children[l]=null),!!cn(v)&&(null===v.residents&&(v.residents=new Rt.A({shrink:!0})),!0)}function cn(v){if(0!==v.terminals.length)return!1;if(null!==v.residents)return 0===v.residents.length;for(let l=0;l<v.children.length;l++)if(v.children[l])return!1;return!0}function Vt(v,l){v[0]=Math.min(v[0],l[0]-l[3]),v[1]=Math.min(v[1],l[1]-l[3]),v[2]=Math.min(v[2],l[2]-l[3])}function Tn(v,l){v[0]=Math.max(v[0],l[0]+l[3]),v[1]=Math.max(v[1],l[1]+l[3]),v[2]=Math.max(v[2],l[2]+l[3])}function fn(v,l,T){T[0]=v[0]+l,T[1]=v[1]+l,T[2]=v[2]+l}function A(v,l,T,E){if(1===l){const P=T(v[0]);(0,K.a)(P,E)}else{pt[0]=1/0,pt[1]=1/0,pt[2]=1/0,At[0]=-1/0,At[1]=-1/0,At[2]=-1/0;for(let P=0;P<l;P++){const W=T(v[P]);U(W[3])&&(Vt(pt,W),Tn(At,W))}(0,Q.o)((0,K.g)(E),pt,At,.5),E[3]=Math.max(At[0]-pt[0],At[1]-pt[1],At[2]-pt[2])/2}}function b(v,l){let T,E=1/0;for(let P=0;P<8;++P){const W=S(v,l,tt[P]);W<E&&(E=W,T=tt[P])}return T}function S(v,l,T){return l*(v[0]*T[0]+v[1]*T[1]+v[2]*T[2])}function U(v){return!isNaN(v)&&v!==-1/0&&v!==1/0&&v>0}y._pool=new Et.A(y),function(v){var l;(l=v.DepthOrder||(v.DepthOrder={}))[l.FRONT_TO_BACK=1]="FRONT_TO_BACK",l[l.BACK_TO_FRONT=-1]="BACK_TO_FRONT"}(J||(J={}));const rt=[(0,C.fA)(-1,-1,-1),(0,C.fA)(1,-1,-1),(0,C.fA)(-1,1,-1),(0,C.fA)(1,1,-1),(0,C.fA)(-1,-1,1),(0,C.fA)(1,-1,1),(0,C.fA)(-1,1,1),(0,C.fA)(1,1,1)],tt=[(0,C.fA)(-1,-1,-1),(0,C.fA)(-1,-1,1),(0,C.fA)(-1,1,-1),(0,C.fA)(-1,1,1),(0,C.fA)(1,-1,-1),(0,C.fA)(1,-1,1),(0,C.fA)(1,1,-1),(0,C.fA)(1,1,1)],Ot=Math.sqrt(3),It=[null],Wt=(0,K.c)(),bt=(0,C.vt)(),pt=(0,C.vt)(),At=(0,C.vt)(),Ht=new Rt.A,In=(0,K.c)(),on=(0,K.c)(),vn=(0,K.c)(),Mn=(0,K.c)(),gn=[{min:0,max:0},{min:0,max:0},{min:0,max:0}],an=new Rt.A,An=[0,0,0,0,0,0,0,0],Rn=J;var bn=L(15096);function Sn(v,l,T){const E=(0,K.c)(),P=(0,K.g)(E);return(0,Q.u)(P,P,v,.5),(0,Q.u)(P,P,l,.5),E[3]=(0,Q.r)(P,v),(0,Q.g)(P,P,T),E}let En=class{constructor(){this._idToComponent=new Map,this._components=new Rn(v=>v.bounds),this._edges=new Rn(v=>v.bounds),this._tmpLineSegment=(0,gt.vt)(),this._tmpP1=(0,C.vt)(),this._tmpP2=(0,C.vt)(),this._tmpP3=(0,C.vt)(),this.remoteClient=null}fetchCandidates(v,l){var T=this;return(0,ft.A)(function*(){yield Promise.resolve(),(0,Z.Te)(l),yield T._ensureEdgeLocations(v,l);const E=[];return T._edges.forEachNeighbor(P=>(T._addCandidates(v,P,E),E.length<1e3),v.bounds),{result:{candidates:E}}})()}_ensureEdgeLocations(v,l){var T=this;return(0,ft.A)(function*(){const E=[];if(T._components.forEachNeighbor(w=>{if(null==w.info){const{id:nt,uid:V}=w;E.push({id:nt,uid:V})}return!0},v.bounds),!E.length)return;const P={components:E},W=yield T.remoteClient.invoke("fetchAllEdgeLocations",P,l??{});for(const w of W.components)T._setFetchEdgeLocations(w)})()}add(v){var l=this;return(0,ft.A)(function*(){const T=new Fn(v.id,v.bounds);return l._idToComponent.set(T.id,T),l._components.add([T]),{result:{}}})()}remove(v){var l=this;return(0,ft.A)(function*(){const T=l._idToComponent.get(v.id);if(T){const E=[];l._edges.forEachNeighbor(P=>(P.component===T&&E.push(P),!0),T.bounds),l._edges.remove(E),l._components.remove([T]),l._idToComponent.delete(T.id)}return{result:{}}})()}_setFetchEdgeLocations(v){const l=this._idToComponent.get(v.id);if(null==l||v.uid!==l.uid)return;const T=bn.HY.createView(v.locations),E=new Array(T.count),P=(0,C.vt)(),W=(0,C.vt)();for(let V=0;V<T.count;V++){T.position0.getVec(V,P),T.position1.getVec(V,W);const _t=Sn(P,W,v.origin),Bt=new Bn(l,V,_t);E[V]=Bt}this._edges.add(E);const{objectIds:w,origin:nt}=v;l.info={locations:T,objectIds:w,origin:nt}}_addCandidates(v,l,T){const{info:E}=l.component,{origin:P,objectIds:W}=E,w=E.locations,nt=w.position0.getVec(l.index,this._tmpP1),V=w.position1.getVec(l.index,this._tmpP2);(0,Q.g)(nt,nt,P),(0,Q.g)(V,V,P);const _t=W[w.componentIndex.get(l.index)];this._addEdgeCandidate(v,_t,nt,V,T),pn(v,_t,nt,T),pn(v,_t,V,T)}_addEdgeCandidate(v,l,T,E,P){if(!v.returnEdge)return;const W=(0,K.g)(v.bounds),w=(0,gt.Cr)(T,E,this._tmpLineSegment),nt=(0,gt._I)(w,W,this._tmpP3);(0,K.n)(v.bounds,nt)&&P.push({type:"edge",objectId:l,target:(0,C.o8)(nt),distance:(0,Q.r)(W,nt),start:(0,C.o8)(T),end:(0,C.o8)(E)})}};En=(0,st._)([(0,at.$)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],En);const Nn=En;function pn(v,l,T,E){if(!v.returnVertex||!(0,K.n)(v.bounds,T))return;const P=(0,K.g)(v.bounds);E.push({type:"vertex",objectId:l,target:(0,C.o8)(T),distance:(0,Q.r)(P,T)})}let Fn=(()=>{class v{constructor(T,E){this.id=T,this.bounds=E,this.info=null,this.uid=++v.uid}}return v.uid=0,v})();class Bn{constructor(l,T,E){this.component=l,this.index=T,this.bounds=E}}}}]);