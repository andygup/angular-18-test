"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[1332],{84289:(tt,W,_)=>{_.d(W,{$:()=>h,s:()=>o});const h=15.5,o=1024},53212:(tt,W,_)=>{_.d(W,{KQ:()=>h,Q4:()=>B,Ss:()=>F});const h=8388607,o=8388608,B=T=>T&h;function F(T,P){return((P?o:0)|T)>>>0}},24821:(tt,W,_)=>{_.d(W,{Y7:()=>bt,HS:()=>mt,mm:()=>it,A:()=>Ot,k2:()=>Tt,ZA:()=>_t,E8:()=>lt,hF:()=>pt,C5:()=>Y,uK:()=>ht,Pi:()=>at});var h=_(8189),c=(_(3248),_(35150)),g=_(1119),j=_(5922),V=_(20951),O=_(65388);class A{constructor(){this._includedModules=new Map}include(a,d){this._includedModules.has(a)?this._includedModules.get(a):(this._includedModules.set(a,d),a(this.builder,d))}}class K extends A{constructor(){super(...arguments),this.vertex=new P,this.fragment=new P,this.attributes=new m,this.varyings=new M,this.extensions=new f,this.constants=new v}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(a,d=!0){const E=this.extensions.generateSource(a),D=this.attributes.generateSource(a),I=this.varyings.generateSource(a),R="vertex"===a?this.vertex:this.fragment,G=R.uniforms.generateSource(),X=R.code.generateSource(),k="vertex"===a?x:function b(Z=!0){return`#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp sampler2D;\n#else\n  precision mediump float;\n  precision mediump sampler2D;\n#endif\n${Z?"out vec4 fragColor;":""}\n`}(d),q=this.constants.generateSource().concat(R.constants.generateSource());return`${d?"#version 300 es":""}\n${E.join("\n")}\n${k}\n${q.join("\n")}\n${G.join("\n")}\n${D.join("\n")}\n${I.join("\n")}\n${X.join("\n")}`}generateBindPass(a){const d=new Map;this.vertex.uniforms.entries.forEach(I=>{const R=I.bind[V.c.Pass];R&&d.set(I.name,R)}),this.fragment.uniforms.entries.forEach(I=>{const R=I.bind[V.c.Pass];R&&d.set(I.name,R)});const E=Array.from(d.values()),D=E.length;return(I,R)=>{for(let G=0;G<D;++G)E[G](a,I,R)}}generateBindDraw(a){const d=new Map;this.vertex.uniforms.entries.forEach(I=>{const R=I.bind[V.c.Draw];R&&d.set(I.name,R)}),this.fragment.uniforms.entries.forEach(I=>{const R=I.bind[V.c.Draw];R&&d.set(I.name,R)});const E=Array.from(d.values()),D=E.length;return(I,R,G)=>{for(let X=0;X<D;++X)E[X](a,I,R,G)}}}class F{constructor(){this._entries=new Map}add(...a){for(const d of a)this._add(d)}get(a){return this._entries.get(a)}_add(a){if(null!=a){if(this._entries.has(a.name)&&!this._entries.get(a.name).equals(a))throw new j.A(`Duplicate uniform name ${a.name} for different uniform type`);this._entries.set(a.name,a)}else c.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder").error(`Trying to add null Uniform from ${(new Error).stack}.`)}generateSource(){return Array.from(this._entries.values()).map(a=>null!=a.arraySize?`uniform ${a.type} ${a.name}[${a.arraySize}];`:`uniform ${a.type} ${a.name};`)}get entries(){return Array.from(this._entries.values())}}class T{constructor(){this._entries=new Array}add(a){this._entries.push(a)}generateSource(){return this._entries}}class P extends A{constructor(){super(...arguments),this.uniforms=new F,this.code=new T,this.constants=new v}get builder(){return this}}class m{constructor(){this._entries=new Array}add(a,d){this._entries.push([a,d])}generateSource(a){return"fragment"===a?[]:this._entries.map(d=>`in ${d[1]} ${d[0]};`)}}class M{constructor(){this._entries=new Map}add(a,d){this._entries.has(a)&&(0,O.vA)(this._entries.get(a)===d),this._entries.set(a,d)}generateSource(a){const d=new Array;return this._entries.forEach((E,D)=>d.push("vertex"===a?`out ${E} ${D};`:`in ${E} ${D};`)),d}}class f{constructor(){this._entries=new Set}add(a){this._entries.add(a)}generateSource(a){const d="vertex"===a?f.ALLOWLIST_VERTEX:f.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter(E=>d.includes(E)).map(E=>`#extension ${E} : enable`)}}f.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"],f.ALLOWLIST_VERTEX=[];class v{constructor(){this._entries=new Set}add(a,d,E){let D="ERROR_CONSTRUCTOR_STRING";switch(d){case"float":D=v._numberToFloatStr(E);break;case"int":D=v._numberToIntStr(E);break;case"bool":D=E.toString();break;case"vec2":D=`vec2(${v._numberToFloatStr(E[0])},                            ${v._numberToFloatStr(E[1])})`;break;case"vec3":D=`vec3(${v._numberToFloatStr(E[0])},                            ${v._numberToFloatStr(E[1])},                            ${v._numberToFloatStr(E[2])})`;break;case"vec4":D=`vec4(${v._numberToFloatStr(E[0])},                            ${v._numberToFloatStr(E[1])},                            ${v._numberToFloatStr(E[2])},                            ${v._numberToFloatStr(E[3])})`;break;case"ivec2":D=`ivec2(${v._numberToIntStr(E[0])},                             ${v._numberToIntStr(E[1])})`;break;case"ivec3":D=`ivec3(${v._numberToIntStr(E[0])},                             ${v._numberToIntStr(E[1])},                             ${v._numberToIntStr(E[2])})`;break;case"ivec4":D=`ivec4(${v._numberToIntStr(E[0])},                             ${v._numberToIntStr(E[1])},                             ${v._numberToIntStr(E[2])},                             ${v._numberToIntStr(E[3])})`;break;case"mat2":case"mat3":case"mat4":D=`${d}(${Array.prototype.map.call(E,I=>v._numberToFloatStr(I)).join(", ")})`}return this._entries.add(`const ${d} ${a} = ${D};`),this}static _numberToIntStr(a){return a.toFixed(0)}static _numberToFloatStr(a){return Number.isInteger(a)?a.toFixed(1):a.toString()}generateSource(){return Array.from(this._entries)}}const x="precision highp float;\nprecision highp sampler2D;";var C=_(3902);function w(Z,a,d){const E=a.split("\n");for(const D of E)if(D.trim().length){{let I="";null!=d&&(I+=`/*id:${d??"000"}*/   `),Z.body+=I.padEnd(14)}Z.body+=" ".repeat(Z.indent)+D+"\n"}}class ${write(a){for(const d of a.rootOutputNodes())a.shouldPruneOutputNode(d)||(d.variableName=this._write(a,d.node));return a}_createVarName(a,d){let E="";return"boolean"!=typeof d&&"number"!=typeof d&&d.debugInfo.name&&(E=`${d.debugInfo.name}_`),`${E}v${a.varCount++}`}_write(a,d,E=!1){if("number"==typeof d||"boolean"==typeof d)return d.toString();let D=a.getEmit(d);if(D)return D;switch(d.shaderType){case"scope-node":D=this._writeScopeNode(a,d);break;case"primitive-node":D=this._writePrimitiveNode(a,d,E);break;case"function-node":D=this._writeFunctionNode(a,d);break;case"property-access-node":D=this._writePropertyAccessNode(a,d);break;case"text-node":D=d.text;break;case"block-node":D=this._writeBlockNode(a,d);break;case"condition-node":D=this._writeConditionNode(a,d)}return a.setEmit(d,D),D}_writeScopeNode(a,d){const E=new d.child.constructor;E.setDebugName(d.debugInfo.name);const D=this._write(a,E,!0);return w(a,`{ /*ScopeStart: ${d.uid} ${d.debugInfo.name}*/`),a.indent+=2,w(a,`${D} = ${this._write(a,d.child)};`),a.indent-=2,w(a,`} /*ScopeEnd: ${d.uid} ${d.debugInfo.name}*/`),D}_writeConditionNode(a,d){const E=new d.ifTrue.constructor,D=this._write(a,E,!0);w(a,`if (${this._write(a,d.condition)}) {`),a.indent+=2;const I=a.createSubgraphContext(),R=this._write(I,d.ifTrue);if(a.body+=I.body,R&&w(a,`${D} = ${R};`),a.indent-=2,w(a,"}"),d.ifFalse){w(a,"else {"),a.indent+=2;const G=a.createSubgraphContext(),X=this._write(G,d.ifFalse);a.body+=G.body,X&&w(a,`${D} = ${X};`),a.indent-=2,w(a,"}")}return D}_writeBlockNode(a,d){const{captureList:E,generator:D,returnType:I}=d,R={};for(const q in E){if(!E[q])continue;const ct=this._write(a,E[q]);R[q]=ct}const G=new I,X=this._write(a,G,!0);if(R.out=X,d.subgraph){const q=a.createSubgraphContext(),ct=this._write(q,d.subgraph.child);R.subgraph={varName:ct,body:q.body}}const k=D(R);return w(a,"{\n"),a.indent+=2,w(a,k),a.indent-=2,w(a,"}\n"),X}_writePropertyAccessNode(a,d){const E=this._write(a,d.target);return"string"==typeof d.property&&d.property.includes("[")?`${E}${d.property}`:"string"!=typeof d.property?`${E}[${this._write(a,d.property)}]`:`${E}.${d.property}`}_writeFunctionNode(a,d){const E=d.returnType.type;if(d.isInfix){const[R,G]=d.children.map(k=>this._write(a,k)),X=this._createVarName(a,d);return w(a,`${E.padEnd(5)} ${X} = ${R} ${d.token} ${G};`,d.uid),X}const D=d.children.map(R=>this._write(a,R)).join(", "),I=this._createVarName(a,d);return w(a,`${E.padEnd(5)} ${I} = ${d.token}(${D});`,d.uid),I}_writePrimitiveNode(a,d,E=!1){const D=a.getInput(d);if(D)return D.isUsed=!0,D.variableName;if(d.isImplicit||1===d.children.length&&d.children[0]?.type===d.type)return this._write(a,d.children[0]);const R=this._createVarName(a,d);if(E)return w(a,`${d.type.padEnd(5)} ${R};`,d.uid),R;const G=!d.debugInfo.name&&!d.isMutable;if(G&&"float"===d.type&&"number"==typeof d.children[0])return Number.isInteger(d.children[0])?d.children[0].toFixed(1):d.children[0].toString();if(G&&"int"===d.type&&"number"==typeof d.children[0]&&Number.isInteger(d.children[0]))return d.children[0].toString();const X=d.children.map(k=>this._write(a,k)).join(", ");return"array"===d.type?(w(a,`${d.type.padEnd(5)} ${R} = [${X}];`,d.uid),R):G?`${d.type}(${X})`:(w(a,`${d.type.padEnd(5)} ${R} = ${d.type}(${X});`,d.uid),R)}}var z=_(92779);class S{constructor(a,d,E){this.variableName=a,this.variableInputType=d,this.node=E,this.type="shader-input",this.isUsed=!1}clone(){return new S(this.variableName,this.variableInputType,(0,z.vA)(this.node))}}class J{constructor(a,d,E){this.outVariableName=a,this.outVariableType=d,this.node=E,this.type="shader-output"}clone(){const a=new J(this.outVariableName,this.outVariableType,(0,z.vA)(this.node));return a.variableName=this.variableName,a}}class Q{static createVertex(a,d,E,D,I,R){const G=[];for(const k in a){const q=a[k],ct=E.get(k);G.push(ct?new S(ct,"builtin",q):new S("a_"+k,"attribute",q))}for(const k of D)G.push(new S(k.uniformName,"uniform",k.uniformHydrated));const X=[];for(const k in d){const q=d[k];X.push("glPosition"===k?new J("gl_Position","builtin",q):"glPointSize"===k?new J("gl_PointSize","builtin",q):new J("v_"+k,"varying",q))}return new Q(G,X,I,R)}static createFragment(a,d,E,D,I,R){const G=[],X=Array.from(I.rootOutputNodes());for(const q in a){const ct=a[q],gt=E.get(q);if(gt){G.push(new S(gt,"builtin",ct));continue}const Dt=X.find(Lt=>Lt.node===ct);Dt&&G.push(new S(Dt.outVariableName,Dt.outVariableType,ct))}for(const q of D)G.push(new S(q.uniformName,"uniform",q.uniformHydrated));const k=[];for(const q in d){const ct=d[q],gt=E.get(q);if("discard"===q)k.push(new J(null,"discard",ct));else{if(!gt)throw new Error(`Member ${q} in shader fragment output shoule be tagged as builtin`);k.push(new J(gt,"builtin",ct))}}return new Q(G,k,R)}constructor(a,d,E,D){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const I of a)this._inputShaderTypesByNodeUid.set(I.node.uid,I);this._outputShaderTypes=d,this._transformFeedbackBindings=E,this._transformFeedbackNames=new Set(E.map(I=>"v_"+I.propertyKey)),this._usedInFragmentShader=D}shouldPruneOutputNode(a){return!!this._usedInFragmentShader&&"builtin"!==a.outVariableType&&!this._transformFeedbackNames.has(a.outVariableName)&&!this._usedInFragmentShader.has(a.node.uid)}setEmit(a,d){this._nodeEmitMap.set(a.uid,d)}getEmit(a){return this._nodeEmitMap.get(a.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(a){return this._inputShaderTypesByNodeUid.get(a.uid)}*rootOutputNodes(){for(const a of this._outputShaderTypes)yield a}*nodes(){const a=[];for(const d of this._outputShaderTypes.values())a.push(d.node);for(;a.length;){const d=a.pop();"number"!=typeof d&&"boolean"!=typeof d&&a.push(...d.children.filter(Boolean)),yield d}}*nodesOfTypeOrFunction(){for(const a of this.nodes())"number"!=typeof a&&"boolean"!=typeof a&&(yield a)}createSubgraphContext(){const a=this.clone();return a.body="",a.indent=this.indent+2,a._nodeEmitMap=new Map(this._nodeEmitMap),a}clone(){const a=new Q([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return a._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,a.indent=this.indent,a.body=this.body,a.varCount=this.varCount,a._nodeEmitMap=this._nodeEmitMap,a}insertVertexShader(a){a.vertex.code.add(""),this._insertInputs(a,"vertex"),a.vertex.code.add(""),a.vertex.code.add("// OUTPUTS: "),a.vertex.code.add("// --------------------------------------------------------- ");for(const d of this.rootOutputNodes()){const E="builtin"===d.outVariableType;this.shouldPruneOutputNode(d)||a.vertex.code.add(E?`// ${d.outVariableType.padEnd(7)} ${d.node.type.padEnd(9)} ${d.outVariableName};`:`${d.outVariableType.padEnd(10)} ${d.node.type.padEnd(9)} ${d.outVariableName};`)}a.vertex.code.add(""),a.vertex.code.add("void main() {"),a.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const d of this.rootOutputNodes())this.shouldPruneOutputNode(d)||a.vertex.code.add(`  ${d.outVariableName} = ${d.variableName};`);a.vertex.code.add("}")}insertFragmentShader(a){this._insertInputs(a,"fragment"),a.fragment.code.add(""),a.fragment.code.add("void main() {"),a.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const d of this.rootOutputNodes())"discard"===d.outVariableType?(a.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),a.fragment.code.add(`  if (${d.variableName}) {`),a.fragment.code.add("    discard;"),a.fragment.code.add("  }"),a.fragment.code.add("  ")):a.fragment.code.add(`  ${d.outVariableName} = ${d.variableName};`);a.fragment.code.add("}")}_insertInputs(a,d){a[d].code.add("// INPUTS: "),a[d].code.add("// --------------------------------------------------------- ");for(const E of this.inputs())E.isUsed&&"builtin"!==E.variableInputType&&a[d].code.add("array"===E.node.type?`${E.variableInputType.padEnd(10)} ${E.node.elementType.type.padEnd(9)} ${E.variableName}[${E.node.size}];`:`${E.variableInputType.padEnd(10)} ${E.node.type.padEnd(9)} ${E.variableName};`)}}var nt=_(77989);function rt(Z){return new Z}function st(Z,a,d){const E=Z.constructor[a]??[];Z.constructor.hasOwnProperty(a)||Object.defineProperty(Z.constructor,a,{value:E.slice()}),Z.constructor[a].push(d)}function Y(Z,a){return(d,E)=>{st(d,"locations",{typeCtor:a,propertyKey:E,parameterIndex:null,index:Z})}}const pt=Z=>(a,d,E)=>{st(a,"inputs",{inputCtor:Z,propertyKey:d,parameterIndex:E})},at=Z=>(a,d)=>{st(a,"uniforms",{typeCtor:Z,propertyKey:d})},ht=Z=>(a,d)=>{st(a,"options",{typeCtor:Z,propertyKey:d})},lt=(Z,a)=>{st(Z,"defines",{propertyKey:a})},Pt=(Z,a)=>(d,E)=>{d.constructor.builtins.push({builtin:Z,propertyKey:E,typeCtor:a})};class _t{}_t.builtins=[],(0,h._)([Pt("gl_VertexID",C.Ai)],_t.prototype,"glVertexID",void 0);class bt{}class mt{}mt.builtins=[],(0,h._)([Pt("gl_FragCoord",C.Zb)],mt.prototype,"glFragCoord",void 0),(0,h._)([Pt("gl_PointCoord",C.ZY)],mt.prototype,"glPointCoord",void 0);class it{}(0,h._)([("gl_FragColor",(a,d)=>{st(a,"builtins",{builtin:"gl_FragColor",propertyKey:d})})],it.prototype,"glFragColor",void 0);class Tt{constructor(){this.type="uniform-group"}get _uniforms(){return this.constructor.uniforms??[]}}class Ot{constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const a=this._shaderModuleClass.inputs.findLast(d=>"vertex"===d.propertyKey&&0===d.parameterIndex);if(!a)throw new Error("Unable to find vertex input parameter");return a}get computeInput(){return this._shaderModuleClass.inputs.findLast(a=>"vertex"===a.propertyKey&&1===a.parameterIndex)}get fragmentInput(){const a=this._shaderModuleClass.inputs.findLast(d=>"fragment"===d.propertyKey);if(!a)throw new Error("Unable to find fragment input parameter");return a}get transformFeedbackBindings(){return this.fragmentInput.inputCtor.transformFeedbackBindings??[]}get locations(){return[...this.vertexInput.inputCtor.locations,...this.computeInput?.inputCtor.locations??[]]}get locationsMap(){const a=new Map,d=new Set;for(const E of this.locations)d.has(E.index)?c.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${E.propertyKey} to ${E.index}. Index already in use`,{locationsMap:a}):(a.set(E.propertyKey,E.index),d.add(E.index));return a}get locationInfo(){if(!this._locationInfo){const a=this.locationsMap,d=Array.from(a.entries()).map(([I,R])=>`${I}.${R}`).join("."),E=(0,g.Wm)(d);this._locationInfo={hash:E,locations:a,computeAttributeMap:this.computeAttributes}}return this._locationInfo}get renamedLocationsMap(){const a=new Map;for(const d of this.locations)a.set("a_"+d.propertyKey,d.index);return a}get optionPropertyKeys(){if(!this._optionPropertyKeys){const a=new Set;for(const d of this._options)a.add(d.propertyKey);this._optionPropertyKeys=a}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){return this._shaderModuleClass.defines??[]}get _options(){return this._shaderModuleClass.options??[]}get _uniforms(){return this._shaderModuleClass.uniforms??[]}getProgram(a,d,E,D){try{const{vertex:I,fragment:R,uniformBindings:G}=this._generateShaders(a,d,E,D);return new nt.K(I,R,this.renamedLocationsMap,this.locationInfo,G,this.transformFeedbackBindings)}catch{return new nt.K("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(a){const d=this._options.find(D=>D.propertyKey===a);if(d)return{type:"option",className:d.typeCtor};const E=this._uniforms.find(D=>D.propertyKey===a);if(!E)throw new Error(`Unable to find uniform class type for property: ${a}`);return{type:"required",className:E.typeCtor}}getShaderKey(a,d,E,D){const I=Object.keys(a).map(k=>`${k}.${a[k]}`).join("."),R=Object.keys(E).map(k=>`${k}.${E[k]}`).join("."),G=Object.keys(D).map(k=>`${k}.${D[k]}`).join("."),X=Object.keys(d).filter(k=>this.optionPropertyKeys.has(k)&&d[k]).join(".");return`${this.constructor.name}.${I}.${R}.${G}.${X}`}_generateShaders(a,d,E,D){const I=[];this._setDefines(E),this._setOptionalUniforms(I,d),this._setRequiredUniforms(I);const R=this._hydrateVertexInput(D),G=this._injectPackPrecisionFactor(R,a),X=this._hydrateComputeInput(),k=X&&this._injectComputePackPrecisionFactor(X,a),q=this.vertex(G,k),ct=this._hydrateFragmentInput(q),gt=this.fragment(ct),Dt=new Set;for(const Kt in gt)(0,z.rz)(Dt,gt[Kt]);const Lt=this._getVertexInputBuiltins(),ft=Q.createVertex({...R,...X},q,Lt,I,this.transformFeedbackBindings,Dt);(new $).write(ft);const dt=this._getFragmentInputBuiltins(gt);dt.set("glPointCoord","gl_PointCoord");const N=Q.createFragment(ct,gt,dt,I,ft,this.transformFeedbackBindings);(new $).write(N);const ut=this._createShaderBuilder(ft,N),wt=ut.generate("vertex",!1),Ct=ut.generate("fragment",!1);return this.logShader&&(console.log(wt),console.log(Ct)),{vertex:wt,fragment:Ct,uniformBindings:I}}_setDefines(a){for(const d in a)this[d]=a[d]}_setOptionalUniforms(a,d){for(const E of this._options)this[E.propertyKey]=d[E.propertyKey]?this._hydrateUniformGroup(a,E):null}_setRequiredUniforms(a){for(const d of this._uniforms)this[d.propertyKey]=this._hydrateUniformGroup(a,d)}_hydrateUniformGroup(a,d){const E=new d.typeCtor;for(const D of E._uniforms??[]){const I=rt(D.typeCtor),R=`u_${d.propertyKey}_${D.propertyKey}`,G=I.type,X=[d.propertyKey,D.propertyKey].join(".");a.push("type"in D.typeCtor&&"array"===D.typeCtor.type?{shaderModulePath:X,uniformName:R,uniformType:G,uniformArrayLength:I.size,uniformArrayElementType:I.elementType.type,uniformHydrated:I}:{shaderModulePath:X,uniformName:R,uniformType:G,uniformHydrated:I}),E[D.propertyKey]=I}return E}_hydrateVertexInput(a){const d=this.vertexInput.inputCtor,E=d.locations.reduce((D,I)=>!1===a[I.propertyKey]?D:{...D,[I.propertyKey]:rt(I.typeCtor)},{});for(const{propertyKey:D,typeCtor:I}of d.builtins){const R=rt(I);E[D]=R}return E}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce((a,d)=>({...a,[d.propertyKey]:rt(d.typeCtor)}),{})}_injectPackPrecisionFactor(a,d){const E={};for(const D in a){const I=a[D],R=d[D];if(R){if("float"!==I.type&&"vec2"!==I.type&&"vec3"!==I.type&&"vec4"!==I.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${I.type}`);E[D]=I.divide(new C.nt(R))}else E[D]=I}return E}_injectComputePackPrecisionFactor(a,d){const E={},D=new Map;for(const I in this.computeAttributes)for(const R of this.computeAttributes[I]??[])D.set(R,I);for(const I in a){const R=a[I],G=D.get(I);if(!G)continue;const X=d[G];if(X){if("float"!==R.type&&"vec2"!==R.type&&"vec3"!==R.type&&"vec4"!==R.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${R.type}`);E[I]=R.divide(new C.nt(X))}else E[I]=R}return E}_hydrateFragmentInput(a){const d={};for(const E in a)d[E]=a[E];for(const{propertyKey:E,typeCtor:D}of mt.builtins){const I=rt(D);d[E]=I}return d}_getVertexInputBuiltins(){const a=this.vertexInput.inputCtor,d=new Map;for(const{builtin:E,propertyKey:D}of a.builtins)d.set(D,E);return d}_getFragmentInputBuiltins(a){const d=a.constructor,E=new Map;for(const D of d.builtins??[])E.set(D.propertyKey,D.builtin);return E}_createShaderBuilder(a,d){const E=new K;return this._insertDebugInfo(E),a.insertVertexShader(E),d.insertFragmentShader(E),E}_insertDebugInfo(a){a.vertex.code.add("// DEFINES: "),a.vertex.code.add("// --------------------------------------------------------- ");for(const d of this._defines)a.vertex.code.add(this[d.propertyKey]?`//   ${d.propertyKey}: true`:`//   ${d.propertyKey}: false`);a.vertex.code.add(""),a.vertex.code.add("// OPTIONS: "),a.vertex.code.add("// --------------------------------------------------------- ");for(const d of this._options)a.vertex.code.add(this[d.propertyKey]?`//   ${d.propertyKey}: true`:`//   ${d.propertyKey}: false`)}}},92779:(tt,W,_)=>{function o(T,P){const m=[];for(m.push(P);m.length;){const M=m.pop();if("object"==typeof M&&!T.has(M.uid)){T.add(M.uid);for(const f of M.children)m.push(f)}}}_.d(W,{XL:()=>A,aw:()=>F,rR:()=>K,rz:()=>o,vA:()=>g,vL:()=>j,zg:()=>B});class c{constructor(){this.uid=c.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(P){return P=function h(T){return T.split(" ").map((P,m)=>m>0?P.charAt(0).toUpperCase()+P.slice(1):P).join("")}(P),this._debugName=P,this.isImplicit&&this.children[0]instanceof c&&this.children[0].setDebugName(P),this}get debugInfo(){return{name:this._debugName??""}}cloneInto(P){P._debugName=this._debugName,P._isMutable=this._isMutable,P.isImplicit=this.isImplicit,P.uid=this.uid}}function g(T){return"object"==typeof T?T.clone():T}c.NodeCount=0;class j extends c{constructor(){super(...arguments),this.shaderType="primitive-node"}}class V extends c{constructor(P){super(),this.child=P,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const P=new V(g(this.child));return this.cloneInto(P),P}}class B extends c{constructor(P,m,M){super(),this.property=P,this.target=m,this.returnType=M,this.shaderType="property-access-node"}get children(){const P=[this.target];return"string"!=typeof this.property&&P.push(this.property),P}clone(){const P=new B(this.property,g(this.target),this.returnType);return this.cloneInto(P),P}}class A extends c{constructor(P,m,M){super(),this.condition=P,this.ifTrue=m,this.ifFalse=M,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const P=g(this.ifTrue),m=this.ifFalse?g(this.ifFalse):null,M=new A(this.condition,P,m);return this.cloneInto(M),M}}class K extends c{constructor(P,m,M,f){super(),this.captureList=P,this.returnType=m,this.generator=f,this.shaderType="block-node",M&&(this.subgraph=new V(M))}get children(){return Object.keys(this.captureList).map(P=>this.captureList[P]).concat(this.subgraph??[])}clone(){const P={};for(const M in this.captureList)P[M]=g(this.captureList[M]);const m=new K(P,this.returnType,this.subgraph?g(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(m),m}}class F extends c{constructor(P,m,M,f,v,b=!1){super(),this.token=P,this._children=m,this.isInfix=M,this.isPropertyAccess=f,this.returnType=v,this.isTernary=b,this.shaderType="function-node"}get children(){return this._children}clone(){const P=new F(this.token,this._children.map(g),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(P),P}}},3902:(tt,W,_)=>{_.d(W,{$5:()=>Qt,$I:()=>I,AU:()=>ye,Ai:()=>Ot,Bw:()=>ce,F8:()=>Nt,Io:()=>oe,LC:()=>Xt,MM:()=>qt,My:()=>rt,Om:()=>ae,PM:()=>me,RI:()=>ue,S8:()=>fe,Sj:()=>Ht,T9:()=>de,TF:()=>ve,Tk:()=>Vt,U:()=>D,US:()=>ge,Uo:()=>Wt,Wh:()=>G,Xe:()=>Jt,ZY:()=>ot,Zb:()=>at,Zc:()=>k,aX:()=>te,eB:()=>pt,eR:()=>q,fV:()=>X,gn:()=>zt,j1:()=>kt,jc:()=>le,jh:()=>_e,jk:()=>he,ln:()=>ct,mk:()=>ie,nf:()=>Yt,nt:()=>Y,or:()=>Ft,qE:()=>se,tn:()=>re,w0:()=>Dt,x:()=>_t,z7:()=>st,ze:()=>Ct,zi:()=>pe});var c,g,j,V,O,B,A,K,F,T,P,m,M,f,h=_(8189),o=_(92779);function z(s){return new Proxy(s,{get(p,y){if("constructor"===y)return new Proxy(p.constructor,{construct:(U,H,et)=>z(new U(...H))});if(y in p)return p[y];if("string"==typeof y){const U=function $(s){const p=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const y of p)if(y.includes(s))return y.map(U=>R[U]);throw new Error("Unable to find type family")}(s.type);return ft(s,y,U[y.length-1])}}})}function S(s){return new Proxy(s,{construct:(p,y,U)=>z(new p(...y))})}class nt extends Error{}let rt=c=class extends o.vL{constructor(s,p){super(),this.elementType=s,this.size=p,this.children=[],this.type="array"}clone(){const s=new c(this.elementType,this.size);return super.cloneInto(s),s}get(s){if("number"==typeof s){const p=new Ot(s);return p.isImplicit=!0,ft(this,p,this.elementType.constructor)}return ft(this,s,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(s,p,y){return function Zt(s,p,y=0,U=s.size){const H=new Ot(y).setMutable().setDebugName("FindIndexIterator"),et=p(s.get(H)).setDebugName("FindIndexPredicate");return Kt({iter:H},Ot,et,({out:Et,iter:vt,subgraph:At})=>`\n${Et} = -1;\n\nfor (; ${vt} < ${U}; ${vt}++) {\n\n${At.body}\n\n  if (${At.varName}) {\n    ${Et} = ${vt};\n    break;\n  }\n\n}\n`).setDebugName("FindIndexBlock")}(this,s,p,y)}glslFindIndex(s,p,y){return function Gt(s,p,y=0,U=s.size){return Kt({array:s},Ot,null,({out:et,array:Mt})=>`\n${et} = -1;\nfor (int i = ${y}; i < ${U}; i++) {\n  bool condition;\n  ${p({array:Mt,i:"i",out:"condition"})}\n  if (condition) {\n    ${et} = i;\n    break;\n  }\n}\n`).setDebugName("GlslFindIndexBlock")}(this,s,p,y)}static ofType(s,p){const y={construct:(U,H)=>new c(new s,p)};return new Proxy(c,y)}};rt.type="array",rt=c=(0,h._)([function Q(s){return new Proxy(s,{construct:(p,y,U)=>function J(s){return new Proxy(s,{get(p,y){if(y in p)return p[y];if("string"==typeof y){const U=parseInt(y,10);if(!isNaN(U))return ft(s,`[${U}]`,s.elementType.constructor)}}})}(new p(...y))})}],rt);let st=(()=>{class s extends o.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}clone(){const y=new s;return y.children=this.children.map(o.vA),super.cloneInto(y),y}}return s.type="sampler2D",s})(),Y=(()=>{class s extends o.vL{constructor(y){super(),this.type="float",this.children=[y]}clone(){const y=new s((0,o.vA)(this.children[0]));return super.cloneInto(y),y}multiply(y){return xt(this,"number"==typeof y?it(y,s):y)}divide(y){return St(this,"number"==typeof y?it(y,s):y)}add(y){return It(this,"number"==typeof y?it(y,s):y)}subtract(y){return Ut(this,"number"==typeof y?it(y,s):y)}}return s.type="float",s})(),ot=g=class extends o.vL{constructor(s,p){super(),this.type="vec2",this.children=[s,p].filter(y=>null!=y)}clone(){const s=new g((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]));return super.cloneInto(s),s}get 0(){return ft(this,"[0]",Y)}get 1(){return ft(this,"[1]",Y)}get 2(){throw new nt}get 3(){throw new nt}multiply(s){return xt(this,"number"==typeof s?it(s,Y):s)}divide(s){return St(this,"number"==typeof s?it(s,Y):s)}add(s){return It(this,"number"==typeof s?it(s,Y):s)}subtract(s){return Ut(this,"number"==typeof s?it(s,Y):s)}};ot.type="vec2",ot=g=(0,h._)([S],ot);let pt=j=class extends o.vL{constructor(s,p,y){super(),this.type="vec3",this.children=[s,p,y].filter(U=>null!=U)}get 0(){return ft(this,"[0]",Y)}get 1(){return ft(this,"[1]",Y)}get 2(){return ft(this,"[2]",Y)}get 3(){throw new nt}clone(){const s=new j((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]));return super.cloneInto(s),s}multiply(s){return xt(this,"number"==typeof s?it(s,Y):s)}divide(s){return St(this,"number"==typeof s?it(s,Y):s)}add(s){return It(this,"number"==typeof s?it(s,Y):s)}subtract(s){return Ut(this,"number"==typeof s?it(s,Y):s)}};pt.type="vec3",pt=j=(0,h._)([S],pt);let at=V=class extends o.vL{constructor(s,p,y,U){super(),this.type="vec4",this.children=[s,p,y,U].filter(H=>null!=H)}clone(){const s=new V((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]));return super.cloneInto(s),s}get 0(){return ft(this,"[0]",Y)}get 1(){return ft(this,"[1]",Y)}get 2(){return ft(this,"[2]",Y)}get 3(){return ft(this,"[3]",Y)}multiply(s){return xt(this,"number"==typeof s?it(s,Y):s)}divide(s){return St(this,"number"==typeof s?it(s,Y):s)}add(s){return It(this,"number"==typeof s?it(s,Y):s)}subtract(s){return Ut(this,"number"==typeof s?it(s,Y):s)}};at.type="vec4",at=V=(0,h._)([S],at);let ht=O=class extends o.vL{constructor(s){super(),this.type="uint",this.children=[s]}clone(){const s=new O((0,o.vA)(this.children[0]));return super.cloneInto(s),s}};ht.type="uint",ht=O=(0,h._)([S],ht);let lt=B=class extends o.vL{constructor(s,p){super(),this.type="uvec2",this.children=[s,p].filter(y=>null!=y)}clone(){const s=new B((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]));return super.cloneInto(s),s}};lt.type="uvec2",lt=B=(0,h._)([S],lt);let yt=A=class extends o.vL{constructor(s,p,y){super(),this.type="uvec3",this.children=[s,p,y].filter(U=>null!=U)}clone(){const s=new A((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]));return super.cloneInto(s),s}};yt.type="uvec3",yt=A=(0,h._)([S],yt);let Pt=K=class extends o.vL{constructor(s,p,y,U){super(),this.type="uvec4",this.children=[s,p,y,U].filter(H=>null!=H)}clone(){const s=new K((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]));return super.cloneInto(s),s}};Pt.type="uvec4",Pt=K=(0,h._)([S],Pt);let _t=(()=>{class s extends o.vL{constructor(y){super(),this.type="bool",this.children=[y]}and(y){return Wt(this,y)}or(y){return Ft(this,y)}clone(){const y=new s((0,o.vA)(this.children[0]));return super.cloneInto(y),y}}return s.type="bool",s})(),bt=F=class extends o.vL{constructor(s,p){super(),this.type="bvec2",this.children=[s,p].filter(y=>null!=y)}all(){return Bt(this)}any(){return Rt(this)}clone(){const s=new F((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]));return super.cloneInto(s),s}};bt.type="bvec2",bt=F=(0,h._)([S],bt);let mt=T=class extends o.vL{constructor(s,p,y){super(),this.type="bvec3",this.children=[s,p,y].filter(U=>null!=U)}all(){return Bt(this)}any(){return Rt(this)}clone(){const s=new T((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]));return super.cloneInto(s),s}};function it(s,p){return"number"==typeof s?new p(s):s}mt.type="bvec3",mt=T=(0,h._)([S],mt);let Tt=P=class extends o.vL{constructor(s,p,y,U){super(),this.type="bvec4",this.children=[s,p,y,U].filter(H=>null!=H)}all(){return Bt(this)}any(){return Rt(this)}clone(){const s=new P((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]));return super.cloneInto(s),s}};Tt.type="bvec4",Tt=P=(0,h._)([S],Tt);let Ot=(()=>{class s extends o.vL{constructor(y){super(),this.type="int",this.children=[y]}multiply(y){return xt(this,it(y,s))}add(y){return It(this,it(y,s))}subtract(y){return Ut(this,it(y,s))}divide(y){return St(this,it(y,s))}clone(){const y=new s((0,o.vA)(this.children[0]));return super.cloneInto(y),y}}return s.type="int",s})(),Z=m=class extends o.vL{constructor(s,p){super(),this.type="ivec2",this.children=[s,p].filter(y=>null!=y)}clone(){const s=new m((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]));return super.cloneInto(s),s}};Z.type="ivec2",Z=m=(0,h._)([S],Z);let a=M=class extends o.vL{constructor(s,p,y){super(),this.type="ivec3",this.children=[s,p,y].filter(U=>null!=U)}clone(){const s=new M((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]));return super.cloneInto(s),s}};a.type="ivec3",a=M=(0,h._)([S],a);let d=f=class extends o.vL{constructor(s,p,y,U){super(),this.type="ivec4",this.children=[s,p,y,U].filter(H=>null!=H)}clone(){const s=new f((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]));return super.cloneInto(s),s}};d.type="ivec4",d=f=(0,h._)([S],d);let D=(()=>{class s extends o.vL{static identity(){return new s(1,0,0,0,1,0,0,0,1)}static fromRotation(y){const U=Nt(y),H=zt(y);return new s(H,U,0,Ct(U),H,0,0,0,1)}constructor(y,U,H,et,Mt,Et,vt,At,jt){super(),this.type="mat3",this.children=[y,U,H,et,Mt,Et,vt,At,jt]}add(y){return It(this,y)}multiply(y){return xt(this,y)}clone(){const y=new s((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]),(0,o.vA)(this.children[4]),(0,o.vA)(this.children[5]),(0,o.vA)(this.children[6]),(0,o.vA)(this.children[7]),(0,o.vA)(this.children[8]));return super.cloneInto(y),y}}return s.type="mat3",s})(),I=(()=>{class s extends o.vL{static identity(){return new s(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(y,U,H,et,Mt,Et,vt,At,jt,Ee,Me,Pe,be,Oe,De,we){super(),this.type="mat4",this.children=[y,U,H,et,Mt,Et,vt,At,jt,Ee,Me,Pe,be,Oe,De,we]}static fromColumns(y,U,H,et){return new s(y.x,y.y,y.z,y.w,U.x,U.y,U.z,U.w,H.x,H.y,H.z,H.w,et.x,et.y,et.z,et.w)}multiply(y){return xt(this,y)}clone(){const y=new s((0,o.vA)(this.children[0]),(0,o.vA)(this.children[1]),(0,o.vA)(this.children[2]),(0,o.vA)(this.children[3]),(0,o.vA)(this.children[4]),(0,o.vA)(this.children[5]),(0,o.vA)(this.children[6]),(0,o.vA)(this.children[7]),(0,o.vA)(this.children[8]),(0,o.vA)(this.children[9]),(0,o.vA)(this.children[10]),(0,o.vA)(this.children[11]),(0,o.vA)(this.children[12]),(0,o.vA)(this.children[13]),(0,o.vA)(this.children[14]),(0,o.vA)(this.children[15]));return super.cloneInto(y),y}}return s.type="mat4",s})();const R={float:Y,vec2:ot,vec3:pt,vec4:at,int:Ot,ivec2:Z,ivec3:a,ivec4:d,uint:ht,uvec2:lt,uvec3:yt,uvec4:Pt,bool:_t,bvec2:bt,bvec3:mt,bvec4:Tt},G=(...s)=>new Ot(...s),X=(...s)=>new Y(...s),k=(...s)=>new ot(...s),q=(...s)=>new pt(...s),ct=(...s)=>new at(...s),Dt=(...s)=>new D(...s);function ft(s,p,y){const U=new y(new o.zg(p,s,y));return U.isImplicit=!0,U}function dt(s,p,y,U=null){if(U){const et=new U,Mt=new U(new o.aw(s,[p,y],!0,!1,et));return Mt.isImplicit=!0,Mt}if("float"===p.type||"int"===p.type){const et=new y.constructor(new o.aw(s,[p,y],!0,!1,y.constructor));return et.isImplicit=!0,et}if(("mat2"===p.type||"mat3"===p.type||"mat4"===p.type)&&"float"!==y.type){const et=new y.constructor(new o.aw(s,[p,y],!0,!1,y.constructor));return et.isImplicit=!0,et}const H=new p.constructor(new o.aw(s,[p,y],!0,!1,p.constructor));return H.isImplicit=!0,H}function N(s,p,y=p.constructor){const U=new y(new o.aw(s,[p],!1,!1,y));return U.isImplicit=!0,U}function ut(s,p,y,U=p.constructor){const H=new U(new o.aw(s,[p,y],!1,!1,U));return H.isImplicit=!0,H}function wt(s,p,y,U,H=p.constructor){const et=new H(new o.aw(s,[p,y,U],!1,!1,H));return et.isImplicit=!0,et}function Ct(s){return xt(s,X(-1))}function Kt(s,p,y,U){return new p(new o.rR(s,p,y,U))}function Vt(s,p,y){const U="function"==typeof p?p():p,H="function"==typeof y?y():y,et=new U.constructor(new o.XL(s,U,H));return et.isImplicit=!0,et}function kt(...s){const p=s.map(([Et,vt])=>"function"==typeof vt?[Et,vt()]:[Et,vt]),y=p[0][1].constructor,U=p.findIndex(Et=>!0===Et[0]);if(-1===U)throw new Error("A cond must have a fallthrough case with `true`/; ");const Mt=new y(p.slice(0,U).reduceRight((Et,vt)=>Vt(vt[0],vt[1],Et),p[U][1]));return Mt.isImplicit=!0,Mt}function xt(s,p){return dt("*",s,p)}function St(s,p){return dt("/",s,p)}function It(s,p){return dt("+",s,p)}function Ut(s,p){return dt("-",s,p)}function Ht(s,p){return dt(">>",s,p)}function Yt(s,p){return dt("&",s,p)}function Xt(s,p){return dt("==",s,p,_t)}function Jt(s,p){return dt("<",s,p,_t)}function Qt(s,p){return dt("<=",s,p,_t)}function qt(s,p){return dt(">",s,p,_t)}function te(s,p){return dt(">=",s,p,_t)}function Ft(...s){return s.length<=1?s[0]:s.slice(1).reduce((p,y)=>function ee(s,p){return dt("||",s,p,_t)}(p,y),s[0])}function Wt(...s){return s.length<=1?s[0]:s.slice(1).reduce((p,y)=>function ne(s,p){return dt("&&",s,p,_t)}(p,y),s[0])}function re(s){return N("abs",s)}function Bt(s){return N("all",s,_t)}function Rt(s){return N("any",s,_t)}function ie(s){return N("ceil",s)}function se(s,p,y){return wt("clamp",s,p,y,s.constructor)}function zt(s){return N("cos",s)}function oe(s,p){return ut("distance",s,p,Y)}function ae(s,p){return ut("dot",s,p,Y)}function ue(s){return N("floor",s)}function le(s){return N("fract",s)}function ce(s){return N("length",s,Y)}function de(s,p){return ut("max",s,p)}function he(s,p){return ut("min",s,p)}function _e(s,p,y){return wt("mix",s,p,y)}function pe(s,p){return ut("mod",s,p)}function fe(s){return N("normalize",s)}function ye(s){return N("bool"===s.type?"!":"not",s)}function Nt(s){return N("sin",s)}function ve(s,p,y){return wt("smoothstep",s,p,y)}function me(s,p){return ut("step",s,p,p.constructor)}function ge(s,p){return ut("texture2D",s,p,at)}},8137:(tt,W,_)=>{var h,o;_.d(W,{N:()=>h}),(o=h||(h={}))[o.Fill=0]="Fill",o[o.PatternFill=1]="PatternFill",o[o.ComplexFill=2]="ComplexFill",o[o.OutlineFill=3]="OutlineFill",o[o.PatternOutlineFill=4]="PatternOutlineFill",o[o.ComplexOutlineFill=5]="ComplexOutlineFill",o[o.Marker=6]="Marker",o[o.PieChart=7]="PieChart",o[o.Line=8]="Line",o[o.TexturedLine=9]="TexturedLine",o[o.Text=10]="Text",o[o.Label=11]="Label",o[o.Heatmap=12]="Heatmap",o[o.DotDensity=13]="DotDensity",o[o.Test=14]="Test"},93300:(tt,W,_)=>{_.d(W,{c:()=>h});const h={bitset:{isSDF:0,isMapAligned:1,scaleSymbolsProportionally:2,overrideOutlineColor:3,colorLocked:4}}},4196:(tt,W,_)=>{_.d(W,{f_:()=>m,$Z:()=>T,DM:()=>P,rz:()=>F});var h=_(8189),o=_(25735),c=_(24821),g=_(3902),j=_(3248),V=_(875);class O extends c.k2{getVisualVariableData(f){if(!this._vvData){const v=this.getAttributeDataCoords(f);this._vvData=(0,g.US)(this.visualVariableData,v).setDebugName("storage2")}return this._vvData}getAttributeDataCoords(f){if(!this._uv){const v=(0,V.Kt)(f),b=this.size,x=(0,g.Wh)(v.x),C=(0,g.Wh)(v.y).multiply((0,g.Wh)(256)),L=(0,g.Wh)(v.z).multiply((0,g.Wh)(256)).multiply((0,g.Wh)(256)),w=(0,g.fV)(x.add(C).add(L)),$=(0,g.zi)(w,b),z=w.subtract($).divide(b);this._uv=new g.ZY($,z).add(.5).divide(b)}return this._uv}getFilterData(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.filterFlags,v).setDebugName("storage0")}getAnimationData(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.animation,v).setDebugName("storage1")}getVVData(f){return this.getVisualVariableData(f)}getDataDrivenData0(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.dataDriven0,v).setDebugName("storage30")}getDataDrivenData1(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.dataDriven1,v).setDebugName("storage31")}getDataDrivenData2(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.dataDriven2,v).setDebugName("storage32")}getGPGPUData(f){const v=this.getAttributeDataCoords(f);return(0,g.US)(this.gpgpu,v).setDebugName("storage4")}getFilterFlags(f){return(0,j.A)("webgl-ignores-sampler-precision")?(0,g.mk)(this.getFilterData(f).x.multiply((0,g.fV)(255))):this.getFilterData(f).x.multiply((0,g.fV)(255))}getAnimationValue(f){return this.getAnimationData(f).x}getSizeValue(f){return this.getVisualVariableData(f).x}getColorValue(f){return this.getVisualVariableData(f).y}getOpacityValue(f){return this.getVisualVariableData(f).z}getRotationValue(f){return this.getVisualVariableData(f).w}}(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"filterFlags",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"animation",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"gpgpu",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"visualVariableData",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"dataDriven0",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"dataDriven1",void 0),(0,h._)([(0,c.Pi)(g.z7)],O.prototype,"dataDriven2",void 0),(0,h._)([(0,c.Pi)(g.nt)],O.prototype,"size",void 0);class B extends c.k2{}(0,h._)([(0,c.Pi)(g.nt)],B.prototype,"activeReasons",void 0),(0,h._)([(0,c.Pi)(g.nt)],B.prototype,"highlightAll",void 0);class A extends c.k2{}(0,h._)([(0,c.Pi)(g.ZY)],A.prototype,"position",void 0),(0,h._)([(0,c.Pi)(g.nt)],A.prototype,"distance",void 0),(0,h._)([(0,c.Pi)(g.nt)],A.prototype,"smallSymbolDistance",void 0),(0,h._)([(0,c.Pi)(g.nt)],A.prototype,"smallSymbolSizeThreshold",void 0);var K=_(16585);class F extends c.ZA{}(0,h._)([(0,c.C5)(0,g.eB)],F.prototype,"id",void 0),(0,h._)([(0,c.C5)(1,g.nt)],F.prototype,"bitset",void 0),(0,h._)([(0,c.C5)(2,g.ZY)],F.prototype,"pos",void 0);class T extends c.Y7{}(0,h._)([(0,c.C5)(14,g.ZY)],T.prototype,"nextPos1",void 0),(0,h._)([(0,c.C5)(15,g.ZY)],T.prototype,"nextPos2",void 0);class P extends c.HS{}class m extends c.A{clip(f,v){let b=new g.nt(0);const x=this.storage.getFilterFlags(f);if(b=b.add((0,g.fV)(2).multiply((0,g.fV)(1).subtract((0,V.i6)(x,0)))),this.inside?b=b.add((0,g.fV)(2).multiply((0,g.fV)(1).subtract((0,V.i6)(x,1)))):this.outside?b=b.add((0,g.fV)(2).multiply((0,V.i6)(x,1))):this.highlight&&(b=b.add((0,g.fV)(2).multiply((0,g.fV)(1).subtract(this._checkHighlight(x))))),null!=v){const C=new g.nt(1).subtract((0,g.PM)(v.x,this.view.currentZoom)),L=(0,g.PM)(v.y,this.view.currentZoom);b=b.add(new g.nt(2).multiply(C.add(L)))}return b}getFragmentOutput(f,v,b=new g.nt(1/255)){const x=new c.mm;return x.glFragColor=this._maybeWriteHittest(v)??this._maybeHighlight(f,b)??f,x}_maybeHighlight(f,v){return this.highlight?new g.Zb(f.rgb,(0,g.PM)(v,f.a)):null}_checkHighlight(f){let v=this._checkHighlightBit(f,0);for(let b=1;b<o.M$.length;b++)v=v.add(this._checkHighlightBit(f,b));return(0,g.PM)(new g.nt(.1),v.add(this.highlight.highlightAll))}_checkHighlightBit(f,v){return(0,V.yS)(f,v).multiply((0,V.mh)(this.highlight.activeReasons,v))}maybeRunHittest(f,v,b){if(null==this.hittestRequest)return null;const x=this.hittest(f,v,b);let C=(0,g.Tk)((0,g.MM)(x,this.hittestRequest.distance),new g.nt(2),new g.nt(0));const L=this.storage.getAttributeDataCoords(f.id),w=(0,V.nb)(L);C=C.add(this.clip(f.id,f.zoomRange));const $=new g.Zb(new g.nt(1/255),0,0,0);return{glPointSize:new g.nt(1),glPosition:new g.Zb(w,C,1),color:$}}_maybeWriteHittest(f){return null!=this.hittestRequest?f.color:null}}(0,h._)([c.E8],m.prototype,"inside",void 0),(0,h._)([c.E8],m.prototype,"outside",void 0),(0,h._)([(0,c.uK)(B)],m.prototype,"highlight",void 0),(0,h._)([(0,c.Pi)(O)],m.prototype,"storage",void 0),(0,h._)([(0,c.Pi)(K.o)],m.prototype,"view",void 0),(0,h._)([(0,c.uK)(A)],m.prototype,"hittestRequest",void 0)},61254:(tt,W,_)=>{_.d(W,{Bh:()=>m,KP:()=>P,Ps:()=>M});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(90731),V=_(35891),O=_(83090),B=_(28580),A=_(875);class K extends V._{}function P(f,v){const b=f.view.requiredZoomFactor,x=new c.ZY(v.width,v.height),C=x.multiply(v.scale).multiply(b),L=v.angle.multiply(j.rp),w=(0,c.F8)(L),$=(0,c.gn)(L),z=function T(f,v,b,x,C){const L=(0,c.LC)((0,A.mh)(C,j.Fz),(0,c.fV)(1)),w=(0,A.Rj)(new c.Zb(f,0));return(0,c.Tk)(L,(0,c.w0)(x.divide(v.x),b.divide(v.y),0,(0,c.ze)(b.divide(v.x)),x.divide(v.y),0,(0,A._9)((0,c.Zc)(w,0)),(0,A._9)((0,c.Zc)(0,w)),1),(0,c.w0)(x.divide(v.x),b.divide(v.y),0,(0,c.ze)(b.divide(v.x)),x.divide(v.y),0,0,0,1))}(v.id,C,w,$,v.bitset),S=f.localTileOffset.getPatternOffsetAtTileOrigin(x,w,$),J=b.multiply(v.scale).multiply(v.offset.subtract(S)).divide(C),Q=new c.eB(v.pos,1),nt=z.multiply(Q).xy.subtract(J),rt=v.tlbr.divide(f.mosaicInfo.size.xyxy);let st=(0,A.mh)(v.bitset,j.cn);return null!=f.visualVariableColor&&(st=(0,c.Tk)((0,A.M8)(f.storage.getColorValue(v.id)),new c.nt(0),st)),{tileTextureCoord:nt,tlbr:rt,sampleAlphaOnly:st}}function m(f,v){const b=(0,c.zi)(v.tileTextureCoord,new c.nt(1)),x=(0,c.jh)(v.tlbr.xy,v.tlbr.zw,b);let C=(0,c.US)(f.mosaicInfo.texture,x);return C=(0,c.Tk)((0,c.MM)(v.sampleAlphaOnly,new c.nt(.5)),C.aaaa,C),v.color.multiply(C)}(0,h._)([(0,o.C5)(5,c.Zb)],K.prototype,"tlbr",void 0),(0,h._)([(0,o.C5)(6,c.nt)],K.prototype,"width",void 0),(0,h._)([(0,o.C5)(7,c.nt)],K.prototype,"height",void 0),(0,h._)([(0,o.C5)(8,c.ZY)],K.prototype,"offset",void 0),(0,h._)([(0,o.C5)(9,c.ZY)],K.prototype,"scale",void 0),(0,h._)([(0,o.C5)(10,c.nt)],K.prototype,"angle",void 0);class M extends V.z{vertex(v,b){return{...super.vertex(v,b),...P(this,v)}}fragment(v){const b=m(this,v);return this.getFragmentOutput(b,v,new c.nt(0))}}(0,h._)([(0,o.Pi)(B.b)],M.prototype,"mosaicInfo",void 0),(0,h._)([(0,o.Pi)(O.P)],M.prototype,"localTileOffset",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(K)),(0,h.a)(1,(0,o.hF)(g.$Z))],M.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(class F extends g.DM{}))],M.prototype,"fragment",null)},80302:(tt,W,_)=>{_.d(W,{RH:()=>v,cZ:()=>T,v9:()=>m});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(61254),V=_(6702),O=_(95827),B=_(83090),A=_(28580),K=_(3772),F=_(89148);const T=16,P=1/T,m=128;class M extends g.rz{}(0,h._)([(0,o.C5)(3,c.Zb)],M.prototype,"color",void 0),(0,h._)([(0,o.C5)(4,c.Zb)],M.prototype,"tlbr",void 0),(0,h._)([(0,o.C5)(5,c.nt)],M.prototype,"angle",void 0),(0,h._)([(0,o.C5)(6,c.nt)],M.prototype,"aux1",void 0),(0,h._)([(0,o.C5)(7,c.nt)],M.prototype,"aux2",void 0),(0,h._)([(0,o.C5)(8,c.ZY)],M.prototype,"aux3",void 0),(0,h._)([(0,o.C5)(9,c.ZY)],M.prototype,"aux4",void 0),(0,h._)([(0,o.C5)(10,c.ZY)],M.prototype,"zoomRange",void 0);class v extends K.My{vertex(x,C){const{aux1:L,aux2:w,aux3:$,aux4:z}=x,S={...x,width:L,height:w,offset:$,scale:z.multiply(P)},J={...x,halfWidth:L,referenceHalfWidth:w,offset:$,normal:z.subtract(m).multiply(P)},Q=(0,K.Yb)(this,J),nt=(0,j.KP)(this,S),rt=(0,c.MM)(Q.isOutline,new c.nt(.5));return{...Q,...nt,...this.maybeRunHittest(x,C,rt)}}fragment(x){const{isOutline:C}=x,L=(0,c.MM)(C,new c.nt(.5)),w=(0,O.o7)(x,this.antialiasingControls.blur),$=(0,j.Bh)(this,x),z=(0,c.Tk)(L,w,$),S=(0,c.Tk)(L,new c.nt(1/255),new c.nt(0));return this.getFragmentOutput(z,x,S)}hittest(x,C,L){return(0,c.Tk)(L,(0,V.My)(this.hittestRequest),(0,V.Lq)(this,x,C))}}(0,h._)([(0,o.Pi)(A.b)],v.prototype,"mosaicInfo",void 0),(0,h._)([(0,o.Pi)(B.P)],v.prototype,"localTileOffset",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(M)),(0,h.a)(1,(0,o.hF)(g.$Z))],v.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(class f extends F.A1{}))],v.prototype,"fragment",null)},35891:(tt,W,_)=>{_.d(W,{_:()=>A,z:()=>K});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(6702),V=_(79677),O=_(35255),B=_(95171);class A extends g.rz{}(0,h._)([(0,o.C5)(3,c.Zb)],A.prototype,"color",void 0),(0,h._)([(0,o.C5)(4,c.ZY)],A.prototype,"zoomRange",void 0);class K extends g.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(T,P){const m=(0,B.cF)(this,T.id),M=(0,B.G7)(this,T.id,T.color).multiply(m),f=this.view.displayViewScreenMat3.multiply(new c.eB(T.pos.xy,1)),v=this.clip(T.id,T.zoomRange);return{glPosition:new c.Zb(f.xy,v,1),color:M,...this.maybeRunHittest(T,P,null)}}fragment(T){return this.getFragmentOutput(T.color,T,new c.nt(0))}hittest(T,P){return(0,j.Lq)(this,T,P)}}(0,h._)([(0,o.uK)(V._)],K.prototype,"visualVariableColor",void 0),(0,h._)([(0,o.uK)(O.i)],K.prototype,"visualVariableOpacity",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(A)),(0,h.a)(1,(0,o.hF)(g.$Z))],K.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(g.DM))],K.prototype,"fragment",null)},95827:(tt,W,_)=>{_.d(W,{$0:()=>C,Xc:()=>m,cM:()=>w,fF:()=>M,fg:()=>f,o7:()=>L,xw:()=>b});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(90731),V=_(6702),O=_(79677),B=_(35255),A=_(2098),K=_(14082),F=_(25688),T=_(47150),P=_(95171);class m extends g.rz{}(0,h._)([(0,o.C5)(3,c.Zb)],m.prototype,"color",void 0),(0,h._)([(0,o.C5)(4,c.ZY)],m.prototype,"offset",void 0),(0,h._)([(0,o.C5)(5,c.ZY)],m.prototype,"normal",void 0),(0,h._)([(0,o.C5)(6,c.nt)],m.prototype,"halfWidth",void 0),(0,h._)([(0,o.C5)(7,c.nt)],m.prototype,"referenceHalfWidth",void 0),(0,h._)([(0,o.C5)(8,c.ZY)],m.prototype,"zoomRange",void 0);class M extends g.DM{}class f extends o.k2{}function v($){return(0,c.T9)(new c.nt(j.Fb).multiply((0,c.PM)($,new c.nt(j.J5))),new c.nt(1))}function b($,z){const{halfWidth:S,normal:J}=$,Q=v(S),nt=(0,c.Bw)(J).multiply(S);return(0,c.qE)(Q.multiply(S.subtract(nt)).divide(z.add(Q).subtract(new c.nt(1))),new c.nt(0),new c.nt(1))}function C($,z){const{id:S,offset:J,pos:Q,normal:nt,zoomRange:rt}=z,{displayViewScreenMat3:st,displayViewMat3:Y}=$.view,ot=(0,P.G7)($,S,z.color),pt=(0,P.cF)($,S),at=function x($,z){const{id:S,halfWidth:J,referenceHalfWidth:Q}=z;if((0,P.G5)($)){const nt=new c.nt(2).multiply(Q),rt=(0,P.Mg)($,S,nt);return new c.nt(.5).multiply(J.divide((0,c.T9)(Q,new c.nt(j.Ni)))).multiply(rt)}return J}($,z),ht=new c.nt(.5).multiply($.antialiasingControls.antialiasing),lt=(0,c.T9)(at.add(ht),new c.nt(.45)).add(new c.nt(.1).multiply(ht)),yt=v(lt).multiply(lt).multiply(J),Pt=Y.multiply(new c.eB(yt,new c.nt(0))),_t=st.multiply(new c.eB(Q,new c.nt(1))).add(Pt),bt=new c.nt(2).multiply((0,c.PM)(at,new c.nt(0))).add($.clip(S,rt)),mt=new c.Zb(_t.xy,bt,1);return{color:ot,opacity:pt,halfWidth:lt,normal:nt,scaledOffset:yt,scaledHalfWidth:at,glPosition:new c.Zb(mt.xy,bt,1)}}function L($,z){const{opacity:S,color:J}=$,Q=b($,z);return S.multiply(J).multiply(Q)}(0,h._)([(0,o.Pi)(c.nt)],f.prototype,"antialiasing",void 0),(0,h._)([(0,o.Pi)(c.nt)],f.prototype,"blur",void 0);class w extends g.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}vertex(z,S){const J=C(this,z);return{...J,...this.maybeRunHittest(z,S,J.halfWidth)}}fragment(z){const S=L(z,this.antialiasingControls.blur);return this.getFragmentOutput(S,z)}hittest(z,S,J){const{viewMat3:Q,tileMat3:nt}=this.view,rt=Q.multiply(nt),st=rt.multiply(new c.eB(z.pos,1)),Y=rt.multiply(new c.eB(S.nextPos1,1)),ot=rt.multiply(new c.eB(S.nextPos2,1)),{distance:pt,smallSymbolDistance:at,smallSymbolSizeThreshold:ht}=this.hittestRequest,lt=(0,c.PM)(J,ht.multiply(.5)).multiply(pt.subtract(at)),yt=this.hittestRequest.position;return(0,c.jk)((0,V.E2)(yt,st.xy,Y.xy),(0,V.E2)(yt,st.xy,ot.xy)).subtract(J).add(lt)}}(0,h._)([(0,o.Pi)(f)],w.prototype,"antialiasingControls",void 0),(0,h._)([(0,o.uK)(O._)],w.prototype,"visualVariableColor",void 0),(0,h._)([(0,o.uK)(B.i)],w.prototype,"visualVariableOpacity",void 0),(0,h._)([(0,o.uK)(A.n)],w.prototype,"visualVariableSizeMinMaxValue",void 0),(0,h._)([(0,o.uK)(K.F)],w.prototype,"visualVariableSizeScaleStops",void 0),(0,h._)([(0,o.uK)(F.N)],w.prototype,"visualVariableSizeStops",void 0),(0,h._)([(0,o.uK)(T.d)],w.prototype,"visualVariableSizeUnitValue",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(m)),(0,h.a)(1,(0,o.hF)(g.$Z))],w.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(M))],w.prototype,"fragment",null)},83090:(tt,W,_)=>{_.d(W,{P:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(90731);class j extends o.k2{getPatternOffsetAtTileOrigin(O,B=new c.nt(0),A=new c.nt(1)){const K=new c.ZY(g.YV).divide(O);let F=O.multiply((0,c.jc)(this.maxIntsToLocalOrigin.multiply(K))).add(this.tileOffsetFromLocalOrigin).subtract(new c.nt(.5).multiply(O));return F=new c.ZY(F.x.multiply(A).subtract(F.y.multiply(B)),F.x.multiply(B).add(F.y.multiply(A))),(0,c.zi)(F,O)}}(0,h._)([(0,o.Pi)(c.ZY)],j.prototype,"tileOffsetFromLocalOrigin",void 0),(0,h._)([(0,o.Pi)(c.ZY)],j.prototype,"maxIntsToLocalOrigin",void 0)},28580:(tt,W,_)=>{_.d(W,{b:()=>g});var h=_(8189),o=_(24821),c=_(3902);class g extends o.k2{}(0,h._)([(0,o.Pi)(c.ZY)],g.prototype,"size",void 0),(0,h._)([(0,o.Pi)(c.z7)],g.prototype,"texture",void 0)},3772:(tt,W,_)=>{_.d(W,{A7:()=>v,My:()=>x,Yb:()=>b,nj:()=>C,wG:()=>f});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(90731),V=_(6702),O=_(95827),B=_(875),A=_(79677),K=_(35255),F=_(2098),T=_(14082),P=_(25688),m=_(47150),M=_(95171);class f extends g.rz{}(0,h._)([(0,o.C5)(3,c.ZY)],f.prototype,"offset",void 0),(0,h._)([(0,o.C5)(4,c.Zb)],f.prototype,"color",void 0),(0,h._)([(0,o.C5)(5,c.ZY)],f.prototype,"normal",void 0),(0,h._)([(0,o.C5)(6,c.nt)],f.prototype,"halfWidth",void 0),(0,h._)([(0,o.C5)(7,c.nt)],f.prototype,"referenceHalfWidth",void 0),(0,h._)([(0,o.C5)(8,c.ZY)],f.prototype,"zoomRange",void 0);class v extends O.fF{}function b(L,w,$){const{id:z,bitset:S}=w,J=(0,B.mh)(S,j.Xx),Q=(0,c.MM)(J,new c.nt(.5)),nt=(0,O.$0)(L,w),rt=(0,c.Tk)(Q,nt.halfWidth,new c.nt(0)),st=(0,M.cF)(L,z),Y=(0,M.G7)(L,z,w.color),ot=(0,c.Tk)(Q,w.color,Y.multiply(st)),pt=L.view.displayViewScreenMat3.multiply(new c.eB(w.pos.xy,1)),at=L.clip(w.id),ht=new c.Zb(pt.xy,at,1),lt=(0,c.Tk)(Q,nt.glPosition,ht),yt=$&&L.maybeRunHittest(w,$,Q);return{isOutline:J,color:ot,opacity:new c.nt(1),halfWidth:rt,normal:nt.normal,glPosition:lt,...yt}}class x extends g.f_{constructor(){super(...arguments),this.computeAttributes={pos:["nextPos1","nextPos2"]}}}(0,h._)([(0,o.Pi)(O.fg)],x.prototype,"antialiasingControls",void 0),(0,h._)([(0,o.uK)(A._)],x.prototype,"visualVariableColor",void 0),(0,h._)([(0,o.uK)(K.i)],x.prototype,"visualVariableOpacity",void 0),(0,h._)([(0,o.uK)(F.n)],x.prototype,"visualVariableSizeMinMaxValue",void 0),(0,h._)([(0,o.uK)(T.F)],x.prototype,"visualVariableSizeScaleStops",void 0),(0,h._)([(0,o.uK)(P.N)],x.prototype,"visualVariableSizeStops",void 0),(0,h._)([(0,o.uK)(m.d)],x.prototype,"visualVariableSizeUnitValue",void 0);class C extends x{vertex(w,$){return b(this,w,$)}fragment(w){const{color:$,isOutline:z}=w,S=(0,c.MM)(z,new c.nt(.5)),J=(0,O.o7)(w,this.antialiasingControls.blur),Q=(0,c.Tk)(S,J,$),nt=(0,c.Tk)(S,new c.nt(1/255),new c.nt(0));return this.getFragmentOutput(Q,w,nt)}hittest(w,$,z){return(0,c.Tk)(z,(0,V.My)(this.hittestRequest),(0,V.Lq)(this,w,$))}}(0,h._)([(0,h.a)(0,(0,o.hF)(f)),(0,h.a)(1,(0,o.hF)(g.$Z))],C.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(v))],C.prototype,"fragment",null)},61312:(tt,W,_)=>{_.d(W,{_u:()=>F,dW:()=>T,vx:()=>P});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(35891),V=_(83090),O=_(28580);class B extends j._{}function F(m,M){const f=M.tlbr.xy,v=M.tlbr.zw,b=v.x.subtract(f.x),x=f.y.subtract(v.y),C=new c.ZY(b,x).multiply(M.inverseRasterizationScale),L=C.multiply(m.view.requiredZoomFactor),w=function K(m){const M=new c.nt(1),f=new c.nt(0);return new c.U(M.divide(m.x),f.divide(m.y),0,(0,c.ze)(f.divide(m.x)),M.divide(m.y),0,0,0,1)}(L),$=m.localTileOffset.getPatternOffsetAtTileOrigin(C).divide(L),z=new c.eB(M.pos,1);return{tileTextureCoord:w.multiply(z).xy.subtract($),tlbr:M.tlbr.divide(m.mosaicInfo.size.xyxy)}}function T(m,M){const f=(0,c.zi)(m.tileTextureCoord,new c.nt(1)),v=(0,c.jh)(m.tlbr.xy,m.tlbr.zw,f),b=(0,c.US)(M.texture,v);return m.color.multiply(b)}(0,h._)([(0,o.C5)(5,c.Zb)],B.prototype,"tlbr",void 0),(0,h._)([(0,o.C5)(6,c.nt)],B.prototype,"inverseRasterizationScale",void 0);class P extends j.z{vertex(M,f){return{...super.vertex(M,f),...F(this,M)}}fragment(M){const f=T(M,this.mosaicInfo);return this.getFragmentOutput(f,M,new c.nt(0))}}(0,h._)([(0,o.Pi)(O.b)],P.prototype,"mosaicInfo",void 0),(0,h._)([(0,o.Pi)(V.P)],P.prototype,"localTileOffset",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(B)),(0,h.a)(1,(0,o.hF)(g.$Z))],P.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(class A extends g.DM{}))],P.prototype,"fragment",null)},89148:(tt,W,_)=>{_.d(W,{A1:()=>F,tA:()=>T});var h=_(8189),o=_(24821),c=_(3902),g=_(4196),j=_(95827),V=_(83090),O=_(28580),B=_(3772),A=_(61312);class K extends B.wG{}(0,h._)([(0,o.C5)(9,c.Zb)],K.prototype,"tlbr",void 0),(0,h._)([(0,o.C5)(10,c.nt)],K.prototype,"inverseRasterizationScale",void 0);class F extends B.A7{}class T extends B.nj{vertex(m,M){return{...(0,B.Yb)(this,m,M),...(0,A._u)(this,m)}}fragment(m){const{isOutline:M}=m,f=(0,c.MM)(M,new c.nt(.5)),v=(0,j.o7)(m,this.antialiasingControls.blur),b=(0,A.dW)(m,this.mosaicInfo),x=(0,c.Tk)(f,v,b),C=(0,c.Tk)(f,new c.nt(1/255),new c.nt(0));return this.getFragmentOutput(x,m,C)}}(0,h._)([(0,o.Pi)(O.b)],T.prototype,"mosaicInfo",void 0),(0,h._)([(0,o.Pi)(V.P)],T.prototype,"localTileOffset",void 0),(0,h._)([(0,h.a)(0,(0,o.hF)(K)),(0,h.a)(1,(0,o.hF)(g.$Z))],T.prototype,"vertex",null),(0,h._)([(0,h.a)(0,(0,o.hF)(F))],T.prototype,"fragment",null)},16585:(tt,W,_)=>{_.d(W,{o:()=>g});var h=_(8189),o=_(24821),c=_(3902);class g extends o.k2{}(0,h._)([(0,o.Pi)(c.U)],g.prototype,"displayViewScreenMat3",void 0),(0,h._)([(0,o.Pi)(c.U)],g.prototype,"displayViewMat3",void 0),(0,h._)([(0,o.Pi)(c.U)],g.prototype,"displayMat3",void 0),(0,h._)([(0,o.Pi)(c.U)],g.prototype,"viewMat3",void 0),(0,h._)([(0,o.Pi)(c.U)],g.prototype,"tileMat3",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"displayZoomFactor",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"requiredZoomFactor",void 0),(0,h._)([(0,o.Pi)(c.ZY)],g.prototype,"tileOffset",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"currentScale",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"currentZoom",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"metersPerSRUnit",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"rotation",void 0),(0,h._)([(0,o.Pi)(c.nt)],g.prototype,"pixelRatio",void 0)},79677:(tt,W,_)=>{_.d(W,{_:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(875);class j extends o.k2{getColor(O,B,A){return(0,c.j1)([(0,c.or)((0,g.M8)(O),A),B],[(0,c.$5)(O,this.values.first()),this.colors.first()],[(0,c.aX)(O,this.values.last()),this.colors.last()],[!0,()=>{const K=this.values.findIndex(M=>(0,c.MM)(M,O)),F=this.values.get(K),T=K.subtract(1),P=this.values.get(T),m=O.subtract(P).divide(F.subtract(P));return(0,c.jh)(this.colors.get(T),this.colors.get(K),m)}])}}(0,h._)([(0,o.Pi)(c.My.ofType(c.Zb,8))],j.prototype,"colors",void 0),(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],j.prototype,"values",void 0)},35255:(tt,W,_)=>{_.d(W,{i:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(875);class j extends o.k2{getOpacity(O){return(0,c.j1)([(0,g.M8)(O),new c.nt(1)],[(0,c.$5)(O,this.opacityValues.first()),this.opacities.first()],[(0,c.aX)(O,this.opacityValues.last()),this.opacities.last()],[!0,()=>{const B=this.opacityValues.findIndex(P=>(0,c.MM)(P,O)),A=this.opacityValues.get(B),K=B.subtract(1),F=this.opacityValues.get(K),T=O.subtract(F).divide(A.subtract(F));return(0,c.jh)(this.opacities.get(K),this.opacities.get(B),T)}])}}(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],j.prototype,"opacities",void 0),(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],j.prototype,"opacityValues",void 0)},2098:(tt,W,_)=>{_.d(W,{n:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(875);class j extends o.k2{getSize(O,B){const A=this.minMaxValueAndSize.xy,K=this.minMaxValueAndSize.zw;return(0,c.Tk)((0,g.M8)(O),B,()=>{const F=O.subtract(A.x).divide(A.y.subtract(A.x)),T=(0,c.qE)(F,new c.nt(0),new c.nt(1));return K.x.add(T.multiply(K.y.subtract(K.x)))})}}(0,h._)([(0,o.Pi)(c.Zb)],j.prototype,"minMaxValueAndSize",void 0)},14082:(tt,W,_)=>{_.d(W,{F:()=>g});var h=_(8189),o=_(24821),c=_(3902);class g extends o.k2{getSizeForViewScale(V){return(0,c.j1)([(0,c.$5)(V,this.values.first()),this.sizes.first()],[(0,c.aX)(V,this.values.last()),this.sizes.last()],[!0,()=>{const O=this.values.findIndex(T=>(0,c.MM)(T,V)),B=this.values.get(O),A=O.subtract(1),K=this.values.get(A),F=V.subtract(K).divide(B.subtract(K));return(0,c.jh)(this.sizes.get(A),this.sizes.get(O),F)}])}}(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],g.prototype,"sizes",void 0),(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],g.prototype,"values",void 0)},25688:(tt,W,_)=>{_.d(W,{N:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(875);class j extends o.k2{getSize(O,B){const A=(0,c.j1)([(0,g.M8)(O),B],[(0,c.$5)(O,this.values.first()),this.sizes.first()],[(0,c.aX)(O,this.values.last()),this.sizes.last()],[!0,()=>{const K=this.values.findIndex(M=>(0,c.MM)(M,O)),F=this.values.get(K),T=K.subtract(1),P=this.values.get(T),m=O.subtract(P).divide(F.subtract(P));return(0,c.jh)(this.sizes.get(T),this.sizes.get(K),m)}]);return(0,c.Tk)((0,g.M8)(A),B,A)}}(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],j.prototype,"sizes",void 0),(0,h._)([(0,o.Pi)(c.My.ofType(c.nt,8))],j.prototype,"values",void 0)},47150:(tt,W,_)=>{_.d(W,{d:()=>j});var h=_(8189),o=_(24821),c=_(3902),g=_(875);class j extends o.k2{getSize(O,B){return(0,c.Tk)((0,g.M8)(O),B,O.multiply(this.unitValueToPixelsRatio))}}(0,h._)([(0,o.Pi)(c.nt)],j.prototype,"unitValueToPixelsRatio",void 0)},90731:(tt,W,_)=>{var h,lt;_.d(W,{$w:()=>m,Fb:()=>B,Fz:()=>st,H_:()=>h,J5:()=>A,M:()=>v,Ni:()=>f,V5:()=>O,Xx:()=>rt,YV:()=>ht,au:()=>P,b5:()=>ot,bg:()=>pt,cn:()=>S,kx:()=>Y,os:()=>o,qM:()=>$,rp:()=>c,ti:()=>at}),(lt=h||(h={}))[lt.Geographic=0]="Geographic",lt[lt.Arithmatic=1]="Arithmatic";const o=3.14159265359/180,c=3.14159265359/128,O=1,B=1.1,A=1,P=24,m=8,f=1e-5,v=.05,$=1e-30,S=4,rt=0,st=2,Y=2,ot=3,pt=0,at=3,ht=16777216},6702:(tt,W,_)=>{_.d(W,{Bo:()=>A,Bs:()=>O,E2:()=>j,Lq:()=>F,My:()=>K,g$:()=>T,kW:()=>V});var h=_(3902),o=_(90731),c=_(875);function j(P,m,M){const f=M.subtract(m),v=function g(P,m){return(0,h.Om)(P,(0,h.S8)(m))}(P.subtract(m),f),b=(0,h.qE)(v.divide((0,h.Bw)(f)),new h.nt(0),new h.nt(1));return(0,h.Io)(P,m.add(b.multiply(M.subtract(m))))}function V(P){const m=(0,h.tn)(P);return(0,h.PM)(m.x.add(m.y).add(m.z),new h.nt(1.05))}function O(P,m,M,f){const v=new h.U(M.x.multiply(f.y).subtract(f.x.multiply(M.y)),f.x.multiply(m.y).subtract(m.x.multiply(f.y)),m.x.multiply(M.y).subtract(M.x.multiply(m.y)),M.y.subtract(f.y),f.y.subtract(m.y),m.y.subtract(M.y),f.x.subtract(M.x),m.x.subtract(f.x),M.x.subtract(m.x)),b=m.x.multiply(M.y.subtract(f.y)),x=M.x.multiply(f.y.subtract(m.y)),C=f.x.multiply(m.y.subtract(M.y)),L=b.add(x).add(C);return new h.nt(1).divide(L).multiply(v.multiply(new h.eB(1,P)))}function B(P,m,M,f){return(0,h.LC)(V(O(P,m,M,f)),new h.nt(1))}function A(P,m,M,f){const v=M.subtract(m),b=f.subtract(m),x=(0,c.tL)(v,b),C=(0,h.Uo)((0,h.Xe)(x,new h.nt(o.M)),(0,h.MM)(x,new h.nt(-o.M)));return(0,h.j1)([(0,h.Uo)((0,h.AU)(C),B(P.xy,m,M,f)),new h.nt(-1)],[!0,()=>{const L=j(P,m,M),w=j(P,M,f),$=j(P,f,m);return(0,h.jk)((0,h.jk)(L,w),$)}])}function K(P){return P.distance.add(1)}function F(P,m,M){const{viewMat3:f,tileMat3:v}=P.view,b=f.multiply(v),x=b.multiply(new h.eB(m.pos,1)),C=b.multiply(new h.eB(M.nextPos1,1)),L=b.multiply(new h.eB(M.nextPos2,1));return A(P.hittestRequest.position,x.xy,C.xy,L.xy)}function T(P,m,M){return(0,h.Io)(P,M).subtract(m)}},875:(tt,W,_)=>{_.d(W,{K5:()=>K,Kt:()=>P,M8:()=>j,Rj:()=>m,_9:()=>g,i6:()=>F,mh:()=>A,nb:()=>B,tL:()=>O,xf:()=>M,yS:()=>T});var h=_(25735),o=_(3902),c=_(90731);function g(f){const v=(0,o.fV)(12.9898),b=(0,o.fV)(78.233),x=(0,o.fV)(43758.5453),C=(0,o.Om)(f,(0,o.Zc)(v,b)),L=(0,o.zi)(C,(0,o.fV)(3.14));return(0,o.jc)((0,o.F8)(L).multiply(x))}function j(f){return(0,o.LC)(f,(0,o.fV)(c.qM))}function O(f,v){return f.x.multiply(v.y).subtract(v.x.multiply(f.y))}function B(f){return f.multiply(2).subtract(1)}function A(f,v){const b=(0,o.fV)(2**v);return(0,o.zi)((0,o.RI)(f.divide(b)),(0,o.fV)(2))}function K(f,v){return(0,o.MM)(A(f,v),(0,o.fV)(.5))}function F(f,v){return A(f,v+h.M$.length)}function T(f,v){return A(f,v)}function P(f){const v=A(f.z,7),b=(0,o.fV)(1).subtract(v),x=f.xyz.subtract((0,o.eR)(0,0,(0,o.fV)(128)));return b.multiply(f).add(v.multiply(x))}function m(f){const v=(0,o.ln)(.99609375,.0038909912109375,1519918441772461e-20,5.9371814131736755e-8);return(0,o.Om)(f,v)}function M(f){return(0,o.T9)((0,o.T9)((0,o.T9)(f.x,f.y),f.z),f.w)}},95171:(tt,W,_)=>{_.d(W,{G5:()=>o,G7:()=>g,Mg:()=>c,TL:()=>V,cF:()=>j});var h=_(3902);function o(O){return null!=O.visualVariableSizeMinMaxValue||null!=O.visualVariableSizeScaleStops||null!=O.visualVariableSizeStops||null!=O.visualVariableSizeUnitValue}function c(O,B,A){if(o(O)){const K=O.storage.getSizeValue(B);return O.visualVariableSizeMinMaxValue?.getSize(K,A)??O.visualVariableSizeScaleStops?.getSizeForViewScale(O.view.currentScale)??O.visualVariableSizeStops?.getSize(K,A)??O.visualVariableSizeUnitValue?.getSize(K,A)}return A}function g(O,B,A,K=new h.x(!1)){if(null==O.visualVariableColor)return A;const F=O.storage.getColorValue(B);return O.visualVariableColor.getColor(F,A,K)}function j(O,B){if(null==O.visualVariableOpacity)return new h.nt(1);const A=O.storage.getOpacityValue(B);return O.visualVariableOpacity.getOpacity(A)}function V(O,B){if(null==O.visualVariableRotation)return h.U.identity();const A=O.storage.getRotationValue(B);return O.visualVariableRotation.getVVRotationMat3(A)}},77989:(tt,W,_)=>{_.d(W,{K:()=>M});var h=_(5922),o=_(35150),c=_(89221),A=(_(40707),_(3248),_(77440),_(50915),_(79061),_(23063)),T=(_(68165),_(26136),_(24370));function m(f,v,b){const x=v.length;if(x!==b){const C=new h.A("Invalid Uniform",`Invalid length, expected ${b} but got ${x}`,{uniformName:f,values:v});o.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(C)}}class M{constructor(v,b,x,C,L,w){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=v,this.fragmentShader=b,this._locations=x,this._locationInfo=C,this._uniformBindings=L,this._transformFeedbackBindings=w}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(v){this._uniforms=v}cleanupTemporaryTextures(){for(const v of this._temporaryTextures)v.dispose();this._temporaryTextures=[]}bind(v){const b=this._uniforms;if(!this._program){const C=new Map;for(const[w,$]of this._locations)C.set(w,$);const L=[];for(const w of this._transformFeedbackBindings??[]){const{index:$,propertyKey:z}=w;L[$]=`v_${z}`}this._program=new A.B(v,this.vertexShader,this.fragmentShader,C,new Map,L)}const x=this._program;v.useProgram(x);for(const C of this._uniformBindings){const{shaderModulePath:L,uniformName:w,uniformType:$,uniformArrayLength:z}=C,S=(0,c.wc)(L,b);if(null==S){if("sampler2D"===$)continue;throw new Error(`Failed to find uniform value for ${L}`)}switch("array"===$?C.uniformArrayElementType:$){case"sampler2D":{const{unit:J,texture:Q}=S;if(x.setUniform1i(w,J),"type"in Q)v.bindTexture(Q,J);else{const nt=(0,T.sZ)(v,Q.descriptor,Q.data);v.bindTexture(nt,J)}break}case"int":if(!z){x.setUniform1i(w,S);break}m(C.uniformName,S,z),x.setUniform1iv(w,S);break;case"float":if(!z){x.setUniform1f(w,S);break}m(C.uniformName,S,z),x.setUniform1fv(w,S);break;case"vec2":if(!z){x.setUniform2f(w,S[0],S[1]);break}m(C.uniformName,S,z),x.setUniform2fv(w,S.flat());break;case"vec3":if(!z){x.setUniform3f(w,S[0],S[1],S[2]);break}m(C.uniformName,S,z),x.setUniform3fv(w,S.flat());break;case"vec4":if(!z){x.setUniform4f(w,S[0],S[1],S[2],S[3]);break}m(C.uniformName,S,z),x.setUniform4fv(w,S.flat());break;case"mat3":x.setUniformMatrix3fv(w,S.flat());break;case"mat4":x.setUniformMatrix4fv(w,S.flat());break;default:throw new Error(`Unable to set uniform for type ${$}`)}}}}},35547:(tt,W,_)=>{_.d(W,{F:()=>F});var h=_(8189),o=_(98877),c=_(3248),g=_(12619),j=_(48900),V=_(85211),A=(_(35150),_(40707),_(76576)),K=_(56985);let F=class extends o.A{constructor(T){super(T),this.debugName="",this._updatingHandles=new K.U,this._idToUpdatingState=new g.A}get updating(){const T=this._updatingHandles.updating||Array.from(this._idToUpdatingState.values()).some(P=>P);if((0,c.A)("esri-2d-log-updating")){const P=Array.from(this._idToUpdatingState.entries()).map(([m,M])=>`-> ${m}: ${M}`).join("\n");console.log(`${this.debugName}: Updating: ${T}\n-> Handles: ${this._updatingHandles.updating}\n${P}`)}return T}addUpdateTracking(T,P){const m=(0,j.wB)(()=>P.updating,M=>this._idToUpdatingState.set(T,M),{sync:!0});this.addHandles(m)}addPromise(T){return this._updatingHandles.addPromise(T)}};(0,h._)([(0,V.MZ)({constructOnly:!0})],F.prototype,"debugName",void 0),(0,h._)([(0,V.MZ)({readOnly:!0})],F.prototype,"updating",null),F=(0,h._)([(0,A.$)("esri.views.2d.layers.support.UpdateTracking2D")],F)},20951:(tt,W,_)=>{var h,o;_.d(W,{c:()=>h}),(o=h||(h={}))[o.Pass=0]="Pass",o[o.Draw=1]="Draw"},65388:(tt,W,_)=>{_.d(W,{O_:()=>B,vA:()=>V}),_(45475),_(53781),(0,_(89141).vt)();class j{constructor(M){this.message=M}toString(){return`AssertException: ${this.message}`}}function V(m,M){if(!m){M=M||"Assertion";const f=new Error(M).stack;throw new j(`${M} at ${f}`)}}function B(m,M,f,v){let b,x=(f[0]-m[0])/M[0],C=(v[0]-m[0])/M[0];x>C&&(b=x,x=C,C=b);let L=(f[1]-m[1])/M[1],w=(v[1]-m[1])/M[1];if(L>w&&(b=L,L=w,w=b),x>w||L>C)return!1;L>x&&(x=L),w<C&&(C=w);let $=(f[2]-m[2])/M[2],z=(v[2]-m[2])/M[2];return $>z&&(b=$,$=z,z=b),!(x>z||$>C||(z<C&&(C=z),C<0))}}}]);