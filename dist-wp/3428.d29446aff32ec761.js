"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[3428],{45219:(X,j,l)=>{l.d(j,{OP:()=>I,V4:()=>_,rZ:()=>d}),l(3248);var P=l(35150);function _(x,S,M){if(null==x)return null;const O=S.readArcadeFeature();S.contextTimeZone=M.$view?.timeZone;try{return x.evaluate({...M,$feature:O},x.services)}catch(o){return P.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",o),null}}function d(x){return null==x||x===1/0||x===-1/0||"number"==typeof x&&isNaN(x)}function I(x,S,M,O){if(null==x)return O??null;const o=S.readArcadeFeature();S.contextTimeZone=M.$view?.timeZone;const p=x.evaluate({...M,$feature:o},x.services);return d(p)?O??null:p}},6690:(X,j,l)=>{l.d(j,{U:()=>M});var w=l(88258),P=l(10084);class d{get length(){return this._pos}constructor(o,p){this._pos=0;const E=p?this._roundToNearest(p,o.BYTES_PER_ELEMENT):40;this._array=new ArrayBuffer(E),this._buffer=new o(this._array),this._ctor=o,this._i16View=new Int16Array(this._array)}_roundToNearest(o,p){const E=Math.round(o);return 1===p?E:E+(p-E%p)}_ensureSize(o){if(this._pos+o>=this._buffer.length){const p=this._roundToNearest(1.25*(this._array.byteLength+o*this._buffer.BYTES_PER_ELEMENT),this._buffer.BYTES_PER_ELEMENT),E=new ArrayBuffer(p),F=new this._ctor(E);F.set(this._buffer,0),this._array=E,this._buffer=F,this._i16View=new Int16Array(this._array)}}ensureSize(o){this._ensureSize(o)}writeF32(o){this._ensureSize(1);const p=this._pos;return new Float32Array(this._array,4*this._pos,1)[0]=o,this._pos++,p}push(o){this._ensureSize(1);const p=this._pos;return this._buffer[this._pos++]=o,p}writeFixed(o){this._buffer[this._pos++]=o}setValue(o,p){this._buffer[o]=p}i1616Add(o,p,E){this._i16View[2*o]+=p,this._i16View[2*o+1]+=E}getValue(o){return this._buffer[o]}getValueF32(o){return new Float32Array(this._array,4*o,1)[0]}incr(o){if(this._buffer.length<o)throw new Error("Increment index overflows the target buffer");this._buffer[o]++}decr(o){this._buffer[o]--}writeRegion(o){this._ensureSize(o.length);const p=this._pos;return this._buffer.set(o,this._pos),this._pos+=o.length,p}writeManyFrom(o,p,E){this._ensureSize(E-p);for(let F=p;F!==E;F++)this.writeFixed(o._buffer[F])}buffer(){const o=this._array.slice(0,4*this._pos);return this.destroy(),o}toArray(){return[...this._buffer]}seek(o){this._pos=o}destroy(){this._array=null,this._buffer=null}}class S{constructor(o,p,E=0){const F=6*E*Uint32Array.BYTES_PER_ELEMENT,L=4*E*p.stride,H=p.stride/4,g=p.attributes.find(A=>"pos"===A.name||"position"===A.name);if(!g)throw new Error("InternalError: Unable to find position attribute");this.layout={...p,position:g},this._indices=new d(Uint32Array,F),this._vertices=new d(Uint32Array,L),this._metrics=new d(Uint32Array,0),this._metricCountOffset=this._metrics.push(0),this._strideInt=H,this._instanceId=o}serialize(o){const p=this._indices.buffer(),E=this._vertices.buffer(),F=this._metrics.length?this._metrics.buffer():null;return o.push(p,E),{instanceId:this._instanceId,layout:this.layout,indices:p,vertices:E,metrics:F}}get strideInt(){return this._strideInt}get vertexCount(){return this._vertices.length/this._strideInt}get indexCount(){return this._indices.length}get indexWriter(){return this._indices}get vertexWriter(){return this._vertices}get metricWriter(){return this._metrics}vertexEnsureSize(o){this._vertices.ensureSize(o)}indexEnsureSize(o){this._indices.ensureSize(o)}writeIndex(o){this._indices.push(o)}writeVertex(o){this._vertices.push(o)}writeVertexRegion(o){this._vertices.writeRegion(o)}writeVertexF32(o){this._vertices.writeF32(o)}writeMetric(o){this._metrics.incr(this._metricCountOffset),o.serialize(this._metrics)}}class M{constructor(o,p=0){this._id=o,this._sizeHint=p,this._entityRecordCountOffset=0,this._entityCountOffset=0,this._entityIdIndex=0,this._entitySortKeyIndex=0,this._instanceIdToVertexData=new Map,this._recordIndexStart=0,this._recordIndexCount=0,this._recordVertexStart=0,this._recordVertexCount=0,this._current={metric:null,writer:null,start:0,sortKey:0,instanceId:0,layoutHash:0,indexStart:0,vertexStart:0,textureKey:0,metricBoxLenPointer:0},this._entities=new d(Uint32Array,this._sizeHint*w.A.byteSizeHint),this._entityCountOffset=this._entities.push(0)}get id(){return this._id}serialize(){const o=new Array,p=[],E=this._entities.buffer();for(const F of this._instanceIdToVertexData.values())p.push(F.serialize(o));return{message:{data:p,entities:E},transferList:o}}vertexCount(){return this._current.writer?.vertexCount??0}indexCount(){return this._current.writer?.indexCount??0}vertexEnsureSize(o){this._current.writer.vertexEnsureSize(o)}indexEnsureSize(o){this._current.writer.indexEnsureSize(o)}vertexWrite(o){this._current.writer.writeVertex(o)}vertexWriteRegion(o){this._current.writer.writeVertexRegion(o)}vertexWriteF32(o){this._current.writer.writeVertexF32(o)}recordBounds(o,p,E,F){}indexWrite(o){this._current.writer.writeIndex(o)}metricStart(o){this._current.metric=o}metricEnd(){this._current.metric.bounds.length&&this._current.writer.writeMetric(this._current.metric)}metricBoxWrite(o){this._current.metric.bounds.push(o)}entityStart(o,p=o){this._entityIdIndex=this._entities.push(o),this._entitySortKeyIndex=this._entities.writeF32(p),this._entityRecordCountOffset=this._entities.push(0)}entityRecordCount(){return this._entities.getValue(this._entityRecordCountOffset)}entityEnd(){0===this.entityRecordCount()?this._entities.seek(this._entityIdIndex):this._entities.incr(this._entityCountOffset)}recordCount(){return this._entities.getValue(this._entityRecordCountOffset)}recordStart(o,p,E=0){this._current.writer=this._getVertexWriter(o,p),this._current.indexStart=this._current.writer.indexCount,this._current.vertexStart=this._current.writer.vertexCount,this._current.instanceId=o,this._current.layoutHash=p.hash,this._current.textureKey=E}recordEnd(o=0){const p=this._current.vertexStart,E=this._current.writer.vertexCount-p;if(!E)return!1;const F=this._current.indexStart,L=this._current.writer.indexCount-F;return this._recordIndexStart=F,this._recordIndexCount=L,this._recordVertexStart=p,this._recordVertexCount=E,this._entities.incr(this._entityRecordCountOffset),P.A.write(this._entities,this._current.instanceId,this._current.textureKey,F,L,p,E,o),!0}copyLast(o,p){const E=this._recordVertexStart+this._recordVertexCount;this._entities.incr(this._entityRecordCountOffset),P.A.write(this._entities,this._current.instanceId,this._current.textureKey,this._recordIndexStart+this._recordIndexCount,this._recordIndexCount,E,this._recordVertexCount,0);const F=this._current.writer.indexWriter,L=this._current.writer.vertexWriter,H=this._recordIndexStart+this._recordIndexCount,g=this._recordVertexCount;for(let y=this._recordIndexStart;y!==H;y++){const m=F.getValue(y);F.push(m+g)}const A=this._current.writer.layout.stride/Uint32Array.BYTES_PER_ELEMENT,U=(this._recordVertexStart+this._recordVertexCount)*A;for(let y=this._recordVertexStart*A;y!==U;y++){const m=L.getValue(y);L.push(m)}const Y=this._current.writer.layout.position,V=Y.packPrecisionFactor??1,Z=Y.offset/Uint32Array.BYTES_PER_ELEMENT,z=o*V,a=p*V;for(let y=E*A;y<=L.length;y+=A)L.i1616Add(y+Z,z,a);this.recordEnd()}copyLastFrom(o,p,E){const F=o._entities.getValue(o._entityIdIndex);if(F!==this._entities.getValue(this._entityIdIndex)){const m=o._entities.getValueF32(o._entitySortKeyIndex);this.entityStart(F,m)}this.recordStart(o._current.instanceId,o._current.writer.layout,o._current.textureKey);const L=this._current.writer.layout.stride/Uint32Array.BYTES_PER_ELEMENT,H=this._current.vertexStart,g=o._current.vertexStart-H,A=this._current.writer.indexWriter,B=this._current.writer.vertexWriter,U=o._current.writer.indexWriter,Y=o._current.writer.vertexWriter;for(let m=o._current.indexStart;m!==U.length;m++){const v=U.getValue(m);A.push(v-g)}for(let m=o._current.vertexStart*L;m!==Y.length;m++){const v=Y.getValue(m);B.push(v)}const V=this._current.writer.layout.position,Z=V.packPrecisionFactor??1,z=V.offset/Uint32Array.BYTES_PER_ELEMENT,a=p*Z,y=E*Z;for(let m=H*L;m<=B.length;m+=L)B.i1616Add(m+z,a,y);this.recordEnd()}_getVertexWriter(o,p){const E=this._instanceIdToVertexData;return E.has(o)||E.set(o,new S(o,p,this._sizeHint)),E.get(o)}}},86220:(X,j,l)=>{l.d(j,{J:()=>I});var w=l(10467),P=l(1119),_=l(24370);class d{}class I extends d{constructor(S){super(),this._fetcher=S,this._controller=new AbortController,this._pendingIds=new Set,this._pendingRequests=[],this._resourceIdToResource=new Map}destroy(){this._controller.abort()}get _abortOptions(){return{signal:this._controller.signal}}enqueueRequest(S){const M=(0,_.IF)(S.resource),O=(0,P.Wm)(JSON.stringify(M));return this._pendingIds.has(O)||(this._pendingIds.add(O),this._pendingRequests.push({...S,resourceId:O})),O}fetchEnqueuedResources(){var S=this;return(0,w.A)(function*(){const M=S._pendingRequests;S._pendingIds.clear(),S._pendingRequests=[];const O=yield S._fetcher.fetch(M,S._abortOptions);for(let o=0;o<O.length;o++)S._resourceIdToResource.set(M[o].resourceId,O[o])})()}fetchResourceImmediate(S){var M=this;return(0,w.A)(function*(){const O=yield M._fetcher.fetch([S],M._abortOptions);if(1!==O.length)throw new Error("FeaturePipelineResourceProxy: failed to fetch resources");return O[0]})()}fetchDictionaryResourceImmediate(S){var M=this;return(0,w.A)(function*(){const O=yield M._fetcher.fetchDictionary([S],M._abortOptions);if(1!==O.length)throw new Error("FeaturePipelineResourceProxy: failed to fetch dictionary resources");return O[0]})()}getResource(S){return this._resourceIdToResource.get(S)}}},54661:(X,j,l)=>{l.d(j,{Z:()=>w});class w{getObjectId(_){return _.getObjectId()}getAttributes(_){return _.readAttributes()}getAttribute(_,d){return _.readAttribute(d)}getAttributeAsTimestamp(_,d){return _.readAttributeAsTimestamp(d)}cloneWithGeometry(_,d){return _}getGeometry(_){return _.readGeometryWorldSpace()}getCentroid(_,d){return _.readCentroidForDisplay()}}w.Shared=new w},32197:(X,j,l)=>{l.d(j,{L:()=>w});class w{destroy(){}}},10903:(X,j,l)=>{l.d(j,{K:()=>Z});var w=l(10467),P=l(5922),_=l(3248),d=l(35150),I=l(48237),x=l(25735),S=l(47669),M=l(53212),O=l(24370),o=l(90731);class F{constructor(a){this.data=a,this._referenceCount=0}increment(){this._referenceCount+=1}decrement(){this._referenceCount-=1}empty(){return 0===this._referenceCount}}class L{constructor(){this._freeIdsGenerationA=[],this._freeIdsGenerationB=[],this._idCounter=1,this._freeIds=this._freeIdsGenerationA,this._objectIdToDisplayId=new Map}createIdForObjectId(a){let y=this._objectIdToDisplayId.get(a);return y?y.increment():(y=new F((0,M.Ss)(this._getFreeId(),!1)),y.increment(),this._objectIdToDisplayId.set(a,y)),y.data}releaseIdForObjectId(a){const y=this._objectIdToDisplayId.get(a);y&&(y.decrement(),y.empty()&&(this._objectIdToDisplayId.delete(a),this._freeIds.push(y.data)))}releaseAll(){for(const a of this._objectIdToDisplayId.values())this._freeIds.push(a.data);this._objectIdToDisplayId.clear()}incrementGeneration(){this._freeIds=this._freeIds===this._freeIdsGenerationA?this._freeIdsGenerationB:this._freeIdsGenerationA}_getFreeId(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}var H=l(83897),g=l(50915);const B=()=>d.A.getLogger("esri.views.layers.2d.features.support.AttributeStore"),U=(!1,B(),()=>null),Y_sharedArrayBuffer=(0,_.A)("esri-shared-array-buffer");(0,_.A)("esri-atomics");class V{constructor(a,y,m){this.size=0,this.texelSize=4,this.dirtyStart=0,this.dirtyEnd=0;const{pixelType:v,layout:D,textureOnly:C}=y;this.textureOnly=C||!1,this.pixelType=v,this.layout=D,this._resetRange(),this.size=a,this.isLocal=m,C||(this.data=this._initData(v,a))}get buffer(){return this.data?.buffer}unsetComponentAllTexels(a,y){const m=this.data;for(let v=0;v<this.size*this.size;v++)m[v*this.texelSize+a]&=~y;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponentAllTexels(a,y){const m=this.data;for(let v=0;v<this.size*this.size;v++)m[v*this.texelSize+a]|=255&y;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponent(a,y,m){const v=this.data;for(const D of m)v[D*this.texelSize+a]|=y,this.dirtyStart=Math.min(this.dirtyStart,D),this.dirtyEnd=Math.max(this.dirtyEnd,D)}setComponentTexel(a,y,m){this.data[m*this.texelSize+a]|=y,this.dirtyStart=Math.min(this.dirtyStart,m),this.dirtyEnd=Math.max(this.dirtyEnd,m)}unsetComponentTexel(a,y,m){this.data[m*this.texelSize+a]&=~y,this.dirtyStart=Math.min(this.dirtyStart,m),this.dirtyEnd=Math.max(this.dirtyEnd,m)}getData(a,y){const m=(0,M.Q4)(a);return this.data[m*this.texelSize+y]}setData(a,y,m){const v=(0,M.Q4)(a);this.layout&1<<y?null!=this.data&&(this.data[v*this.texelSize+y]=m,this.dirtyStart=Math.min(this.dirtyStart,v),this.dirtyEnd=Math.max(this.dirtyEnd,v)):B().error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}expand(a){if(this.size=a,!this.textureOnly){const y=this._initData(this.pixelType,a);y.set(this.data),this.data=y}}toMessage(){const a=this.dirtyStart,y=this.dirtyEnd,m=this.texelSize;if(a>y)return null;this._resetRange();const D=this.pixelType,C=this.layout;return{start:a,end:y,data:!this.isLocal&&this.data.slice(a*m,(y+1)*m)||null,pixelType:D,layout:C}}_initData(a,y){const m=ArrayBuffer,v=(0,O.Qz)(a),D=new v(new m(y*y*4*v.BYTES_PER_ELEMENT));for(let C=0;C<D.length;C+=4)D[C+1]=255;return D}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}}class Z{constructor(a){this._client=a,this._filters=[],this._blocks=new Array,this._attributeComputeInfo=null,this._abortController=new AbortController,this._size=S.TB,this._idsToHighlight=new Map,this._referencesScale=!1,this._referencesGeometry=!1,this._initialized=!1,this.version=0,this._idGenerator=new L,this._epoch=1}destroy(){this._abortController.abort()}_initialize(){if(null!=this._blockDescriptors)return;const a=g.ld.FLOAT;U(`Creating AttributeStore ${Y_sharedArrayBuffer?"with":"without"} shared memory`),this._blockDescriptors=[{pixelType:g.ld.UNSIGNED_BYTE,layout:1},{pixelType:g.ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:g.ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:a,layout:15},{pixelType:a,layout:15},{pixelType:a,layout:15},{pixelType:a,layout:15}],this._blocks=this._blockDescriptors.map(()=>null)}get referencesScale(){return this._referencesScale}get referencesGeometry(){return this._referencesGeometry}get hasHighlight(){return this._idsToHighlight.size>0}createDisplayIdForObjectId(a){return this._idGenerator.createIdForObjectId(a)}releaseDisplayIdForObjectId(a){return this._idGenerator.releaseIdForObjectId(a)}incrementDisplayIdGeneration(){this._idGenerator.incrementGeneration()}releaseAllIds(){this._idGenerator.releaseAll()}update(a,y,m,v,D=0){var C=this;return(0,w.A)(function*(){const Q=(0,I.Ui)(C._schema,a);if(C.version=D,Q&&((0,_.A)("esri-2d-update-debug")&&console.debug(`Version[${D}] AttributeStore.update`,{changed:Q}),C._schema=a,C._attributeComputeInfo=null,C._initialize(),null!=a))if(m&&(C._filters=yield Promise.all(a.filters.map(R=>R?H.A.create({geometryType:m.geometryType,hasM:!1,hasZ:!1,timeInfo:m.timeInfo,fieldsIndex:m.fieldsIndex,spatialReference:v??m.spatialReference,filterJSON:R}):null))),"subtype"!==a.type)C._attributeComputeInfo={isSubtype:!1,map:new Map},yield Promise.all(a.bindings.map(function(){var R=(0,w.A)(function*(n){const s=yield C._bind(y,n);C._referencesGeometry=C._referencesGeometry||(s?.referencesGeometry()??!1),C._referencesScale=C._referencesScale||(s?.referencesScale()??!1)});return function(n){return R.apply(this,arguments)}}()));else{C._attributeComputeInfo={isSubtype:!0,subtypeField:a.subtypeField,map:new Map},C._referencesScale=!1,C._referencesGeometry=!1;for(const R in a.bindings){const n=a.bindings[R];yield Promise.all(n.map(function(){var s=(0,w.A)(function*(i){const h=yield C._bind(y,i,parseInt(R,10));C._referencesGeometry=C._referencesGeometry||(h?.referencesGeometry()??!1),C._referencesScale=C._referencesScale||(h?.referencesScale()??!1)});return function(i){return s.apply(this,arguments)}}()))}}})()}setHighlight(a,y){const m=this._getBlock(0);m.unsetComponentAllTexels(0,(1<<x.M$.length)-1);for(const{displayId:v,highlightFlags:D}of a){if(null==v)continue;const C=(0,M.Q4)(v);m.setComponent(0,D,[C])}this._idsToHighlight.clear();for(const{objectId:v,highlightFlags:D}of a)this._idsToHighlight.set(v,D);for(const{objectId:v,highlightFlags:D}of y)this._idsToHighlight.set(v,D)}setData(a,y,m,v){const D=(0,M.Q4)(a);this._ensureSizeForTexel(D),this._getBlock(y).setData(a,m,v)}getData(a,y,m){return this._getBlock(y).getData(a,m)}getHighlightFlags(a){return this._idsToHighlight.get(a)||0}unsetAttributeData(a){const y=(0,M.Q4)(a);this._getBlock(0).setData(y,0,0)}setAttributeData(a,y,m){const v=(0,M.Q4)(a);this._ensureSizeForTexel(v),this._getBlock(0).setData(v,0,this.getFilterFlags(y));const D=this._attributeComputeInfo;let R=null;D&&(R=D.isSubtype?D.map.get(y.readAttribute(D.subtypeField)):D.map,R?.size&&R.forEach((n,s)=>{const i=1*s%4,h=Math.floor(1*s/4),T=this._getBlock(h+S.dV.VV);let b=n.field?.read(y,m);n.valueRepresentation&&(b=function A(z,a){if(!z||!a)return z;switch(a){case"radius":case"distance":return 2*z;case"diameter":case"width":return z;case"area":return Math.sqrt(z)}return z}(b,n.valueRepresentation)),(null===b||isNaN(b)||b===1/0||b===-1/0)&&(b=o.qM),T.setData(v,i,b)}))}get epoch(){return this._epoch}sendUpdates(){const a=this._blocks.map(m=>null!=m?m.toMessage():null),y=this._getInitArgs();(0,_.A)("esri-2d-log-updating")&&console.log("AttributeStore: _doSendUpdate.start"),this._client.update({initArgs:y,blockData:a,version:this.version,sendUpdateEpoch:this._epoch}),this._epoch+=1,(0,_.A)("esri-2d-log-updating")&&console.log("AttributeStore: _doSendUpdate.end")}_ensureSizeForTexel(a){for(;a>=this._size*this._size;)if(this._expand())return}_bind(a,y,m){var v=this;return(0,w.A)(function*(){const D=yield a.createComputedField(y),{valueRepresentation:C}=y,Q=v._attributeComputeInfo;if(Q.isSubtype){const R=Q.map.get(m)??new Map;R.set(y.binding,{field:D,valueRepresentation:C}),Q.map.set(m,R)}else Q.map.set(y.binding,{field:D,valueRepresentation:C});return D})()}_getInitArgs(){return this._initialized?null:(this._initialized=!0,this._getBlock(S.dV.Animation),this._getBlock(S.dV.GPGPU),{blockSize:this._size,blockDescriptors:this._blocks.map(a=>null!=a?{textureOnly:a.textureOnly,buffer:a.buffer,pixelType:a.pixelType}:null)})}_getBlock(a){const y=this._blocks[a];if(null!=y)return y;U(`Initializing AttributeBlock at index ${a}`);const m=new V(this._size,this._blockDescriptors[a],this._client.isLocal);return this._blocks[a]=m,this._initialized=!1,m}_expand(){if(this._size<this._schema.capabilities.maxTextureSize){const a=this._size<<=1;U("Expanding block size to",a,this._blocks);for(const y of this._blocks)y?.expand(a);return this._initialized=!1,this._size=a,0}return B().error(new P.A("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}isVisible(a){return!!(this._getBlock(0).getData(a,0)&1<<x.M$.length)}getFilterFlags(a){let y=0;for(let v=0;v<this._filters.length;v++){const C=this._filters[v];y|=(1<<v&&null!=C&&!C.check(a)?0:1)<<v}let m=0;if(this._idsToHighlight.size){const v=a.getObjectId();m=this.getHighlightFlags(v)}return y<<x.M$.length|m}}},85452:(X,j,l)=>{l.d(j,{l:()=>Q});var w=l(10467),P=l(5922),_=l(35150),d=l(2296),I=l(53212),x=l(32197);class S extends x.L{constructor(n){super(),this._field=n}resize(n){throw new Error("Method not implemented.")}read(n,s){return n.readAttribute(this._field)}readWithDefault(n,s){return n.readAttribute(this._field)}referencesScale(){return!1}referencesGeometry(){return!1}}var M=l(1119),O=l(48218),o=l(45219);class p extends x.L{static create(n,s){return(0,w.A)(function*(){const i=yield(0,O.Ad)(n,s.spatialReference,s.fields),h=(0,M.Wm)(n);return new p(i,h)})()}constructor(n,s){super(),this._compiled=n,this._cacheKey=s}resize(n){}read(n,s){return this.referencesScale()||"system"!==s.$view.timeZone?(0,o.V4)(this._compiled,n,s):this._readCached(n,s)}readWithDefault(n,s,i){return this.referencesScale()||"system"!==s.$view.timeZone?(0,o.OP)(this._compiled,n,s,i):this._readWithDefaultCached(n,s,i)}referencesScale(){return this._compiled?.referencesScale()??!1}referencesGeometry(){return this._compiled?.referencesGeometry()??!1}_readCached(n,s){if(n.setCache(this._cacheKey),n.hasCachedValue())return n.getCachedValue();const i=(0,o.V4)(this._compiled,n,s);return n.setCachedValue(i),i}_readWithDefaultCached(n,s,i){if(n.setCache(this._cacheKey),n.hasCachedValue())return n.getCachedValue();const h=(0,o.OP)(this._compiled,n,s,i);return n.setCachedValue(h),h}}var E=l(48266),F=l(68479),L=l(54444),H=l(86300),g=l(4858);class z extends x.L{static create(n,s){return(0,w.A)(function*(){const i=(0,g.lc)(n);return new z(h=>i.replaceAll(/{[^}]*}/g,T=>{const b=T.slice(1,-1),K=h.metadata.fieldsIndex.get(b);if(null==K)return T;const W=h.readAttribute(b);return null==W?"":function Z(R,n){if(null==R)return"";const s=n.domain;if(s)if("codedValue"===s.type||"coded-value"===s.type){const h=R;for(const T of s.codedValues)if(T.code===h)return T.name}else if("range"===s.type){const{max:h,min:T}=(0,L.A5)(n),b=+R;if(null!=T&&null!=h&&T<=b&&b<=h)return s.name}let i=R;return(0,H.vE)(n)?i=(0,E.Yq)(i,(0,E.J2)("short-date")):(0,H.WA)(n)&&(i=(0,F.ZV)(+i)),i||""}(W,K)}))})()}constructor(n){super(),this._evaluator=n}resize(n){}read(n,s){return this._evaluator(n)}readWithDefault(n,s,i){const h=this._evaluator(n);return(0,o.rZ)(h)?i:h}referencesScale(){return!1}referencesGeometry(){return!1}}class a extends x.L{constructor(n,s){super(),this._field=n,this._normalizationInfo=s}resize(n){throw new Error("Method not implemented.")}read(n,s){return this._readNormalized(n)}readWithDefault(n,s){return this._readNormalized(n)}referencesScale(){return!1}referencesGeometry(){return!1}_readNormalized(n){const s=n.readAttribute(this._field);if(null==s)return null;const{normalizationField:i,normalizationTotal:h,normalizationType:T}=this._normalizationInfo,b=n.readAttribute(i);switch(T??"esriNormalizeByField"){case"esriNormalizeByField":return b?b?s/b:void 0:null;case"esriNormalizeByLog":return Math.log(s)*Math.LOG10E;case"esriNormalizeByPercentOfTotal":return h?s/h*100:null}}}var y=l(42178),m=l(96845);const v=()=>_.A.getLogger("esri.views.2d.layers.features.support.ComputedAttributeStorage"),D=4294967295;function C(R,n,s){if(!(R.length>n))for(;R.length<=n;)R.push(s)}class Q{constructor(n){this._numerics=[],this._strings=[],this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[],this._dirtyBitset=this.getBitset(this.createBitset()),this.compilationOptions=n}createBitset(){const n=this._bitsets.length;return this._bitsets.push(y.y.create(this._allocatedSize,I.KQ)),n+1}createComputedField(n,s=!1){var i=this;return(0,w.A)(function*(){if(n.expression)try{if(!i.compilationOptions)throw new Error("InternalError: Compilation options not defined");return s?z.create(n.expression,i.compilationOptions):yield p.create(n.expression,i.compilationOptions)}catch(T){const b=new P.A("featurelayer","Failed to compile arcade expression",{error:T,expression:n.expression});return v().error(b),null}if(n.normalizationType||n.normalizationField)return new a(n.field,n);if(n.field)return new S(n.field);const h=new P.A("featurelayer","Unable to create computed field. No expression or field found",{info:n});return v().error(h),null})()}createWhereClause(n){var s=this;return(0,w.A)(function*(){return n?(0,m.$)(n,s.compilationOptions.fields):null})()}getBitset(n){return this._bitsets[n-1]}getComputedNumeric(n,s){return this.getComputedNumericAtIndex(n&I.KQ,0)}setComputedNumeric(n,s,i){return this.setComputedNumericAtIndex(n&I.KQ,i,0)}getComputedString(n,s){return this.getComputedStringAtIndex(n&I.KQ,0)}setComputedString(n,s,i){return this.setComputedStringAtIndex(n&I.KQ,0,i)}getComputedNumericAtIndex(n,s){const i=n&I.KQ;return this._ensureNumeric(s,i),this._numerics[s][i]}setComputedNumericAtIndex(n,s,i){const h=n&I.KQ;this._ensureNumeric(s,h),this._numerics[s][h]=i}getPackedChunkId(n){const s=n&I.KQ;return this._ensureInstanceId(s),this._instanceIds[s]}setPackedChunkId(n,s){const i=n&I.KQ;this._ensureInstanceId(i),this._instanceIds[i]=s}getComputedStringAtIndex(n,s){const i=n&I.KQ;return this._ensureString(s,i),this._strings[s][i]}setComputedStringAtIndex(n,s,i){const h=n&I.KQ;this._ensureString(s,h),this._strings[s][h]=i}getXMin(n){return this._bounds[4*(n&I.KQ)]}getYMin(n){return this._bounds[4*(n&I.KQ)+1]}getXMax(n){return this._bounds[4*(n&I.KQ)+2]}getYMax(n){return this._bounds[4*(n&I.KQ)+3]}setBounds(n,s,i=!1){const h=n&I.KQ;if(!i&&!this._dirtyBitset.has(n))return this._bounds[4*h]!==D;this._dirtyBitset.unset(n);const T=s.readGeometryWorldSpace();if(C(this._bounds,4*h+4,0),!T||!T.coords.length)return this._bounds[4*h]=D,this._bounds[4*h+1]=D,this._bounds[4*h+2]=D,this._bounds[4*h+3]=D,!1;let b=1/0,K=1/0,W=-1/0,G=-1/0;return T.forEachVertex((N,J)=>{b=Math.min(b,N),K=Math.min(K,J),W=Math.max(W,N),G=Math.max(G,J)}),this._bounds[4*h]=b,this._bounds[4*h+1]=K,this._bounds[4*h+2]=W,this._bounds[4*h+3]=G,!0}getBounds(n,s){const i=this.getXMin(s),h=this.getYMin(s),T=this.getXMax(s),b=this.getYMax(s);return(0,d.BI)(n,i,h,T,b),i!==D}_ensureNumeric(n,s){this._numerics[n]||(this._numerics[n]=[]),C(this._numerics[n],s,0)}_ensureInstanceId(n){C(this._instanceIds,n,0)}_ensureString(n,s){this._strings[n]||(this._strings[n]=[]),C(this._strings[n],s,null)}}},83897:(X,j,l)=>{l.d(j,{A:()=>L});var w=l(10467),P=l(5922),_=l(35150),d=l(51995),I=l(83065),x=l(871),S=l(18633),M=l(76980),O=l(87086),o=l(54661),p=l(96845);class L{constructor(g){this._geometryBounds=(0,d.vt)(),this._idToVisibility=new Map,this._serviceInfo=g}static create(g){return(0,w.A)(function*(){const A=new L(g);return yield A.update(g.filterJSON,g.spatialReference),A})()}get hash(){return this._hash}check(g){return this._applyFilter(g)}clear(){const g=this._resetAllHiddenIds();return this.update(),{show:g,hide:[]}}invalidate(){this._idToVisibility.forEach((g,A)=>{this._idToVisibility.set(A,0)})}setKnownIds(g){for(const A of g)this._idToVisibility.set(A,1)}setTrue(g){const A=[],B=[],U=new Set(g);return this._idToVisibility.forEach((Y,V)=>{const Z=!!(1&this._idToVisibility.get(V)),z=U.has(V);!Z&&z?A.push(V):Z&&!z&&B.push(V),this._idToVisibility.set(V,z?3:0)}),{show:A,hide:B}}createQuery(){const{geometry:g,spatialRel:A,where:B,timeExtent:U,objectIds:Y}=this;return O.A.fromJSON({geometry:g,spatialRel:A,where:B,timeExtent:U,objectIds:Y})}update(g,A){var B=this;return(0,w.A)(function*(){B._hash=JSON.stringify(g);const U=yield(0,x.T2)(g,null,A);yield Promise.all([B._setGeometryFilter(U),B._setIdFilter(U),B._setAttributeFilter(U),B._setTimeFilter(U)])})()}_setAttributeFilter(g){var A=this;return(0,w.A)(function*(){if(!g?.where)return A._clause=null,void(A.where=null);A._clause=yield(0,p.$)(g.where,A._serviceInfo.fieldsIndex),A.where=g.where})()}_setIdFilter(g){this._idsToShow=g?.objectIds&&new Set(g.objectIds),this._idsToHide=g?.hiddenIds&&new Set(g.hiddenIds),this.objectIds=g?.objectIds}_setGeometryFilter(g){var A=this;return(0,w.A)(function*(){if(!g?.geometry)return A._spatialQueryOperator=null,A.geometry=null,void(A.spatialRel=null);const B=g.geometry,U=g.spatialRel||"esriSpatialRelIntersects",Y=yield(0,S.xt)(U,B,A._serviceInfo.geometryType,A._serviceInfo.hasZ,A._serviceInfo.hasM);(0,I.Rg)(A._geometryBounds,B),A._spatialQueryOperator=Y,A.geometry=B,A.spatialRel=U})()}_setTimeFilter(g){if(this.timeExtent=this._timeOperator=null,g?.timeExtent)if(this._serviceInfo.timeInfo)this.timeExtent=g.timeExtent,this._timeOperator=(0,M.I)(this._serviceInfo.timeInfo,g.timeExtent,o.Z.Shared);else{const A=new P.A("feature-layer-view:time-filter-not-available","Unable to apply time filter, as layer doesn't have time metadata.",g.timeExtent);_.A.getLogger("esri.views.2d.layers.features.controllers.FeatureFilter").error(A)}}_applyFilter(g){return this._filterByGeometry(g)&&this._filterById(g)&&this._filterByTime(g)&&this._filterByExpression(g)}_filterByExpression(g){return!this.where||this._clause(g)}_filterById(g){return(!this._idsToHide?.size||!this._idsToHide.has(g.getObjectId()))&&(!this._idsToShow?.size||this._idsToShow.has(g.getObjectId()))}_filterByGeometry(g){if(!this.geometry)return!0;const A=g.readGeometryWorldSpace();return!!A&&this._spatialQueryOperator(A)}_filterByTime(g){return null==this._timeOperator||this._timeOperator(g)}_resetAllHiddenIds(){const g=[];return this._idToVisibility.forEach((A,B)=>{1&A||(this._idToVisibility.set(B,1),g.push(B))}),g}}},34650:(X,j,l)=>{l.d(j,{h:()=>d,i:()=>_});var w=l(32034),P=l(73258);class _{static minimal(x,S,M=[]){return new _({geometryType:x,fields:M,objectIdField:S,subtypes:null,subtypeField:null,types:null,globalIdField:null,spatialReference:null,timeInfo:null,timeReferenceUnknownClient:null,typeIdField:null})}constructor(x){this._options=x,this._fieldsIndex="fieldsIndex"in x?P.A.fromJSON(x.fieldsIndex):new P.A(x.fields),x.spatialReference&&(this._spatialReference=w.A.fromJSON(x.spatialReference)),this._arcadeSchema={fields:this.fieldsIndex.fields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,objectIdField:this.objectIdField,globalIdField:this._options.globalIdField,spatialReference:this._spatialReference,timeInfo:this._options.timeInfo,typeIdField:this._options.typeIdField??void 0,types:this._options.types??void 0,subtypeField:this._options.subtypeField,subtypes:this._options.subtypes??void 0}}get fieldsIndex(){return this._fieldsIndex}get geometryType(){return this._options.geometryType}get subtypeField(){return this._options.subtypeField}get timeInfo(){return this._options.timeInfo}get objectIdField(){return this._options.objectIdField}get globalIdField(){return this._options.globalIdField}get arcadeSchema(){return this._arcadeSchema}get spatialReference(){return this._spatialReference}get timeReferenceUnknownClient(){return this._options.timeReferenceUnknownClient}}class d extends _{static create(x){return new d({fields:[],objectIdField:"uid",geometryType:null,spatialReference:x,globalIdField:null,subtypeField:null,subtypes:null,timeInfo:null,typeIdField:null,types:null,timeReferenceUnknownClient:null})}}},54977:(X,j,l)=>{l.d(j,{P:()=>P});var w=l(42178);class P{constructor(d){this._valid=w.y.create(d),this._data=new Array(d)}has(d){return this._valid.has(d)}set(d,I){this._valid.set(d),this._data[d]=I}get(d){return this._data[d]}}},27420:(X,j,l)=>{l.d(j,{Y:()=>R}),l(21152);var P=l(61299),_=l(3248),d=l(11432),I=l(87257),x=l(29752),S=l(72137),M=l(2296),O=l(13259),o=l(27999),p=l(31732),E=l(42086),F=l(13682),L=l(22639),H=l(54977),g=l(42178),A=l(61320);const B=(0,_.A)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],U=B[0],Y=B[1],V=B[2],Z=B[3],z=(0,_.A)("featurelayer-simplify-payload-size-factors")??[1,2,4],a=z[0],y=z[1],m=z[2],v=(0,_.A)("featurelayer-simplify-mobile-factor")??2,D=(0,_.A)("esri-mobile"),C=4294967295;class R{constructor(s){this.metadata=s,this.type="FeatureSetReader",this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._boundsBuffer=[],this._caches=new Map,this.arcadeDeclaredClass="esri.arcade.Feature",this._contextTimeZone=null}get isEmpty(){return null!=this._deleted&&this._deleted.countSet()===this.getSize()}getAreaSimplificationThreshold(s,i){let h=1;const T=D?v:1;i>4e6?h=m*T:i>1e6?h=y*T:i>5e5?h=a*T:i>1e5&&(h=T);let b=0;return s>4e3?b=Z*h:s>2e3?b=V*h:s>100?b=Y:s>15&&(b=U),b}parseTimestampOffset(s){return s}getBounds(s){if(function Q(n,s,i){if(!(n.length>s))for(;n.length<=s;)n.push(i)}(this._boundsBuffer,4*this.getIndex()+4,0),this.getBoundsXMin()===C)return!1;if(0===this.getBoundsXMin()){const K=this.readGeometryWorldSpace();if(!K)return this.setBoundsXMin(C),!1;let W=1/0,G=1/0,N=-1/0,J=-1/0;return K.forEachVertex(($,k)=>{W=Math.min(W,$),G=Math.min(G,k),N=Math.max(N,$),J=Math.max(J,k)}),this.setBoundsXMin(W),this.setBoundsYMin(G),this.setBoundsXMax(N),this.setBoundsYMax(J),(0,M.BI)(s,W,G,N,J),!0}const i=this.getBoundsXMin(),h=this.getBoundsYMin(),T=this.getBoundsXMax(),b=this.getBoundsYMax();return(0,M.BI)(s,i,h,T,b),!0}getBoundsXMin(){return this._boundsBuffer[4*this.getIndex()]}setBoundsXMin(s){this._boundsBuffer[4*this.getIndex()]=s}getBoundsYMin(){return this._boundsBuffer[4*this.getIndex()+1]}setBoundsYMin(s){this._boundsBuffer[4*this.getIndex()+1]=s}getBoundsXMax(){return this._boundsBuffer[4*this.getIndex()+2]}setBoundsXMax(s){this._boundsBuffer[4*this.getIndex()+2]=s}getBoundsYMax(){return this._boundsBuffer[4*this.getIndex()+3]}setBoundsYMax(s){this._boundsBuffer[4*this.getIndex()+3]=s}readAttributeAsTimestamp(s){const i=this.readAttribute(s);return"string"==typeof i?new Date(i).getTime():"number"==typeof i||null==i?i:null}readAttribute(s,i=!1){const h=this._readAttribute(s,i);if(void 0!==h)return h;for(const T of this._joined){T.setIndex(this.getIndex());const b=T._readAttribute(s,i);if(void 0!==b)return b}}readAttributes(){const s=this._readAttributes();for(const i of this._joined){i.setIndex(this.getIndex());const h=i._readAttributes();for(const T of Object.keys(h))s[T]=h[T]}return s}joinAttributes(s){this._joined.push(s)}removeIds(s){if(null==this._objectIdToIndex){const h=new Map,T=this.getCursor();for(;T.next();){const b=T.getObjectId();(0,d.Lw)(b),h.set(b,T.getIndex())}this._objectIdToIndex=h}const i=this._objectIdToIndex;for(const h of s.values())i.has(h)&&this._removeAtIndex(i.get(h))}readOptimizedFeatureWorldSpace(){const s=this.readGeometryWorldSpace(),i=this.readAttributes(),h=this.readCentroidWorldSpace(),T=new E.Om(s,i,h);return T.objectId=this.getObjectId(),T.displayId=this.getDisplayId(),T}readLegacyFeatureForDisplay(){const s=this.readCentroidForDisplay();return{attributes:this.readAttributes(),geometry:this.readLegacyGeometryForDisplay(),centroid:(s&&{x:s.coords[0],y:s.coords[1]})??null}}readLegacyFeatureWorldSpace(){const s=this.readCentroidWorldSpace();return{attributes:this.readAttributes(),geometry:this._readLegacyGeometryWorldSpace(),centroid:(s&&{x:s.coords[0],y:s.coords[1]})??null}}readLegacyGeometryForDisplay(){const s=this.readGeometryForDisplay();return(0,p.zv)(s,this.geometryType,!1,!1)}readXForDisplay(){return this._readX()}readYForDisplay(){return this._readY()}readXWorldSpace(){const s=this._readX(),i=this.getInTransform();return null==i?s:s*i.scale[0]+i.translate[0]}readYWorldSpace(){const s=this._readY(),i=this.getInTransform();return null==i?s:i.translate[1]-s*i.scale[1]}readGeometryForDisplay(){const s=this._readGeometryDeltaDecoded(!0);if(!s){const i=this._createGeometryFromServerCentroid();return i?i.deltaDecode():null}return s}readGeometryWorldSpace(){let s=this._readGeometry();if(s||(s=this._createGeometryFromServerCentroid()),!s)return null;const i=s.clone(),h=this.getInTransform();return null!=h&&(0,p.Ch)(i,i,this.hasZ,this.hasM,h),i}readCentroidForDisplay(){const s=this.readGeometryForDisplay();return s?this._computeDisplayCentroid(s):this._readServerCentroid()}readCentroidWorldSpace(){const s=this.readGeometryForDisplay(),i=s?this._computeDisplayCentroid(s):this._readServerCentroid();if(!i)return null;const h=i.clone(),T=this.getInTransform();return null!=T&&(0,p.Ch)(h,h,this.hasZ,this.hasM,T),h}setCache(s){let i=this._caches.get(s);null==i&&(i=new H.P(this.getSize()),this._caches.set(s,i)),this._activeCache=i}setCachedValue(s){this._activeCache.set(this.getIndex(),s)}hasCachedValue(){return this._activeCache.has(this.getIndex())}getCachedValue(){return this._activeCache.get(this.getIndex())}_readGeometryDeltaDecoded(s){const i=this._readGeometry(s);return"esriGeometryPoint"!==this.geometryType&&i&&this.getInTransform()?i.deltaDecode():i}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(s){this._contextTimeZone=s}readArcadeFeature(){return this}hasField(s){return this.fields.has(s)||this._joined.some(i=>i.hasField(s))}geometry(){const s=this.readGeometryWorldSpace(),i=(0,p.zv)(s,this.geometryType,this.hasZ,this.hasM),h=(0,A.rS)(i);if(h){if(!this.metadata.spatialReference)throw new Error("InternalError: Expected spatial reference to be defined");h.spatialReference=this.metadata.spatialReference}return h}autocastArcadeDate(s,i){return i&&i instanceof Date?this.isUnknownDateTimeField(s)?P.lY.unknownDateJSToArcadeDate(i):P.lY.dateJSAndZoneToArcadeDate(i,this.contextTimeZone??L.qU):i}isUnknownDateTimeField(s){return this.metadata.fieldsIndex.getTimeZone(s)===L.L5}field(s){let i=this.fields.get(s);if(i)switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return I.n.fromReader(this.readAttribute(s,!1));case"time-only":case"esriFieldTypeTimeOnly":return x.k.fromReader(this.readAttribute(s,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return P.lY.fromReaderAsTimeStampOffset(this.readAttribute(s,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(s,this.readAttribute(s,!0));default:return this.readAttribute(s,!1)}for(const h of this._joined)if(h.setIndex(this.getIndex()),i=h.fields.get(s),i)switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return I.n.fromReader(h._readAttribute(s,!1));case"time-only":case"esriFieldTypeTimeOnly":return x.k.fromReader(h._readAttribute(s,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return P.lY.fromReaderAsTimeStampOffset(h._readAttribute(s,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(s,h._readAttribute(s,!0));default:return this.readAttribute(s,!1)}throw new Error(`Field ${s} does not exist`)}setField(s,i){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.fields.fields.map(s=>s.name)}castToText(s=!1){if(!s)return JSON.stringify(this.readLegacyFeatureForDisplay());const i=this.readLegacyFeatureForDisplay();if(!i)return JSON.stringify(null);const h={geometry:i.geometry,attributes:{...i.attributes??{}}};for(const T in h.attributes){const b=h.attributes[T];b instanceof Date&&(h.attributes[T]=b.getTime())}return JSON.stringify(h)}gdbVersion(){return null}fullSchema(){return this.metadata.arcadeSchema}castAsJson(s=null){return{attributes:this._readAttributes(),geometry:!0===s?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(s=null,i=null){return Promise.resolve(this.castAsJson(i))}_getExists(){return null==this._deleted||!this._deleted.has(this.getIndex())}_computeDisplayCentroid(s){if(null==this.getInTransform())return(0,o.Q)(new F.A,s,this.hasM,this.hasZ);const i=S.z.fromOptimized(s,this.geometryType);i.yFactor*=-1;const h=(0,O.d)(i);return h?(h[1]*=-1,new F.A([],h)):null}copyInto(s){s._joined=this._joined,s._deleted=this._deleted,s._objectIdToIndex=this._objectIdToIndex,s._boundsBuffer=this._boundsBuffer,s._activeCache=this._activeCache,s._caches=this._caches,s._contextTimeZone=this._contextTimeZone}_readLegacyGeometryWorldSpace(){const s=this.readGeometryWorldSpace();return(0,p.zv)(s,this.geometryType,!1,!1)}_createGeometryFromServerCentroid(){const s=this._readServerCentroid();if(!s)return null;const[i,h]=s.coords;return this._createQuantizedExtrudedGeometry(i,h)}_createQuantizedExtrudedGeometry(s,i){return"esriGeometryPolyline"===this.geometryType?this._createQuantizedExtrudedLine(s,i):this._createQuantizedExtrudedQuad(s,i)}_createQuantizedExtrudedQuad(s,i){return new F.A([5],[s-1,i,1,-1,1,1,-1,1,-1,-1])}_createQuantizedExtrudedLine(s,i){return new F.A([2],[s-1,i+1,1,-1])}_removeAtIndex(s){null==this._deleted&&(this._deleted=g.y.create(this.getSize())),this._deleted.set(s)}}},42178:(X,j,l)=>{l.d(j,{y:()=>w});class w{static fromBuffer(_,d){return new w(_,d)}static create(_,d=4294967295){const I=new Uint32Array(Math.ceil(_/32));return new w(I,d)}constructor(_,d){this._mask=0,this._buf=_,this._mask=d}_getIndex(_){return Math.floor(_/32)}has(_){const d=this._mask&_;return!!(this._buf[this._getIndex(d)]&1<<d%32)}hasRange(_,d){let I=_,x=d;for(;I%32&&I!==x;){if(this.has(I))return!0;I++}for(;x%32&&I!==x;){if(this.has(I))return!0;x--}if(I===x)return!1;for(let S=I/32;S!==x/32;S++)if(this._buf[S])return!0;return!1}set(_){const d=this._mask&_,I=this._getIndex(d);this._buf[I]|=1<<d%32}setRange(_,d){let I=_,x=d;for(;I%32&&I!==x;)this.set(I++);for(;x%32&&I!==x;)this.set(x--);if(I!==x)for(let S=I/32;S!==x/32;S++)this._buf[S]=4294967295}unset(_){const d=this._mask&_,I=this._getIndex(d);this._buf[I]&=4294967295^1<<d%32}resize(_){const d=this._buf,I=new Uint32Array(Math.ceil(_/32));I.set(d),this._buf=I}or(_){for(let d=0;d<this._buf.length;d++)this._buf[d]|=_._buf[d];return this}and(_){for(let d=0;d<this._buf.length;d++)this._buf[d]&=_._buf[d];return this}xor(_){for(let d=0;d<this._buf.length;d++)this._buf[d]^=_._buf[d];return this}ior(_){for(let d=0;d<this._buf.length;d++)this._buf[d]|=~_._buf[d];return this}iand(_){for(let d=0;d<this._buf.length;d++)this._buf[d]&=~_._buf[d];return this}ixor(_){for(let d=0;d<this._buf.length;d++)this._buf[d]^=~_._buf[d];return this}any(){for(let _=0;_<this._buf.length;_++)if(this._buf[_])return!0;return!1}copy(_){for(let d=0;d<this._buf.length;d++)this._buf[d]=_._buf[d];return this}clone(){return new w(this._buf.slice(),this._mask)}clear(){for(let _=0;_<this._buf.length;_++)this._buf[_]=0;return this}forEachSet(_){for(let d=0;d<this._buf.length;d++){let I=this._buf[d],x=32*d;if(I)for(;I;)1&I&&_(x),I>>>=1,x++}}countSet(){let _=0;return this.forEachSet(d=>{_++}),_}}},96845:(X,j,l)=>{l.d(j,{$:()=>S});var w=l(10467),P=l(5922),_=l(35150),d=l(63484);const I=()=>_.A.getLogger("esri.views.2d.layers.features.support.whereUtils"),x={getAttribute:(O,o)=>O.readAttribute(o)};function S(O,o){return M.apply(this,arguments)}function M(){return(M=(0,w.A)(function*(O,o){try{const p=yield(0,d.G)(O,o);if(!p.isStandardized){const E=new P.A("mapview - bad input","Unable to apply filter's definition expression, as expression is not standardized.",p);I().error(E)}return E=>{const F=E.readArcadeFeature();try{return p.testFeature(F,x)}catch{return I().warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",O),!0}}}catch{return I().warn("mapview-bad-where-clause","Encountered an error when evaluating where clause",O),E=>!0}})).apply(this,arguments)}}}]);