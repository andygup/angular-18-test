"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[512],{3567:(Pe,ie,m)=>{m.d(ie,{w:()=>le});var j=m(89952),se=(m(3248),m(12438)),ye=m(17694);class le{constructor(E=9,A){this._compareMinX=Q,this._compareMinY=me,this._toBBox=I=>I,this._maxEntries=Math.max(4,E||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),A&&("function"==typeof A?this._toBBox=A:this._initFormat(A)),this.clear()}destroy(){this.clear(),_e.prune(),Se.prune(),Ee.prune(),Oe.prune()}all(E){q(this._data,E)}search(E,A){let I=this._data;const M=this._toBBox;if(Ne(E,I))for(_e.clear();I;){for(let _=0,D=I.children.length;_<D;_++){const T=I.children[_],L=I.leaf?M(T):T;Ne(E,L)&&(I.leaf?A(T):G(E,L)?q(T,A):_e.push(T))}I=_e.pop()}}collides(E){let A=this._data;const I=this._toBBox;if(!Ne(E,A))return!1;for(_e.clear();A;){for(let M=0,_=A.children.length;M<_;M++){const D=A.children[M],T=A.leaf?I(D):D;if(Ne(E,T)){if(A.leaf||G(E,T))return!0;_e.push(D)}}A=_e.pop()}return!1}load(E){if(!E.length)return this;if(E.length<this._minEntries){for(let I=0,M=E.length;I<M;I++)this.insert(E[I]);return this}let A=this._build(E.slice(0,E.length),0,E.length-1,0);if(this._data.children.length)if(this._data.height===A.height)this._splitRoot(this._data,A);else{if(this._data.height<A.height){const I=this._data;this._data=A,A=I}this._insert(A,this._data.height-A.height-1,!0)}else this._data=A;return this}insert(E){return E&&this._insert(E,this._data.height-1),this}clear(){return this._data=new De([]),this}remove(E){if(!E)return this;let A,I=this._data,M=null,_=0,D=!1;const T=this._toBBox(E);for(Ee.clear(),Oe.clear();I||Ee.length>0;){if(I||(I=Ee.pop(),M=Ee.data[Ee.length-1],_=Oe.pop()??0,D=!0),I.leaf&&(A=(0,j.qh)(I.children,E,I.children.length,I.indexHint),-1!==A))return I.children.splice(A,1),Ee.push(I),this._condense(Ee),this;D||I.leaf||!G(I,T)?M?(_++,I=M.children[_],D=!1):I=null:(Ee.push(I),Oe.push(_),_=0,M=I,I=I.children[0])}return this}toJSON(){return this._data}fromJSON(E){return this._data=E,this}_build(E,A,I,M){const _=I-A+1;let D=this._maxEntries;if(_<=D){const w=new De(E.slice(A,I+1));return K(w,this._toBBox),w}M||(M=Math.ceil(Math.log(_)/Math.log(D)),D=Math.ceil(_/D**(M-1)));const T=new Ge([]);T.height=M;const L=Math.ceil(_/D),P=L*Math.ceil(Math.sqrt(D));Ke(E,A,I,P,this._compareMinX);for(let w=A;w<=I;w+=P){const W=Math.min(w+P-1,I);Ke(E,w,W,L,this._compareMinY);for(let H=w;H<=W;H+=L){const N=Math.min(H+L-1,W);T.children.push(this._build(E,H,N,M-1))}}return K(T,this._toBBox),T}_insert(E,A,I){const _=I?E:(0,this._toBBox)(E);Ee.clear();const D=function de(S,E,A,I){for(;I.push(E),!0!==E.leaf&&I.length-1!==A;){let M,_=1/0,D=1/0;for(let T=0,L=E.children.length;T<L;T++){const P=E.children[T],w=B(P),W=ne(S,P)-w;W<D?(D=W,_=w<_?w:_,M=P):W===D&&w<_&&(_=w,M=P)}E=M||E.children[0]}return E}(_,this._data,A,Ee);for(D.children.push(E),$(D,_);A>=0&&Ee.data[A].children.length>this._maxEntries;)this._split(Ee,A),A--;!function V(S,E,A){for(let I=A;I>=0;I--)$(E.data[I],S)}(_,Ee,A)}_split(E,A){const I=E.data[A],M=I.children.length,_=this._minEntries;this._chooseSplitAxis(I,_,M);const D=this._chooseSplitIndex(I,_,M);if(!D)return;const T=I.children.splice(D,I.children.length-D),L=I.leaf?new De(T):new Ge(T);L.height=I.height,K(I,this._toBBox),K(L,this._toBBox),A?E.data[A-1].children.push(L):this._splitRoot(I,L)}_splitRoot(E,A){this._data=new Ge([E,A]),this._data.height=E.height+1,K(this._data,this._toBBox)}_chooseSplitIndex(E,A,I){let M,_,D;M=_=1/0;for(let T=A;T<=I-A;T++){const L=C(E,0,T,this._toBBox),P=C(E,T,I,this._toBBox),w=fe(L,P),W=B(L)+B(P);w<M?(M=w,D=T,_=W<_?W:_):w===M&&W<_&&(_=W,D=T)}return D}_chooseSplitAxis(E,A,I){const M=E.leaf?this._compareMinX:Q,_=E.leaf?this._compareMinY:me;this._allDistMargin(E,A,I,M)<this._allDistMargin(E,A,I,_)&&E.children.sort(M)}_allDistMargin(E,A,I,M){E.children.sort(M);const _=this._toBBox,D=C(E,0,A,_),T=C(E,I-A,I,_);let L=b(D)+b(T);for(let P=A;P<I-A;P++){const w=E.children[P];$(D,E.leaf?_(w):w),L+=b(D)}for(let P=I-A-1;P>=A;P--){const w=E.children[P];$(T,E.leaf?_(w):w),L+=b(T)}return L}_condense(E){for(let A=E.length-1;A>=0;A--){const I=E.data[A];if(0===I.children.length)if(A>0){const M=E.data[A-1],_=M.children;_.splice((0,j.qh)(_,I,_.length,M.indexHint),1)}else this.clear();else K(I,this._toBBox)}}_initFormat(E){const A=["return a"," - b",";"];this._compareMinX=new Function("a","b",A.join(E[0])),this._compareMinY=new Function("a","b",A.join(E[1])),this._toBBox=new Function("a","return {minX: a"+E[0]+", minY: a"+E[1]+", maxX: a"+E[2]+", maxY: a"+E[3]+"};")}}function q(S,E){let A=S;for(Se.clear();A;){if(!0===A.leaf)for(const I of A.children)E(I);else Se.pushArray(A.children);A=Se.pop()??null}}function K(S,E){C(S,0,S.children.length,E,S)}function C(S,E,A,I,M){M||(M=new De([])),M.minX=1/0,M.minY=1/0,M.maxX=-1/0,M.maxY=-1/0;for(let _,D=E;D<A;D++)_=S.children[D],$(M,S.leaf?I(_):_);return M}function $(S,E){S.minX=Math.min(S.minX,E.minX),S.minY=Math.min(S.minY,E.minY),S.maxX=Math.max(S.maxX,E.maxX),S.maxY=Math.max(S.maxY,E.maxY)}function Q(S,E){return S.minX-E.minX}function me(S,E){return S.minY-E.minY}function B(S){return(S.maxX-S.minX)*(S.maxY-S.minY)}function b(S){return S.maxX-S.minX+(S.maxY-S.minY)}function ne(S,E){return(Math.max(E.maxX,S.maxX)-Math.min(E.minX,S.minX))*(Math.max(E.maxY,S.maxY)-Math.min(E.minY,S.minY))}function fe(S,E){const A=Math.max(S.minX,E.minX),I=Math.max(S.minY,E.minY),M=Math.min(S.maxX,E.maxX),_=Math.min(S.maxY,E.maxY);return Math.max(0,M-A)*Math.max(0,_-I)}function G(S,E){return S.minX<=E.minX&&S.minY<=E.minY&&E.maxX<=S.maxX&&E.maxY<=S.maxY}function Ne(S,E){return E.minX<=S.maxX&&E.minY<=S.maxY&&E.maxX>=S.minX&&E.maxY>=S.minY}function Ke(S,E,A,I,M){const _=[E,A];for(;_.length;){const D=_.pop(),T=_.pop();if(D-T<=I)continue;const L=T+Math.ceil((D-T)/I/2)*I;(0,ye.q)(S,L,T,D,M),_.push(T,L,L,D)}}const _e=new se.A,Se=new se.A,Ee=new se.A,Oe=new se.A({deallocator:void 0});class Ze{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class Ue extends Ze{constructor(){super(...arguments),this.height=1,this.indexHint=new j.vW}}class De extends Ue{constructor(E){super(),this.children=E,this.leaf=!0}}class Ge extends Ue{constructor(E){super(),this.children=E,this.leaf=!1}}},59894:(Pe,ie,m)=>{m.d(ie,{F:()=>V});var j=m(3248),R=m(3567),se=m(51995);const le={minX:0,minY:0,maxX:0,maxY:0};class V{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new R.w(9,(0,j.A)("esri-csp-restrictions")?C=>({minX:C[0],minY:C[1],maxX:C[2],maxY:C[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const C=new Array(this._idByBounds.size);let $=0;this._idByBounds.forEach((Q,me)=>{C[$++]=me}),this._indexInvalid=!1,this._index.clear(),this._index.load(C)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(C=>this._idByBounds.has(C))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const C=(0,se.Ie)();for(const $ of this._boundsById.values())$&&(C[0]=Math.min($[0],C[0]),C[1]=Math.min($[1],C[1]),C[2]=Math.max($[2],C[2]),C[3]=Math.max($[3],C[3]));return C}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(C){const $=this._boundsById.get(C);this._boundsById.delete(C),$&&(this._idByBounds.delete($),this._indexInvalid||this._index.remove($))}forEachInBounds(C,$){this._loadIndex(),function q(K,C,$){(function de(K){le.minX=K[0],le.minY=K[1],le.maxX=K[2],le.maxY=K[3]})(C),K.search(le,$)}(this._index,C,Q=>$(this._idByBounds.get(Q)))}get(C){return this._boundsById.get(C)}has(C){return this._boundsById.has(C)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(C,$){if(!this._indexInvalid){const Q=this._boundsById.get(C);Q&&(this._index.remove(Q),this._idByBounds.delete(Q))}this._boundsById.set(C,$),$&&(this._idByBounds.set($,C),this._indexInvalid||(this._boundsToLoad.push($),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},64373:(Pe,ie,m)=>{m.d(ie,{A:()=>Q});var j=m(89952),R=m(5922),se=m(42425),ye=m(35150),le=m(2296),de=m(51995),q=m(31732),V=m(59894),K=m(95985),C=m(50690);const $=(0,le.vt)();class Q{constructor(B){this.geometryInfo=B,this._boundsStore=new V.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new se.A,this.featureAdapter=C.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let B=0;return this._featuresById.forEach(b=>{null!=b.geometry&&b.geometry.coords&&(B+=b.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:B/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(B){if(null==this.fullBounds)return null;const[b,ne,fe,G]=this.fullBounds;return{xmin:b,ymin:ne,xmax:fe,ymax:G,spatialReference:(0,K.ag)(B)}}add(B){this._add(B),this._emitChanged()}addMany(B){for(const b of B)this._add(b);this._emitChanged()}upsertMany(B){const b=B.map(ne=>this._upsert(ne));return this._emitChanged(),b.filter(j.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(B){const b=this._featuresById.get(B);return b?(this._remove(b),this._emitChanged(),b):null}removeManyById(B){this._boundsStore.invalidateIndex();for(const b of B){const ne=this._featuresById.get(b);ne&&this._remove(ne)}this._emitChanged()}forEachBounds(B,b){for(const ne of B){const fe=this._boundsStore.get(ne.objectId);fe&&b((0,le.Jt)($,fe))}}getFeature(B){return this._featuresById.get(B)}has(B){return this._featuresById.has(B)}forEach(B){this._featuresById.forEach(b=>B(b))}forEachInBounds(B,b){this._boundsStore.forEachInBounds(B,ne=>{b(this._featuresById.get(ne))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let B=!1;this._featuresById.forEach((b,ne)=>{this._markedIds.has(ne)||(B=!0,this._remove(b))}),this._markedIds.clear(),B&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(B){if(!B)return;const b=B.objectId;if(null==b)return void ye.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new R.A("featurestore:invalid-feature","feature id is missing",{feature:B}));const ne=this._featuresById.get(b);let fe;if(this._markedIds.add(b),ne?(B.displayId=ne.displayId,fe=this._boundsStore.get(b),this._boundsStore.delete(b)):null!=this.onFeatureAdd&&this.onFeatureAdd(B),!B.geometry?.coords?.length)return this._boundsStore.set(b,null),void this._featuresById.set(b,B);fe=(0,q.jQ)(fe??(0,de.vt)(),B.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=fe&&this._boundsStore.set(b,fe),this._featuresById.set(b,B)}_upsert(B){const b=B?.objectId;if(null==b)return ye.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new R.A("featurestore:invalid-feature","feature id is missing",{feature:B})),null;const ne=this._featuresById.get(b);if(!ne)return this._add(B),B;this._markedIds.add(b);const{geometry:fe,attributes:G}=B;for(const Ne in G)ne.attributes[Ne]=G[Ne];return fe&&(ne.geometry=fe,this._boundsStore.set(b,(0,q.jQ)((0,de.vt)(),fe,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),ne}_remove(B){null!=this.onFeatureRemove&&this.onFeatureRemove(B);const b=B.objectId;return this._markedIds.delete(b),this._boundsStore.delete(b),this._featuresById.delete(b),B}}},89962:(Pe,ie,m)=>{m.d(ie,{F0:()=>le,Vx:()=>V,e2:()=>C,f:()=>$});var j=m(3248),R=m(77806),se=m(78200),ye=m(48254);function le(Q){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===Q||"esriGeometryMultipoint"===Q?ye.Cb:"esriGeometryPolyline"===Q?ye.yM:ye.WR}}}const de=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let q=1;function V(Q,me){if((0,j.A)("esri-csp-restrictions"))return()=>({[me]:null,...Q});try{let B=`this${K(me)} = null;`;for(const ne in Q)B+=`this${K(ne)} = ${JSON.stringify(Q[ne])};`;const b=new Function(`\n      return class AttributesClass$${q++} {\n        constructor() {\n          ${B};\n        }\n      }\n    `)();return()=>new b}catch{return()=>({[me]:null,...Q})}}function K(Q){return de.test(Q)?`.${Q}`:`["${Q}"]`}function C(Q={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,R.o8)(Q)}}]}function $(Q,me){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:Q},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:me,supportsDelete:me,supportsEditing:me,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:me,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:se.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:me,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},44797:(Pe,ie,m)=>{m.d(ie,{PB:()=>I,d4:()=>A,ZL:()=>S,sZ:()=>E,yC:()=>De,Vr:()=>Ge});var j=m(10467),R=m(8189),ye=(m(21152),m(98877)),le=m(5922),de=m(35150),q=m(60797),V=m(63484),K=m(85211),Q=(m(3248),m(40707),m(76576)),me=m(55861),B=m(11817),b=m(58701),ne=m(31732),fe=m(42086),G=m(61320);class _e{constructor(){this._featureLookup=new Map}static getInstance(){return _e.instance||(_e.instance=new _e),_e.instance}static resetInstance(){_e.instance&&(_e.instance=null)}deleteFromStore(_){_.forEach(D=>{this._featureLookup.delete(D)})}readFromStoreByList(_){const D=[];return _.forEach(T=>{const L=this.readFromStoreById(T);L&&D.push(L)}),D}readFromStoreById(_){return this._featureLookup.get(_)??null}writeToStore(_,D,T){const L=[];return _.forEach(P=>{if(!P?.id)return;P.properties||(P.properties=[]);let w,W=null;if(T&&P.properties[T]&&(W=(0,ne.Ux)(P.properties[T])),"originId"in P&&"destinationId"in P&&(P.properties.ESRI__ORIGIN_ID=P.originId,P.properties.ESRI__DESTINATION_ID=P.destinationId),P.properties[D]=P.id,P.id&&this._featureLookup.has(P.id)&&this._featureLookup.get(P.id).attributes){const H=this._featureLookup.get(P.id),N=JSON.parse(JSON.stringify(Object.assign(H.attributes,P.properties)));T&&P.properties[T]&&(N[T]=(0,G.rS)(P.properties[T])),w=new fe.Om(W?JSON.parse(JSON.stringify(W)):H?.geometry?JSON.parse(JSON.stringify(H.geometry)):null,N,null,P.properties[D])}else w=new fe.Om(W?JSON.parse(JSON.stringify(W)):null,P.properties,null,P.properties[D]);this._featureLookup.set(P.id,w),L.push(w)}),L}}var Se=m(81308),Ee=m(328),Oe=m(74490),Ze=m(87086),Ue=m(28067);const De="ESRI__ID",Ge="ESRI__ORIGIN_ID",S="ESRI__DESTINATION_ID",E="ESRI__LAYOUT_GEOMETRY",A="ESRI__AGGREGATION_COUNT";let I=class extends ye.A{constructor(M){super(M),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const _=new Map;M.knowledgeGraph.dataModel.entityTypes?.forEach(D=>{D.name&&(_.set(D.name,"entity"),this._processingCacheUpdatesLookup.set(D.name,[]),M.inclusionModeDefinition&&!M.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(D.name),D.properties?.forEach(T=>{T.geometryType&&"esriGeometryNull"!==T.geometryType&&this.geographicLookup.set(D.name,{name:T.name??"",geometryType:T.geometryType})}))}),M.knowledgeGraph.dataModel.relationshipTypes?.forEach(D=>{D.name&&(_.set(D.name,"relationship"),this._processingCacheUpdatesLookup.set(D.name,[]),M.inclusionModeDefinition&&!M.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(D.name),D.properties?.forEach(T=>{T.geometryType&&"esriGeometryNull"!==T.geometryType&&this.geographicLookup.set(D.name,{name:T.name??"",geometryType:T.geometryType})}))}),M.inclusionModeDefinition?.namedTypeDefinitions.forEach((D,T)=>{if("entity"===_.get(T))this.entityTypeNames.add(T);else{if("relationship"!==_.get(T))return de.A.getLogger(this).warn(`A named type, ${T}, was in the inclusion list that wasn't in the data model and will be removed`),void M.inclusionModeDefinition?.namedTypeDefinitions.delete(T);this.relationshipTypeNames.add(T)}const L=new Map;D.members?.forEach(P=>{(0,q.tE)(this.memberIdTypeLookup,P.id,()=>new Set).add(T);const w=this.getById(P.id);w&&L.set(P.id,w)}),this.sublayerCaches.set(T,L)})}addToLayer(M){M.forEach(({typeName:_,id:D})=>{if(!this.inclusionModeDefinition)throw new le.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(_)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(_)){const T=this.inclusionModeDefinition.namedTypeDefinitions.get(_);T.members||(T.members=new Map),T.members.set(D,{id:D}),(0,q.tE)(this.memberIdTypeLookup,D,()=>new Set).add(_)}}else{const T=new Map;T.set(D,{id:D}),this.inclusionModeDefinition.namedTypeDefinitions.set(_,{useAllData:!1,members:T}),(0,q.tE)(this.memberIdTypeLookup,D,()=>new Set).add(_)}})}getById(M){return _e.getInstance().readFromStoreById(M)}getData(M,_,D){var T=this;return(0,j.A)(function*(){if(_.objectType.name&&T.inclusionModeDefinition?.namedTypeDefinitions&&T.inclusionModeDefinition.namedTypeDefinitions.size>0&&!T.inclusionModeDefinition.namedTypeDefinitions.has(_.objectType.name))return[];let L;if(L=M||new Ze.A({where:"1=1",outFields:["*"]}),"link-chart"===_.parentCompositeLayer.type){const P=_.parentCompositeLayer,w=T._processingCacheUpdatesLookup.get(_.objectType.name??""),W=L.outFields;W&&1===W.length&&W[0]===De&&"1=1"===L.where||(yield Promise.all(w??[]));const H=T.sublayerCaches.has(_.objectType.name??"")?Array.from(T.sublayerCaches.get(_.objectType.name)?.values()):[],N=[];return H.forEach(z=>{z.geometry=T.relationshipTypeNames.has(_.objectType.name)?P.relationshipLinkChartDiagramLookup.get(z.attributes[_.objectIdField]):P.entityLinkChartDiagramLookup.get(z.attributes[_.objectIdField]),z.attributes[E]=z.geometry,N.push(z)}),N}return T.retrieveDataFromService(L,_,D)})()}getConnectedRecordIds(M,_){var D=this;return(0,j.A)(function*(){const T=[];let L="";const P=[],w=new Map;if(M.forEach(W=>{if(D.memberIdTypeLookup.has(W))for(const H of D.memberIdTypeLookup.get(W)){if(!D.entityTypeNames.has(H))return;w.has(H)?w.get(H)?.push(W):w.set(H,[W])}}),_&&0!==_?.length){for(const W of _)L=L+W+"|";L=L.slice(0,-1)}return w.forEach((W,H)=>{let N;N=_&&0!==_?.length?`MATCH (n:${H})-[r:${L}]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`:`MATCH (n:${H})-[r]-(m) WHERE id(n) IN $ids RETURN id(r), type(r), id(m), labels(m)[0]`;const z=new Promise(be=>{(0,j.A)(function*(){const Ce=(yield(0,Ee.executeQueryStreaming)(D.knowledgeGraph,new Oe.A({openCypherQuery:N,bindParameters:{ids:W}}))).resultRowsStream.getReader();try{for(;;){const{done:Ae,value:Be}=yield Ce.read();if(Ae)break;for(let te=0;te<Be.length;te++){const Y=Be[te];T.push({id:Y[0],typeName:Y[1]}),T.push({id:Y[2],typeName:Y[3]})}}}catch(Ae){if("AbortError"!==Ae.name)throw Ae;de.A.getLogger(D).info("Request aborted as expected")}})().then(()=>{be()})});P.push(z)}),D.refreshCacheContent(),yield Promise.all(P),T})()}getAttachedRelationships(M,_){var D=this;return(0,j.A)(function*(){const T=[],P=(yield(0,Ee.executeQueryStreaming)(D.knowledgeGraph,new Oe.A({openCypherQuery:"MATCH (n)-[r]->(m) WHERE id(n) IN $nodeIds AND id(m) in $nodeIds AND NOT id(r) IN $relationshipExclusionIds return id(r), type(r)",bindParameters:{nodeIds:M,relationshipExclusionIds:_}}))).resultRowsStream.getReader();try{for(;;){const{done:w,value:W}=yield P.read();if(w)break;for(let H=0;H<W.length;H++){const N=W[H];T.push({id:N[0],typeName:N[1]})}}}catch(w){if("AbortError"!==w.name)throw w;de.A.getLogger(D).info("Request aborted as expected")}return T})()}refreshCacheContent(M,_,D,T=!0){var L=this;return(0,j.A)(function*(){const P=_e.getInstance(),w=[],W=new Map,H=new Map;L.knowledgeGraph.dataModel.entityTypes?.forEach(N=>{N.name&&H.set(N.name,N)}),L.knowledgeGraph.dataModel.relationshipTypes?.forEach(N=>{N.name&&H.set(N.name,N)}),M||L.inclusionModeDefinition?M?M.forEach(N=>{if(L.memberIdTypeLookup.has(N))for(const z of L.memberIdTypeLookup.get(N))W.has(z)?W.get(z)?.push(N):W.set(z,[N])}):L.inclusionModeDefinition?.namedTypeDefinitions?.forEach((N,z)=>{N.useAllData?W.set(z,null):N.members&&N.members.forEach(be=>{W.has(z)&&null!==W.get(z)?W.get(z)?.push(be.id):W.set(z,[be.id])})}):(L.knowledgeGraph.dataModel.entityTypes?.forEach(N=>{N.name&&W.set(N.name,null)}),L.knowledgeGraph.dataModel.entityTypes?.forEach(N=>{N.name&&W.set(N.name,null)}));for(const[N,z]of W){const be=new Promise(Ce=>{(function(){var Be=(0,j.A)(function*(){const te=new Set,Y=[];let Me,he="",ve=!1;if(_||H.get(N)?.properties?.forEach(ee=>{ee.name&&te.add(ee.name)}),D&&L.geographicLookup.has(N)){const ee=L.geographicLookup.get(N)?.name;ee&&te.add(ee)}if(L.entityTypeNames.has(N))he=`MATCH (n:${N}) ${z?"WHERE id(n) IN $ids ":""}return ID(n)`,te.forEach(ee=>{he+=`, n.${ee}`,Y.push(ee)});else{if(!L.relationshipTypeNames.has(N))throw new le.A("knowledge-graph:layer-data-manager",`The graph type of ${N} could not be determined. Was this type set in the KG data model and inclusion definition?`);ve=!0,he=`MATCH ()-[n:${N}]->() ${z?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,te.forEach(ee=>{he+=`, n.${ee}`,Y.push(ee)})}Me=new Oe.A(z?{openCypherQuery:he,bindParameters:{ids:z}}:{openCypherQuery:he});const ae=(yield(0,Ee.executeQueryStreaming)(L.knowledgeGraph,Me)).resultRowsStream.getReader();for(;;){const{done:ee,value:pe}=yield ae.read();if(ee)break;const Z=[];for(let Le=0;Le<pe.length;Le++){const Re=pe[Le];let U=0,We=0;const h={properties:{}};for(h.id=Re[U],U++,We++,ve&&(h.originId=Re[U],U++,We++,h.destinationId=Re[U],U++,We++,(0,q.tE)(L.nodeConnectionsLookup,h.originId,()=>new Set).add(h.id),(0,q.tE)(L.nodeConnectionsLookup,h.destinationId,()=>new Set).add(h.id),(0,q.tE)(L.relationshipConnectionsLookup,h.id,()=>[h.originId,h.destinationId]));U<Re.length;U++)h.properties[Y[U-We]]=Re[U];Z.push(h)}const ce=P.writeToStore(Z,De,L.geographicLookup.get(N)?.name);L.sublayerCaches.has(N)||L.sublayerCaches.set(N,new Map),T&&!L.inclusionModeDefinition?.namedTypeDefinitions.has(N)&&L.inclusionModeDefinition?.namedTypeDefinitions.set(N,{useAllData:!1,members:new Map}),T&&!L.inclusionModeDefinition?.namedTypeDefinitions.get(N).members&&(L.inclusionModeDefinition.namedTypeDefinitions.get(N).members=new Map);const xe=L.sublayerCaches.get(N);ce.forEach(Le=>{xe?.set(Le.attributes[De],Le),T&&!L.inclusionModeDefinition?.namedTypeDefinitions.get(N).members.has(Le.attributes[De])&&(L.inclusionModeDefinition?.namedTypeDefinitions.get(N).members.set(Le.attributes[De],{id:Le.attributes[De]}),(0,q.tE)(L.memberIdTypeLookup,Le.attributes[De],()=>new Set).add(N))})}});return function(){return Be.apply(this,arguments)}})()().then(()=>{Ce(null)})});w.push(be),L._processingCacheUpdatesLookup.get(N)?.push(be)}yield Promise.all(w)})()}removeFromLayer(M){const _=new Set,D=new Set(M.map(T=>T.id));for(const T of M)_.add(T.typeName),1===this.memberIdTypeLookup.get(T.id)?.size?this.memberIdTypeLookup.delete(T.id):this.memberIdTypeLookup.get(T.id)?.delete(T.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach((L,P)=>{P===T.typeName&&L.members?.has(T.id)&&L.members.delete(T.id)});_.forEach(T=>{this.sublayerCaches.get(T)?.forEach((L,P)=>{D.has(P)&&this.sublayerCaches.get(T)?.delete(P)})})}retrieveDataFromService(M,_,D){var T=this;return(0,j.A)(function*(){const L=_e.getInstance(),P=new Set,w=[];let W,H="",N=[];const z="relationship"===_.graphType,be=T.inclusionModeDefinition?.namedTypeDefinitions?.get(_.objectType.name)?.useAllData,Ce=_.parentCompositeLayer.sublayerIdsCache.get(_.objectType.name);let Ae=!be&&Ce?Array.from(Ce).sort():null;if(T.inclusionModeDefinition?.namedTypeDefinitions?.get(_.objectType.name)?.useAllData)T.inclusionModeDefinition?.namedTypeDefinitions?.get(_.objectType.name)?.useAllData&&null!=M.objectIds&&(Ae=M.objectIds);else if(null!=M.objectIds&&Ae&&Ae.length>0){const te=M.objectIds;M.objectIds=Ae.filter(Y=>te.includes(Y))}else if(null!=M.objectIds)Ae=M.objectIds;else{if(T.inclusionModeDefinition?.namedTypeDefinitions.has(_.objectType.name)&&(!T.inclusionModeDefinition.namedTypeDefinitions.get(_.objectType.name)?.members||T.inclusionModeDefinition.namedTypeDefinitions.get(_.objectType.name)?.members?.size<1))return M.objectIds=[],[];M.objectIds=Ae}if(null!=M.outFields){const te=M.outFields;te.includes("*")?_.fields.forEach(Y=>{P.add(Y.name)}):te.forEach(Y=>{Y!==De&&Y!==_.geometryFieldName&&P.add(Y)})}if(null!=M.geometry){const te=M.geometry;let Y;const Me=_.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,he=Me?.spatialReference,ve=Me?.serviceCapabilities?.geometryCapabilities;let ae=ve?.geometryMaxBoundingRectangleSizeX,ee=ve?.geometryMaxBoundingRectangleSizeY;if(te?.extent?.spatialReference&&!te.spatialReference?.isWGS84?(yield(0,B.initializeProjection)(te.extent.spatialReference,b.KK),Y=(0,B.project)(te.extent,b.KK)):Y=te.extent,ae&&ee&&he){if(4326!==he.wkid){const pe=new Ue.A({spatialReference:he,xmax:ae,ymax:ee}),Z=(0,B.project)(pe,b.KK);ae=Z.xmax,ee=Z.ymax}if(Y.xmax-Y.xmin>ae)throw new le.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${ae}\xb0 latitude, limit exceeded`);if(Y.ymax-Y.ymin>ee)throw new le.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${ee}\xb0 longitude, limit exceeded`)}if(null!=M.where&&"1=1"!==M.where){const pe=yield(0,V.G)(M.where.toUpperCase(),_.fieldsIndex);_.fields.forEach(Z=>{pe.fieldNames.includes(Z.name)&&P.add(Z.name)})}H=z?`Match ()-[n:${_.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${_.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${_.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${_.geometryFieldName}) return ID(n)`,_.geometryFieldName&&P.add(_.geometryFieldName),P.forEach(pe=>{H+=`, n.${pe}`,w.push(pe)}),W=new Oe.A({openCypherQuery:H,bindParameters:{param_filter_geom:new me.A({rings:(0,Se.DX)(Y)})}})}else{let te="";if(null!=M.where&&"1=1"!==M.where){const he=yield(0,V.G)(M.where,_.fieldsIndex);_.fields.forEach(Z=>{he.fieldNames.includes(Z.name)&&P.add(Z.name)});const ve=new Set(["column-reference","string","number","binary-expression"]),ae=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let ee=!1;const pe=Z=>{if("column-reference"===Z.type)return`n.${Z.column}`;if("string"===Z.type)return`'${Z.value}'`;if("number"===Z.type)return`${Z.value}`;if("binary-expression"===Z.type&&ve.has(Z.left.type)&&ve.has(Z.right.type)&&ae.has(Z.operator))return`${pe(Z.left)} ${Z.operator} ${pe(Z.right)}`;if("binary-expression"===Z.type&&"LIKE"===Z.operator){let ce="";if("function"===Z.left.type&&"column-reference"===Z.left.args.value[0].type)ce+=`lower(n.${Z.left.args.value[0].column})`;else{if("column-reference"!==Z.left.type)return ee=!0,"";ce+=`lower(n.${Z.left.column})`}if(ce+=" CONTAINS (","string"!==Z.right.type)return ee=!0,"";{let xe=Z.right.value;"%"===xe.charAt(0)&&(xe=xe.slice(1)),"%"===xe.charAt(xe.length-1)&&(xe=xe.slice(0,-1)),ce+=`'${xe.toLowerCase()}')`}return ce}return ee=!0,""};te=pe(he.parseTree),ee&&(te="")}let Y="";Y=z?`Match ()-[n:${_.objectType.name}]->()`:`Match (n:${_.objectType.name})`;let Me=!1;Ae&&(Me=!0,Y+=" WHERE ID(n) IN $ids"),te&&(Y+=Me?" AND":" WHERE",Y+=` ${te}`),Y+=" return ID(n)",z&&(Y+=", id(startNode(n)), id(endNode(n))"),M.returnGeometry&&_.geometryFieldName&&P.add(_.geometryFieldName),P.forEach(he=>{Y+=`, n.${he}`,w.push(he)}),W=new Oe.A(Ae?{openCypherQuery:Y,bindParameters:{ids:Ae}}:{openCypherQuery:Y})}const Be=(yield(0,Ee.executeQueryStreaming)(_.parentCompositeLayer.dataManager.knowledgeGraph,W,D)).resultRowsStream.getReader();for(;;){const{done:te,value:Y}=yield Be.read();if(te)break;const Me=[];for(let he=0;he<Y.length;he++){const ve=Y[he];let ae=0,ee=0;const pe={properties:{}};for(pe.id=ve[ae],ae++,ee++,z&&(pe.originId=ve[ae],ae++,ee++,pe.destinationId=ve[ae],ae++,ee++);ae<ve.length;ae++)pe.properties[w[ae-ee]]=ve[ae];Me.push(pe)}N=N.concat(L.writeToStore(Me,De,_.parentCompositeLayer.dataManager.geographicLookup.get(_.objectType.name)?.name))}return N})()}};(0,R._)([(0,K.MZ)()],I.prototype,"knowledgeGraph",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"inclusionModeDefinition",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"entityTypeNames",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"relationshipTypeNames",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"geographicLookup",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"sublayerCaches",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"nodeConnectionsLookup",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"relationshipConnectionsLookup",void 0),(0,R._)([(0,K.MZ)()],I.prototype,"memberIdTypeLookup",void 0),I=(0,R._)([(0,Q.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],I)},85574:(Pe,ie,m)=>{m.d(ie,{A:()=>We});var j=m(10467),R=m(8189),ye=(m(21152),m(92165)),me=(m(79122),m(70176),m(92089),m(9826),m(15317),m(38582),m(96128),m(13318),m(85718)),B=m(36156),b=m(77806),ne=m(39693),G=(m(19284),m(85211)),_e=(m(3248),m(35150),m(76576)),Se=m(50305),Ee=m(26514),Oe=m(11817),Ze=m(32034),Ue=m(58701),De=m(95478),Ge=m(64373),S=m(33594),E=m(89962),A=m(44797);m(40707);const _=(0,m(3404).p)(),D=h=>{let g=class extends h{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,R._)([(0,G.MZ)(_.fields)],g.prototype,"fields",void 0),(0,R._)([(0,G.MZ)(_.fieldsIndex)],g.prototype,"fieldsIndex",void 0),g=(0,R._)([(0,_e.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],g),g};var T=m(93410),L=m(31446),P=m(25263),w=m(43124),W=m(1151),H=m(33036),N=m(84311),z=m(22329),be=m(14236),Ce=m(29141),Ae=m(86300),Be=m(20329),te=m(73975),Y=m(93327),Me=m(87086),he=m(41843),ve=m(85311),ae=m(28067),ee=m(55861),pe=m(93615),Z=m(6434);function ce(h){if(!h.json)return h;h.json.write=xe(h.json.write);const g=h.json.origins;if(!g)return h;let O;for(O in g){const v=g[O];v&&(v.write=xe(v.write))}return h}function xe(h){return"object"==typeof h&&h?(!1!==h.enabled&&(h.overridePolicy=function Le(h){const{target:g,writer:O,overridePolicy:v,...x}=h;return function(F,J){const X=Re.call(this,F,J);return X.enabled?{...x,...X}:X}}(h)),h):!0===h?{overridePolicy:Re}:h}function Re(h,g){const O=!!this.geometryType,v={enabled:O};return O&&(v.ignoreOrigin=this.originIdOf(g)>Ee.Gr.COMPUTED),v}let U=class extends(D((0,P.J)((0,L.F)((0,T.dM)((0,w.f)((0,N.e)((0,H.j)((0,W.J)((0,ne.P)(De.A)))))))))){constructor(h){super(h),this.blendMode="normal",this.capabilities=(0,E.f)(!1,!1),this.charts=null,this.definitionExpression=null,this.displayField="",this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.labelingInfo=null,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=A.yC,this.objectType=null,this.opacity=1,this.orderBy=null,this.parentCompositeLayer=null,this.popupEnabled=!0,this.popupTemplate=null,this.source={openPorts:()=>this.load().then(()=>{const g=new MessageChannel;return new ve.A(g.port1,{channel:g,client:{queryFeatures:(O,v={})=>{const x=Me.A.fromJSON(O);return this.queryFeaturesJSON(x,v)}}}),[g.port2]})},this.title=null,this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(h){const g=this._normalizeFeatureReduction(h);this._set("featureReduction",g)}get fields(){const h=[];return this.objectType?.properties?.forEach(g=>{h.push(Ce.A.fromJSON({name:g.name,type:"esriFieldTypeOID"===g.fieldType?"esriFieldTypeInteger":g.fieldType,alias:g.alias,defaultValue:g.defaultValue,editable:g.editable,nullable:g.nullable}))}),h.push(Ce.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),Ce.A.fromJSON({name:A.d4,type:"esriFieldTypeInteger",alias:A.d4,editable:!1})),h}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const h=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),g=h?.geometryType;return g&&"esriGeometryNull"!==g?Z.g.fromJSON(g):null}get geometryFieldName(){return"link-chart"===this.parentCompositeLayer?.type?A.sZ:this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name)?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const h=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),g=h?.name;return(g?this.objectType?.properties?.[g]:null)?.hasM??!1}get hasZ(){const h=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),g=h?.name;return(g?this.objectType?.properties?.[g]:null)?.hasZ??!1}set renderer(h){(0,Ae.yp)(h,this.fieldsIndex),this._set("renderer",h)}get renderer(){return this._isOverridden("renderer")?this._get("renderer"):(0,me.r)("link-chart"===this.parentCompositeLayer?.type?"relationship"===this.graphType?(0,E.F0)(Z.g.toJSON("polyline")).renderer:(0,E.F0)(Z.g.toJSON("point")).renderer:(0,E.F0)(Z.g.toJSON(this.geometryType)).renderer)}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??Ze.A.WGS84}writeTitle(h,g){g.title=h??"Layer"}createPopupTemplate(h){return(0,he.tn)(this,h)}createQuery(){return new Me.A({where:"1=1",outFields:["*"]})}getField(h){for(let g=0;g<this.fields.length;g++)if(this.fields[g].name===h)return this.fields[g];return null}getFieldDomain(h,g){return null}queryFeatures(h,g){var O=this;return(0,j.A)(function*(){const{resolvedQuery:v,queryEngine:x}=yield O._setupQueryObjects(h),F=Y.A.fromJSON(yield x.executeQuery(v.toJSON(),g?.signal));return F.features.forEach(J=>{J.sourceLayer=O}),F})()}queryFeaturesJSON(h,g){var O=this;return(0,j.A)(function*(){const{resolvedQuery:v,queryEngine:x}=yield O._setupQueryObjects(h);return yield x.executeQuery(v.toJSON(),g?.signal)})()}queryFeatureCount(h,g){var O=this;return(0,j.A)(function*(){const{resolvedQuery:v,queryEngine:x}=yield O._setupQueryObjects(h);return x.executeQueryForCount(v.toJSON(),g?.signal)})()}queryExtent(h={},g){var O=this;return(0,j.A)(function*(){const v={...h,returnGeometry:!0},{resolvedQuery:x,queryEngine:F}=yield O._setupQueryObjects(v),J=yield F.executeQueryForExtent(x.toJSON(),g?.signal);let X;return X=null!=J.extent?.xmin&&null!=J.extent?.xmax&&null!=J.extent?.ymin&&null!=J.extent?.ymax?new ae.A(J.extent):new ae.A,{count:J.count,extent:X}})()}queryObjectIds(h,g){var O=this;return(0,j.A)(function*(){const v=Me.A.from(h);let x;if("link-chart"===O.parentCompositeLayer.type&&O._cachedQueryEngine)x=O._cachedQueryEngine;else{const F=yield O.parentCompositeLayer.dataManager.getData(v,O,g);x=O.loadQueryEngine(F)}return x.executeQueryForIds(v.toJSON(),g?.signal)})()}loadQueryEngine(h){const g=new Ge.A({geometryType:Z.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),O=new S.d({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:Z.g.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,objectIdField:this.objectIdField,spatialReference:this.spatialReference.toJSON(),timeInfo:null,featureStore:g});return O.featureStore.addMany(h),O}refreshCachedQueryEngine(){var h=this;return(0,j.A)(function*(){const g=yield h.parentCompositeLayer.dataManager.getData(new Me.A({where:"1=1",outFields:[A.yC]}),h);h._cachedQueryEngine=h.loadQueryEngine(g)})()}_setupQueryObjects(h,g){var O=this;return(0,j.A)(function*(){const v=Me.A.from(h),x=v.geometry;let F;if(x&&!x.spatialReference?.isWGS84&&(yield(0,Oe.initializeProjection)(x.spatialReference,Ue.KK),v.geometry=(0,Oe.project)(x instanceof ee.A||x instanceof pe.A?x:x.extent,Ue.KK)),"link-chart"===O.parentCompositeLayer.type&&O._cachedQueryEngine)F=O._cachedQueryEngine;else{const J=yield O.parentCompositeLayer.dataManager.getData(v,O,g);F=O.loadQueryEngine(J)}return{resolvedQuery:v,queryEngine:F}})()}};(0,R._)([(0,G.MZ)(ce((0,b.o8)(T.sU)))],U.prototype,"blendMode",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"capabilities",void 0),(0,R._)([(0,G.MZ)({json:{origins:{"web-scene":{write:!1}},write:{overridePolicy:Re}}})],U.prototype,"charts",void 0),(0,R._)([(0,G.MZ)({readOnly:!0})],U.prototype,"defaultPopupTemplate",null),(0,R._)([(0,G.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],U.prototype,"definitionExpression",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"displayField",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(T.LF)))],U.prototype,"effect",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"elevationInfo",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(L.Y)))],U.prototype,"featureEffect",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(be.d)))],U.prototype,"featureReduction",null),(0,R._)([(0,G.MZ)()],U.prototype,"fields",null),(0,R._)([(0,G.MZ)()],U.prototype,"geometryType",null),(0,R._)([(0,G.MZ)()],U.prototype,"geometryFieldName",null),(0,R._)([(0,G.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],U.prototype,"graphType",void 0),(0,R._)([(0,G.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],U.prototype,"graphTypeName",null),(0,R._)([(0,G.MZ)()],U.prototype,"hasM",null),(0,R._)([(0,G.MZ)()],U.prototype,"hasZ",null),(0,R._)([(0,G.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],U.prototype,"id",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.kF)))],U.prototype,"labelsVisible",void 0),(0,R._)([(0,G.MZ)({type:[Be.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:te.w,write:{overridePolicy:Re}}})],U.prototype,"labelingInfo",void 0),(0,R._)([(0,G.MZ)({readOnly:!0,json:{read:!1,write:{writer(h,g){g.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],U.prototype,"layerType",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.fV)))],U.prototype,"legendEnabled",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.hG)))],U.prototype,"maxScale",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.hn)))],U.prototype,"minScale",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"objectIdField",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"objectType",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.ke)))],U.prototype,"opacity",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(w.n)))],U.prototype,"orderBy",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"parentCompositeLayer",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(z.M6)))],U.prototype,"popupEnabled",void 0),(0,R._)([(0,G.MZ)({type:ye.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],U.prototype,"popupTemplate",void 0),(0,R._)([(0,G.MZ)({types:B.H,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:Re}}})],U.prototype,"renderer",null),(0,R._)([(0,G.MZ)()],U.prototype,"source",void 0),(0,R._)([(0,G.MZ)()],U.prototype,"spatialReference",null),(0,R._)([(0,G.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],U.prototype,"title",void 0),(0,R._)([(0,Se.K)("title")],U.prototype,"writeTitle",null),(0,R._)([(0,G.MZ)({json:{read:!1}})],U.prototype,"type",void 0),(0,R._)([(0,G.MZ)(ce((0,b.o8)(N.B)))],U.prototype,"useViewTime",void 0),(0,R._)([(0,G.MZ)({type:Boolean,json:{name:"visibility",write:{overridePolicy:Re}}})],U.prototype,"visible",void 0),U=(0,R._)([(0,_e.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],U);const We=U},81308:(Pe,ie,m)=>{m.d(ie,{DX:()=>L,_s:()=>be,aq:()=>P,fe:()=>te});var Se,h,Oe,Ze,j=m(10467),R=m(89563),se=m(5922),ye=m(60797),de=(m(31732),m(328)),q=m(74490);m(21152),m(32034),(h=Se||(Se={})).ELEMENTUID="ELEMENTUID",h.TYPENAME="TYPENAME",function(h){h[h.ELEMENTUID=0]="ELEMENTUID",h[h.TYPENAME=1]="TYPENAME"}(Oe||(Oe={})),function(h){h[h.ELEMENTUID=0]="ELEMENTUID",h[h.TYPENAME=1]="TYPENAME",h[h.FROMUID=2]="FROMUID",h[h.TOUID=3]="TOUID"}(Ze||(Ze={}));var Ge,S,E,A,Ue=m(31772);function L(h){if(!h.spatialReference.isWGS84)throw new se.A("knowledge-graph:layer-support-utils","The extentToInBoundsRings function only supports WGS84 spatial references.");return h.clone().normalize().map(g=>[[g.xmin,g.ymin],[g.xmin,g.ymax],[g.xmax,g.ymax],[g.xmax,g.ymin],[g.xmin,g.ymin]])}function P(h,g){return w.apply(this,arguments)}function w(){return w=(0,j.A)(function*(h,g){const O=[],v=new Map,x=[];if(g.dataModel?.relationshipTypes)for(const F of g.dataModel.relationshipTypes)F.name&&v.set(F.name,[]);for(const F of h)v.has(F.typeName)&&v.get(F.typeName)?.push(F.id);for(const[F,J]of v){if(J.length<1)continue;const X=new q.A({openCypherQuery:`MATCH (n)-[r:${F}]->(m) WHERE id(r) in $ids RETURN id(n), labels(n)[0], id(m), labels(m)[0]`,bindParameters:{ids:J}});x.push((0,de.executeQueryStreaming)(g,X).then(function(){var k=(0,j.A)(function*(Te){const oe=Te.resultRowsStream.getReader();for(;;){const{done:ue,value:ge}=yield oe.read();if(ue)break;for(const re of ge)O.push({id:re[0],typeName:re[1]}),O.push({id:re[2],typeName:re[3]})}});return function(Te){return k.apply(this,arguments)}}()))}return yield Promise.all(x),O}),w.apply(this,arguments)}function be(h,g){return Ce.apply(this,arguments)}function Ce(){return Ce=(0,j.A)(function*(h,g){g??=!1;const O={generateAllSublayers:g,namedTypeDefinitions:new Map};return yield function Z(h){return ce.apply(this,arguments)}(h).then(v=>{!function U(h,g){for(const[O,v]of h){const x=(0,ye.tE)(g.namedTypeDefinitions,O,()=>({useAllData:!1,members:new Map}));for(const F of v)x.members.has(F)||x.members.set(F,{id:F})}return g}(v,O)}),O}),Ce.apply(this,arguments)}function te(h){return Y.apply(this,arguments)}function Y(){return Y=(0,j.A)(function*(h){const g=yield(0,Ue.I)(),O=new g.MapOfObjectIdentifierSets;!function he(h,g,O){for(const[v,x]of O.namedTypeDefinitions){if(!x.members||x.useAllData)continue;const F=x.members.keys(),J=new g.GlobalIdArray,X=new g.ObjectIdentifierSet;for(const k of F)J.add_globalid(k);X.set_globalid_array(J),J.delete(),h.put_identifier_set(v,X),X.delete()}}(O,g,h);const v=new g.MapOfObjectIdentifierSetsEncoder;try{v.set_map_of_identifier_sets(O),v.encode();const x=v.get_encoding_result();if(0!==x.error.error_code)throw new se.A("knowledge-graph:layer-support-utils",x.error.error_message);const F=structuredClone(x.get_byte_buffer());return v.delete(),F}finally{O.delete()}}),Y.apply(this,arguments)}function ce(){return ce=(0,j.A)(function*(h){const g=yield(0,R.A)(h,{responseType:"array-buffer"}),O=yield g.data;return function xe(h){return Le.apply(this,arguments)}(new Uint8Array(O))}),ce.apply(this,arguments)}function Le(){return Le=(0,j.A)(function*(h){const g=new((yield(0,Ue.I)()).MapOfObjectIdentifierSetsDecoder),O=g.decode(new Uint8Array(h)),v=new Map;if(0!==O.error_code)throw new se.A("knowledge-graph:layer-support-utils",O.error_message);const x=g.get_map_of_identifier_sets(),F=x.keys,J=F.size();for(let X=0;X<J;X++){const k=F.get(X),Te=x.query_identifier_set(k),oe=[];if(Te.id_array_type.value===A.GLOBALID_ARRAY){const ue=Te.get_globalid_array(),ge=ue.count();for(let re=0;re<ge;re++)oe.push(ue.get_globalid_at(re))}else{if(Te.id_array_type.value!==A.IDENTIFIER_ARRAY)throw new se.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const ue=Te.get_identifier_array(),ge=ue.count();for(let re=0;re<ge;re++)oe.push(ue.get_identifier_at(re).toString())}}v.set(k,oe)}return g.delete(),v}),Le.apply(this,arguments)}m(66072),function(h){h[h.featureResult=0]="featureResult",h[h.countResult=1]="countResult",h[h.idsResult=2]="idsResult"}(Ge||(Ge={})),function(h){h[h.upperLeft=0]="upperLeft",h[h.lowerLeft=1]="lowerLeft"}(S||(S={})),function(h){h[h.sqlTypeBigInt=0]="sqlTypeBigInt",h[h.sqlTypeBinary=1]="sqlTypeBinary",h[h.sqlTypeBit=2]="sqlTypeBit",h[h.sqlTypeChar=3]="sqlTypeChar",h[h.sqlTypeDate=4]="sqlTypeDate",h[h.sqlTypeDecimal=5]="sqlTypeDecimal",h[h.sqlTypeDouble=6]="sqlTypeDouble",h[h.sqlTypeFloat=7]="sqlTypeFloat",h[h.sqlTypeGeometry=8]="sqlTypeGeometry",h[h.sqlTypeGUID=9]="sqlTypeGUID",h[h.sqlTypeInteger=10]="sqlTypeInteger",h[h.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",h[h.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",h[h.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",h[h.sqlTypeNChar=14]="sqlTypeNChar",h[h.sqlTypeNVarChar=15]="sqlTypeNVarChar",h[h.sqlTypeOther=16]="sqlTypeOther",h[h.sqlTypeReal=17]="sqlTypeReal",h[h.sqlTypeSmallInt=18]="sqlTypeSmallInt",h[h.sqlTypeSqlXml=19]="sqlTypeSqlXml",h[h.sqlTypeTime=20]="sqlTypeTime",h[h.sqlTypeTimestamp=21]="sqlTypeTimestamp",h[h.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",h[h.sqlTypeTinyInt=23]="sqlTypeTinyInt",h[h.sqlTypeVarbinary=24]="sqlTypeVarbinary",h[h.sqlTypeVarchar=25]="sqlTypeVarchar"}(E||(E={})),function(h){h[h.OID_ARRAY=0]="OID_ARRAY",h[h.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",h[h.STRING_ARRAY=2]="STRING_ARRAY",h[h.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(A||(A={}))},36775:(Pe,ie,m)=>{m.d(ie,{A:()=>$});var j=m(8189),se=(m(21152),m(85211)),q=(m(3248),m(35150),m(40707),m(76576)),V=m(14430),K=m(1749);let C=class extends V.A{constructor(Q){super(Q),this.layoutGeometry=null}};(0,j._)([(0,se.MZ)({type:K.A,json:{write:!0}})],C.prototype,"layoutGeometry",void 0),C=(0,j._)([(0,q.$)("esri.rest.knowledgeGraph.Entity")],C);const $=C},14430:(Pe,ie,m)=>{m.d(ie,{A:()=>K});var j=m(8189),R=m(85211),de=(m(3248),m(35150),m(40707),m(76576)),q=m(53805);let V=class extends q.A{constructor(C){super(C),this.typeName=null,this.id=null}};(0,j._)([(0,R.MZ)({type:String,json:{write:!0}})],V.prototype,"typeName",void 0),(0,j._)([(0,R.MZ)({type:String,json:{write:!0}})],V.prototype,"id",void 0),V=(0,j._)([(0,de.$)("esri.rest.knowledgeGraph.GraphNamedObject")],V);const K=V},53805:(Pe,ie,m)=>{m.d(ie,{A:()=>K});var j=m(8189),R=m(71065),se=m(85211),q=(m(3248),m(35150),m(40707),m(76576));let V=class extends R.oY{constructor(C){super(C),this.properties=null}};(0,j._)([(0,se.MZ)({json:{write:!0}})],V.prototype,"properties",void 0),V=(0,j._)([(0,q.$)("esri.rest.knowledgeGraph.GraphObject")],V);const K=V},74490:(Pe,ie,m)=>{m.d(ie,{A:()=>$});var j=m(8189),R=m(85211),de=(m(3248),m(35150),m(40707),m(76576)),q=m(98877);let V=class extends q.A{constructor(Q){super(Q),this.openCypherQuery=""}};(0,j._)([(0,R.MZ)()],V.prototype,"openCypherQuery",void 0),V=(0,j._)([(0,de.$)("esri.rest.knowledgeGraph.GraphQuery")],V);const K=V;let C=class extends K{constructor(Q){super(Q),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,j._)([(0,R.MZ)()],C.prototype,"bindParameters",void 0),(0,j._)([(0,R.MZ)()],C.prototype,"bindGeometryQuantizationParameters",void 0),(0,j._)([(0,R.MZ)()],C.prototype,"outputQuantizationParameters",void 0),(0,j._)([(0,R.MZ)()],C.prototype,"outputSpatialReference",void 0),(0,j._)([(0,R.MZ)()],C.prototype,"provenanceBehavior",void 0),C=(0,j._)([(0,de.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],C);const $=C},49238:(Pe,ie,m)=>{m.d(ie,{A:()=>K});var j=m(8189),de=(m(35150),m(3248),m(40707),m(5922),m(76576)),q=m(53805);let V=class extends q.A{constructor(C){super(C)}};V=(0,j._)([(0,de.$)("esri.rest.knowledgeGraph.ObjectValue")],V);const K=V},36303:(Pe,ie,m)=>{m.d(ie,{A:()=>C});var j=m(8189),R=m(71065),se=m(85211),q=(m(3248),m(35150),m(40707),m(76576)),V=m(53805);let K=class extends R.oY{constructor($){super($),this.path=null}};(0,j._)([(0,se.MZ)({type:[V.A],json:{write:!0}})],K.prototype,"path",void 0),K=(0,j._)([(0,q.$)("esri.rest.knowledgeGraph.Path")],K);const C=K},97870:(Pe,ie,m)=>{m.d(ie,{A:()=>$});var j=m(8189),se=(m(21152),m(85211)),q=(m(3248),m(35150),m(40707),m(76576)),V=m(14430),K=m(93615);let C=class extends V.A{constructor(Q){super(Q),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,j._)([(0,se.MZ)({type:String,json:{write:!0}})],C.prototype,"originId",void 0),(0,j._)([(0,se.MZ)({type:String,json:{write:!0}})],C.prototype,"destinationId",void 0),(0,j._)([(0,se.MZ)({type:K.A,json:{write:!0}})],C.prototype,"layoutGeometry",void 0),C=(0,j._)([(0,q.$)("esri.rest.knowledgeGraph.Relationship")],C);const $=C}}]);