"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[1570],{28250:(z,Y,_)=>{function v(f){return null!=S(f)||null!=b(f)}function w(f){return K.test(f)}function W(f){return S(f)??b(f)}function b(f){const m=new Date(f);return function L(f,m){if(Number.isNaN(f.getTime()))return!1;let y=!0;if(T&&/\d+\W*$/.test(m)){const P=m.match(/[a-zA-Z]{2,}/);if(P){let h=!1,l=0;for(;!h&&l<=P.length;)h=!R.test(P[l]),l++;y=!h}}return y}(m,f)?Number.isNaN(m.getTime())?null:m.getTime()-6e4*m.getTimezoneOffset():null}function S(f){const m=K.exec(f);if(!m?.groups)return null;const y=m.groups,P=+y.year,h=+y.month-1,l=+y.day,E=+(y.hours??"0"),F=+(y.minutes??"0"),U=+(y.seconds??"0");if(E>23||F>59||U>59)return null;const M=y.ms??"0",A=M?+M.padEnd(3,"0").substring(0,3):0;let C;return C=y.isUTC||!y.offsetSign?Date.UTC(P,h,l,E,F,U,A):6e4*("+"===y.offsetSign?-1:1)*(60*+y.offsetHours+ +y.offsetMinutes)+Date.UTC(P,h,l,E,F,U,A),Number.isNaN(C)?null:C}_.d(Y,{Br:()=>w,Cq:()=>v,_U:()=>W});const K=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,R=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,T=!Number.isNaN(new Date("technology 10").getTime())},3567:(z,Y,_)=>{_.d(Y,{w:()=>S});var v=_(89952),W=(_(3248),_(12438)),b=_(17694);class S{constructor(n=9,i){this._compareMinX=y,this._compareMinY=P,this._toBBox=r=>r,this._maxEntries=Math.max(4,n||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),C.prune(),$.prune(),u.prune(),d.prune()}all(n){L(this._data,n)}search(n,i){let r=this._data;const t=this._toBBox;if(M(n,r))for(C.clear();r;){for(let e=0,s=r.children.length;e<s;e++){const o=r.children[e],p=r.leaf?t(o):o;M(n,p)&&(r.leaf?i(o):U(n,p)?L(o,i):C.push(o))}r=C.pop()}}collides(n){let i=this._data;const r=this._toBBox;if(!M(n,i))return!1;for(C.clear();i;){for(let t=0,e=i.children.length;t<e;t++){const s=i.children[t],o=i.leaf?r(s):s;if(M(n,o)){if(i.leaf||U(n,o))return!0;C.push(s)}}i=C.pop()}return!1}load(n){if(!n.length)return this;if(n.length<this._minEntries){for(let r=0,t=n.length;r<t;r++)this.insert(n[r]);return this}let i=this._build(n.slice(0,n.length),0,n.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const r=this._data;this._data=i,i=r}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(n){return n&&this._insert(n,this._data.height-1),this}clear(){return this._data=new x([]),this}remove(n){if(!n)return this;let i,r=this._data,t=null,e=0,s=!1;const o=this._toBBox(n);for(u.clear(),d.clear();r||u.length>0;){if(r||(r=u.pop(),t=u.data[u.length-1],e=d.pop()??0,s=!0),r.leaf&&(i=(0,v.qh)(r.children,n,r.children.length,r.indexHint),-1!==i))return r.children.splice(i,1),u.push(r),this._condense(u),this;s||r.leaf||!U(r,o)?t?(e++,r=t.children[e],s=!1):r=null:(u.push(r),d.push(e),e=0,t=r,r=r.children[0])}return this}toJSON(){return this._data}fromJSON(n){return this._data=n,this}_build(n,i,r,t){const e=r-i+1;let s=this._maxEntries;if(e<=s){const O=new x(n.slice(i,r+1));return T(O,this._toBBox),O}t||(t=Math.ceil(Math.log(e)/Math.log(s)),s=Math.ceil(e/s**(t-1)));const o=new I([]);o.height=t;const p=Math.ceil(e/s),j=p*Math.ceil(Math.sqrt(s));A(n,i,r,j,this._compareMinX);for(let O=i;O<=r;O+=j){const D=Math.min(O+j-1,r);A(n,O,D,p,this._compareMinY);for(let X=O;X<=D;X+=p){const N=Math.min(X+p-1,D);o.children.push(this._build(n,X,N,t-1))}}return T(o,this._toBBox),o}_insert(n,i,r){const e=r?n:(0,this._toBBox)(n);u.clear();const s=function K(a,n,i,r){for(;r.push(n),!0!==n.leaf&&r.length-1!==i;){let t,e=1/0,s=1/0;for(let o=0,p=n.children.length;o<p;o++){const j=n.children[o],O=h(j),D=E(a,j)-O;D<s?(s=D,e=O<e?O:e,t=j):D===s&&O<e&&(e=O,t=j)}n=t||n.children[0]}return n}(e,this._data,i,u);for(s.children.push(n),m(s,e);i>=0&&u.data[i].children.length>this._maxEntries;)this._split(u,i),i--;!function R(a,n,i){for(let r=i;r>=0;r--)m(n.data[r],a)}(e,u,i)}_split(n,i){const r=n.data[i],t=r.children.length,e=this._minEntries;this._chooseSplitAxis(r,e,t);const s=this._chooseSplitIndex(r,e,t);if(!s)return;const o=r.children.splice(s,r.children.length-s),p=r.leaf?new x(o):new I(o);p.height=r.height,T(r,this._toBBox),T(p,this._toBBox),i?n.data[i-1].children.push(p):this._splitRoot(r,p)}_splitRoot(n,i){this._data=new I([n,i]),this._data.height=n.height+1,T(this._data,this._toBBox)}_chooseSplitIndex(n,i,r){let t,e,s;t=e=1/0;for(let o=i;o<=r-i;o++){const p=f(n,0,o,this._toBBox),j=f(n,o,r,this._toBBox),O=F(p,j),D=h(p)+h(j);O<t?(t=O,s=o,e=D<e?D:e):O===t&&D<e&&(e=D,s=o)}return s}_chooseSplitAxis(n,i,r){const t=n.leaf?this._compareMinX:y,e=n.leaf?this._compareMinY:P;this._allDistMargin(n,i,r,t)<this._allDistMargin(n,i,r,e)&&n.children.sort(t)}_allDistMargin(n,i,r,t){n.children.sort(t);const e=this._toBBox,s=f(n,0,i,e),o=f(n,r-i,r,e);let p=l(s)+l(o);for(let j=i;j<r-i;j++){const O=n.children[j];m(s,n.leaf?e(O):O),p+=l(s)}for(let j=r-i-1;j>=i;j--){const O=n.children[j];m(o,n.leaf?e(O):O),p+=l(o)}return p}_condense(n){for(let i=n.length-1;i>=0;i--){const r=n.data[i];if(0===r.children.length)if(i>0){const t=n.data[i-1],e=t.children;e.splice((0,v.qh)(e,r,e.length,t.indexHint),1)}else this.clear();else T(r,this._toBBox)}}_initFormat(n){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(n[0])),this._compareMinY=new Function("a","b",i.join(n[1])),this._toBBox=new Function("a","return {minX: a"+n[0]+", minY: a"+n[1]+", maxX: a"+n[2]+", maxY: a"+n[3]+"};")}}function L(a,n){let i=a;for($.clear();i;){if(!0===i.leaf)for(const r of i.children)n(r);else $.pushArray(i.children);i=$.pop()??null}}function T(a,n){f(a,0,a.children.length,n,a)}function f(a,n,i,r,t){t||(t=new x([])),t.minX=1/0,t.minY=1/0,t.maxX=-1/0,t.maxY=-1/0;for(let e,s=n;s<i;s++)e=a.children[s],m(t,a.leaf?r(e):e);return t}function m(a,n){a.minX=Math.min(a.minX,n.minX),a.minY=Math.min(a.minY,n.minY),a.maxX=Math.max(a.maxX,n.maxX),a.maxY=Math.max(a.maxY,n.maxY)}function y(a,n){return a.minX-n.minX}function P(a,n){return a.minY-n.minY}function h(a){return(a.maxX-a.minX)*(a.maxY-a.minY)}function l(a){return a.maxX-a.minX+(a.maxY-a.minY)}function E(a,n){return(Math.max(n.maxX,a.maxX)-Math.min(n.minX,a.minX))*(Math.max(n.maxY,a.maxY)-Math.min(n.minY,a.minY))}function F(a,n){const i=Math.max(a.minX,n.minX),r=Math.max(a.minY,n.minY),t=Math.min(a.maxX,n.maxX),e=Math.min(a.maxY,n.maxY);return Math.max(0,t-i)*Math.max(0,e-r)}function U(a,n){return a.minX<=n.minX&&a.minY<=n.minY&&n.maxX<=a.maxX&&n.maxY<=a.maxY}function M(a,n){return n.minX<=a.maxX&&n.minY<=a.maxY&&n.maxX>=a.minX&&n.maxY>=a.minY}function A(a,n,i,r,t){const e=[n,i];for(;e.length;){const s=e.pop(),o=e.pop();if(s-o<=r)continue;const p=o+Math.ceil((s-o)/r/2)*r;(0,b.q)(a,p,o,s,t),e.push(o,p,p,s)}}const C=new W.A,$=new W.A,u=new W.A,d=new W.A({deallocator:void 0});class c{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class g extends c{constructor(){super(...arguments),this.height=1,this.indexHint=new v.vW}}class x extends g{constructor(n){super(),this.children=n,this.leaf=!0}}class I extends g{constructor(n){super(),this.children=n,this.leaf=!1}}},59894:(z,Y,_)=>{_.d(Y,{F:()=>R});var v=_(3248),w=_(3567),W=_(51995);const S={minX:0,minY:0,maxX:0,maxY:0};class R{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new w.w(9,(0,v.A)("esri-csp-restrictions")?f=>({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const f=new Array(this._idByBounds.size);let m=0;this._idByBounds.forEach((y,P)=>{f[m++]=P}),this._indexInvalid=!1,this._index.clear(),this._index.load(f)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(f=>this._idByBounds.has(f))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const f=(0,W.Ie)();for(const m of this._boundsById.values())m&&(f[0]=Math.min(m[0],f[0]),f[1]=Math.min(m[1],f[1]),f[2]=Math.max(m[2],f[2]),f[3]=Math.max(m[3],f[3]));return f}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(f){const m=this._boundsById.get(f);this._boundsById.delete(f),m&&(this._idByBounds.delete(m),this._indexInvalid||this._index.remove(m))}forEachInBounds(f,m){this._loadIndex(),function L(T,f,m){(function K(T){S.minX=T[0],S.minY=T[1],S.maxX=T[2],S.maxY=T[3]})(f),T.search(S,m)}(this._index,f,y=>m(this._idByBounds.get(y)))}get(f){return this._boundsById.get(f)}has(f){return this._boundsById.has(f)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(f,m){if(!this._indexInvalid){const y=this._boundsById.get(f);y&&(this._index.remove(y),this._idByBounds.delete(y))}this._boundsById.set(f,m),m&&(this._idByBounds.set(m,f),this._indexInvalid||(this._boundsToLoad.push(m),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},64373:(z,Y,_)=>{_.d(Y,{A:()=>y});var v=_(89952),w=_(5922),W=_(42425),b=_(35150),S=_(2296),K=_(51995),L=_(31732),R=_(59894),T=_(95985),f=_(50690);const m=(0,S.vt)();class y{constructor(h){this.geometryInfo=h,this._boundsStore=new R.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new W.A,this.featureAdapter=f.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let h=0;return this._featuresById.forEach(l=>{null!=l.geometry&&l.geometry.coords&&(h+=l.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:h/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(h){if(null==this.fullBounds)return null;const[l,E,F,U]=this.fullBounds;return{xmin:l,ymin:E,xmax:F,ymax:U,spatialReference:(0,T.ag)(h)}}add(h){this._add(h),this._emitChanged()}addMany(h){for(const l of h)this._add(l);this._emitChanged()}upsertMany(h){const l=h.map(E=>this._upsert(E));return this._emitChanged(),l.filter(v.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(h){const l=this._featuresById.get(h);return l?(this._remove(l),this._emitChanged(),l):null}removeManyById(h){this._boundsStore.invalidateIndex();for(const l of h){const E=this._featuresById.get(l);E&&this._remove(E)}this._emitChanged()}forEachBounds(h,l){for(const E of h){const F=this._boundsStore.get(E.objectId);F&&l((0,S.Jt)(m,F))}}getFeature(h){return this._featuresById.get(h)}has(h){return this._featuresById.has(h)}forEach(h){this._featuresById.forEach(l=>h(l))}forEachInBounds(h,l){this._boundsStore.forEachInBounds(h,E=>{l(this._featuresById.get(E))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let h=!1;this._featuresById.forEach((l,E)=>{this._markedIds.has(E)||(h=!0,this._remove(l))}),this._markedIds.clear(),h&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(h){if(!h)return;const l=h.objectId;if(null==l)return void b.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new w.A("featurestore:invalid-feature","feature id is missing",{feature:h}));const E=this._featuresById.get(l);let F;if(this._markedIds.add(l),E?(h.displayId=E.displayId,F=this._boundsStore.get(l),this._boundsStore.delete(l)):null!=this.onFeatureAdd&&this.onFeatureAdd(h),!h.geometry?.coords?.length)return this._boundsStore.set(l,null),void this._featuresById.set(l,h);F=(0,L.jQ)(F??(0,K.vt)(),h.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=F&&this._boundsStore.set(l,F),this._featuresById.set(l,h)}_upsert(h){const l=h?.objectId;if(null==l)return b.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new w.A("featurestore:invalid-feature","feature id is missing",{feature:h})),null;const E=this._featuresById.get(l);if(!E)return this._add(h),h;this._markedIds.add(l);const{geometry:F,attributes:U}=h;for(const M in U)E.attributes[M]=U[M];return F&&(E.geometry=F,this._boundsStore.set(l,(0,L.jQ)((0,K.vt)(),F,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),E}_remove(h){null!=this.onFeatureRemove&&this.onFeatureRemove(h);const l=h.objectId;return this._markedIds.delete(l),this._boundsStore.delete(l),this._featuresById.delete(l),h}}},81570:(z,Y,_)=>{_.r(Y),_.d(Y,{default:()=>C});var v=_(10467),w=_(89563),W=_(89447),b=_(5922),S=_(35150),K=_(56492),L=_(61320),R=_(58701),T=_(31732),f=_(64373),m=_(88840),y=_(33594),P=_(36761),h=_(89962),l=_(51248),E=_(73258),F=_(38965),U=_(86300),M=_(22639);const A={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};class C{constructor(){var u=this;this._queryEngine=null,this._snapshotFeatures=function(){var d=(0,v.A)(function*(c){const g=yield u._fetch(c);return u._createFeatures(g)});return function(c){return d.apply(this,arguments)}}()}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._createDefaultAttributes=null}load(u,d={}){var c=this;return(0,v.A)(function*(){c._loadOptions={url:u.url,customParameters:u.customParameters};const g=[],[x]=yield Promise.all([u.url?c._fetch(d?.signal):null,c._checkProjection(u.spatialReference)]),I=(0,P.BM)(x,{geometryType:u.geometryType}),a=u.fields||I.fields||[],n=null!=u.hasZ?u.hasZ:I.hasZ,i=I.geometryType;let r=u.objectIdField||I.objectIdFieldName||"__OBJECTID";const t=u.spatialReference||R.KK;let e=u.timeInfo;a===I.fields&&I.unknownFields.length>0&&g.push({name:"geojson-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:I.unknownFields}});const s=new E.A(a);let o=s.get(r);o?("esriFieldTypeString"!==o.type&&(o.type="esriFieldTypeOID"),o.editable=!1,o.nullable=!1,r=o.name):(o={alias:r,name:r,type:"string"===I.objectIdFieldType?"esriFieldTypeString":"esriFieldTypeOID",editable:!1,nullable:!1},a.unshift(o));const p={};for(const B of a){if(null==B.name&&(B.name=B.alias),null==B.alias&&(B.alias=B.name),!B.name)throw new b.A("geojson-layer:invalid-field-name","field name is missing",{field:B});if(!F.m.jsonValues.includes(B.type))throw new b.A("geojson-layer:invalid-field-type",`invalid type for field "${B.name}"`,{field:B});if(B.name!==o.name){const G=(0,U.lD)(B);void 0!==G&&(p[B.name]=G)}null==B.length&&(B.length=(0,U._b)(B))}if(e){if(e.startTimeField){const B=s.get(e.startTimeField);B?(e.startTimeField=B.name,B.type="esriFieldTypeDate"):e.startTimeField=null}if(e.endTimeField){const B=s.get(e.endTimeField);B?(e.endTimeField=B.name,B.type="esriFieldTypeDate"):e.endTimeField=null}if(e.trackIdField){const B=s.get(e.trackIdField);B?e.trackIdField=B.name:(e.trackIdField=null,g.push({name:"geojson-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:e}}))}e.startTimeField||e.endTimeField||(g.push({name:"geojson-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:e}}),e=null)}const j=i?(0,h.F0)(i):void 0,O=s.dateFields.length?{timeZoneIANA:M.n$}:null,D={warnings:g,featureErrors:[],layerDefinition:{...A,drawingInfo:j??void 0,templates:(0,h.e2)(p),extent:void 0,geometryType:i,objectIdField:r,fields:a,hasZ:!!n,timeInfo:e,dateFieldsTimeReference:O}};c._queryEngine=new y.d({fieldsIndex:E.A.fromLayerJSON({fields:a,timeInfo:e,dateFieldsTimeReference:O}),geometryType:i,hasM:!1,hasZ:n,objectIdField:r,spatialReference:t,timeInfo:e,featureStore:new f.A({geometryType:i,hasM:!1,hasZ:n}),cacheSpatialQueries:!0});const X=c._queryEngine.fieldsIndex.requiredFields.indexOf(o);X>-1&&c._queryEngine.fieldsIndex.requiredFields.splice(X,1),c._createDefaultAttributes=(0,h.Vx)(p,r);const N=yield c._createFeatures(x);c._objectIdGenerator=c._createObjectIdGenerator(c._queryEngine,N);const k=c._normalizeFeatures(N,D.featureErrors);c._queryEngine.featureStore.addMany(k);const{fullExtent:V,timeExtent:Q}=yield c._queryEngine.fetchRecomputedExtents();if(D.layerDefinition.extent=V,Q){const{start:B,end:G}=Q;D.layerDefinition.timeInfo.timeExtent=[B,G]}return D})()}applyEdits(u){var d=this;return(0,v.A)(function*(){const{spatialReference:c,geometryType:g}=d._queryEngine;return yield Promise.all([(0,l.$1)(c,g),(0,m.Nk)(u.adds,c),(0,m.Nk)(u.updates,c)]),yield d._waitSnapshotComplete(),d._applyEdits(u)})()}queryFeatures(u={},d={}){var c=this;return(0,v.A)(function*(){return yield c._waitSnapshotComplete(),c._queryEngine.executeQuery(u,d.signal)})()}queryFeatureCount(u={},d={}){var c=this;return(0,v.A)(function*(){return yield c._waitSnapshotComplete(),c._queryEngine.executeQueryForCount(u,d.signal)})()}queryObjectIds(u={},d={}){var c=this;return(0,v.A)(function*(){return yield c._waitSnapshotComplete(),c._queryEngine.executeQueryForIds(u,d.signal)})()}queryExtent(u={},d={}){var c=this;return(0,v.A)(function*(){return yield c._waitSnapshotComplete(),c._queryEngine.executeQueryForExtent(u,d.signal)})()}querySnapping(u,d={}){var c=this;return(0,v.A)(function*(){return yield c._waitSnapshotComplete(),c._queryEngine.executeQueryForSnapping(u,d.signal)})()}refresh(u){var d=this;return(0,v.A)(function*(){d._loadOptions.customParameters=u,d._snapshotTask?.abort(),d._snapshotTask=(0,W.UT)(d._snapshotFeatures),d._snapshotTask.promise.then(x=>{d._queryEngine.featureStore.clear(),d._objectIdGenerator=d._createObjectIdGenerator(d._queryEngine,x);const I=d._normalizeFeatures(x);I&&d._queryEngine.featureStore.addMany(I)},x=>{d._queryEngine.featureStore.clear(),(0,K.zf)(x)||S.A.getLogger("esri.layers.GeoJSONLayer").error(new b.A("geojson-layer:refresh","An error occurred during refresh",{error:x}))}),yield d._waitSnapshotComplete();const{fullExtent:c,timeExtent:g}=yield d._queryEngine.fetchRecomputedExtents();return{extent:c,timeExtent:g}})()}_createFeatures(u){var d=this;return(0,v.A)(function*(){if(null==u)return[];const{geometryType:c,hasZ:g,objectIdField:x}=d._queryEngine,I=(0,P.bd)(u,{geometryType:c,hasZ:g,objectIdField:x});if(!(0,R.aI)(d._queryEngine.spatialReference,R.KK))for(const a of I)null!=a.geometry&&(a.geometry=(0,T.Ux)((0,m.Cv)((0,T.zv)(a.geometry,d._queryEngine.geometryType,d._queryEngine.hasZ,!1),R.KK,d._queryEngine.spatialReference)));return I})()}_waitSnapshotComplete(){var u=this;return(0,v.A)(function*(){if(u._snapshotTask&&!u._snapshotTask.finished){try{yield u._snapshotTask.promise}catch{}return u._waitSnapshotComplete()}})()}_fetch(u){var d=this;return(0,v.A)(function*(){const{url:c,customParameters:g}=d._loadOptions,x=(yield(0,w.A)(c??"",{responseType:"json",query:{...g},signal:u})).data;return(0,P.sO)(x),x})()}_normalizeFeatures(u,d){const{objectIdField:c,fieldsIndex:g}=this._queryEngine,x=[];for(const I of u){const a=this._createDefaultAttributes(),n=(0,l.MB)(g,a,I.attributes,!0);n?d?.push(n):(this._assignObjectId(a,I.attributes,!0),I.attributes=a,I.objectId=a[c],x.push(I))}return x}_applyEdits(u){var d=this;return(0,v.A)(function*(){const{adds:c,updates:g,deletes:x}=u,I={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(c?.length&&d._applyAddEdits(I,c),g?.length&&d._applyUpdateEdits(I,g),x?.length){for(const i of x)I.deleteResults.push((0,l.bP)(i));d._queryEngine.featureStore.removeManyById(x)}const{fullExtent:a,timeExtent:n}=yield d._queryEngine.fetchRecomputedExtents();return{extent:a,timeExtent:n,featureEditResults:I}})()}_applyAddEdits(u,d){const{addResults:c}=u,{geometryType:g,hasM:x,hasZ:I,objectIdField:a,spatialReference:n,featureStore:i,fieldsIndex:r}=this._queryEngine,t=[];for(const e of d){if(e.geometry&&g!==(0,L.$B)(e.geometry)){c.push((0,l.Yx)("Incorrect geometry type."));continue}const s=this._createDefaultAttributes(),o=(0,l.MB)(r,s,e.attributes);if(o)c.push(o);else{if(this._assignObjectId(s,e.attributes),e.attributes=s,null!=e.uid&&(u.uidToObjectId[e.uid]=e.attributes[a]),null!=e.geometry){const p=e.geometry.spatialReference??n;e.geometry=(0,m.Cv)((0,l.CR)(e.geometry,p),p,n)}t.push(e),c.push((0,l.bP)(e.attributes[a]))}}i.addMany((0,T.Di)([],t,g,I,x,a))}_applyUpdateEdits({updateResults:u},d){const{geometryType:c,hasM:g,hasZ:x,objectIdField:I,spatialReference:a,featureStore:n,fieldsIndex:i}=this._queryEngine;for(const r of d){const{attributes:t,geometry:e}=r,s=t?.[I];if(null==s){u.push((0,l.Yx)(`Identifier field ${I} missing`));continue}if(!n.has(s)){u.push((0,l.Yx)(`Feature with object id ${s} missing`));continue}const o=(0,T.oN)(n.getFeature(s),c,x,g);if(null!=e){if(c!==(0,L.$B)(e)){u.push((0,l.Yx)("Incorrect geometry type."));continue}const p=e.spatialReference??a;o.geometry=(0,m.Cv)((0,l.CR)(e,p),p,a)}if(t){const p=(0,l.MB)(i,o.attributes,t);if(p){u.push(p);continue}}n.add((0,T.E2)(o,c,x,g,I)),u.push((0,l.bP)(s))}}_createObjectIdGenerator(u,d){const c=u.fieldsIndex.get(u.objectIdField);if("esriFieldTypeString"===c.type)return()=>c.name+"-"+Date.now().toString(16);let g=Number.NEGATIVE_INFINITY;for(const x of d)x.objectId&&(g=Math.max(g,x.objectId));return g=Math.max(0,g)+1,()=>g++}_assignObjectId(u,d,c=!1){const g=this._queryEngine.objectIdField;u[g]=c&&g in d?d[g]:this._objectIdGenerator()}_checkProjection(u){return(0,v.A)(function*(){try{yield(0,m.Nk)(R.KK,u)}catch{throw new b.A("geojson-layer","Projection not supported")}})()}}},36761:(z,Y,_)=>{_.d(Y,{BM:()=>i,bd:()=>r,sO:()=>n,xD:()=>R});var v=_(28250),w=_(5922),W=_(58701),b=_(42086),S=_(13682),K=_(86300);const L={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function R(t){return L[t]}function*T(t){switch(t.type){case"Feature":yield t;break;case"FeatureCollection":for(const e of t.features)e&&(yield e)}}function*f(t){if(t)switch(t.type){case"Point":yield t.coordinates;break;case"LineString":case"MultiPoint":yield*t.coordinates;break;case"MultiLineString":case"Polygon":for(const e of t.coordinates)yield*e;break;case"MultiPolygon":for(const e of t.coordinates)for(const s of e)yield*s}}function y(t){for(const e of t)if(e.length>2)return!0;return!1}function l(t){let e=0;for(let s=0;s<t.length;s++){const o=t[s],p=t[(s+1)%t.length];e+=o[0]*p[1]-p[0]*o[1]}return e<=0}function E(t){const e=t[0],s=t[t.length-1];return e[0]===s[0]&&e[1]===s[1]&&e[2]===s[2]||t.push(e),t}function F(t,e,s){switch(e.type){case"LineString":return function U(t,e,s){return g(t,e.coordinates,s),t}(t,e,s);case"MultiLineString":return function M(t,e,s){for(const o of e.coordinates)g(t,o,s);return t}(t,e,s);case"MultiPoint":return function A(t,e,s){return g(t,e.coordinates,s),t}(t,e,s);case"MultiPolygon":return function C(t,e,s){for(const o of e.coordinates){d(t,o[0],s);for(let p=1;p<o.length;p++)c(t,o[p],s)}return t}(t,e,s);case"Point":return function $(t,e,s){return I(t,e.coordinates,s),t}(t,e,s);case"Polygon":return function u(t,e,s){const o=e.coordinates;d(t,o[0],s);for(let p=1;p<o.length;p++)c(t,o[p],s);return t}(t,e,s)}}function d(t,e,s){const o=E(e);!function P(t){return!l(t)}(o)?g(t,o,s):x(t,o,s)}function c(t,e,s){const o=E(e);!function h(t){return l(t)}(o)?g(t,o,s):x(t,o,s)}function g(t,e,s){for(const o of e)I(t,o,s);t.lengths.push(e.length)}function x(t,e,s){for(let o=e.length-1;o>=0;o--)I(t,e[o],s);t.lengths.push(e.length)}function I(t,e,s){const[o,p,j]=e;t.coords.push(o,p),s.hasZ&&t.coords.push(j||0)}function a(t){switch(typeof t){case"string":return(0,v.Br)(t)?"esriFieldTypeDate":"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function n(t,e=4326){if(!t)throw new w.A("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==t.type&&"FeatureCollection"!==t.type)throw new w.A("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:t});const{crs:s}=t;if(!s)return;const o="string"==typeof s?s:"name"===s.type?s.properties.name:"EPSG"===s.type?s.properties.code:null,p=(0,W.oT)({wkid:e})?new RegExp(".*(CRS84H?|4326)$","i"):new RegExp(`.*(${e})$`,"i");if(!o||!p.test(o))throw new w.A("geojson:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:s})}function i(t,e={}){const s=[],o=new Set,p=new Set;let j,O=!1,D=null,X=!1,{geometryType:N=null}=e,k=!1;for(const Q of T(t)){const{geometry:B,properties:G,id:J}=Q;if((!B||(N||(N=R(B.type)),R(B.type)===N))&&(O||(O=y(f(B))),X||(X=null!=J,X&&(j=typeof J,G&&(D=Object.keys(G).filter(H=>G[H]===J)))),G&&D&&X&&null!=J&&(D.length>1?D=D.filter(H=>G[H]===J):1===D.length&&(D=G[D[0]]===J?D:[])),!k&&G)){let H=!0;for(const Z in G){if(o.has(Z))continue;const q=G[Z];if(null==q){H=!1,p.add(Z);continue}const ee=a(q);if("unknown"===ee){p.add(Z);continue}p.delete(Z),o.add(Z);const te=(0,K.rS)(Z);te&&s.push({name:te,alias:Z,type:ee})}k=H}}const V=(0,K.rS)(1===D?.length&&D[0]||null)??void 0;if(V)for(const Q of s)if(Q.name===V&&(0,K.WA)(Q)){Q.type="esriFieldTypeOID";break}return{fields:s,geometryType:N,hasZ:O,objectIdFieldName:V,objectIdFieldType:j,unknownFields:Array.from(p)}}function r(t,e){return Array.from(function*m(t,e={}){const{geometryType:s,objectIdField:o}=e;for(const p of t){const{geometry:j,properties:O,id:D}=p;if(j&&R(j.type)!==s)continue;const X=O||{};let N;o&&(N=X[o],null==D||N||(X[o]=N=D)),yield new b.Om(j?F(new S.A,j,e):null,X,null,N??void 0)}}(T(t),e))}},89962:(z,Y,_)=>{_.d(Y,{F0:()=>S,Vx:()=>R,e2:()=>f,f:()=>m});var v=_(3248),w=_(77806),W=_(78200),b=_(48254);function S(y){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===y||"esriGeometryMultipoint"===y?b.Cb:"esriGeometryPolyline"===y?b.yM:b.WR}}}const K=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let L=1;function R(y,P){if((0,v.A)("esri-csp-restrictions"))return()=>({[P]:null,...y});try{let h=`this${T(P)} = null;`;for(const E in y)h+=`this${T(E)} = ${JSON.stringify(y[E])};`;const l=new Function(`\n      return class AttributesClass$${L++} {\n        constructor() {\n          ${h};\n        }\n      }\n    `)();return()=>new l}catch{return()=>({[P]:null,...y})}}function T(y){return K.test(y)?`.${y}`:`["${y}"]`}function f(y={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,w.o8)(y)}}]}function m(y,P){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:y},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:P,supportsDelete:P,supportsEditing:P,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:P,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:W.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:P,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},51248:(z,Y,_)=>{_.d(Y,{$1:()=>F,CR:()=>h,MB:()=>m,Yx:()=>L,bP:()=>T});var v=_(10467),w=_(28250),W=_(58701),b=_(86300);class S{constructor(){this.code=null,this.description=null}}class K{constructor(A){this.error=new S,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=A}}function L(M){return new K(M)}class R{constructor(A){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=A}}function T(M){return new R(M)}const f=new Set;function m(M,A,C,$=!1){f.clear();for(const u in C){const d=M.get(u);if(!d)continue;const c=y(d,C[u]);if(f.add(d.name),d&&($||d.editable)){const g=(0,b.CJ)(d,c);if(g)return L((0,b.uo)(g,d,c));A[d.name]=c}}for(const u of M?.requiredFields??[])if(!f.has(u.name))return L(`missing required field "${u.name}"`);return null}function y(M,A){let C=A;return(0,b.WA)(M)&&"string"==typeof A?C=parseFloat(A):(0,b.yM)(M)&&null!=A&&"string"!=typeof A?C=String(A):(0,b.vE)(M)&&"string"==typeof A&&(C=(0,w._U)(A)),(0,b.WX)(C)}let P;function h(M,A){if(!M||!(0,W.fn)(A))return M;if("rings"in M||"paths"in M){if(null==P)throw new TypeError("geometry engine not loaded");return P.simplify(A,M)}return M}function E(){return(E=(0,v.A)(function*(){return null==P&&(P=yield Promise.all([_.e(3930),_.e(2076),_.e(2296)]).then(_.bind(_,27815))),P})).apply(this,arguments)}function F(M,A){return U.apply(this,arguments)}function U(){return U=(0,v.A)(function*(M,A){!(0,W.fn)(M)||"esriGeometryPolygon"!==A&&"esriGeometryPolyline"!==A||(yield function l(){return E.apply(this,arguments)}())}),U.apply(this,arguments)}}}]);