"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[9757,3014],{40856:(de,W,u)=>{u.d(W,{X_:()=>K,i1:()=>P,zx:()=>I});var R=u(69287),l=u(82663);const L=96;function K(v,y){const w=y||v.extent,p=v.width,$=(0,l.GA)(w?.spatialReference);return w&&p?w.width/p*$*l.dy*L:0}function P(v,y){return v/((0,l.GA)(y)*l.dy*L)}function I(v,y,w){return function N(v,y){return 0===y||(0,R.Sp)(v,y)||v<y}(v,y)&&function O(v,y){return 0===y||(0,R.Sp)(v,y)||v>y}(v,w)}},52138:(de,W,u)=>{u.r(W),u.d(W,{default:()=>pt});var q,R=u(10467),l=u(8189),L=u(23098),K=u(81098),P=u(92165),D=u(89563),U=u(31178),Z=u(2993),I=u(49976),N=u(77806),O=u(39693),v=u(56492),y=u(48900),w=u(45272),p=u(85211),$=u(55739),V=u(17221),ce=u(76576),te=u(50305),Be=u(56558),G=u(28067),T=u(32034),me=u(40856),We=u(58701),De=u(95478),$e=u(93410),Ve=u(17049),Ge=u(85551),He=u(1151),Xe=u(33036),Ke=u(84311),re=u(32282),Je=u(68438),fe=u(22329),ye=u(2277),ze=u(63014),Qe=u(3046),Ye=u(48669);u(40707),u(3248);let qe=0,b=q=class extends((0,Qe.sA)(O.L)){constructor(t){super(t),this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.legendUrl=null,this.legendEnabled=!0,this.layer=null,this.maxScale=0,this.minScale=0,this.name=null,this.parent=null,this.popupEnabled=!1,this.queryable=!1,this.sublayers=null,this.spatialReferences=null,this.title=null,this.addHandles([(0,y.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=this,r.layer=this.layer},y.OH),(0,y.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},y.OH),(0,y.wB)(()=>this.sublayers,(r,s)=>{if(s)for(const i of s)i.layer=i.parent=null;if(r)for(const i of r)i.parent=this,i.layer=this.layer},y.OH),(0,y.wB)(()=>this.layer,r=>{if(this.sublayers)for(const s of this.sublayers)s.layer=r},y.OH)])}get id(){return this._get("id")??qe++}set id(t){this._set("id",t)}readLegendUrl(t,r){return r.legendUrl??r.legendURL??null}get effectiveScaleRange(){const{minScale:t,maxScale:r}=this;return{minScale:t,maxScale:r}}castSublayers(t){return(0,$.dp)(U.A.ofType(q),t)}set visible(t){this._setAndNotifyLayer("visible",t)}clone(){const t=new q;return this.hasOwnProperty("description")&&(t.description=this.description),this.hasOwnProperty("fullExtent")&&(t.fullExtent=this.fullExtent.clone()),this.hasOwnProperty("fullExtents")&&(t.fullExtents=this.fullExtents?.map(r=>r.clone())??null),this.hasOwnProperty("legendUrl")&&(t.legendUrl=this.legendUrl),this.hasOwnProperty("legendEnabled")&&(t.legendEnabled=this.legendEnabled),this.hasOwnProperty("layer")&&(t.layer=this.layer),this.hasOwnProperty("name")&&(t.name=this.name),this.hasOwnProperty("parent")&&(t.parent=this.parent),this.hasOwnProperty("queryable")&&(t.queryable=this.queryable),this.hasOwnProperty("sublayers")&&(t.sublayers=this.sublayers?.map(r=>r.clone())),this.hasOwnProperty("spatialReferences")&&(t.spatialReferences=this.spatialReferences?.map(r=>r)),this.hasOwnProperty("visible")&&(t.visible=this.visible),this.hasOwnProperty("title")&&(t.title=this.title),t}_setAndNotifyLayer(t,r){const s=this.layer;this._get(t)!==r&&(this._set(t,r),s&&s.emit("wms-sublayer-update",{propertyName:t,id:this.id}))}};(0,l._)([(0,p.MZ)()],b.prototype,"description",void 0),(0,l._)([(0,p.MZ)({readOnly:!0})],b.prototype,"dimensions",void 0),(0,l._)([(0,p.MZ)({type:G.A,json:{name:"extent"}})],b.prototype,"fullExtent",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"fullExtents",void 0),(0,l._)([(0,p.MZ)({type:Number,json:{write:{enabled:!1,overridePolicy:()=>({ignoreOrigin:!0,enabled:!0})}}})],b.prototype,"id",null),(0,l._)([(0,p.MZ)({type:String,json:{name:"legendUrl",write:{ignoreOrigin:!0}}})],b.prototype,"legendUrl",void 0),(0,l._)([(0,V.w)("legendUrl",["legendUrl","legendURL"])],b.prototype,"readLegendUrl",null),(0,l._)([(0,p.MZ)({type:Boolean,json:{name:"showLegend",origins:{"web-map":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],b.prototype,"legendEnabled",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"layer",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"maxScale",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"minScale",void 0),(0,l._)([(0,p.MZ)({readOnly:!0})],b.prototype,"effectiveScaleRange",null),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],b.prototype,"name",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"parent",void 0),(0,l._)([(0,p.MZ)({type:Boolean,json:{read:{source:"showPopup"},write:{ignoreOrigin:!0,target:"showPopup"}}})],b.prototype,"popupEnabled",void 0),(0,l._)([(0,p.MZ)({type:Boolean,json:{write:{ignoreOrigin:!0}}})],b.prototype,"queryable",void 0),(0,l._)([(0,p.MZ)()],b.prototype,"sublayers",void 0),(0,l._)([(0,Ye.w)("sublayers")],b.prototype,"castSublayers",null),(0,l._)([(0,p.MZ)({type:[Number],json:{read:{source:"spatialReferences"}}})],b.prototype,"spatialReferences",void 0),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],b.prototype,"title",void 0),(0,l._)([(0,p.MZ)({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"}}})],b.prototype,"visible",null),b=q=(0,l._)([(0,ce.$)("esri.layers.support.WMSSublayer")],b);const ne=b;var J=u(89952),ke=u(5922);const he={84:4326,83:4269,27:4267};function _e(t){if(!t)return null;const r={idCounter:-1};"string"==typeof t&&(t=(new DOMParser).parseFromString(t,"text/xml"));const s=t.documentElement;if("ServiceExceptionReport"===s.nodeName){const E=Array.prototype.slice.call(s.childNodes).map(Y=>Y.textContent).join("\r\n");throw new ke.A("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",E)}const i=S("Capability",s),a=S("Service",s),d=i&&S("Request",i);if(!i||!a||!d)return null;const o=S("Layer",i);if(!o)return null;const h="WMS_Capabilities"===s.nodeName||"WMT_MS_Capabilities"===s.nodeName?s.getAttribute("version"):"1.3.0",c=F("Title",a,"")||F("Name",a,""),m=F("AccessConstraints",a,""),g=/^none$/i.test(m)?"":m,x=F("Abstract",a,""),A=parseInt(F("MaxWidth",a,"5000"),10),j=parseInt(F("MaxHeight",a,"5000"),10),C=be(d,"GetMap"),B=xe(d,"GetMap"),M=Q(o,h,r);if(!M)return null;let Pe,oe=0;const dt=Array.prototype.slice.call(i.childNodes),ct=M.sublayers??[],le=E=>{null!=E&&ct.push(E)};dt.forEach(E=>{"Layer"===E.nodeName&&(0===oe?Pe=E:(1===oe&&M.name&&(M.name="",le(Q(Pe,h,r))),le(Q(E,h,r))),oe++)});let X=M.sublayers,ue=M.extent;const mt=M.fullExtents??[];if(X||(X=[]),0===X.length&&X.push(M),!ue){const E=new G.A(X[0].extent);M.extent=E.toJSON(),ue=M.extent}const ft=M.spatialReferences.length>0?M.spatialReferences:ge(M),Ue=xe(d,"GetFeatureInfo"),yt=Ue?be(d,"GetFeatureInfo"):null,Ze=ve(X),ht=M.minScale||0,gt=M.maxScale||0,Te=M.dimensions??[],vt=Ze.reduce((E,Y)=>E.concat(Y.dimensions??[]),[]),je=Te.concat(vt).filter(se);let Ce=null;if(je.length){const E=je.map(Y=>{const{extent:pe}=Y;return function rt(t){return Array.isArray(t)&&t.length>0&&t[0]instanceof Date}(pe)?pe.map(ee=>ee.getTime()):pe?.map(ee=>[ee.min.getTime(),ee.max.getTime()])}).flat(2).filter(J.Ru);Ce={startTimeField:null,endTimeField:null,trackIdField:void 0,timeExtent:[Math.min(...E),Math.max(...E)]}}return{copyright:g,description:x,dimensions:Te,extent:ue,fullExtents:mt,featureInfoFormats:yt,featureInfoUrl:Ue,mapUrl:B,maxWidth:A,maxHeight:j,maxScale:gt,minScale:ht,layers:Ze,spatialReferences:ft,supportedImageFormatTypes:C,timeInfo:Ce,title:c,version:h}}function ge(t){if(t.spatialReferences.length>0)return t.spatialReferences;if(t.sublayers)for(const r of t.sublayers){const s=ge(r);if(s.length>0)return s}return[]}function ve(t){let r=[];for(const s of t)r.push(s),s.sublayers?.length&&(r=r.concat(ve(s.sublayers)),delete s.sublayers);return r}function k(t,r,s){return r.getAttribute(t)??s}function S(t,r){for(let s=0;s<r.childNodes.length;s++){const i=r.childNodes[s];if(Me(i)&&i.nodeName===t)return i}return null}function _(t,r){if(null==r)return[];const s=[];for(let i=0;i<r.childNodes.length;i++){const a=r.childNodes[i];Me(a)&&a.nodeName===t&&s.push(a)}return s}function F(t,r,s){return S(t,r)?.textContent??s}function z(t,r,s){if(!t)return null;const i=parseFloat(t.getAttribute("minx")),a=parseFloat(t.getAttribute("miny")),d=parseFloat(t.getAttribute("maxx")),o=parseFloat(t.getAttribute("maxy"));let h,c,m,g;s?(h=isNaN(a)?-Number.MAX_VALUE:a,c=isNaN(i)?-Number.MAX_VALUE:i,m=isNaN(o)?Number.MAX_VALUE:o,g=isNaN(d)?Number.MAX_VALUE:d):(h=isNaN(i)?-Number.MAX_VALUE:i,c=isNaN(a)?-Number.MAX_VALUE:a,m=isNaN(d)?Number.MAX_VALUE:d,g=isNaN(o)?Number.MAX_VALUE:o);const x=new T.A({wkid:r});return new G.A({xmin:h,ymin:c,xmax:m,ymax:g,spatialReference:x})}function xe(t,r){const s=S(r,t);if(s){const i=S("DCPType",s);if(i){const a=S("HTTP",i);if(a){const d=S("Get",a);if(d){let o=function tt(t,r,s,i){const a=S(t,s);return a?k(r,a,i):i}("OnlineResource","xlink:href",d,null);if(o)return o.indexOf("&")===o.length-1&&(o=o.substring(0,o.length-1)),function nt(t,r){const s=[],i=(0,w.An)(t);for(const a in i.query)i.query.hasOwnProperty(a)&&(r.includes(a.toLowerCase())||s.push(a+"="+i.query[a]));return i.path+(s.length?"?"+s.join("&"):"")}(o,["service","request"])}}}}return null}function be(t,r){const s=_("Operation",t);if(!s.length)return _("Format",S(r,t)).map(({textContent:a})=>a).filter(J.Ru);const i=[];for(const a of s)if(a.getAttribute("name")===r){const d=_("Format",a);for(const{textContent:o}of d)null!=o&&i.push(o)}return i}function we(t,r,s){const i=S(r,t);if(!i)return s;const{textContent:a}=i;if(null==a||""===a)return s;const d=Number(a);return isNaN(d)?s:d}function Q(t,r,s){if(!t)return null;const i={id:s.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===t.getAttribute("queryable"),spatialReferences:[],sublayers:null},a=S("LatLonBoundingBox",t),d=S("EX_GeographicBoundingBox",t);let o=null;a&&(o=z(a,4326)),d&&(o=new G.A(0,0,0,0,new T.A({wkid:4326})),o.xmin=parseFloat(F("westBoundLongitude",d,"0")),o.ymin=parseFloat(F("southBoundLatitude",d,"0")),o.xmax=parseFloat(F("eastBoundLongitude",d,"0")),o.ymax=parseFloat(F("northBoundLatitude",d,"0"))),a||d||(o=new G.A(-180,-90,180,90,new T.A({wkid:4326}))),i.minScale=we(t,"MaxScaleDenominator",0),i.maxScale=we(t,"MinScaleDenominator",0);const h=["1.0.0","1.1.0","1.1.1"].includes(r)?"SRS":"CRS";return Array.prototype.slice.call(t.childNodes).forEach(c=>{if("Name"===c.nodeName)i.name=c.textContent||"";else if("Title"===c.nodeName)i.title=c.textContent||"";else if("Abstract"===c.nodeName)i.description=c.textContent||"";else if("BoundingBox"===c.nodeName){const m=c.getAttribute(h);if(m&&0===m.indexOf("EPSG:")){const x=parseInt(m.substring(5),10);0===x||isNaN(x)||o||(o="1.3.0"===r?z(c,x,(0,re.m)(x)):z(c,x))}const g=m?.indexOf(":");if(g&&g>-1){let x=parseInt(m.substring(g+1,m.length),10);0===x||isNaN(x)||(x=he[x]??x);const A="1.3.0"===r?z(c,x,(0,re.m)(x)):z(c,x);A&&i.fullExtents&&i.fullExtents.push(A)}}else if(c.nodeName===h)(c.textContent?.split(" ")??[]).forEach(m=>{const g=m.includes(":")?parseInt(m.split(":")[1],10):parseInt(m,10);if(0!==g&&!isNaN(g)){const x=he[g]??g;i.spatialReferences.includes(x)||i.spatialReferences.push(x)}});else if("Style"!==c.nodeName||i.legendUrl){if("Layer"===c.nodeName){const m=Q(c,r,s);m&&(m.parentLayerId=i.id,i.sublayers||(i.sublayers=[]),i.sublayers.push(m))}}else{const m=S("LegendURL",c);if(m){const g=S("OnlineResource",m);g&&(i.legendUrl=g.getAttribute("xlink:href"))}}}),i.extent=o?.toJSON(),i.dimensions=_("Dimension",t).filter(c=>c.getAttribute("name")&&c.getAttribute("units")&&c.textContent).map(c=>{const m=c.getAttribute("name"),g=c.getAttribute("units"),x=c.textContent,A=c.getAttribute("unitSymbol")??void 0,j=c.getAttribute("default")??void 0,C="0"!==k("default",c,"0"),B="0"!==k("nearestValue",c,"0"),M="0"!==k("current",c,"0");return se({name:m,units:g})?{name:"time",units:"ISO8601",extent:Ie(x),default:Ie(j),multipleValues:C,nearestValue:B,current:M}:function Se(t){return/^elevation$/i.test(t.name)&&/^(epsg|crs):\d+$/i.test(t.units)}({name:m,units:g})?{name:"elevation",units:g,extent:Ee(x),unitSymbol:A,default:Ee(j),multipleValues:C,nearestValue:B}:{name:m,units:g,extent:Ae(x),unitSymbol:A,default:Ae(j),multipleValues:C,nearestValue:B}}),i}function Me(t){return t.nodeType===Node.ELEMENT_NODE}function se(t){return/^time$/i.test(t.name)&&/^iso8601$/i.test(t.units)}function Ee(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:parseFloat(a[0]),max:parseFloat(a[1]),resolution:a.length>=3&&"0"!==a[2]?parseFloat(a[2]):void 0}}).filter(J.Ru):s.map(i=>parseFloat(i))}function Ae(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:a[0],max:a[1],resolution:a.length>=3&&"0"!==a[2]?a[2]:void 0}}).filter(J.Ru):s}function Ie(t){if(!t)return;const r=t.includes("/"),s=t.split(",");return r?s.map(i=>{const a=i.split("/");return a.length<2?null:{min:new Date(a[0]),max:new Date(a[1]),resolution:a.length>=3&&"0"!==a[2]?st(a[2]):void 0}}).filter(J.Ru):s.map(i=>new Date(i))}function st(t){const s=t.match(/(?:p(\d+y|\d+(?:\.|,)\d+y)?(\d+m|\d+(?:\.|,)\d+m)?(\d+d|\d+(?:\.|,)\d+d)?)?(?:t(\d+h|\d+(?:\.|,)\d+h)?(\d+m|\d+(?:\.|,)\d+m)?(\d+s|\d+(?:\.|,)\d+s)?)?/i);return s?{years:H(s[1]),months:H(s[2]),days:H(s[3]),hours:H(s[4]),minutes:H(s[5]),seconds:H(s[6])}:null}function H(t){if(!t)return 0;const s=t.match(/(?:\d+(?:\.|,)\d+|\d+)/);if(!s)return 0;const i=s[0].replace(",",".");return Number(i)}function ie(t){return t.toISOString().replace(/\.[0-9]{3}/,"")}function Oe(t){if(!t||t.isAllTime||t.isEmpty)return;const{start:r,end:s}=t;return r&&s&&r.getTime()===s.getTime()?`${ie(r)}`:`${r?ie(r):"0000-01-01T00:00:00Z"}/${s?ie(s):"9999-12-31T23:59:59Z"}`}const Ne=new Set([102100,3857,102113,900913]),ot=new Set([3395,54004]),ae=new I.J({bmp:"image/bmp",gif:"image/gif",jpg:"image/jpeg",png:"image/png",svg:"image/svg+xml"},{ignoreUnknown:!1});function Fe(t){return"text/html"===t}function Re(t){return"text/plain"===t}let f=class extends((0,$e.dM)((0,Ke.e)((0,He.J)((0,Xe.j)((0,Ve.q)((0,Ge.A)((0,O.P)(De.A)))))))){constructor(...t){super(...t),this.allSublayers=new Z.A({getCollections:()=>[this.sublayers],getChildrenFunction:r=>r.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType="WMS",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type="wms",this.version=null,this.addHandles([(0,y.on)(()=>this.sublayers,"after-add",({item:r})=>{r.parent=r.layer=this},y.OH),(0,y.on)(()=>this.sublayers,"after-remove",({item:r})=>{r.layer=r.parent=null},y.OH),(0,y.wB)(()=>this.sublayers,(r,s)=>{if(s)for(const i of s)i.layer=i.parent=null;if(r)for(const i of r)i.parent=i.layer=this},y.OH)])}normalizeCtorArgs(t,r){return"string"==typeof t?{url:t,...r}:t}destroy(){this.allSublayers.destroy()}load(t){const r=null!=t?t.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WMS"]},t).catch(v.QP).then(()=>this._fetchService(r))),Promise.resolve(this)}readFullExtentFromItemOrMap(t,r){const s=r.extent;return s?new G.A({xmin:s[0][0],ymin:s[0][1],xmax:s[1][0],ymax:s[1][1]}):null}writeFullExtent(t,r){r.extent=[[t.xmin,t.ymin],[t.xmax,t.ymax]]}get featureInfoFormat(){return null==this.featureInfoFormats?null:this.featureInfoFormats.find(Fe)??this.featureInfoFormats.find(Re)??null}set featureInfoFormat(t){null==t?(this.revert("featureInfoFormat","service"),this._clearOverride("featureInfoFormat")):(Fe(t)||Re(t))&&this._override("featureInfoFormat",t)}readImageFormat(t,r){const s=r.supportedImageFormatTypes;return s&&s.includes("image/png")?"image/png":s&&s[0]}readSpatialReferenceFromItemOrDocument(t,r){return new T.A(r.spatialReferences[0])}writeSpatialReferences(t,r){const s=this.spatialReference?.wkid;t&&s?(r.spatialReferences=t.filter(i=>i!==s),r.spatialReferences.unshift(s)):r.spatialReferences=t}readSublayersFromItemOrMap(t,r,s){return Le(r.layers,s,r.visibleLayers)}readSublayers(t,r,s){return Le(r.layers,s)}writeSublayers(t,r,s,i){r.layers=[];const a=new Map,d=t.flatten(({sublayers:o})=>o??[]);for(const o of d)if("number"==typeof o.parent?.id){const h=a.get(o.parent.id);null!=h?h.push(o.id):a.set(o.parent.id,[o.id])}for(const o of d){const h={sublayer:o,...i},c=o.write({parentLayerId:"number"==typeof o.parent?.id?o.parent.id:-1},h);if(a.has(o.id)&&(c.sublayerIds=a.get(o.id)),!o.sublayers&&o.name){const m=o.write({},h);delete m.id,r.layers.push(m)}}r.visibleLayers=d.filter(({visible:o,sublayers:h})=>o&&!h).map(({name:o})=>o).toArray()}set url(t){if(!t)return void this._set("url",t);const{path:r,query:s}=(0,w.An)(t);for(const a in s)/^(request|service)$/i.test(a)&&delete s[a];const i=(0,w.a6)(r,s??{});this._set("url",i)}createExportImageParameters(t,r,s,i){const a=i?.pixelRatio??1,d=(0,me.X_)({extent:t,width:r})*a,o=new ye.r({layer:this,scale:d}),{xmin:h,ymin:c,xmax:m,ymax:g,spatialReference:x}=t,A=function lt(t,r){let s=t.wkid;return null==r?s:(null!=s&&r.includes(s)||!t.latestWkid||(s=t.latestWkid),null!=s&&Ne.has(s)?r.find(i=>Ne.has(i))||r.find(i=>ot.has(i))||102100:s)}(x,this.spatialReferences),j="1.3.0"===this.version&&(0,re.m)(A)?`${c},${h},${g},${m}`:`${h},${c},${m},${g}`,C=o.toJSON(),B="1.3.0"===this.version?"crs":"srs";return{bbox:j,[B]:null==A||isNaN(A)?void 0:"EPSG:"+A,...C}}fetchImage(t,r,s,i){var a=this;return(0,R.A)(function*(){const d=a.mapUrl,o=a.createExportImageParameters(t,r,s,i);if(!o.layers){const m=document.createElement("canvas");return m.width=r,m.height=s,m}const h=Oe(i?.timeExtent),c={responseType:"image",query:a._mixCustomParameters({width:r,height:s,...o,time:h,...a.refreshParameters}),signal:i?.signal};return(0,D.A)(d??"",c).then(m=>m.data)})()}fetchImageBitmap(t,r,s,i){var a=this;return(0,R.A)(function*(){const d=a.mapUrl??"",o=a.createExportImageParameters(t,r,s,i);if(!o.layers){const g=document.createElement("canvas");return g.width=r,g.height=s,g}const h=Oe(i?.timeExtent),c={responseType:"blob",query:a._mixCustomParameters({width:r,height:s,...o,time:h,...a.refreshParameters}),signal:i?.signal},{data:m}=yield(0,D.A)(d,c);return(0,ze.m)(m,d,i?.signal)})()}fetchFeatureInfo(t,r,s,i,a){const d=(0,me.X_)({extent:t,width:r}),h=function et(t){const r=t.filter(s=>s.popupEnabled&&s.name&&s.queryable);return r.length?r.map(({name:s})=>s).join():null}(new ye.r({layer:this,scale:d}).visibleSublayers);if(null==this.featureInfoUrl||null==h)return Promise.resolve([]);if(null==this.fetchFeatureInfoFunction&&null==this.featureInfoFormat)return Promise.resolve([]);const m={query_layers:h,request:"GetFeatureInfo",info_format:this.featureInfoFormat,feature_count:25,width:r,height:s,..."1.3.0"===this.version?{I:i,J:a}:{x:i,y:a}},g={...this.createExportImageParameters(t,r,s),...m},x=this._mixCustomParameters(g);return null!=this.fetchFeatureInfoFunction?this.fetchFeatureInfoFunction(x):this._defaultFetchFeatureInfoFunction((0,w.a6)(this.featureInfoUrl,x))}findSublayerById(t){return this.allSublayers.find(r=>r.id===t)}findSublayerByName(t){return this.allSublayers.find(r=>r.name===t)}serviceSupportsSpatialReference(t){return(0,Je.bd)(this.url)||null!=this.spatialReferences&&this.spatialReferences.some(r=>{const s=900913===r?T.A.WebMercator:new T.A({wkid:r});return(0,We.aI)(s,t)})}_defaultFetchFeatureInfoFunction(t){const r=document.createElement("iframe");r.src=(0,w.yM)(t),r.style.border="none",r.style.margin="0",r.style.width="100%",r.setAttribute("sandbox","");const s=new P.A({title:this.title,content:r}),i=new K.A({sourceLayer:this,popupTemplate:s});return Promise.resolve([i])}_fetchService(t){var r=this;return(0,R.A)(function*(){if(!r.resourceInfo&&r.parsedUrl?.path){const{path:s,query:i}=r.parsedUrl,{data:a}=yield(0,D.A)(s,{query:{SERVICE:"WMS",REQUEST:"GetCapabilities",...i,...r.customParameters},responseType:"xml",signal:t});r.resourceInfo=_e(a)}if(r.parsedUrl){const s=new w.s0(r.parsedUrl.path),{httpsDomains:i}=L.A.request;"https"!==s.scheme||s.port&&"443"!==s.port||!s.host||i.includes(s.host)||i.push(s.host)}r.read(r.resourceInfo,{origin:"service"})})()}_mixCustomParameters(t){if(!this.customLayerParameters&&!this.customParameters)return t;const r={...this.customParameters,...this.customLayerParameters};for(const s in r)t[s.toLowerCase()]=r[s];return t}};function Le(t,r,s){t=t??[];const i=new Map;t.every(d=>null==d.id)&&(t=(0,N.o8)(t)).forEach((d,o)=>d.id=o);for(const d of t){const o=new ne;o.read(d,r),s&&!s.includes(o.name)&&(o.visible=!1),i.set(o.id,o)}const a=[];for(const d of t){const o=null!=d.id?i.get(d.id):null;if(o)if(null!=d.parentLayerId&&d.parentLayerId>=0){const h=i.get(d.parentLayerId);if(!h)continue;h.sublayers||(h.sublayers=new U.A),h.sublayers.push(o)}else a.push(o)}return a}(0,l._)([(0,p.MZ)({readOnly:!0})],f.prototype,"allSublayers",void 0),(0,l._)([(0,p.MZ)({json:{type:Object,write:!0}})],f.prototype,"customParameters",void 0),(0,l._)([(0,p.MZ)({json:{type:Object,write:!0}})],f.prototype,"customLayerParameters",void 0),(0,l._)([(0,p.MZ)({type:String,json:{write:!0}})],f.prototype,"copyright",void 0),(0,l._)([(0,p.MZ)()],f.prototype,"description",void 0),(0,l._)([(0,p.MZ)({readOnly:!0})],f.prototype,"dimensions",void 0),(0,l._)([(0,p.MZ)({json:{type:[[Number]],read:{source:"extent"},write:{target:"extent"},origins:{"web-document":{write:{ignoreOrigin:!0}},"portal-item":{write:{ignoreOrigin:!0}}}}})],f.prototype,"fullExtent",void 0),(0,l._)([(0,V.w)(["web-document","portal-item"],"fullExtent",["extent"])],f.prototype,"readFullExtentFromItemOrMap",null),(0,l._)([(0,te.K)(["web-document","portal-item"],"fullExtent",{extent:{type:[[Number]]}})],f.prototype,"writeFullExtent",null),(0,l._)([(0,p.MZ)()],f.prototype,"fullExtents",void 0),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],f.prototype,"featureInfoFormat",null),(0,l._)([(0,p.MZ)({type:[String],readOnly:!0})],f.prototype,"featureInfoFormats",void 0),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],f.prototype,"featureInfoUrl",void 0),(0,l._)([(0,p.MZ)()],f.prototype,"fetchFeatureInfoFunction",void 0),(0,l._)([(0,p.MZ)({type:String,json:{origins:{"web-document":{default:"image/png",type:ae.jsonValues,read:{reader:ae.read,source:"format"},write:{writer:ae.write,target:"format"}}}}})],f.prototype,"imageFormat",void 0),(0,l._)([(0,V.w)("imageFormat",["supportedImageFormatTypes"])],f.prototype,"readImageFormat",null),(0,l._)([(0,p.MZ)({type:Number,json:{read:{source:"maxHeight"},write:{target:"maxHeight"}}})],f.prototype,"imageMaxHeight",void 0),(0,l._)([(0,p.MZ)({type:Number,json:{read:{source:"maxWidth"},write:{target:"maxWidth"}}})],f.prototype,"imageMaxWidth",void 0),(0,l._)([(0,p.MZ)()],f.prototype,"imageTransparency",void 0),(0,l._)([(0,p.MZ)(fe.fV)],f.prototype,"legendEnabled",void 0),(0,l._)([(0,p.MZ)({type:["show","hide","hide-children"]})],f.prototype,"listMode",void 0),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],f.prototype,"mapUrl",void 0),(0,l._)([(0,p.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],f.prototype,"isReference",void 0),(0,l._)([(0,p.MZ)({type:["WMS"]})],f.prototype,"operationalLayerType",void 0),(0,l._)([(0,p.MZ)()],f.prototype,"resourceInfo",void 0),(0,l._)([(0,p.MZ)({type:T.A,json:{origins:{service:{read:{source:"extent.spatialReference"}}},write:!1}})],f.prototype,"spatialReference",void 0),(0,l._)([(0,V.w)(["web-document","portal-item"],"spatialReference",["spatialReferences"])],f.prototype,"readSpatialReferenceFromItemOrDocument",null),(0,l._)([(0,p.MZ)({type:[$.jz],json:{read:!1,origins:{service:{read:!0},"web-document":{read:!1,write:{ignoreOrigin:!0}},"portal-item":{read:!1,write:{ignoreOrigin:!0}}}}})],f.prototype,"spatialReferences",void 0),(0,l._)([(0,te.K)(["web-document","portal-item"],"spatialReferences")],f.prototype,"writeSpatialReferences",null),(0,l._)([(0,p.MZ)({type:U.A.ofType(ne),json:{write:{target:"layers",overridePolicy(t,r,s){if(function ut(t,r){return t.some(s=>{for(const i in s)if((0,Be.R)(s,i,null,r))return!0;return!1})}(this.allSublayers,s))return{ignoreOrigin:!0}}}}})],f.prototype,"sublayers",void 0),(0,l._)([(0,V.w)(["web-document","portal-item"],"sublayers",["layers","visibleLayers"])],f.prototype,"readSublayersFromItemOrMap",null),(0,l._)([(0,V.w)("service","sublayers",["layers"])],f.prototype,"readSublayers",null),(0,l._)([(0,te.K)("sublayers",{layers:{type:[ne]},visibleLayers:{type:[String]}})],f.prototype,"writeSublayers",null),(0,l._)([(0,p.MZ)({json:{read:!1},readOnly:!0,value:"wms"})],f.prototype,"type",void 0),(0,l._)([(0,p.MZ)(fe.OZ)],f.prototype,"url",null),(0,l._)([(0,p.MZ)({type:String,json:{write:{ignoreOrigin:!0}}})],f.prototype,"version",void 0),f=(0,l._)([(0,ce.$)("esri.layers.WMSLayer")],f);const pt=f},63014:(de,W,u)=>{u.d(W,{C:()=>D,m:()=>K});var R=u(10467),l=u(5922),L=u(56492);function K(Z,I,N){return P.apply(this,arguments)}function P(){return(P=(0,R.A)(function*(Z,I,N){let O;try{O=yield createImageBitmap(Z)}catch(v){throw new l.A("request:server",`Unable to load ${I}`,{url:I,error:v})}return(0,L.Te)(N),O})).apply(this,arguments)}function D(Z,I,N,O,v){return U.apply(this,arguments)}function U(){return(U=(0,R.A)(function*(Z,I,N,O,v){let y;try{y=yield createImageBitmap(Z)}catch(w){throw new l.A("request:server",`Unable to load tile ${I}/${N}/${O}`,{error:w,level:I,row:N,col:O})}return(0,L.Te)(v),y})).apply(this,arguments)}}}]);