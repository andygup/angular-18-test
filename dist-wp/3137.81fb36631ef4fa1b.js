"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[3137,7340,9063],{23506:(N,v,n)=>{n.d(v,{v:()=>m});var u=n(99305);function m(M){M?.writtenProperties&&M.writtenProperties.forEach(({target:d,propName:O,newOrigin:W})=>{(0,u.H)(d)&&W&&d.originOf(O)!==W&&d.updateOrigin(O,W)})}},99305:(N,v,n)=>{function u(m){return m&&"getAtOrigin"in m&&"originOf"in m}n.d(v,{H:()=>u})},57340:(N,v,n)=>{n.r(v),n.d(v,{addOrUpdateResources:()=>R,contentToBlob:()=>E,fetchResources:()=>O,getSiblingOfSameType:()=>U,getSiblingOfSameTypeI:()=>w,removeAllResources:()=>P,removeResource:()=>I,splitPrefixFileNameAndExtension:()=>p});var u=n(10467),m=n(89563),M=n(5922),d=n(45272);function O(o){return W.apply(this,arguments)}function W(){return(W=(0,u.A)(function*(o,l={},c){yield o.load(c);const h=(0,d.fj)(o.itemUrl,"resources"),{start:D=1,num:i=10,sortOrder:g="asc",sortField:G="resource"}=l,T={query:{start:D,num:i,sortOrder:g,sortField:G,token:o.apiKey},signal:c?.signal},x=yield o.portal.request(h,T);return{total:x.total,nextStart:x.nextStart,resources:x.resources.map(({created:$,size:b,resource:B})=>({created:new Date($),size:b,resource:o.resourceFromPath(B)}))}})).apply(this,arguments)}function R(o,l,c,h){return L.apply(this,arguments)}function L(){return(L=(0,u.A)(function*(o,l,c,h){const D=new Map;for(const{resource:g,content:G,compress:T,access:x}of l){if(!g.hasPath())throw new M.A(`portal-item-resource-${c}:invalid-path`,"Resource does not have a valid path");const[$,b]=j(g.path),B=`${$}/${T??""}/${x??""}`;D.has(B)||D.set(B,{prefix:$,compress:T,access:x,files:[]}),D.get(B).files.push({fileName:b,content:G})}yield o.load(h);const i=(0,d.fj)(o.userItemUrl,"add"===c?"addResources":"updateResources");for(const{prefix:g,compress:G,access:T,files:x}of D.values())for(let b=0;b<x.length;b+=25){const B=x.slice(b,b+25),S=new FormData;g&&"."!==g&&S.append("resourcesPrefix",g),G&&S.append("compress","true"),T&&S.append("access",T);let z=0;for(const{fileName:H,content:Y}of B)S.append("file"+ ++z,Y,H);S.append("f","json"),yield o.portal.request(i,{method:"post",body:S,signal:h?.signal})}})).apply(this,arguments)}function I(o,l,c){return y.apply(this,arguments)}function y(){return(y=(0,u.A)(function*(o,l,c){if(!l.hasPath())throw new M.A("portal-item-resources-remove:invalid-path","Resource does not have a valid path");yield o.load(c);const h=(0,d.fj)(o.userItemUrl,"removeResources");yield o.portal.request(h,{method:"post",query:{resource:l.path},signal:c?.signal}),l.portalItem=null})).apply(this,arguments)}function P(o,l){return C.apply(this,arguments)}function C(){return(C=(0,u.A)(function*(o,l){yield o.load(l);const c=(0,d.fj)(o.userItemUrl,"removeResources");return o.portal.request(c,{method:"post",query:{deleteAll:!0},signal:l?.signal})})).apply(this,arguments)}function j(o){const l=o.lastIndexOf("/");return-1===l?[".",o]:[o.slice(0,l),o.slice(l+1)]}function p(o){const[l,c]=function s(o){const l=(0,d.Zo)(o);return null==l?[o,""]:[o.slice(0,o.length-l.length-1),`.${l}`]}(o),[h,D]=j(l);return[h,D,c]}function E(o){return f.apply(this,arguments)}function f(){return(f=(0,u.A)(function*(o){return"blob"===o.type?o.blob:"json"===o.type?new Blob([o.jsonString],{type:"application/json"}):(yield(0,m.A)(o.url,{responseType:"blob"})).data})).apply(this,arguments)}function U(o,l){if(!o.hasPath())return null;const[c,,h]=p(o.path);return o.portalItem.resourceFromPath((0,d.fj)(c,l+h))}function w(o,l){if(!o.hasPath())return null;const[c,,h]=p(o.path);return o.portalItem.resourceFromPath((0,d.fj)(c,l+h))}},3458:(N,v,n)=>{n.d(v,{S:()=>L,r:()=>W});var u=n(10467),m=n(5922),M=n(56492),d=n(43085),O=n(57340);function W(p,s,E){return R.apply(this,arguments)}function R(){return(R=(0,u.A)(function*(p,s,E){const f=yield y(p,s,E);yield C(f,s,E)})).apply(this,arguments)}function L(p,s,E,f,U){return I.apply(this,arguments)}function I(){return(I=(0,u.A)(function*(p,s,E,f,U){const w=yield y(E,f,U);yield p.update({data:s}),yield C(w,f,U)})).apply(this,arguments)}function y(p,s,E){return P.apply(this,arguments)}function P(){return(P=(0,u.A)(function*(p,s,E){if(!s?.resources)return;const f=s.portalItem===p.portalItem?new Set(p.paths):new Set;p.paths.length=0,p.portalItem=s.portalItem;const U=new Set(s.resources.toKeep.map(i=>i.resource.path)),w=new Set,o=[];U.forEach(i=>{f.delete(i),p.paths.push(i)});const l=[],c=[],h=[];for(const i of s.resources.toUpdate)if(f.delete(i.resource.path),U.has(i.resource.path)||w.has(i.resource.path)){const{resource:g,content:G,finish:T}=i,x=(0,O.getSiblingOfSameTypeI)(g,(0,d.lk)());p.paths.push(x.path),l.push({resource:x,content:yield(0,O.contentToBlob)(G),compress:i.compress}),T&&h.push(()=>T(x))}else{p.paths.push(i.resource.path),c.push({resource:i.resource,content:yield(0,O.contentToBlob)(i.content),compress:i.compress});const g=i.finish;g&&h.push(()=>g(i.resource)),w.add(i.resource.path)}for(const i of s.resources.toAdd)if(p.paths.push(i.resource.path),f.has(i.resource.path))f.delete(i.resource.path);else{l.push({resource:i.resource,content:yield(0,O.contentToBlob)(i.content),compress:i.compress});const g=i.finish;g&&h.push(()=>g(i.resource))}if(l.length||c.length){const{addOrUpdateResources:i}=yield Promise.resolve().then(n.bind(n,57340));yield i(s.portalItem,l,"add",E),yield i(s.portalItem,c,"update",E)}if(h.forEach(i=>i()),0===o.length)return f;const D=yield(0,M.Ol)(o);if((0,M.Te)(E),D.length>0)throw new m.A("save:resources","Failed to save one or more resources",{errors:D});return f})).apply(this,arguments)}function C(p,s,E){return j.apply(this,arguments)}function j(){return(j=(0,u.A)(function*(p,s,E){if(!p||!s.portalItem)return;const f=[];for(const U of p){const w=s.portalItem.resourceFromPath(U);f.push(w.portalItem.removeResource(w,E))}yield(0,M.Lx)(f)})).apply(this,arguments)}},96904:(N,v,n)=>{n.d(v,{X:()=>d});var u=n(23098),m=n(5922),M=n(2174);function d(O){if(u.A.apiKey&&(0,M.Q)(O.portal.url))throw new m.A("save-api-key-utils:api-key-not-supported",`Saving is not supported on ${O.portal.url} when using an api key`)}},95945:(N,v,n)=>{n.d(v,{c:()=>W,d:()=>M});var u=n(10467),m=n(5922);function M(R){return d.apply(this,arguments)}function d(){return(d=(0,u.A)(function*(R){const L=[];for(const I of R.allLayers)if("beforeSave"in I&&"function"==typeof I.beforeSave){const y=I.beforeSave();y&&L.push(y)}yield Promise.allSettled(L)})).apply(this,arguments)}const O=new Set(["layer:unsupported","property:unsupported","symbol:unsupported","symbol-layer:unsupported","url:unsupported"]);function W(R,L,I){let y=(R.messages??[]).filter(({type:P})=>"error"===P).map(({name:P,message:C,details:j})=>new m.A(P,C,j));if(R.blockedRelativeUrls&&(y=y.concat(R.blockedRelativeUrls.map(P=>new m.A("url:unsupported",`Relative url '${P}' is not supported`)))),I){const{ignoreUnsupported:P,supplementalUnsupportedErrors:C=[],requiredPropertyChecksDisabled:j}=I;P&&(y=y.filter(({name:p})=>!(O.has(p)||C.includes(p)))),j&&(y=y.filter(p=>"web-document-write:property-required"!==p.name))}if(y.length>0)throw new m.A(L.errorName,"Failed to save due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:y})}},53137:(N,v,n)=>{n.r(v),n.d(v,{createJSON:()=>i,save:()=>h,saveAs:()=>G});var u=n(10467),m=n(5922),M=n(39693),d=n(48900),O=n(45272),W=n(23506),R=n(32034),L=n(58701),I=n(55039),y=n(68438),P=n(58443),C=n(73874),j=n(46577),p=n(15764),s=n(69927),E=n(66456),f=n(77436),U=n(71470),w=n(3458),o=n(96904),l=n(95945);const c=["NatGeo_World_Map","Ocean_Basemap","USA_Topo_Maps","World_Imagery","World_Street_Map","World_Terrain_Base","World_Topo_Map","World_Hillshade","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Reference/World_Boundaries_and_Places","Reference/World_Reference_Overlay","Reference/World_Transportation"].map(t=>t.toLowerCase());function h(t,e,r){return D.apply(this,arguments)}function D(){return D=(0,u.A)(function*(t,e,r){r??={},function x(t,e){if(!e.portalItem)throw new m.A(`${t.name}:portal-item-not-set`,"Portal item to save to has not been set on the WebMap");(0,o.X)(e.portalItem),$(t,e.portalItem)}(t,e),yield(0,d.C_)(()=>!e.updatingFromView),yield e.load(),yield H(e),yield(0,l.d)(e),yield B(t,e);const a=e.portalItem,{json:_,jsonContext:A}=yield i(e,a);return(0,l.c)(A,{errorName:`${t.name}:save`},r),yield Y(e,a),yield function Be(t,e,r,a,_){return te.apply(this,arguments)}(t,e,a,_,A),yield Promise.all([e.updateItemThumbnail(),(0,w.r)(e.resourceReferences,A)]),a}),D.apply(this,arguments)}function i(t,e){return g.apply(this,arguments)}function g(){return(g=(0,u.A)(function*(t,e){const r=(0,p.m)(e,"web-map",!0),a=t.write({},r);return yield Promise.all(r.resources.pendingOperations),{json:a,jsonContext:r}})).apply(this,arguments)}function G(t,e,r,a){return T.apply(this,arguments)}function T(){return T=(0,u.A)(function*(t,e,r,a){a??={};const _=function z(t,e){let r=j.default.from(e);return r.id&&(r=r.clone(),r.id=null),r.type||(r.type=t.itemType),r.portal||(r.portal=C.A.getDefault()),(0,o.X)(r),$(t,r),r}(t,r);yield(0,d.C_)(()=>!e.updatingFromView),yield e.load(),function b(t,e){const r=e.allLayers.filter(a=>"unsupported"===a.type&&"KnowledgeGraphLayer"===a.resourceInfo?.layerType);if(r.length)throw new m.A(`${t.name}:save-as-invalid-configuration`,`Failed to save a copy of ${t.name} to prevent persisting invalid configuration. See 'details.layers'`,{layers:r.toArray()})}(t,e),yield H(e),yield(0,l.d)(e),yield B(t,e);const{json:A,jsonContext:K}=yield i(e,_);(0,l.c)(K,{errorName:`${t.name}:save`},a),yield function Ae(t,e){return Z.apply(this,arguments)}(e,_);const F=e.getThumbnailState();return(yield function Se(t,e,r,a,_,A){return re.apply(this,arguments)}(t,e,_,A,K,a))&&(e.resourceReferences.portalItem=_),e.restoreThumbnailFromState(F),yield Promise.all([e.updateItemThumbnail(),(0,w.r)(e.resourceReferences,K)]),_}),T.apply(this,arguments)}function $(t,e){if(e.type!==t.itemType)throw new m.A(`${t.name}:portal-item-wrong-type`,`Portal item needs to have type "${t.itemType}"`)}function B(t,e){return S.apply(this,arguments)}function S(){return(S=(0,u.A)(function*(t,e){if(!e.basemap?.baseLayers.length)throw new m.A(`${t.name}:save`,"Map does not have a valid basemap with a base layer.");let r=null;if(yield(0,d.C_)(()=>{const a=(0,U.n8)(e.initialViewProperties,e.basemap);return r=a.spatialReference,!a.updating}),!(0,L.aI)(r,e.initialViewProperties.spatialReference))throw new m.A(`${t.name}:save`,"The spatial reference of the basemap is not compatible with the one from the map.",{expected:e.initialViewProperties.spatialReference,actual:r})})).apply(this,arguments)}function H(t){const e=[];return t.basemap&&e.push(t.basemap.load()),t.ground&&e.push(t.ground.load()),Promise.allSettled(e).then(()=>{})}function Y(t,e){return X.apply(this,arguments)}function X(){return X=(0,u.A)(function*(t,e){e.extent=yield function Le(t,e){return q.apply(this,arguments)}(t.portalItem,t.initialViewProperties.viewpoint.targetGeometry),yield function ve(t,e){return Q.apply(this,arguments)}(t,e)}),X.apply(this,arguments)}const Ee=s.mm.JSAPI,ae="CollectorDisabled",ie="Collector",le="Data Editing",ue="OfflineDisabled",pe="Offline",_e="Workforce Project",ce="Workforce Worker",de="Workforce Dispatcher",Oe="Offline Map Areas",Pe="FieldMapsDisabled",me=s.mm.DEVELOPER_BASEMAP,fe="UtilityNetwork",ye="IPS";function Z(){return(Z=(0,u.A)(function*(t,e){(0,s.OM)(e,ae),(0,s.OM)(e,Pe),(0,s.OM)(e,s.mm.METADATA),(0,s.OM)(e,ue),(0,s.OM)(e,Oe),(0,s.OM)(e,de),(0,s.OM)(e,_e),(0,s.OM)(e,ce),yield Y(t,e)})).apply(this,arguments)}function Q(){return(Q=(0,u.A)(function*(t,e){(0,s.LG)(e,Ee),yield function Me(t){const e=k(t).map(r=>r.load()).toArray();return Promise.allSettled(e).then(()=>{})}(t),function xe(t,e){(0,s.Y)(e,ae)||(0,s.Y)(e,_e)||(0,s.Y)(e,ce)||(0,s.Y)(e,de)||!he(t)?(0,s.OM)(e,ie):(0,s.LG)(e,ie)}(t,e),function Re(t,e){he(t)?(0,s.LG)(e,le):(0,s.OM)(e,le)}(t,e),function Ie(t,e){!(0,s.Y)(e,ue)&&function De(t){return k(t).filter(e=>"group"!==e.type).every(e=>e.loaded&&function we(t,e){return(0,P.W_)(e)&&e.capabilities.operations.supportsSync||function je(t){return(0,P.Ov)(t)||"map-notes"===t.type||"route"===t.type}(e)&&!e.portalItem||("tile"===e.type||"vector-tile"===e.type)&&(e.capabilities.operations.supportsExportTiles||function be(t){return"tile"===t.type&&(0,y.tK)(t.url)&&c.some(e=>t.url?.toLowerCase().includes("/"+e+"/"))}(e)||(0,U.JT)(e))&&e.spatialReference.equals(t.initialViewProperties.spatialReference)}(t,e))}(t)?(0,s.LG)(e,pe):(0,s.OM)(e,pe)}(t,e),function Ue(t,e){(0,U.Rc)(t.basemap)?(0,s.LG)(e,me):(0,s.OM)(e,me)}(t,e),function Te(t,e){t.utilityNetworks?.length?(0,s.LG)(e,fe):(0,s.OM)(e,fe)}(t,e),function We(t,e){t.ipsInfo?(0,s.LG)(e,ye):(0,s.OM)(e,ye)}(t,e),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter((r,a,_)=>_.indexOf(r)===a))})).apply(this,arguments)}function k(t){return t.allLayers.concat(t.allTables)}function he(t){return k(t).some(e=>e.loaded&&(0,P.W_)(e)&&e.capabilities.operations.supportsEditing&&e.editingEnabled&&("subtype-group"!==e.type||e.sublayers.some(r=>r.editingEnabled)))}function q(){return q=(0,u.A)(function*(t,e){const r=e.clone().normalize();let a;if(r.length>1)for(const _ of r)a?_.width>a.width&&(a=_):a=_;else a=r[0];return function Ce(t,e){return ee.apply(this,arguments)}(t,a)}),q.apply(this,arguments)}function ee(){return(ee=(0,u.A)(function*(t,e){const r=e.spatialReference;if(r.isWGS84)return e.clone();if(r.isWebMercator)return(0,I.ci)(e);const{getGeometryServiceURL:a}=yield n.e(5385).then(n.bind(n,65385)),_=yield a(t),A=new f.A({geometries:[e],outSpatialReference:R.A.WGS84});return(yield(0,E.C)(_,A))[0]})).apply(this,arguments)}function te(){return(te=(0,u.A)(function*(t,e,r,a,_){yield r.update({data:a}),ge(t,e,r,a,_)})).apply(this,arguments)}function re(){return re=(0,u.A)(function*(t,e,r,a,_,A){const K=e.portalItem,F={item:K,authenticated:!(!K?.id||!K.portal.user)},V=r.portal;yield V.signIn();const{copyAllowed:J,itemReloaded:se}=yield function Ke(t,e){return ne.apply(this,arguments)}(F,V);if(F.authenticated||=se,!J)throw new m.A(`${t.name}:save-as-copy-not-allowed`,"Owner of this map does not allow others to save a copy");const $e=yield function Ge(t,e,r,a){return oe.apply(this,arguments)}(r,F,a,A);return e.portalItem=r,ge(t,e,r,a,_),$e}),re.apply(this,arguments)}function ne(){return(ne=(0,u.A)(function*(t,e){const{item:r,authenticated:a}=t;return r?.id&&r.typeKeywords?.includes("useOnly")?r.portal.portalHostname!==e.portalHostname?{copyAllowed:!1,itemReloaded:!1}:(a||(yield r.reload()),{copyAllowed:"admin"===r.itemControl||"update"===r.itemControl,itemReloaded:!0}):{copyAllowed:!0,itemReloaded:!1}})).apply(this,arguments)}function oe(){return(oe=(0,u.A)(function*(t,e,r,a){const _=t.portal,{item:A}=e,{folder:K,copyAllResources:F}=a;let V=!1;if(F&&A?.id&&(0,O.b8)(A.portal.url,_.url)&&parseInt(A.portal.currentVersion,10)>=2023){const{total:J}=yield A.fetchResources();V=!!J}if(V){const J=yield A.copy({copyResources:"all",folder:K});t.id=J.id,t.portal=J.portal;const se=t.toJSON();yield t.load(),t.read(se),yield t.update({data:r})}else yield _.user?.addItem({item:t,folder:K,data:r});return V})).apply(this,arguments)}function ge(t,e,r,a,_){M.L.prototype.read.call(e,{version:a.version,authoringApp:a.authoringApp,authoringAppVersion:a.authoringAppVersion},{origin:t.origin,ignoreDefaults:!0,url:r.itemUrl?(0,O.An)(r.itemUrl):void 0}),(0,W.v)(_),e.resourceInfo=a}}}]);