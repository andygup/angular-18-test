"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[9373],{19373:(me,R,t)=>{t.r(R),t.d(R,{default:()=>le});var g,m=t(10467),n=t(8189),E=(t(21152),t(92165)),U=(t(79122),t(70176),t(92089),t(9826),t(15317),t(38582),t(96128),t(13318),t(85718)),A=t(36156),C=t(89563),D=t(90660),y=t(5922),N=t(17715),b=t(77806),V=t(35150),w=t(39693),Z=t(56492),o=t(85211),x=t(55739),j=t(17221),P=t(76576),u=t(6434),G=t(95478),J=t(25936),z=t(93410),$=t(23e3),X=t(31446),Q=t(25263),W=t(17049),Y=t(85551),B=t(1151),H=t(33036),K=t(84311),d=t(22329),k=t(39729),q=t(29141),_=t(3404),f=t(86300),ee=t(20329),te=t(73975),re=t(71065);t(3248),t(40707);let p=g=class extends re.oY{constructor(){super(...arguments),this.age=null,this.ageReceived=null,this.displayCount=null,this.maxObservations=1}clone(){return new g({age:this.age,ageReceived:this.ageReceived,displayCount:this.displayCount,maxObservations:this.maxObservations})}};(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],p.prototype,"age",void 0),(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],p.prototype,"ageReceived",void 0),(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],p.prototype,"displayCount",void 0),(0,n._)([(0,o.MZ)({type:Number,json:{write:!0}})],p.prototype,"maxObservations",void 0),p=g=(0,n._)([(0,P.$)("esri.layers.support.PurgeOptions")],p);const T=p;var ne=t(8691),oe=t(87086),ie=t(41843),se=t(88485),v=t(71655),F=t(32034),ae=t(28067);const L=(0,_.p)();function O(r,e){return new y.A("layer:unsupported",`Layer (${r.title}, ${r.id}) of type '${r.declaredClass}' ${e}`,{layer:r})}let i=class extends((0,Q.J)((0,X.F)((0,z.dM)((0,K.e)((0,H.j)((0,B.J)((0,J.b)((0,W.q)((0,Y.A)((0,w.P)((0,$.d)((0,D.O)(G.A))))))))))))){constructor(...r){var e;super(...r),e=this,this.copyright=null,this.definitionExpression=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.geometryDefinition=null,this.geometryType=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.maxReconnectionAttempts=0,this.maxReconnectionInterval=20,this.maxScale=0,this.minScale=0,this.objectIdField=null,this.operationalLayerType="ArcGISStreamLayer",this.outFields=["*"],this.popupEnabled=!0,this.popupTemplate=null,this.purgeOptions=new T,this.refreshInterval=0,this.screenSizePerspectiveEnabled=!0,this.sourceJSON=null,this.spatialReference=F.A.WGS84,this.type="stream",this.url=null,this.updateInterval=300,this.useViewTime=!0,this.webSocketUrl=null,this._debouncedSaveOperations=(0,Z.sg)(function(){var s=(0,m.A)(function*(a,l,c){const{save:S,saveAs:I}=yield Promise.all([t.e(2076),t.e(1399)]).then(t.bind(t,4069));switch(a){case v.X.SAVE:return S(e,l);case v.X.SAVE_AS:return I(e,c,l)}});return function(a,l,c){return s.apply(this,arguments)}}())}normalizeCtorArgs(r,e){return"string"==typeof r?{url:r,...e}:r}load(r){if(!("WebSocket"in globalThis))return this.addResolvingPromise(Promise.reject(new y.A("stream-layer:websocket-unsupported","WebSocket is not supported in this browser. StreamLayer will not have real-time connection with the stream service."))),Promise.resolve(this);const e=null!=r?r.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Stream Service","Feed"]},r).catch(Z.QP).then(()=>this._fetchService(e))),Promise.resolve(this)}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(r){const e=this._normalizeFeatureReduction(r);this._set("featureReduction",e)}set renderer(r){(0,f.yp)(r,this.fieldsIndex),this._set("renderer",r)}readRenderer(r,e,s){e=e.layerDefinition||e;const a=e.drawingInfo?.renderer;if(a){const l=(0,U.L)(a,e,s)||void 0;return l||V.A.getLogger(this).error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:s}),l}return(0,k.PD)(e,s)}connect(r){var e=this;return(0,m.A)(function*(){const[{createConnection:s}]=yield Promise.all([Promise.all([t.e(1277),t.e(2076),t.e(9557)]).then(t.bind(t,69809)),e.load()]),a=e.geometryType?u.g.toJSON(e.geometryType):null,{customParameters:l=null,definitionExpression:c=null,geometryDefinition:S=null,maxReconnectionAttempts:I=0,maxReconnectionInterval:de=20,spatialReference:pe=e.spatialReference}=r||e.createConnectionParameters(),h=s(e.parsedUrl,e.spatialReference,pe,a,c,S,I,de,l??void 0),ye=(0,N.vE)([e.on("send-message-to-socket",M=>h.sendMessageToSocket(M)),e.on("send-message-to-client",M=>h.sendMessageToClient(M))]);return h.once("destroy",ye.remove),h})()}createConnectionParameters(){return{spatialReference:this.spatialReference,customParameters:this.customParameters,definitionExpression:this.definitionExpression,geometryDefinition:this.geometryDefinition,maxReconnectionAttempts:this.maxReconnectionAttempts,maxReconnectionInterval:this.maxReconnectionInterval}}createPopupTemplate(r){return(0,ie.tn)(this,r)}createQuery(){const r=new oe.A;return r.returnGeometry=!0,r.outFields=["*"],r.where=this.definitionExpression||"1=1",r}getFieldDomain(r,e){if(!this.fields)return null;let s=null;return this.fields.some(a=>(a.name===r&&(s=a.domain),!!s)),s}getField(r){return this.fieldsIndex.get(r)}serviceSupportsSpatialReference(r){return!0}sendMessageToSocket(r){this.emit("send-message-to-socket",r)}sendMessageToClient(r){this.emit("send-message-to-client",r)}save(r){var e=this;return(0,m.A)(function*(){return e._debouncedSaveOperations(v.X.SAVE,r)})()}saveAs(r,e){var s=this;return(0,m.A)(function*(){return s._debouncedSaveOperations(v.X.SAVE_AS,e,r)})()}write(r,e){const s=e?.messages;return this.webSocketUrl?(s?.push(O(this,"using a custom websocket connection cannot be written to web scenes and web maps")),null):this.parsedUrl?super.write(r,e):(s?.push(O(this,"using a client-side only connection without a url cannot be written to web scenes and web maps")),null)}_fetchService(r){var e=this;return(0,m.A)(function*(){if(!e.webSocketUrl&&e.parsedUrl){if(!e.sourceJSON){const{data:s}=yield(0,C.A)(e.parsedUrl.path,{query:{f:"json",...e.customParameters,...e.parsedUrl.query},responseType:"json",signal:r});e.sourceJSON=s}}else{if(!e.timeInfo?.trackIdField)throw new y.A("stream-layer:missing-metadata","The stream layer trackIdField must be specified.");if(!e.objectIdField){const s=e.fields.find(a=>"oid"===a.type)?.name;if(!s)throw new y.A("stream-layer:missing-metadata","The stream layer objectIdField must be specified.");e.objectIdField=s}if(!e.fields)throw new y.A("stream-layer:missing-metadata","The stream layer fields must be specified.");if(e.fields.some(s=>s.name===e.objectIdField)||e.fields.push(new q.A({name:e.objectIdField,alias:e.objectIdField,type:"oid"})),!e.geometryType)throw new y.A("stream-layer:missing-metadata","The stream layer geometryType must be specified.");e.webSocketUrl&&(e.url=e.webSocketUrl)}return e.read(e.sourceJSON,{origin:"service",portalItem:e.portalItem,portal:e.portalItem?.portal,url:e.parsedUrl}),(0,f.yp)(e.renderer,e.fieldsIndex),(0,f.sv)(e.timeInfo,e.fieldsIndex),e.objectIdField||(e.objectIdField="__esri_stream_id__"),(0,ne.L)(e,{origin:"service"})})()}};(0,n._)([(0,o.MZ)({type:String})],i.prototype,"copyright",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],i.prototype,"defaultPopupTemplate",null),(0,n._)([(0,o.MZ)({type:String,json:{name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],i.prototype,"definitionExpression",void 0),(0,n._)([(0,o.MZ)({type:String})],i.prototype,"displayField",void 0),(0,n._)([(0,o.MZ)({type:se.A})],i.prototype,"elevationInfo",void 0),(0,n._)([(0,o.MZ)({json:{origins:{"web-map":{read:!1,write:!1},"portal-item":{read:!1,write:!1},"web-scene":{read:!1,write:!1}}}})],i.prototype,"featureReduction",null),(0,n._)([(0,o.MZ)(L.fields)],i.prototype,"fields",void 0),(0,n._)([(0,o.MZ)(L.fieldsIndex)],i.prototype,"fieldsIndex",void 0),(0,n._)([(0,o.MZ)({type:ae.A,json:{name:"layerDefinition.definitionGeometry",write:!0}})],i.prototype,"geometryDefinition",void 0),(0,n._)([(0,o.MZ)({type:u.g.apiValues,json:{read:{reader:u.g.read}}})],i.prototype,"geometryType",void 0),(0,n._)([(0,o.MZ)(d.kF)],i.prototype,"labelsVisible",void 0),(0,n._)([(0,o.MZ)({type:[ee.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:te.w},write:!0}})],i.prototype,"labelingInfo",void 0),(0,n._)([(0,o.MZ)(d.fV)],i.prototype,"legendEnabled",void 0),(0,n._)([(0,o.MZ)({type:["show","hide"],json:{origins:{"portal-item":{read:!1,write:!1}}}})],i.prototype,"listMode",void 0),(0,n._)([(0,o.MZ)({type:x.jz})],i.prototype,"maxReconnectionAttempts",void 0),(0,n._)([(0,o.MZ)({type:x.jz})],i.prototype,"maxReconnectionInterval",void 0),(0,n._)([(0,o.MZ)(d.hG)],i.prototype,"maxScale",void 0),(0,n._)([(0,o.MZ)(d.hn)],i.prototype,"minScale",void 0),(0,n._)([(0,o.MZ)({type:String})],i.prototype,"objectIdField",void 0),(0,n._)([(0,o.MZ)({value:"ArcGISStreamLayer",type:["ArcGISStreamLayer"]})],i.prototype,"operationalLayerType",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],i.prototype,"outFields",void 0),(0,n._)([(0,o.MZ)(d.M6)],i.prototype,"popupEnabled",void 0),(0,n._)([(0,o.MZ)({type:E.A,json:{name:"popupInfo",write:!0}})],i.prototype,"popupTemplate",void 0),(0,n._)([(0,o.MZ)({type:T})],i.prototype,"purgeOptions",void 0),(0,n._)([(0,o.MZ)({json:{read:!1,write:!1}})],i.prototype,"refreshInterval",void 0),(0,n._)([(0,o.MZ)({types:A.H,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{name:"layerDefinition.drawingInfo.renderer",types:A.X,write:!0}},write:{target:"layerDefinition.drawingInfo.renderer"}}})],i.prototype,"renderer",null),(0,n._)([(0,j.w)("service","renderer",["drawingInfo.renderer","defaultSymbol"]),(0,j.w)("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],i.prototype,"readRenderer",null),(0,n._)([(0,o.MZ)((()=>{const r=(0,b.o8)(d.PY);return r.json.origins["portal-item"]={read:!1,write:!1},r})())],i.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,o.MZ)()],i.prototype,"sourceJSON",void 0),(0,n._)([(0,o.MZ)({type:F.A,json:{origins:{service:{read:{source:"spatialReference"}}}}})],i.prototype,"spatialReference",void 0),(0,n._)([(0,o.MZ)({json:{read:!1}})],i.prototype,"type",void 0),(0,n._)([(0,o.MZ)(d.OZ)],i.prototype,"url",void 0),(0,n._)([(0,o.MZ)({type:Number})],i.prototype,"updateInterval",void 0),(0,n._)([(0,o.MZ)({json:{read:!1,write:!1}})],i.prototype,"useViewTime",void 0),(0,n._)([(0,o.MZ)({type:String})],i.prototype,"webSocketUrl",void 0),i=(0,n._)([(0,P.$)("esri.layers.StreamLayer")],i);const le=i}}]);