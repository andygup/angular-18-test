"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[3688],{28250:(Z,w,_)=>{function C(l){return null!=j(l)||null!=P(l)}function Y(l){return X.test(l)}function R(l){return j(l)??P(l)}function P(l){const f=new Date(l);return function L(l,f){if(Number.isNaN(l.getTime()))return!1;let p=!0;if(T&&/\d+\W*$/.test(f)){const B=f.match(/[a-zA-Z]{2,}/);if(B){let a=!1,h=0;for(;!a&&h<=B.length;)a=!U.test(B[h]),h++;p=!a}}return p}(f,l)?Number.isNaN(f.getTime())?null:f.getTime()-6e4*f.getTimezoneOffset():null}function j(l){const f=X.exec(l);if(!f?.groups)return null;const p=f.groups,B=+p.year,a=+p.month-1,h=+p.day,I=+(p.hours??"0"),A=+(p.minutes??"0"),S=+(p.seconds??"0");if(I>23||A>59||S>59)return null;const E=p.ms??"0",D=E?+E.padEnd(3,"0").substring(0,3):0;let F;return F=p.isUTC||!p.offsetSign?Date.UTC(B,a,h,I,A,S,D):6e4*("+"===p.offsetSign?-1:1)*(60*+p.offsetHours+ +p.offsetMinutes)+Date.UTC(B,a,h,I,A,S,D),Number.isNaN(F)?null:F}_.d(w,{Br:()=>Y,Cq:()=>C,_U:()=>R});const X=/^(?:(?<year>-?\d{4,})-(?<month>\d{2})-(?<day>\d{2}))(?:T(?<hours>\d{2}):(?<minutes>\d{2}):(?<seconds>\d{2})(?:\.(?<ms>\d+))?)?(?:(?<isUTC>Z)|(?:(?<offsetSign>\+|-)(?<offsetHours>\d{2}):(?<offsetMinutes>\d{2})))?$/,U=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,T=!Number.isNaN(new Date("technology 10").getTime())},3567:(Z,w,_)=>{_.d(w,{w:()=>j});var C=_(89952),R=(_(3248),_(12438)),P=_(17694);class j{constructor(e=9,t){this._compareMinX=p,this._compareMinY=B,this._toBBox=s=>s,this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&("function"==typeof t?this._toBBox=t:this._initFormat(t)),this.clear()}destroy(){this.clear(),F.prune(),W.prune(),o.prune(),m.prune()}all(e){L(this._data,e)}search(e,t){let s=this._data;const u=this._toBBox;if(E(e,s))for(F.clear();s;){for(let n=0,c=s.children.length;n<c;n++){const r=s.children[n],d=s.leaf?u(r):r;E(e,d)&&(s.leaf?t(r):S(e,d)?L(r,t):F.push(r))}s=F.pop()}}collides(e){let t=this._data;const s=this._toBBox;if(!E(e,t))return!1;for(F.clear();t;){for(let u=0,n=t.children.length;u<n;u++){const c=t.children[u],r=t.leaf?s(c):c;if(E(e,r)){if(t.leaf||S(e,r))return!0;F.push(c)}}t=F.pop()}return!1}load(e){if(!e.length)return this;if(e.length<this._minEntries){for(let s=0,u=e.length;s<u;s++)this.insert(e[s]);return this}let t=this._build(e.slice(0,e.length),0,e.length-1,0);if(this._data.children.length)if(this._data.height===t.height)this._splitRoot(this._data,t);else{if(this._data.height<t.height){const s=this._data;this._data=t,t=s}this._insert(t,this._data.height-t.height-1,!0)}else this._data=t;return this}insert(e){return e&&this._insert(e,this._data.height-1),this}clear(){return this._data=new x([]),this}remove(e){if(!e)return this;let t,s=this._data,u=null,n=0,c=!1;const r=this._toBBox(e);for(o.clear(),m.clear();s||o.length>0;){if(s||(s=o.pop(),u=o.data[o.length-1],n=m.pop()??0,c=!0),s.leaf&&(t=(0,C.qh)(s.children,e,s.children.length,s.indexHint),-1!==t))return s.children.splice(t,1),o.push(s),this._condense(o),this;c||s.leaf||!S(s,r)?u?(n++,s=u.children[n],c=!1):s=null:(o.push(s),m.push(n),n=0,u=s,s=s.children[0])}return this}toJSON(){return this._data}fromJSON(e){return this._data=e,this}_build(e,t,s,u){const n=s-t+1;let c=this._maxEntries;if(n<=c){const O=new x(e.slice(t,s+1));return T(O,this._toBBox),O}u||(u=Math.ceil(Math.log(n)/Math.log(c)),c=Math.ceil(n/c**(u-1)));const r=new v([]);r.height=u;const d=Math.ceil(n/c),b=d*Math.ceil(Math.sqrt(c));D(e,t,s,b,this._compareMinX);for(let O=t;O<=s;O+=b){const K=Math.min(O+b-1,s);D(e,O,K,d,this._compareMinY);for(let $=O;$<=K;$+=d){const Q=Math.min($+d-1,K);r.children.push(this._build(e,$,Q,u-1))}}return T(r,this._toBBox),r}_insert(e,t,s){const n=s?e:(0,this._toBBox)(e);o.clear();const c=function X(i,e,t,s){for(;s.push(e),!0!==e.leaf&&s.length-1!==t;){let u,n=1/0,c=1/0;for(let r=0,d=e.children.length;r<d;r++){const b=e.children[r],O=a(b),K=I(i,b)-O;K<c?(c=K,n=O<n?O:n,u=b):K===c&&O<n&&(n=O,u=b)}e=u||e.children[0]}return e}(n,this._data,t,o);for(c.children.push(e),f(c,n);t>=0&&o.data[t].children.length>this._maxEntries;)this._split(o,t),t--;!function U(i,e,t){for(let s=t;s>=0;s--)f(e.data[s],i)}(n,o,t)}_split(e,t){const s=e.data[t],u=s.children.length,n=this._minEntries;this._chooseSplitAxis(s,n,u);const c=this._chooseSplitIndex(s,n,u);if(!c)return;const r=s.children.splice(c,s.children.length-c),d=s.leaf?new x(r):new v(r);d.height=s.height,T(s,this._toBBox),T(d,this._toBBox),t?e.data[t-1].children.push(d):this._splitRoot(s,d)}_splitRoot(e,t){this._data=new v([e,t]),this._data.height=e.height+1,T(this._data,this._toBBox)}_chooseSplitIndex(e,t,s){let u,n,c;u=n=1/0;for(let r=t;r<=s-t;r++){const d=l(e,0,r,this._toBBox),b=l(e,r,s,this._toBBox),O=A(d,b),K=a(d)+a(b);O<u?(u=O,c=r,n=K<n?K:n):O===u&&K<n&&(n=K,c=r)}return c}_chooseSplitAxis(e,t,s){const u=e.leaf?this._compareMinX:p,n=e.leaf?this._compareMinY:B;this._allDistMargin(e,t,s,u)<this._allDistMargin(e,t,s,n)&&e.children.sort(u)}_allDistMargin(e,t,s,u){e.children.sort(u);const n=this._toBBox,c=l(e,0,t,n),r=l(e,s-t,s,n);let d=h(c)+h(r);for(let b=t;b<s-t;b++){const O=e.children[b];f(c,e.leaf?n(O):O),d+=h(c)}for(let b=s-t-1;b>=t;b--){const O=e.children[b];f(r,e.leaf?n(O):O),d+=h(r)}return d}_condense(e){for(let t=e.length-1;t>=0;t--){const s=e.data[t];if(0===s.children.length)if(t>0){const u=e.data[t-1],n=u.children;n.splice((0,C.qh)(n,s,n.length,u.indexHint),1)}else this.clear();else T(s,this._toBBox)}}_initFormat(e){const t=["return a"," - b",";"];this._compareMinX=new Function("a","b",t.join(e[0])),this._compareMinY=new Function("a","b",t.join(e[1])),this._toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}function L(i,e){let t=i;for(W.clear();t;){if(!0===t.leaf)for(const s of t.children)e(s);else W.pushArray(t.children);t=W.pop()??null}}function T(i,e){l(i,0,i.children.length,e,i)}function l(i,e,t,s,u){u||(u=new x([])),u.minX=1/0,u.minY=1/0,u.maxX=-1/0,u.maxY=-1/0;for(let n,c=e;c<t;c++)n=i.children[c],f(u,i.leaf?s(n):n);return u}function f(i,e){i.minX=Math.min(i.minX,e.minX),i.minY=Math.min(i.minY,e.minY),i.maxX=Math.max(i.maxX,e.maxX),i.maxY=Math.max(i.maxY,e.maxY)}function p(i,e){return i.minX-e.minX}function B(i,e){return i.minY-e.minY}function a(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function h(i){return i.maxX-i.minX+(i.maxY-i.minY)}function I(i,e){return(Math.max(e.maxX,i.maxX)-Math.min(e.minX,i.minX))*(Math.max(e.maxY,i.maxY)-Math.min(e.minY,i.minY))}function A(i,e){const t=Math.max(i.minX,e.minX),s=Math.max(i.minY,e.minY),u=Math.min(i.maxX,e.maxX),n=Math.min(i.maxY,e.maxY);return Math.max(0,u-t)*Math.max(0,n-s)}function S(i,e){return i.minX<=e.minX&&i.minY<=e.minY&&e.maxX<=i.maxX&&e.maxY<=i.maxY}function E(i,e){return e.minX<=i.maxX&&e.minY<=i.maxY&&e.maxX>=i.minX&&e.maxY>=i.minY}function D(i,e,t,s,u){const n=[e,t];for(;n.length;){const c=n.pop(),r=n.pop();if(c-r<=s)continue;const d=r+Math.ceil((c-r)/s/2)*s;(0,P.q)(i,d,r,c,u),n.push(r,d,d,c)}}const F=new R.A,W=new R.A,o=new R.A,m=new R.A({deallocator:void 0});class y{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class M extends y{constructor(){super(...arguments),this.height=1,this.indexHint=new C.vW}}class x extends M{constructor(e){super(),this.children=e,this.leaf=!0}}class v extends M{constructor(e){super(),this.children=e,this.leaf=!1}}},59894:(Z,w,_)=>{_.d(w,{F:()=>U});var C=_(3248),Y=_(3567),R=_(51995);const j={minX:0,minY:0,maxX:0,maxY:0};class U{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new Y.w(9,(0,C.A)("esri-csp-restrictions")?l=>({minX:l[0],minY:l[1],maxX:l[2],maxY:l[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const l=new Array(this._idByBounds.size);let f=0;this._idByBounds.forEach((p,B)=>{l[f++]=B}),this._indexInvalid=!1,this._index.clear(),this._index.load(l)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter(l=>this._idByBounds.has(l))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const l=(0,R.Ie)();for(const f of this._boundsById.values())f&&(l[0]=Math.min(f[0],l[0]),l[1]=Math.min(f[1],l[1]),l[2]=Math.max(f[2],l[2]),l[3]=Math.max(f[3],l[3]));return l}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(l){const f=this._boundsById.get(l);this._boundsById.delete(l),f&&(this._idByBounds.delete(f),this._indexInvalid||this._index.remove(f))}forEachInBounds(l,f){this._loadIndex(),function L(T,l,f){(function X(T){j.minX=T[0],j.minY=T[1],j.maxX=T[2],j.maxY=T[3]})(l),T.search(j,f)}(this._index,l,p=>f(this._idByBounds.get(p)))}get(l){return this._boundsById.get(l)}has(l){return this._boundsById.has(l)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(l,f){if(!this._indexInvalid){const p=this._boundsById.get(l);p&&(this._index.remove(p),this._idByBounds.delete(p))}this._boundsById.set(l,f),f&&(this._idByBounds.set(f,l),this._indexInvalid||(this._boundsToLoad.push(f),this._boundsToLoad.length>5e4&&this._loadIndex()))}}},64373:(Z,w,_)=>{_.d(w,{A:()=>p});var C=_(89952),Y=_(5922),R=_(42425),P=_(35150),j=_(2296),X=_(51995),L=_(31732),U=_(59894),T=_(95985),l=_(50690);const f=(0,j.vt)();class p{constructor(a){this.geometryInfo=a,this._boundsStore=new U.F,this._featuresById=new Map,this._markedIds=new Set,this.events=new R.A,this.featureAdapter=l.T}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let a=0;return this._featuresById.forEach(h=>{null!=h.geometry&&h.geometry.coords&&(a+=h.geometry.coords.length)}),{featureCount:this._featuresById.size,vertexCount:a/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(a){if(null==this.fullBounds)return null;const[h,I,A,S]=this.fullBounds;return{xmin:h,ymin:I,xmax:A,ymax:S,spatialReference:(0,T.ag)(a)}}add(a){this._add(a),this._emitChanged()}addMany(a){for(const h of a)this._add(h);this._emitChanged()}upsertMany(a){const h=a.map(I=>this._upsert(I));return this._emitChanged(),h.filter(C.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged()}removeById(a){const h=this._featuresById.get(a);return h?(this._remove(h),this._emitChanged(),h):null}removeManyById(a){this._boundsStore.invalidateIndex();for(const h of a){const I=this._featuresById.get(h);I&&this._remove(I)}this._emitChanged()}forEachBounds(a,h){for(const I of a){const A=this._boundsStore.get(I.objectId);A&&h((0,j.Jt)(f,A))}}getFeature(a){return this._featuresById.get(a)}has(a){return this._featuresById.has(a)}forEach(a){this._featuresById.forEach(h=>a(h))}forEachInBounds(a,h){this._boundsStore.forEachInBounds(a,I=>{h(this._featuresById.get(I))})}startMarkingUsedFeatures(){this._boundsStore.invalidateIndex(),this._markedIds.clear()}sweep(){let a=!1;this._featuresById.forEach((h,I)=>{this._markedIds.has(I)||(a=!0,this._remove(h))}),this._markedIds.clear(),a&&this._emitChanged()}_emitChanged(){this.events.emit("changed",void 0)}_add(a){if(!a)return;const h=a.objectId;if(null==h)return void P.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new Y.A("featurestore:invalid-feature","feature id is missing",{feature:a}));const I=this._featuresById.get(h);let A;if(this._markedIds.add(h),I?(a.displayId=I.displayId,A=this._boundsStore.get(h),this._boundsStore.delete(h)):null!=this.onFeatureAdd&&this.onFeatureAdd(a),!a.geometry?.coords?.length)return this._boundsStore.set(h,null),void this._featuresById.set(h,a);A=(0,L.jQ)(A??(0,X.vt)(),a.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=A&&this._boundsStore.set(h,A),this._featuresById.set(h,a)}_upsert(a){const h=a?.objectId;if(null==h)return P.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new Y.A("featurestore:invalid-feature","feature id is missing",{feature:a})),null;const I=this._featuresById.get(h);if(!I)return this._add(a),a;this._markedIds.add(h);const{geometry:A,attributes:S}=a;for(const E in S)I.attributes[E]=S[E];return A&&(I.geometry=A,this._boundsStore.set(h,(0,L.jQ)((0,X.vt)(),A,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),I}_remove(a){null!=this.onFeatureRemove&&this.onFeatureRemove(a);const h=a.objectId;return this._markedIds.delete(h),this._boundsStore.delete(h),this._featuresById.delete(h),a}}},53688:(Z,w,_)=>{_.r(w),_.d(w,{default:()=>F});var C=_(10467),Y=_(5922),R=_(61320),P=_(58701),j=_(31732),X=_(18056),L=_(64373),U=_(88840),T=_(33594),l=_(89962),f=_(51248),p=_(73258),B=_(38965),a=_(86300),h=_(22639);const I=P.KK,A={xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:P.KK},S={hasAttachments:!1,capabilities:"query, editing, create, delete, update",useStandardizedQueries:!0,supportsCoordinatesQuantization:!0,supportsReturningQueryGeometry:!0,advancedQueryCapabilities:{supportsQueryAttachments:!1,supportsStatistics:!0,supportsPercentileStatistics:!0,supportsReturningGeometryCentroid:!0,supportsQueryWithDistance:!0,supportsDistinct:!0,supportsReturningQueryExtent:!0,supportsReturningGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQueryWithResultType:!1,supportsSqlExpression:!0,supportsDisjointSpatialRel:!0}};function D(W){return(0,R.fT)(W)?null!=W.m:!!W.hasM}class F{constructor(){this._queryEngine=null,this._nextObjectId=null}destroy(){this._queryEngine?.destroy(),this._queryEngine=this._createDefaultAttributes=null}load(o){var m=this;return(0,C.A)(function*(){const y=[],{features:M}=o,x=m._inferLayerProperties(M,o.fields),v=o.fields||[],i=null!=o.hasM?o.hasM:!!x.hasM,e=null!=o.hasZ?o.hasZ:!!x.hasZ,t=!o.spatialReference&&!x.spatialReference,s=t?I:o.spatialReference||x.spatialReference,u=t?A:null,n=o.geometryType||x.geometryType,c=!n;let r=o.objectIdField||x.objectIdField,d=o.timeInfo;const b=new p.A(v);if(!c&&(t&&y.push({name:"feature-layer:spatial-reference-not-found",message:"Spatial reference not provided or found in features. Defaults to WGS84"}),!n))throw new Y.A("feature-layer:missing-property","geometryType not set and couldn't be inferred from the provided features");if(!r)throw new Y.A("feature-layer:missing-property","objectIdField not set and couldn't be found in the provided fields");if(x.objectIdField&&r!==x.objectIdField&&(y.push({name:"feature-layer:duplicated-oid-field",message:`Provided objectIdField "${r}" doesn't match the field name "${x.objectIdField}", found in the provided fields`}),r=x.objectIdField),r&&!x.objectIdField){const g=b.get(r);g?(r=g.name,g.type="esriFieldTypeOID",g.editable=!1,g.nullable=!1):v.unshift({alias:r,name:r,type:"esriFieldTypeOID",editable:!1,nullable:!1})}for(const g of v){if(null==g.name&&(g.name=g.alias),null==g.alias&&(g.alias=g.name),!g.name)throw new Y.A("feature-layer:invalid-field-name","field name is missing",{field:g});if(g.name===r&&(g.type="esriFieldTypeOID"),!B.m.jsonValues.includes(g.type))throw new Y.A("feature-layer:invalid-field-type",`invalid type for field "${g.name}"`,{field:g});null==g.length&&(g.length=(0,a._b)(g))}const O={};for(const g of v)if("esriFieldTypeOID"!==g.type&&"esriFieldTypeGlobalID"!==g.type){const N=(0,a.lD)(g);void 0!==N&&(O[g.name]=N)}if(d){if(d.startTimeField){const g=b.get(d.startTimeField);g?(d.startTimeField=g.name,g.type="esriFieldTypeDate"):d.startTimeField=null}if(d.endTimeField){const g=b.get(d.endTimeField);g?(d.endTimeField=g.name,g.type="esriFieldTypeDate"):d.endTimeField=null}if(d.trackIdField){const g=b.get(d.trackIdField);g?d.trackIdField=g.name:(d.trackIdField=null,y.push({name:"feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:d}}))}d.startTimeField||d.endTimeField||(y.push({name:"feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing or invalid",details:{timeInfo:d}}),d=null)}const K=b.dateFields.length?{timeZoneIANA:o.dateFieldsTimeZone??h.n$}:null;m._createDefaultAttributes=(0,l.Vx)(O,r);const $={warnings:y,featureErrors:[],layerDefinition:{...S,drawingInfo:(0,l.F0)(n),templates:(0,l.e2)(O),extent:u,geometryType:n,objectIdField:r,fields:v,hasZ:e,hasM:i,timeInfo:d,dateFieldsTimeReference:K},assignedObjectIds:{}};if(m._queryEngine=new T.d({fieldsIndex:p.A.fromLayerJSON({fields:v,timeInfo:d,dateFieldsTimeReference:K}),geometryType:n,hasM:i,hasZ:e,objectIdField:r,spatialReference:s,featureStore:new L.A({geometryType:n,hasM:i,hasZ:e}),timeInfo:d,cacheSpatialQueries:!0}),!M?.length)return m._nextObjectId=X.L,$;const Q=(0,X.H)(r,M);return m._nextObjectId=Q+1,yield(0,U.Nk)(M,s),m._loadInitialFeatures($,M)})()}applyEdits(o){var m=this;return(0,C.A)(function*(){const{spatialReference:y,geometryType:M}=m._queryEngine;return yield Promise.all([(0,f.$1)(y,M),(0,U.Nk)(o.adds,y),(0,U.Nk)(o.updates,y)]),m._applyEdits(o)})()}queryFeatures(o,m={}){return this._queryEngine.executeQuery(o,m.signal)}queryFeatureCount(o,m={}){return this._queryEngine.executeQueryForCount(o,m.signal)}queryObjectIds(o,m={}){return this._queryEngine.executeQueryForIds(o,m.signal)}queryExtent(o,m={}){return this._queryEngine.executeQueryForExtent(o,m.signal)}querySnapping(o,m={}){return this._queryEngine.executeQueryForSnapping(o,m.signal)}_inferLayerProperties(o,m){let y,M,x=null,v=null,i=null;for(const e of o){const t=e.geometry;if(null!=t&&(x||(x=(0,R.$B)(t)),v||(v=t.spatialReference),null==y&&(y=(0,R.fT)(W=t)?null!=W.z:!!W.hasZ),null==M&&(M=D(t)),x&&v&&null!=y&&null!=M))break}var W;if(m&&m.length){let e=null;m.some(t=>{const s="esriFieldTypeOID"===t.type,u=!t.type&&t.name&&"objectid"===t.name.toLowerCase();return e=t,s||u})&&(i=e.name)}return{geometryType:x,spatialReference:v,objectIdField:i,hasM:M,hasZ:y}}_loadInitialFeatures(o,m){var y=this;return(0,C.A)(function*(){const{geometryType:M,hasM:x,hasZ:v,objectIdField:i,spatialReference:e,featureStore:t,fieldsIndex:s}=y._queryEngine,u=[];for(const r of m){if(null!=r.uid&&(o.assignedObjectIds[r.uid]=-1),r.geometry&&M!==(0,R.$B)(r.geometry)){o.featureErrors.push((0,f.Yx)("Incorrect geometry type."));continue}const d=y._createDefaultAttributes(),b=(0,f.MB)(s,d,r.attributes,!0);b?o.featureErrors.push(b):(y._assignObjectId(d,r.attributes,!0),r.attributes=d,null!=r.uid&&(o.assignedObjectIds[r.uid]=r.attributes[i]),null!=r.geometry&&(r.geometry=(0,U.Cv)(r.geometry,r.geometry.spatialReference,e)),u.push(r))}t.addMany((0,j.Di)([],u,M,v,x,i));const{fullExtent:n,timeExtent:c}=yield y._queryEngine.fetchRecomputedExtents();if(o.layerDefinition.extent=n,c){const{start:r,end:d}=c;o.layerDefinition.timeInfo.timeExtent=[r,d]}return o})()}_applyEdits(o){var m=this;return(0,C.A)(function*(){const{adds:y,updates:M,deletes:x}=o,v={addResults:[],deleteResults:[],updateResults:[],uidToObjectId:{}};if(y?.length&&m._applyAddEdits(v,y),M?.length&&m._applyUpdateEdits(v,M),x?.length){for(const t of x)v.deleteResults.push((0,f.bP)(t));m._queryEngine.featureStore.removeManyById(x)}const{fullExtent:i,timeExtent:e}=yield m._queryEngine.fetchRecomputedExtents();return{extent:i,timeExtent:e,featureEditResults:v}})()}_applyAddEdits(o,m){const{addResults:y}=o,{geometryType:M,hasM:x,hasZ:v,objectIdField:i,spatialReference:e,featureStore:t,fieldsIndex:s}=this._queryEngine,u=[];for(const n of m){if(n.geometry&&M!==(0,R.$B)(n.geometry)){y.push((0,f.Yx)("Incorrect geometry type."));continue}const c=this._createDefaultAttributes(),r=(0,f.MB)(s,c,n.attributes);if(r)y.push(r);else{if(this._assignObjectId(c,n.attributes),n.attributes=c,null!=n.uid&&(o.uidToObjectId[n.uid]=n.attributes[i]),null!=n.geometry){const d=n.geometry.spatialReference??e;n.geometry=(0,U.Cv)((0,f.CR)(n.geometry,d),d,e)}u.push(n),y.push((0,f.bP)(n.attributes[i]))}}t.addMany((0,j.Di)([],u,M,v,x,i))}_applyUpdateEdits({updateResults:o},m){const{geometryType:y,hasM:M,hasZ:x,objectIdField:v,spatialReference:i,featureStore:e,fieldsIndex:t}=this._queryEngine;for(const s of m){const{attributes:u,geometry:n}=s,c=u?.[v];if(null==c){o.push((0,f.Yx)(`Identifier field ${v} missing`));continue}if(!e.has(c)){o.push((0,f.Yx)(`Feature with object id ${c} missing`));continue}const r=(0,j.oN)(e.getFeature(c),y,x,M);if(null!=n){if(y!==(0,R.$B)(n)){o.push((0,f.Yx)("Incorrect geometry type."));continue}const d=n.spatialReference??i;r.geometry=(0,U.Cv)((0,f.CR)(n,d),d,i)}if(u){const d=(0,f.MB)(t,r.attributes,u);if(d){o.push(d);continue}}e.add((0,j.E2)(r,y,x,M,v)),o.push((0,f.bP)(c))}}_assignObjectId(o,m,y=!1){const M=this._queryEngine.objectIdField;o[M]=y&&m&&isFinite(m[M])?m[M]:this._nextObjectId++}}},89962:(Z,w,_)=>{_.d(w,{F0:()=>j,Vx:()=>U,e2:()=>l,f:()=>f});var C=_(3248),Y=_(77806),R=_(78200),P=_(48254);function j(p){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===p||"esriGeometryMultipoint"===p?P.Cb:"esriGeometryPolyline"===p?P.yM:P.WR}}}const X=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let L=1;function U(p,B){if((0,C.A)("esri-csp-restrictions"))return()=>({[B]:null,...p});try{let a=`this${T(B)} = null;`;for(const I in p)a+=`this${T(I)} = ${JSON.stringify(p[I])};`;const h=new Function(`\n      return class AttributesClass$${L++} {\n        constructor() {\n          ${a};\n        }\n      }\n    `)();return()=>new h}catch{return()=>({[B]:null,...p})}}function T(p){return X.test(p)?`.${p}`:`["${p}"]`}function l(p={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,Y.o8)(p)}}]}function f(p,B){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:p},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:B,supportsDelete:B,supportsEditing:B,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:B,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:R.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsGeometryUpdate:B,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},51248:(Z,w,_)=>{_.d(w,{$1:()=>A,CR:()=>a,MB:()=>f,Yx:()=>L,bP:()=>T});var C=_(10467),Y=_(28250),R=_(58701),P=_(86300);class j{constructor(){this.code=null,this.description=null}}class X{constructor(D){this.error=new j,this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error.description=D}}function L(E){return new X(E)}class U{constructor(D){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=D}}function T(E){return new U(E)}const l=new Set;function f(E,D,F,W=!1){l.clear();for(const o in F){const m=E.get(o);if(!m)continue;const y=p(m,F[o]);if(l.add(m.name),m&&(W||m.editable)){const M=(0,P.CJ)(m,y);if(M)return L((0,P.uo)(M,m,y));D[m.name]=y}}for(const o of E?.requiredFields??[])if(!l.has(o.name))return L(`missing required field "${o.name}"`);return null}function p(E,D){let F=D;return(0,P.WA)(E)&&"string"==typeof D?F=parseFloat(D):(0,P.yM)(E)&&null!=D&&"string"!=typeof D?F=String(D):(0,P.vE)(E)&&"string"==typeof D&&(F=(0,Y._U)(D)),(0,P.WX)(F)}let B;function a(E,D){if(!E||!(0,R.fn)(D))return E;if("rings"in E||"paths"in E){if(null==B)throw new TypeError("geometry engine not loaded");return B.simplify(D,E)}return E}function I(){return(I=(0,C.A)(function*(){return null==B&&(B=yield Promise.all([_.e(3930),_.e(2076),_.e(2296)]).then(_.bind(_,27815))),B})).apply(this,arguments)}function A(E,D){return S.apply(this,arguments)}function S(){return S=(0,C.A)(function*(E,D){!(0,R.fn)(E)||"esriGeometryPolygon"!==D&&"esriGeometryPolyline"!==D||(yield function h(){return I.apply(this,arguments)}())}),S.apply(this,arguments)}}}]);