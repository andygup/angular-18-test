"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[5565],{61597:(G,E,t)=>{t.d(E,{v:()=>n});var e=t(10467),O=t(56151);class n{constructor(){this._serviceMetadatas=new Map,this._itemDatas=new Map}fetchServiceMetadata(c,m){var L=this;return(0,e.A)(function*(){const g=L._serviceMetadatas.get(c);if(g)return g;const v=yield(0,O.V)(c,m);return L._serviceMetadatas.set(c,v),v})()}fetchItemData(c){var m=this;return(0,e.A)(function*(){const{id:L}=c;if(!L)return null;const{_itemDatas:g}=m;if(g.has(L))return g.get(L);const v=yield c.fetchData();return g.set(L,v),v})()}fetchCustomParameters(c,m){var L=this;return(0,e.A)(function*(){const g=yield L.fetchItemData(c);return g&&"object"==typeof g&&(m?m(g):g.customParameters)||null})()}}},86537:(G,E,t)=>{t.d(E,{L:()=>v});var e=t(10467),O=t(77469),n=t(89563),a=t(5922),c=t(56492),m=t(68438),L=t(73874),g=t(46577);function v(o,h){return C.apply(this,arguments)}function C(){return C=(0,e.A)(function*(o,h){const M=(0,m.qg)(o);if(!M)throw new a.A("invalid-url","Invalid scene service url");const y={...h,sceneServerUrl:M.url.path,layerId:M.sublayer??void 0};if(y.sceneLayerItem??=(yield function N(o){return U.apply(this,arguments)}(y)),null==y.sceneLayerItem)return f(y.sceneServerUrl.replace("/SceneServer","/FeatureServer"),y);const I=yield function K(o){return P.apply(this,arguments)}(y);if(!I?.url)throw new a.A("related-service-not-found","Could not find feature service through portal item relationship");y.featureServiceItem=I;const j=yield f(I.url,y);return j.portalItem=I,j}),C.apply(this,arguments)}function U(){return U=(0,e.A)(function*(o){const h=(yield i(o)).serviceItemId;if(!h)return null;const M=new g.default({id:h,apiKey:o.apiKey}),y=yield function l(o){return u.apply(this,arguments)}(o);null!=y&&(M.portal=new L.A({url:y}));try{return M.load({signal:o.signal})}catch(I){return(0,c.QP)(I),null}}),U.apply(this,arguments)}function i(o){return A.apply(this,arguments)}function A(){return(A=(0,e.A)(function*(o){if(o.rootDocument)return o.rootDocument;const h={query:{f:"json",...o.customParameters,token:o.apiKey},responseType:"json",signal:o.signal};try{const M=yield(0,n.A)(o.sceneServerUrl,h);o.rootDocument=M.data}catch{o.rootDocument={}}return o.rootDocument})).apply(this,arguments)}function u(){return(u=(0,e.A)(function*(o){const h=O.id?.findServerInfo(o.sceneServerUrl);if(h?.owningSystemUrl)return h.owningSystemUrl;const M=o.sceneServerUrl.replace(/(.*\/rest)\/.*/i,"$1")+"/info";try{const y=(yield(0,n.A)(M,{query:{f:"json"},responseType:"json",signal:o.signal})).data.owningSystemUrl;if(y)return y}catch(y){(0,c.QP)(y)}return null})).apply(this,arguments)}function f(o,h){return S.apply(this,arguments)}function S(){return(S=(0,e.A)(function*(o,h){const M=(0,m.qg)(o);if(!M)throw new a.A("invalid-feature-service-url","Invalid feature service url");const y=M.url.path,I=h.layerId;if(null==I)return{serverUrl:y};const j=i(h),X=h.featureServiceItem?yield h.featureServiceItem.fetchData("json"):null,V=(X?.layers?.[0]||X?.tables?.[0])?.customParameters,$=x=>{const Z={query:{f:"json",...V},responseType:"json",authMode:x,signal:h.signal};return(0,n.A)(y,Z)},Y=$("anonymous").catch(()=>$("no-prompt")),[H,z]=yield Promise.all([Y,j]),J=z?.layers,B=H.data&&H.data.layers;if(!Array.isArray(B))throw new Error("expected layers array");if(Array.isArray(J)){for(let x=0;x<Math.min(J.length,B.length);x++)if(J[x].id===I)return{serverUrl:y,layerId:B[x].id}}else if(null!=I&&I<B.length)return{serverUrl:y,layerId:B[I].id};throw new Error("could not find matching associated sublayer")})).apply(this,arguments)}function P(){return(P=(0,e.A)(function*({sceneLayerItem:o,signal:h}){if(!o)return null;try{const M=(yield o.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},{signal:h})).find(I=>"Feature Service"===I.type)||null;if(!M)return null;const y=new g.default({portal:M.portal,id:M.id});return yield y.load(),y}catch(M){return(0,c.QP)(M),null}})).apply(this,arguments)}},23154:(G,E,t)=>{t.d(E,{K:()=>U,Q:()=>a});var e=t(10467),O=t(56151);const n=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);function a(i,A){return c.apply(this,arguments)}function c(){return(c=(0,e.A)(function*(i,A){const{loadContext:l,...u}=A||{},f=l?yield l.fetchServiceMetadata(i,u):yield(0,O.V)(i,u);N(f),g(f);const S={serviceJSON:f};if((f.currentVersion??0)<10.5)return S;const K=`${i}/layers`,P=l?yield l.fetchServiceMetadata(K,u):yield(0,O.V)(K,u);return N(P),g(P),S.layersJSON={layers:P.layers,tables:P.tables},S})).apply(this,arguments)}function m(i){const{type:A}=i;return!!A&&n.has(A)}function L(i){return"Table"===i.type}function g(i){i.layers=i.layers?.filter(m),i.tables=i.tables?.filter(L)}function v(i){i.type||="Feature Layer"}function C(i){i.type||="Table"}function N(i){i.layers?.forEach(v),i.tables?.forEach(C)}function U(i){switch(i){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},64833:(G,E,t)=>{t.d(E,{S:()=>O});var e=t(10467);const O={BingMapsLayer:(n=(0,e.A)(function*(){return(yield t.e(6767).then(t.bind(t,16767))).default}),function(){return n.apply(this,arguments)}),BuildingSceneLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(3647),t.e(6406),t.e(9641),t.e(401),t.e(9078),t.e(2734)]).then(t.bind(t,13305))).default});return function(){return n.apply(this,arguments)}}(),CSVLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(4015).then(t.bind(t,34015))).default});return function(){return n.apply(this,arguments)}}(),CatalogLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(1277),t.e(9377),t.e(5434),t.e(3647),t.e(143),t.e(2767),t.e(5931),t.e(3718),t.e(8512)]).then(t.bind(t,78512))).default});return function(){return n.apply(this,arguments)}}(),DimensionLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(4511)]).then(t.bind(t,94511))).default});return function(){return n.apply(this,arguments)}}(),ElevationLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(8147)]).then(t.bind(t,98147))).default});return function(){return n.apply(this,arguments)}}(),FeatureLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.resolve().then(t.bind(t,35940))).default});return function(){return n.apply(this,arguments)}}(),GeoJSONLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(8474).then(t.bind(t,88474))).default});return function(){return n.apply(this,arguments)}}(),GeoRSSLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(6337).then(t.bind(t,66337))).default});return function(){return n.apply(this,arguments)}}(),GroupLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(2429).then(t.bind(t,82429))).default});return function(){return n.apply(this,arguments)}}(),ImageryLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1277),t.e(9642),t.e(2758),t.e(3944),t.e(1375)]).then(t.bind(t,64123))).default});return function(){return n.apply(this,arguments)}}(),ImageryTileLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(9642),t.e(18),t.e(2758),t.e(9965),t.e(3944),t.e(2076),t.e(6739)]).then(t.bind(t,36739))).default});return function(){return n.apply(this,arguments)}}(),IntegratedMesh3DTilesLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(1912).then(t.bind(t,41912))).default});return function(){return n.apply(this,arguments)}}(),IntegratedMeshLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(6406),t.e(2076),t.e(2138)]).then(t.bind(t,12138))).default});return function(){return n.apply(this,arguments)}}(),KMLLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(7160)]).then(t.bind(t,27160))).default});return function(){return n.apply(this,arguments)}}(),KnowledgeGraphLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(7936),t.e(3596),t.e(13),t.e(9377),t.e(515),t.e(328),t.e(512),t.e(916)]).then(t.bind(t,20916))).default});return function(){return n.apply(this,arguments)}}(),LineOfSightLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(5357)]).then(t.bind(t,89957))).default});return function(){return n.apply(this,arguments)}}(),LinkChartLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(7936),t.e(3596),t.e(13),t.e(9377),t.e(515),t.e(328),t.e(512),t.e(497)]).then(t.bind(t,10497))).default});return function(){return n.apply(this,arguments)}}(),MapImageLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(1277),t.e(5931),t.e(5395),t.e(2076),t.e(2916)]).then(t.bind(t,39425))).default});return function(){return n.apply(this,arguments)}}(),MapNotesLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(2921)]).then(t.bind(t,72921))).default});return function(){return n.apply(this,arguments)}}(),MediaLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(3073)]).then(t.bind(t,92072))).default});return function(){return n.apply(this,arguments)}}(),OGCFeatureLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(5225),t.e(2693)]).then(t.bind(t,64368))).default});return function(){return n.apply(this,arguments)}}(),OpenStreetMapLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(2882)]).then(t.bind(t,94717))).default});return function(){return n.apply(this,arguments)}}(),OrientedImageryLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(9027).then(t.bind(t,49027))).default});return function(){return n.apply(this,arguments)}}(),PointCloudLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(6406),t.e(2076),t.e(1852)]).then(t.bind(t,1852))).default});return function(){return n.apply(this,arguments)}}(),RouteLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(709),t.e(380)]).then(t.bind(t,30380))).default});return function(){return n.apply(this,arguments)}}(),SceneLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(5434),t.e(3647),t.e(143),t.e(6406),t.e(9641),t.e(2767),t.e(401),t.e(9078),t.e(2076),t.e(3136)]).then(t.bind(t,33136))).default});return function(){return n.apply(this,arguments)}}(),StreamLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(9373).then(t.bind(t,19373))).default});return function(){return n.apply(this,arguments)}}(),SubtypeGroupLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(1943).then(t.bind(t,11943))).default});return function(){return n.apply(this,arguments)}}(),TileLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(1732),t.e(1277),t.e(5931),t.e(5395),t.e(2076),t.e(460)]).then(t.bind(t,40460))).default});return function(){return n.apply(this,arguments)}}(),UnknownLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(482).then(t.bind(t,30482))).default});return function(){return n.apply(this,arguments)}}(),UnsupportedLayer:function(){var n=(0,e.A)(function*(){return(yield t.e(2605).then(t.bind(t,42605))).default});return function(){return n.apply(this,arguments)}}(),VectorTileLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(9093),t.e(6517),t.e(2076),t.e(6989)]).then(t.bind(t,90769))).default});return function(){return n.apply(this,arguments)}}(),VideoLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(9127)]).then(t.bind(t,29127))).default});return function(){return n.apply(this,arguments)}}(),VoxelLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(6406),t.e(2076),t.e(584)]).then(t.bind(t,18203))).default});return function(){return n.apply(this,arguments)}}(),WFSLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(3650),t.e(2996)]).then(t.bind(t,3723))).default});return function(){return n.apply(this,arguments)}}(),WMSLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(9757)]).then(t.bind(t,52138))).default});return function(){return n.apply(this,arguments)}}(),WMTSLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(7438)]).then(t.bind(t,67438))).default});return function(){return n.apply(this,arguments)}}(),WebTileLayer:function(){var n=(0,e.A)(function*(){return(yield Promise.all([t.e(2076),t.e(3014)]).then(t.bind(t,75090))).default});return function(){return n.apply(this,arguments)}}()};var n},43092:(G,E,t)=>{t.d(E,{Ju:()=>v,K8:()=>U,XH:()=>C,_r:()=>a,bO:()=>c,iK:()=>N,nu:()=>i,pJ:()=>L,rc:()=>g});var e=t(10467),O=t(86537),n=t(23154);function a(l){const u={id:l.id,name:l.name},f=(0,n.K)(l.type);return"FeatureLayer"!==f&&(u.layerType=f),u}function c(l,u,f){return m.apply(this,arguments)}function m(){return(m=(0,e.A)(function*(l,u,f){if(null==l?.layers||null==l?.tables){const S=yield f.fetchServiceMetadata(u,{customParameters:L(l)?.customParameters});(l=l||{}).layers=l.layers||S?.layers?.map(a),l.tables=l.tables||S?.tables?.map(a)}return l})).apply(this,arguments)}function L(l){if(!l)return null;const{layers:u,tables:f}=l;return u?.length?u[0]:f?.length?f[0]:null}function g(l,u){return null==u?null:[...l.layers||[],...l.tables||[]].find(f=>f.id===u)}function v(l,u){return[...l.layers||[],...l.tables||[]].filter(({layerType:f})=>"FeatureLayer"===u?!f:f===u)}function C(l){return(l?.layers?.length??0)+(l?.tables?.length??0)}function N(l){switch(l){case"catalog":return"CatalogLayer";case"feature":return"FeatureLayer";case"oriented-imagery":return"OrientedImageryLayer";case"subtype-group":return"SubtypeGroupLayer"}return null}function U(l){switch(l){case"CatalogLayer":return"CatalogLayer";case"OrientedImageryLayer":return"OrientedImageryLayer";case"SubtypeGroupLayer":return"SubtypeGroupLayer"}return"FeatureLayer"}function i(l,u,f){return A.apply(this,arguments)}function A(){return(A=(0,e.A)(function*(l,u,f){if(!l?.url)return u??{};if(u??={},!u.layers){const P=yield f.fetchServiceMetadata(l.url);u.layers=P.layers?.map(a)}const{serverUrl:S,portalItem:K}=yield(0,O.L)(l.url,{sceneLayerItem:l,customParameters:L(u)?.customParameters}).catch(()=>({serverUrl:null,portalItem:null}));if(null==S)return u.tables=[],u;if(!u.tables&&K){const P=yield K.fetchData();if(P?.tables)u.tables=P.tables.map(a);else{const o=yield f.fetchServiceMetadata(S,{customParameters:L(P)?.customParameters});u.tables=o?.tables?.map(a)}}if(u.tables)for(const P of u.tables)P.url=`${S}/${P.id}`;return u})).apply(this,arguments)}},15565:(G,E,t)=>{t.r(E),t.d(E,{fromItem:()=>N,selectLayerClassPath:()=>l});var e=t(10467),O=t(5922),n=t(86537),a=t(23154),c=t(61597),m=t(58443),L=t(64833),g=t(46577),v=t(43092),C=t(69927);function N(r){return U.apply(this,arguments)}function U(){return U=(0,e.A)(function*(r){let{portalItem:s}=r;!s||s instanceof g.default||(s=new g.default(s));const d=yield function i(r){return A.apply(this,arguments)}(s);return new d.constructor({portalItem:s,...d.properties})}),U.apply(this,arguments)}function A(){return A=(0,e.A)(function*(r){yield r.load();const s=new c.v;return function f(r){return S.apply(this,arguments)}(yield l(r,s))}),A.apply(this,arguments)}function l(r,s){return u.apply(this,arguments)}function u(){return u=(0,e.A)(function*(r,s){switch(r.type){case"3DTiles Service":return{className:"IntegratedMesh3DTilesLayer"};case"CSV":return{className:"CSVLayer"};case"Feature Collection":return function I(r){return j.apply(this,arguments)}(r);case"Feature Service":return function o(r,s){return h.apply(this,arguments)}(r,s);case"Feed":case"Stream Service":return{className:"StreamLayer"};case"GeoJson":return{className:"GeoJSONLayer"};case"Group Layer":return{className:"GroupLayer"};case"Image Service":return function X(r,s){return V.apply(this,arguments)}(r,s);case"KML":return{className:"KMLLayer"};case"Map Service":return function K(r,s){return P.apply(this,arguments)}(r,s);case"Media Layer":return{className:"MediaLayer"};case"Scene Service":return function M(r,s){return y.apply(this,arguments)}(r,s);case"Vector Tile Service":return{className:"VectorTileLayer"};case"WFS":return{className:"WFSLayer"};case"WMS":return{className:"WMSLayer"};case"WMTS":return{className:"WMTSLayer"};default:throw new O.A("portal:unknown-item-type","Unknown item type '${type}'",{type:r.type})}}),u.apply(this,arguments)}function S(){return(S=(0,e.A)(function*(r){const d=L.S[r.className];return{constructor:yield d(),properties:r.properties}})).apply(this,arguments)}function P(){return P=(0,e.A)(function*(r,s){return(yield function rt(r,s){return b.apply(this,arguments)}(r,s))?{className:"TileLayer"}:{className:"MapImageLayer"}}),P.apply(this,arguments)}function h(){return(h=(0,e.A)(function*(r,s){const d=yield q(r,s);if("object"==typeof d){const{sourceJSON:p,className:D}=d,W={sourceJSON:p};return null!=d.id&&(W.layerId=d.id),{className:D||"FeatureLayer",properties:W}}return{className:"GroupLayer"}})).apply(this,arguments)}function y(){return(y=(0,e.A)(function*(r,s){const d=yield q(r,s,(0,e.A)(function*(){try{if(!r.url)return[];const{serverUrl:p}=yield(0,n.L)(r.url,{sceneLayerItem:r});return(yield s.fetchServiceMetadata(p))?.tables??[]}catch{return[]}}));if("object"==typeof d){const p={};let D;if(null!=d.id?(p.layerId=d.id,D=`${r.url}/layers/${d.id}`):D=r.url,r.typeKeywords?.length)for(const T of Object.keys(m.XX))if(r.typeKeywords.includes(T))return{className:m.XX[T]};const W=yield s.fetchServiceMetadata(D,{customParameters:yield s.fetchCustomParameters(r,T=>(0,v.pJ)(T)?.customParameters)});return{className:m.XX[W?.layerType]||"SceneLayer",properties:p}}return!1===d&&"Voxel"===(yield s.fetchServiceMetadata(r.url))?.layerType?{className:"VoxelLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function j(){return(j=(0,e.A)(function*(r){yield r.load();const s=(0,C.Y)(r,"Map Notes"),d=(0,C.Y)(r,"Markup");if(s||d)return{className:"MapNotesLayer"};if((0,C.Y)(r,"Route Layer"))return{className:"RouteLayer"};const p=yield r.fetchData();return 1===(0,v.XH)(p)?{className:"FeatureLayer"}:{className:"GroupLayer"}})).apply(this,arguments)}function V(){return(V=(0,e.A)(function*(r,s){yield r.load();const d=r.typeKeywords?.map(R=>R.toLowerCase())??[];if(d.includes("elevation 3d layer"))return{className:"ElevationLayer"};if(d.includes("tiled imagery"))return{className:"ImageryTileLayer"};const p=yield s.fetchItemData(r),D=p?.layerType;if("ArcGISTiledImageServiceLayer"===D)return{className:"ImageryTileLayer"};if("ArcGISImageServiceLayer"===D)return{className:"ImageryLayer"};const W=yield s.fetchServiceMetadata(r.url,{customParameters:yield s.fetchCustomParameters(r)}),T=W.cacheType?.toLowerCase(),Q=W.capabilities?.toLowerCase().includes("tilesonly");return"map"===T||Q?{className:"ImageryTileLayer"}:{className:"ImageryLayer"}})).apply(this,arguments)}function b(){return(b=(0,e.A)(function*(r,s){const{tileInfo:d}=yield s.fetchServiceMetadata(r.url,{customParameters:yield s.fetchCustomParameters(r)});return d})).apply(this,arguments)}function q(r,s,d){return w.apply(this,arguments)}function w(){return(w=(0,e.A)(function*(r,s,d){const{url:p,type:D}=r,W="Feature Service"===D;if(!p)return{};if(/\/\d+$/.test(p)){if(W){const R=yield s.fetchServiceMetadata(p,{customParameters:yield s.fetchCustomParameters(r,F=>(0,v.pJ)(F)?.customParameters)});return{id:R.id,className:(0,a.K)(R.type),sourceJSON:R}}return{}}yield r.load();let T=yield s.fetchItemData(r);if(W){const R=yield(0,v.bO)(T,p,s),F=k(R);if("object"==typeof F){const at=(0,v.rc)(R,F.id);F.className=(0,v.K8)(at?.layerType)}return F}if("Scene Service"===D&&(T=yield(0,v.nu)(r,T,s)),(0,v.XH)(T)>0)return k(T);const Q=yield s.fetchServiceMetadata(p);return d&&(Q.tables=yield d()),k(Q)})).apply(this,arguments)}function k(r){return 1===(0,v.XH)(r)&&{id:(0,v.pJ)(r)?.id}}},56151:(G,E,t)=>{t.d(E,{V:()=>n});var e=t(10467),O=t(89563);function n(c,m){return a.apply(this,arguments)}function a(){return(a=(0,e.A)(function*(c,m){const{data:L}=yield(0,O.A)(c,{responseType:"json",query:{f:"json",...m?.customParameters,token:m?.apiKey}});return L})).apply(this,arguments)}}}]);