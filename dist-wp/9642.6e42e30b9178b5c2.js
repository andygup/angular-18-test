"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[9642],{21980:(vt,yt,H)=>{H.d(yt,{A:()=>Mt});var ft,Z=H(8189),gt=H(5922),at=H(71065),ht=H(77806),dt=H(35150),$=H(85211),xt=H(48669),q=H(76576),ut=H(855),ot=H(96115);let it=ft=class extends at.oY{static createEmptyBand(E,D){return new(ft.getPixelArrayConstructor(E))(D)}static combineBandMasks(E){if(E.length<2)return E[0];const D=E[0].length,G=new Uint8Array(D).fill(255);for(let X=0;X<E.length;X++){const j=E[X];for(let V=0;V<D;V++)j[V]||(G[V]=0)}return G}static getPixelArrayConstructor(E){let D;switch(E){case"u1":case"u2":case"u4":case"u8":D=Uint8Array;break;case"u16":D=Uint16Array;break;case"u32":D=Uint32Array;break;case"s8":D=Int8Array;break;case"s16":D=Int16Array;break;case"s32":D=Int32Array;break;case"f32":case"c64":case"c128":case"unknown":D=Float32Array;break;case"f64":D=Float64Array}return D}constructor(E){super(E),this.width=null,this.height=null,this.pixelType="f32",this.validPixelCount=null,this.mask=null,this.maskIsAlpha=!1,this.premultiplyAlpha=!1,this.statistics=null,this.depthCount=1}castPixelType(E){if(!E)return"f32";let D=E.toLowerCase();return["u1","u2","u4"].includes(D)?D="u8":["unknown","u8","s8","u16","s16","u32","s32","f32","f64"].includes(D)||(D="f32"),D}getPlaneCount(){return this.pixels?.length}addData(E){if(!E.pixels||E.pixels.length!==this.width*this.height)throw new gt.A("pixelblock:invalid-or-missing-pixels","add data requires valid pixels array that has same length defined by pixel block width * height");this.pixels||(this.pixels=[]),this.statistics||(this.statistics=[]),this.pixels.push(E.pixels),this.statistics.push(E.statistics??new ut.z)}getAsRGBA(){const E=new ArrayBuffer(this.width*this.height*4);switch(this.pixelType){case"s8":case"s16":case"u16":case"s32":case"u32":case"f32":case"f64":this._fillFromNon8Bit(E);break;default:this._fillFrom8Bit(E)}return new Uint8ClampedArray(E)}getAsRGBAFloat(){const E=new Float32Array(this.width*this.height*4);return this._fillFrom32Bit(E),E}updateStatistics(){if(!this.pixels)return;this.statistics=this.pixels.map(G=>function mt(E,D){let G=1/0,X=-1/0;const j=E.length;let V,O=0;if(null!=D)for(V=0;V<j;V++)D[V]&&(O=E[V],G=O<G?O:G,X=O>X?O:X);else for(V=0;V<j;V++)O=E[V],G=O<G?O:G,X=O>X?O:X;return new ut.z(G,X)}(G,this.mask));const E=this.mask;let D=0;if(null!=E)for(let G=0;G<E.length;G++)E[G]&&D++;else D=this.width*this.height;this.validPixelCount=D}clamp(E){if(!E||"f64"===E||"f32"===E||!this.pixels)return;const[D,G]=(0,ot.hP)(E),X=this.pixels,j=this.width*this.height,V=X.length;let O,tt,R;const et=[];for(let Y=0;Y<V;Y++){R=ft.createEmptyBand(E,j),O=X[Y];for(let U=0;U<j;U++)tt=O[U],R[U]=tt>G?G:tt<D?D:tt;et.push(R)}this.pixels=et,this.pixelType=E}extractBands(E){const{pixels:D,statistics:G}=this;if(null==E||0===E.length||!D||0===D.length)return this;const X=D.length,j=E.some(U=>U>=D.length),V=X===E.length&&!E.some((U,v)=>U!==v);if(j||V)return this;const O=this.bandMasks?.length===X?E.map(U=>this.bandMasks[U]):void 0;let{mask:tt,validPixelCount:R}=this;const{width:et,height:Y}=this;return O?.length&&(tt=ft.combineBandMasks(O),R=tt.filter(U=>!!U).length),new ft({pixelType:this.pixelType,width:et,height:Y,mask:tt,bandMasks:O,validPixelCount:R,maskIsAlpha:this.maskIsAlpha,pixels:E.map(U=>D[U]),statistics:G&&E.map(U=>G[U])})}clone(){const E=new ft({width:this.width,height:this.height,pixelType:this.pixelType,maskIsAlpha:this.maskIsAlpha,validPixelCount:this.validPixelCount});let D;null!=this.mask&&(E.mask=new Uint8Array(this.mask)),this.bandMasks&&(E.bandMasks=this.bandMasks.map(X=>new Uint8Array(X)));const G=ft.getPixelArrayConstructor(this.pixelType);if(this.pixels&&this.pixels.length>0){E.pixels=[];const X=!!this.pixels[0].slice;for(D=0;D<this.pixels.length;D++)E.pixels[D]=X?this.pixels[D].slice(0,this.pixels[D].length):new G(this.pixels[D])}if(this.statistics)for(E.statistics=[],D=0;D<this.statistics.length;D++)E.statistics[D]=(0,ht.o8)(this.statistics[D]);return E.premultiplyAlpha=this.premultiplyAlpha,E}_fillFrom8Bit(E){const{mask:D,maskIsAlpha:G,premultiplyAlpha:X,pixels:j}=this;if(!E||!j?.length)return void dt.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");let V,O,tt,R;V=O=tt=j[0],j.length>=3?(O=j[1],tt=j[2]):2===j.length&&(O=j[1]);const et=new Uint32Array(E),Y=this.width*this.height;if(V.length===Y)if(null!=D&&D.length===Y)if(G)for(R=0;R<Y;R++){const U=D[R];if(U){const v=U/255;et[R]=X?U<<24|tt[R]*v<<16|O[R]*v<<8|V[R]*v:U<<24|tt[R]<<16|O[R]<<8|V[R]}}else for(R=0;R<Y;R++)D[R]&&(et[R]=255<<24|tt[R]<<16|O[R]<<8|V[R]);else for(R=0;R<Y;R++)et[R]=255<<24|tt[R]<<16|O[R]<<8|V[R];else dt.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.")}_fillFromNon8Bit(E){const{pixels:D,mask:G,statistics:X}=this;if(!E||!D?.length)return void dt.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The input pixel block is empty.");const j=this.pixelType;let V=1,O=0,tt=1;if(X&&X.length>0){for(const C of X)null!=C.minValue&&(O=Math.min(O,C.minValue)),null!=C.maxValue&&null!=C.minValue&&(tt=Math.max(tt,C.maxValue-C.minValue));V=255/tt}else{let C=255;"s8"===j?(O=-128,C=127):"u16"===j?C=65535:"s16"===j?(O=-32768,C=32767):"u32"===j?C=4294967295:"s32"===j?(O=-2147483648,C=2147483647):"f32"===j?(O=-34e38,C=34e38):"f64"===j&&(O=-Number.MAX_VALUE,C=Number.MAX_VALUE),V=255/(C-O)}const R=new Uint32Array(E),et=this.width*this.height;let Y,U,v,P,F;if(Y=U=v=D[0],Y.length!==et)return dt.A.getLogger(this).error("getAsRGBA()","Unable to convert to RGBA. The pixelblock is invalid.");if(D.length>=2)if(U=D[1],D.length>=3&&(v=D[2]),null!=G&&G.length===et)for(P=0;P<et;P++)G[P]&&(R[P]=255<<24|(v[P]-O)*V<<16|(U[P]-O)*V<<8|(Y[P]-O)*V);else for(P=0;P<et;P++)R[P]=255<<24|(v[P]-O)*V<<16|(U[P]-O)*V<<8|(Y[P]-O)*V;else if(null!=G&&G.length===et)for(P=0;P<et;P++)F=(Y[P]-O)*V,G[P]&&(R[P]=255<<24|F<<16|F<<8|F);else for(P=0;P<et;P++)F=(Y[P]-O)*V,R[P]=255<<24|F<<16|F<<8|F}_fillFrom32Bit(E){const{pixels:D,mask:G}=this;if(!E||!D?.length)return dt.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The input pixel block is empty.");let X,j,V,O;X=j=V=D[0],D.length>=3?(j=D[1],V=D[2]):2===D.length&&(j=D[1]);const tt=this.width*this.height;if(X.length!==tt)return dt.A.getLogger(this).error("getAsRGBAFloat()","Unable to convert to RGBA. The pixelblock is invalid.");let R=0;if(null!=G&&G.length===tt)for(O=0;O<tt;O++)E[R++]=X[O],E[R++]=j[O],E[R++]=V[O],E[R++]=1&G[O];else for(O=0;O<tt;O++)E[R++]=X[O],E[R++]=j[O],E[R++]=V[O],E[R++]=1}};(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"width",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"height",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"pixelType",void 0),(0,Z._)([(0,xt.w)("pixelType")],it.prototype,"castPixelType",null),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"validPixelCount",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"mask",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"maskIsAlpha",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"pixels",void 0),(0,Z._)([(0,$.MZ)()],it.prototype,"premultiplyAlpha",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"statistics",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"depthCount",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"noDataValues",void 0),(0,Z._)([(0,$.MZ)({json:{write:!0}})],it.prototype,"bandMasks",void 0),it=ft=(0,Z._)([(0,q.$)("esri.layers.support.PixelBlock")],it);const Mt=it},855:(vt,yt,H)=>{H.d(yt,{z:()=>Z});class Z{constructor(at=null,ht=null,dt=null){this.minValue=at,this.maxValue=ht,this.noDataValue=dt}}},96115:(vt,yt,H)=>{H.d(yt,{Sp:()=>xt,X1:()=>dt,hP:()=>ht,zw:()=>$});const Z=9999999e31,gt=2e-7,at={u1:[0,1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-34028234663852886e22,34028234663852886e22],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};function ht(q){return at[q]??[-34028234663852886e22,34028234663852886e22]}function dt(q,ut){return null==q||null==ut?"s32":q<0?q>=-128&&ut<128?"s8":q>=-32768&&ut<32768?"s16":"s32":ut<256?"u8":ut<65536?"u16":"u32"}function $(q){return(q?.startsWith("s")||q?.startsWith("u"))??!1}function xt(q,ut,ot){if(q.depthCount&&q.depthCount>1)return;const{pixels:ft,statistics:it,pixelType:mt}=q,E=q.bandMasks??[],D=q.mask??new Uint8Array(ft[0].length).fill(255),G="f32"===mt||"f64"===mt,X=ht(mt);let j=!1;for(let V=0;V<ft.length;V++){const O="number"==typeof ut?ut:ut[V];if(null==O)continue;if((it?.[V]?.minValue??X[0])>O+Number.EPSILON||(it?.[V]?.maxValue??X[1])<O-Number.EPSILON)continue;const et=E[V]||D.slice(),Y=ft[V],U=ot?.customFloatTolerance;if(G&&0!==U){let v=U;v||(v=Math.abs(O)>=Z?gt*Math.abs(O):"f32"===mt?2**-23:Number.EPSILON);for(let P=0;P<Y.length;P++)et[P]&&Math.abs(Y[P]-O)<v&&(Y[P]=0,et[P]=0,D[P]=0,j=!0)}else for(let v=0;v<Y.length;v++)et[v]&&Y[v]===O&&(Y[v]=0,et[v]=0,D[v]=0,j=!0);E[V]=et}j&&(q.bandMasks=q.bandMasks||q.pixels.length>1?E:null,q.mask=D),j&&"updateStatistics"in q&&q.updateStatistics()}},40275:(vt,yt,H)=>{H.d(yt,{$i:()=>I,AB:()=>$,Ew:()=>Mt,Hx:()=>mt,IB:()=>at,J$:()=>A,LY:()=>tt,QF:()=>_,UK:()=>it,Wb:()=>ht,Wt:()=>V,Wy:()=>q,XU:()=>j,dK:()=>X,eH:()=>ft,et:()=>dt,lD:()=>w,qL:()=>ot,z$:()=>U,z7:()=>et,zg:()=>ut});var at,ht,e,Z=H(21980),gt=H(96115);(e=at||(at={}))[e.matchAny=0]="matchAny",e[e.matchAll=1]="matchAll",function(e){e[e.bestMatch=0]="bestMatch",e[e.fail=1]="fail"}(ht||(ht={}));const dt=6;function $(e){return null!=e&&"esri.layers.support.PixelBlock"===e.declaredClass&&e.pixels&&e.pixels.length>0}function q(e){if(!e?.length||e.some(n=>!$(n)))return null;if(1===e.length)return e[0]?.clone()??null;const i=e,{width:t,height:s,pixelType:l}=i[0];if(i.some(n=>n.width!==t||n.height!==s))return null;const o=i.map(({mask:n})=>n).filter(n=>null!=n);let r=null;o.length&&(r=new Uint8Array(t*s),r.set(o[0]),o.length>1&&G(o.slice(1),r));const h=[];i.forEach(({pixels:n})=>h.push(...n));const c=i.map(({statistics:n})=>n).filter(n=>n?.length),a=[];return c.forEach(n=>a.push(...n)),new Z.A({pixelType:l,width:t,height:s,mask:r,pixels:h,statistics:a.length?a:null})}function ut(e){if(!e)return;const i=e.colormap;if(!i||0===i.length)return;const t=i.sort((p,u)=>p[0]-u[0]);let s=0;t[0][0]<0&&(s=t[0][0]);const l=Math.max(256,t[t.length-1][0]-s+1),o=new Uint8Array(4*l),r=[];let h,c=0,a=0;const n=5===t[0].length;if(l>65536)return t.forEach(p=>{r[p[0]-s]=n?p.slice(1):p.slice(1).concat([255])}),{indexed2DColormap:r,offset:s,alphaSpecified:n};if(e.fillUnspecified)for(h=t[a],c=h[0]-s;c<l;c++)o[4*c]=h[1],o[4*c+1]=h[2],o[4*c+2]=h[3],o[4*c+3]=n?h[4]:255,c===h[0]-s&&(h=a===t.length-1?h:t[++a]);else for(c=0;c<t.length;c++)h=t[c],a=4*(h[0]-s),o[a]=h[1],o[a+1]=h[2],o[a+2]=h[3],o[a+3]=n?h[4]:255;return{indexedColormap:o,offset:s,alphaSpecified:n}}function ot(e,i){if(!$(e)||!i||!i.indexedColormap&&!i.indexed2DColormap)return e;const t=e.clone(),s=t.pixels;let l=t.mask;const o=t.width*t.height;if(1!==s.length)return e;const{indexedColormap:r,indexed2DColormap:h,offset:c,alphaSpecified:a}=i;let n=0;const p=s[0],u=new Uint8Array(p.length),f=new Uint8Array(p.length),m=new Uint8Array(p.length);let x,g=0;if(r){const k=r.length-1;if(null!=l)for(n=0;n<o;n++)l[n]&&(g=4*(p[n]-c),g<c||g>k?l[n]=0:(u[n]=r[g],f[n]=r[g+1],m[n]=r[g+2],l[n]=r[g+3]));else{for(l=new Uint8Array(o),n=0;n<o;n++)g=4*(p[n]-c),g<c||g>k?l[n]=0:(u[n]=r[g],f[n]=r[g+1],m[n]=r[g+2],l[n]=r[g+3]);t.mask=l}}else if(h)if(null!=l)for(n=0;n<o;n++)l[n]&&(x=h[p[n]],u[n]=x[0],f[n]=x[1],m[n]=x[2],l[n]=x[3]);else{for(l=new Uint8Array(o),n=0;n<o;n++)x=h[p[n]],u[n]=x[0],f[n]=x[1],m[n]=x[2],l[n]=x[3];t.mask=l}return t.pixels=[u,f,m],t.statistics=null,t.pixelType="u8",t.maskIsAlpha=a,t}function ft(e,i){if(!$(e))return null;const{pixels:t,mask:s}=e,l=t.length;let o=i.lut;const{offset:r}=i;o&&1===o[0].length&&(o=t.map(()=>o));const h=[],c=i.outputPixelType||"u8";for(let n=0;n<l;n++){const p=it(t[n],s,o[n],r||0,c);h.push(p)}const a=new Z.A({width:e.width,height:e.height,pixels:h,mask:s,pixelType:c});return a.updateStatistics(),a}function it(e,i,t,s,l){const o=e.length,r=Z.A.createEmptyBand(l,o);if(i)for(let h=0;h<o;h++)i[h]&&(r[h]=t[e[h]-s]);else for(let h=0;h<o;h++)r[h]=t[e[h]-s];return r}function mt(e,i){if(!$(e))return null;const t=e.clone(),{pixels:s}=t,l=t.width*t.height,o=i.length,r=Math.floor(o/2),h=i[Math.floor(r)],c=s[0];let a,n,p,u,f,m,x=!1;const g=new Uint8Array(l),k=new Uint8Array(l),S=new Uint8Array(l);let b=t.mask;const T=4===i[0].mappedColor.length;for(b||(b=new Uint8Array(l),b.fill(T?255:1),t.mask=b),f=0;f<l;f++)if(b[f]){for(a=c[f],x=!1,m=r,n=h,p=0,u=o-1;u-p>1;){if(a===n.value){x=!0;break}a>n.value?p=m:u=m,m=Math.floor((p+u)/2),n=i[Math.floor(m)]}x||(a===i[p].value?(n=i[p],x=!0):a===i[u].value?(n=i[u],x=!0):a<i[p].value?(x=!1,n=null):a>i[p].value&&(a<i[u].value?(n=i[p],x=!0):u===o-1?(x=!1,n=null):(n=i[u],x=!0))),x?(g[f]=n.mappedColor[0],k[f]=n.mappedColor[1],S[f]=n.mappedColor[2],b[f]=n.mappedColor[3]):g[f]=k[f]=S[f]=b[f]=0}return t.pixels=[g,k,S],t.mask=b,t.pixelType="u8",t.maskIsAlpha=T,t}function Mt(e,i){if(!$(e))return null;const{width:t,height:s}=e,{inputRanges:l,outputValues:o,outputPixelType:r,noDataRanges:h,allowUnmatched:c,isLastInputRangeInclusive:a}=i,n=e.pixels[0],p=Z.A.createEmptyBand(r,n.length),u=e.mask,f=new Uint8Array(t*s);u?f.set(u):f.fill(255);const m=e.pixelType.startsWith("f")?1e-6:0,x=l.map(T=>T-m);x[0]=l[0],x[x.length-1]=l[l.length-1]+(a?1e-6:0);const g=l.length/2,[k,S]=(0,gt.hP)(r);for(let T=0;T<s;T++)for(let B=0;B<t;B++){const L=T*t+B;if(f[L]){const K=n[L];let z=!1;for(let J=g-1;J>=0;J--)if(K===x[2*J]||K>x[2*J]&&K<x[2*J+1]){p[L]=o[J],z=!0;break}z||(c?p[L]=K>S?S:K<k?k:K:f[L]=0)}}const b=h?.length;if(b)for(let T=0;T<s;T++)for(let B=0;B<t;B++){const L=T*t+B;if(!u||u[L]){const K=n[L];for(let z=0;z<b;z+=2)if(K>=h[z]&&K<=h[z+1]){p[L]=0,f[L]=0;break}}}return new Z.A({width:t,height:s,pixelType:r,pixels:[p],mask:f})}function E(e,i,t,s){const l=null!=t&&t.length>=2?new Set(t):null,o=1===t?.length?t[0]:null,r=!!i?.length;for(let h=0;h<e.length;h++)if(s[h]){const c=e[h];if(r){let a=!1;for(let n=0;n<i.length;n+=2)if(c>=i[n]&&c<=i[n+1]){a=!0;break}a||(s[h]=0)}s[h]&&(c===o||l?.has(c))&&(s[h]=0)}}function D(e,i){const t=e[0].length;for(let s=0;s<t;s++)if(i[s]){let l=!1;for(let o=0;o<e.length;o++)if(e[o][s]){l=!0;break}l||(i[s]=0)}}function G(e,i){const t=e[0].length;for(let s=0;s<t;s++)if(i[s]){let l=!1;for(let o=0;o<e.length;o++)if(0===e[o][s]){l=!0;break}l&&(i[s]=0)}}function X(e,i){if(!$(e))return null;const{width:t,height:s,pixels:l}=e,o=t*s,r=new Uint8Array(o);e.mask?r.set(e.mask):r.fill(255);const h=l.length,{includedRanges:c,noDataValues:a,outputPixelType:n,matchAll:p,lookups:u}=i;if(u){const f=[];for(let m=0;m<h;m++){const x=u[m],g=it(l[m],r,x.lut,x.offset||0,"u8");f.push(g)}1===f.length?r.set(f[0]):p?D(f,r):G(f,r)}else if(p){const f=[];for(let m=0;m<h;m++){const x=new Uint8Array(o);x.set(r),E(l[m],c?.slice(2*m,2*m+2),a?.[m],x),f.push(x)}1===f.length?r.set(f[0]):D(f,r)}else for(let f=0;f<h;f++)E(l[f],c?.slice(2*f,2*f+2),a?.[f],r);return new Z.A({width:t,height:s,pixelType:n,pixels:l,mask:r})}function j(e){const{srcPixelType:i,inputRanges:t,outputValues:s,allowUnmatched:l,noDataRanges:o,isLastInputRangeInclusive:r,outputPixelType:h}=e;if("u8"!==i&&"s8"!==i&&"u16"!==i&&"s16"!==i)return null;const c=i.includes("16")?65536:256,a=i.includes("s")?-c/2:0,n=Z.A.createEmptyBand(h,c),p=new Uint8Array(c);l&&p.fill(255);const[u,f]=(0,gt.hP)(h);if(t?.length&&s?.length){const x=t.map(g=>g-1e-6);x[0]=t[0],r&&(x[x.length-1]=t[t.length-1]);for(let g=0;g<x.length;g++){const k=s[g]>f?f:s[g]<u?u:s[g],S=Math.ceil(x[2*g]-a),b=Math.floor(x[2*g+1]-a);for(let T=S;T<=b;T++)n[T]=k,p[T]=255}}if(o?.length)for(let m=0;m<o.length;m++){const x=Math.ceil(o[2*m]-a),g=Math.floor(o[2*m+1]-a);for(let k=x;k<=g;k++)p[k]=0}return{lut:n,offset:a,mask:p}}function V(e,i,t){if("u8"!==e&&"s8"!==e&&"u16"!==e&&"s16"!==e)return null;const s=e.includes("16")?65536:256,l=e.includes("s")?-s/2:0,o=new Uint8Array(s);if(i)for(let r=0;r<i.length;r++){const h=Math.ceil(i[2*r]-l),c=Math.floor(i[2*r+1]-l);for(let a=h;a<=c;a++)o[a]=255}else o.fill(255);if(t)for(let r=0;r<t.length;r++)o[t[r]-l]=0;return{lut:o,offset:l}}function tt(e,i){if(!e||0===e.length)return null;const t=e.find(m=>m.pixelBlock);if(null==t?.pixelBlock)return null;const s=(t.extent.xmax-t.extent.xmin)/t.pixelBlock.width,l=(t.extent.ymax-t.extent.ymin)/t.pixelBlock.height,o=.01*Math.min(s,l),r=e.sort((m,x)=>Math.abs(m.extent.ymax-x.extent.ymax)>o?x.extent.ymax-m.extent.ymax:Math.abs(m.extent.xmin-x.extent.xmin)>o?m.extent.xmin-x.extent.xmin:0),h=Math.min.apply(null,r.map(m=>m.extent.xmin)),c=Math.min.apply(null,r.map(m=>m.extent.ymin)),a=Math.max.apply(null,r.map(m=>m.extent.xmax)),n=Math.max.apply(null,r.map(m=>m.extent.ymax)),p={x:Math.round((i.xmin-h)/s),y:Math.round((n-i.ymax)/l)},u={width:Math.round((a-h)/s),height:Math.round((n-c)/l)},f={width:Math.round((i.xmax-i.xmin)/s),height:Math.round((i.ymax-i.ymin)/l)};return Math.round(u.width/t.pixelBlock.width)*Math.round(u.height/t.pixelBlock.height)!==r.length||p.x<0||p.y<0||u.width<f.width||u.height<f.height?null:{extent:i,pixelBlock:et(r.map(m=>m.pixelBlock),u,{clipOffset:p,clipSize:f})}}function R(e,i,t,s,l,o){const{width:r,height:h}=t.block,{x:c,y:a}=t.offset,{width:n,height:p}=t.mosaic,u=function O(e,i,t,s,l,o,r,h){return{xmin:l<=t*e?0:l<t*e+e?l-t*e:e,ymin:o<=s*i?0:o<s*i+i?o-s*i:i,xmax:l+r<=t*e?0:l+r<t*e+e?l+r-t*e:e,ymax:o+h<=s*i?0:o+h<s*i+i?o+h-s*i:i}}(r,h,s,l,c,a,n,p);let f=0,m=0;if(o){const x=o.hasGCSSShiftTransform?360:o.halfWorldWidth??0,g=r*o.resolutionX,k=o.startX+s*g;k<x&&k+g>x?m=o.rightPadding:k>=x&&(f=o.leftMargin-o.rightPadding,m=0)}if(u.xmax-=m,"number"!=typeof i)for(let x=u.ymin;x<u.ymax;x++){const g=(l*h+x-a)*n+(s*r-c)+f,k=x*r;for(let S=u.xmin;S<u.xmax;S++)e[g+S]=i[k+S]}else for(let x=u.ymin;x<u.ymax;x++){const g=(l*h+x-a)*n+(s*r-c)+f;for(let k=u.xmin;k<u.xmax;k++)e[g+k]=i}}function et(e,i,t={}){const{clipOffset:s,clipSize:l,alignmentInfo:o,blockWidths:r}=t;if(r)return function Y(e,i,t){const s=e.find(g=>null!=g);if(null==s)return null;const l=e.some(g=>null==g||!!g.mask),{width:o,height:r}=i,h=l?new Uint8Array(o*r):null,{blockWidths:c}=t,a=[],n=s.getPlaneCount(),p=Z.A.getPixelArrayConstructor(s.pixelType);if(l)for(let g=0,k=0;g<e.length;k+=c[g],g++){const S=e[g];if(!$(S))continue;const b=S.mask;for(let T=0;T<r;T++)for(let B=0;B<c[g];B++)h[T*o+B+k]=null==b?255:b[T*S.width+B]}const u=e.some(g=>g?.bandMasks&&g.bandMasks.length>1),f=u?[]:void 0,m=o*r;for(let g=0;g<n;g++){const k=new p(m),S=u?new Uint8Array(m):void 0;for(let b=0,T=0;b<e.length;T+=c[b],b++){const B=e[b];if(!$(B))continue;const L=B.pixels[g];if(null!=L){for(let K=0;K<r;K++)for(let z=0;z<c[b];z++)k[K*o+z+T]=L[K*B.width+z];if(S){const K=B.bandMasks?.[g]??B.mask;for(let z=0;z<r;z++)for(let J=0;J<c[b];J++)S[z*o+J+T]=K?K[z*B.width+J]:255}}}a.push(k),f&&S&&f.push(S)}const x=new Z.A({width:o,height:r,mask:h,bandMasks:f,pixels:a,pixelType:s.pixelType});return x.updateStatistics(),x}(e,i,{blockWidths:r});const h=e.find(N=>$(N));if(null==h)return null;const c=l?l.width:i.width,a=l?l.height:i.height,n=h.width,p=h.height,u=i.width/n,f=i.height/p,m={offset:s||{x:0,y:0},mosaic:l||i,block:{width:n,height:p}},x=h.pixelType,g=Z.A.getPixelArrayConstructor(x),k=h.pixels.length,S=[];let b,T;for(let N=0;N<k;N++){T=new g(c*a);for(let Q=0;Q<f;Q++)for(let W=0;W<u;W++){const nt=e[Q*u+W];$(nt)&&(b=nt.pixels[N],R(T,b,m,W,Q,o))}S.push(T)}const B=e.some(N=>null==N||null!=N.mask&&N.mask.length>0),L=e.some(N=>N?.bandMasks&&N.bandMasks.length>1),K=B?new Uint8Array(c*a):void 0,z=L?[]:void 0;if(K){for(let N=0;N<f;N++)for(let Q=0;Q<u;Q++){const W=e[N*u+Q];R(K,(null!=W?W.mask:null)??(W?255:0),m,Q,N,o)}if(z)for(let N=0;N<k;N++){const Q=new Uint8Array(c*a);for(let W=0;W<f;W++)for(let nt=0;nt<u;nt++){const pt=e[W*u+nt];R(Q,pt?.bandMasks?.[N]??pt?.mask??(pt?255:0),m,nt,W,o)}z.push(Q)}}const J=new Z.A({width:c,height:a,pixels:S,pixelType:x,bandMasks:z,mask:K});return J.updateStatistics(),J}function U(e,i,t){if(!$(e))return null;const{width:s,height:l}=e,o=i.x,r=i.y,h=t.width+o,c=t.height+r;if(o<0||r<0||h>s||c>l||0===o&&0===r&&h===s&&c===l)return e;e.mask||(e.mask=new Uint8Array(s*l));const a=e.mask;for(let n=0;n<l;n++){const p=n*s;for(let u=0;u<s;u++)a[p+u]=n<r||n>=c||u<o||u>=h?0:1}return e.updateStatistics(),e}function P(e){if(0===e.size)return 0;let i=0,t=-1,s=0;const l=e.keys();let o=l.next();for(;!o.done;)s=e.get(o.value),s>i&&(t=o.value,i=s),o=l.next();return t}function F(e,i,t){if(0===t)return;const s=e.get(i);1===s?e.delete(i):e.set(i,s-1)}function C(e,i,t){0!==t&&e.set(i,e.has(i)?e.get(i)+1:1)}function d(e,i,t){let{x:s,y:l}=i;const{width:o,height:r}=t;if(0===s&&0===l&&r===e.height&&o===e.width)return e;const{width:h,height:c}=e,a=Math.max(0,l),n=Math.max(0,s),p=Math.min(s+o,h),u=Math.min(l+r,c);if(p<0||u<0||!$(e))return null;s=Math.max(0,-s),l=Math.max(0,-l);const{pixels:f}=e,m=o*r,x=f.length,g=[];for(let T=0;T<x;T++){const B=f[T],L=Z.A.createEmptyBand(e.pixelType,m);for(let K=a;K<u;K++){const z=K*h;let J=(K+l-a)*o+s;for(let N=n;N<p;N++)L[J++]=B[z+N]}g.push(L)}const k=new Uint8Array(m),S=e.mask;for(let T=a;T<u;T++){const B=T*h;let L=(T+l-a)*o+s;for(let K=n;K<p;K++)k[L++]=S?S[B+K]:1}const b=new Z.A({width:t.width,height:t.height,pixelType:e.pixelType,pixels:g,mask:k});return b.updateStatistics(),b}function M(e,i=!0){if(!$(e))return null;const{pixels:t,width:s,height:l,mask:o,pixelType:r}=e,h=[],c=Math.round(s/2),a=Math.round(l/2),n=l-1,p=s-1;for(let f=0;f<t.length;f++){const m=t[f],x=Z.A.createEmptyBand(r,c*a);let g=0;for(let k=0;k<l;k+=2)for(let S=0;S<s;S+=2){const b=m[k*s+S];if(i){const T=S===p?b:m[k*s+S+1],B=k===n?b:m[k*s+S+s];x[g++]=(b+T+B+(S===p?B:k===n?T:m[k*s+S+s+1]))/4}else x[g++]=b}h.push(x)}let u=null;if(null!=o){u=new Uint8Array(c*a);let f=0;for(let m=0;m<l;m+=2)for(let x=0;x<s;x+=2){const g=o[m*s+x];if(i){const k=x===p?g:o[m*s+x+1],S=m===n?g:o[m*s+x+s];u[f++]=g*k*S*(x===p?S:m===n?k:o[m*s+x+s+1])?1:0}else u[f++]=g}}return new Z.A({width:c,height:a,pixelType:r,pixels:h,mask:u})}function w(e,i,t=0,s=!0){if(!$(e))return null;const{width:l,height:o}=i;let{width:r,height:h}=e;const c=new Map,a={x:0,y:0},n=1+t;let p=e;for(let u=0;u<n;u++){const f=Math.ceil(r/l),m=Math.ceil(h/o);for(let x=0;x<m;x++){a.y=x*o;for(let g=0;g<f;g++){a.x=g*l;const k=d(p,a,i);c.set(`${u}/${x}/${g}`,k)}}u<n-1&&(p=M(p,s)),r=Math.round(r/2),h=Math.round(h/2)}return c}function A(e){const{pixelBlock:i,tileSize:t,level:s,row:l,col:o,useBilinear:r}=e;if(!$(i))return null;const{width:h,height:c}=t,a=2**s,n=a*h,p=a*c;let u=d(i,{y:l*p,x:o*n},{width:n,height:p});if(!u)return null;for(let f=s;f>0;f--)u=M(u,r);return u}function y(e,i,t,s,l=0){const{width:o,height:r}=e,{width:h,height:c}=i,a=s.cols,n=s.rows,p=Math.ceil(h/a-.1/a),u=Math.ceil(c/n-.1/n);let f,m,x,g,k,S,b;const T=p*a,B=T*u*n,L=new Float32Array(B),K=new Float32Array(B),z=new Uint32Array(B),J=new Uint32Array(B);let N,Q,W=0;for(let nt=0;nt<u;nt++)for(let pt=0;pt<p;pt++){f=12*(nt*p+pt),m=t[f],x=t[f+1],g=t[f+2],k=t[f+3],S=t[f+4],b=t[f+5];for(let ct=0;ct<n;ct++){W=(nt*n+ct)*T+pt*a,Q=(ct+.5)/n;for(let st=0;st<ct;st++)N=(st+.5)/a,L[W+st]=(m*N+x*Q+g)*o+l,K[W+st]=(k*N+S*Q+b)*r+l,z[W+st]=Math.floor(L[W+st]),J[W+st]=Math.floor(K[W+st])}f+=6,m=t[f],x=t[f+1],g=t[f+2],k=t[f+3],S=t[f+4],b=t[f+5];for(let ct=0;ct<n;ct++){W=(nt*n+ct)*T+pt*a,Q=(ct+.5)/n;for(let st=ct;st<a;st++)N=(st+.5)/a,L[W+st]=(m*N+x*Q+g)*o+l,K[W+st]=(k*N+S*Q+b)*r+l,z[W+st]=Math.floor(L[W+st]),J[W+st]=Math.floor(K[W+st])}}return{offsets_x:L,offsets_y:K,offsets_xi:z,offsets_yi:J,gridWidth:T}}function _(e,i){const{coefficients:t,spacing:s}=i,{offsets_x:l,offsets_y:o,gridWidth:r}=y(e,e,t,{rows:s[0],cols:s[1]}),{width:h,height:c}=e,a=new Float32Array(h*c),n=180/Math.PI;for(let p=0;p<c;p++)for(let u=0;u<h;u++){const f=p*r+u,m=0===p?f:f-r,x=p===c-1?f:f+r,g=l[m]-l[x],k=o[x]-o[m];if(isNaN(g)||isNaN(k))a[p*h+u]=90;else{let S=Math.atan2(k,g)*n;S=(360+S)%360,a[p*h+u]=S}}return a}function I(e,i,t,s,l="nearest"){if(!$(e))return null;"majority"===l&&(e=function v(e){if(!$(e))return null;const i=e.clone(),{width:t,height:s,pixels:l}=e,o=l[0],r=i.pixels[0],h=e.mask;for(let c=2;c<s-1;c++){const a=new Map;for(let p=c-2;p<c+2;p++)for(let u=0;u<4;u++){const f=p*t+u;C(a,o[f],h?h[f]:1)}r[c*t]=P(a),r[c*t+1]=r[c*t+2]=r[c*t];let n=3;for(;n<t-1;n++){let p=(c-2)*t+n+1;C(a,o[p],h?h[p]:1),p=(c-1)*t+n+1,C(a,o[p],h?h[p]:1),p=c*t+n+1,C(a,o[p],h?h[p]:1),p=(c+1)*t+n+1,C(a,o[p],h?h[p]:1),p=(c-2)*t+n-3,F(a,o[p],h?h[p]:1),p=(c-1)*t+n-3,F(a,o[p],h?h[p]:1),p=c*t+n-3,F(a,o[p],h?h[p]:1),p=(c+1)*t+n-3,F(a,o[p],h?h[p]:1),r[c*t+n]=P(a)}r[c*t+n+1]=r[c*t+n]}for(let c=0;c<t;c++)r[c]=r[t+c]=r[2*t+c],r[(s-1)*t+c]=r[(s-2)*t+c];return i.updateStatistics(),i}(e));const{pixels:o,mask:r,bandMasks:h,pixelType:c}=e,a=e.width,n=e.height,p=Z.A.getPixelArrayConstructor(c),u=o.length,{width:f,height:m}=i;let x=!1;for(let W=0;W<t.length;W+=3)-1===t[W]&&-1===t[W+1]&&-1===t[W+2]&&(x=!0);const{offsets_x:g,offsets_y:k,offsets_xi:S,offsets_yi:b,gridWidth:T}=y({width:a,height:n},i,t,s,"majority"===l?.5:0);let B;const L=(W,nt,pt,ct)=>{const st=W instanceof Float32Array||W instanceof Float64Array?0:.5;for(let lt=0;lt<m;lt++){B=lt*T;for(let rt=0;rt<f;rt++){if(g[B]<0||k[B]<0)W[lt*f+rt]=0;else if(ct)W[lt*f+rt]=nt[S[B]+b[B]*a];else{const _t=Math.floor(g[B]),wt=Math.floor(k[B]),At=Math.ceil(g[B]),kt=Math.ceil(k[B]),Pt=g[B]-_t,bt=k[B]-wt;W[lt*f+rt]=!pt||pt[_t+wt*a]&&pt[At+wt*a]&&pt[_t+kt*a]&&pt[At+kt*a]?(1-bt)*((1-Pt)*nt[_t+wt*a]+Pt*nt[At+wt*a])+bt*((1-Pt)*nt[_t+kt*a]+Pt*nt[At+kt*a])+st:nt[S[B]+b[B]*a]}B++}}},K=[];let z;const J=h?.length===u,N=[];for(let W=0;W<u;W++){if(J){const nt=new Uint8Array(f*m);L(nt,h[W],h[W],!0),N.push(nt)}z=new p(f*m),L(z,o[W],J?h[W]:r,"nearest"===l||"majority"===l),K.push(z)}const Q=new Z.A({width:f,height:m,pixelType:c,pixels:K,bandMasks:J?N:void 0});if(null!=r)Q.mask=new Uint8Array(f*m),L(Q.mask,r,r,!0);else if(x){Q.mask=new Uint8Array(f*m);for(let W=0;W<f*m;W++)Q.mask[W]=g[W]<0||k[W]<0?0:1}return Q.updateStatistics(),Q}},50444:(vt,yt,H)=>{H.d(yt,{$Q:()=>E,FI:()=>mt,KL:()=>q,Lu:()=>ot,MD:()=>xt,Rn:()=>Mt,Ud:()=>P,Wu:()=>C,Y2:()=>it,gf:()=>F});var Z=H(49976),gt=H(21980),at=H(40275);const ht=new Map;ht.set("meter-per-second",1),ht.set("kilometer-per-hour",.277778),ht.set("knots",.514444),ht.set("feet-per-second",.3048),ht.set("mile-per-hour",.44704);const dt=180/Math.PI,$=5,xt=new Z.J({esriMetersPerSecond:"meter-per-second",esriKilometersPerHour:"kilometer-per-hour",esriKnots:"knots",esriFeetPerSecond:"feet-per-second",esriMilesPerHour:"mile-per-hour"});function q(d,M){return ht.get(d)/ht.get(M)||1}function ut(d){return(450-d)%360}function ot(d,M="geographic"){const[w,A]=d,y=Math.sqrt(w*w+A*A);let _=Math.atan2(A,w)*dt;return _=(360+_)%360,"geographic"===M&&(_=ut(_)),[y,_]}function ft(d,M="geographic"){let w=d[1];"geographic"===M&&(w=ut(w)),w%=360;const A=d[0];return[A*Math.cos(w/dt),A*Math.sin(w/dt)]}function it(d,M,w,A="geographic"){if(!(0,at.AB)(d)||null==w)return d;const y="vector-magdir"===M?d.clone():mt(d,M),_=y.pixels[1];for(let I=0;I<_.length;I++)_[I]="geographic"===A?(_[I]+w[I]+270)%360:(_[I]+360-w[I])%360;return"vector-magdir"===M?y:mt(y,"vector-magdir")}function mt(d,M,w="geographic",A=1){if(!(0,at.AB)(d))return d;const{pixels:y,width:_,height:I}=d,e=_*I,i=y[0],t=y[1],s=d.pixelType.startsWith("f")?d.pixelType:"f32",l=gt.A.createEmptyBand(s,e),o=gt.A.createEmptyBand(s,e);let r=0;for(let c=0;c<I;c++)for(let a=0;a<_;a++)"vector-uv"===M?([l[r],o[r]]=ot([i[r],t[r]],w),l[r]*=A):([l[r],o[r]]=ft([i[r],t[r]],w),l[r]*=A,o[r]*=A),r++;const h=new gt.A({pixelType:s,width:d.width,height:d.height,mask:d.mask,validPixelCount:d.validPixelCount,maskIsAlpha:d.maskIsAlpha,pixels:[l,o]});return h.updateStatistics(),h}function Mt(d,M,w=1){if(1===w||!(0,at.AB)(d))return d;const A=d.clone(),{pixels:y,width:_,height:I}=A,e=y[0],i=y[1];let t=0;for(let s=0;s<I;s++)for(let l=0;l<_;l++)"vector-uv"===M?(e[t]*=w,i[t]*=w):e[t]*=w,t++;return A.updateStatistics(),A}function E(d,M,w,A,y){if(null==y||!y.spatialReference.equals(d.spatialReference))return{extent:d,width:Math.round(M/A),height:Math.round(w/A),resolution:d.width/M};const _=y.xmin,I=y.ymax,e=(d.xmax-d.xmin)/M*A,i=(d.ymax-d.ymin)/w*A,t=(e+i)/2;return d.xmin=_+Math.floor((d.xmin-_)/e)*e,d.xmax=_+Math.ceil((d.xmax-_)/e)*e,d.ymin=I+Math.floor((d.ymin-I)/i)*i,d.ymax=I+Math.ceil((d.ymax-I)/i)*i,{extent:d,width:Math.round(d.width/e),height:Math.round(d.height/i),resolution:t}}const D=G(0,0,0);function G(d=0,M=0,w=Math.PI,A=!0){A&&(w=(2*Math.PI-w)%(2*Math.PI));const y=A?-1:1,_=13*y,I=-7*y,e=-2*y,i=-16*y,t=21.75,[s,l]=j(0,M+_,w,t),[o,r]=j(d-5.5,M+I,w,t),[h,c]=j(d+5.5,M+I,w,t),[a,n]=j(d-1.5,M+e,w,t),[p,u]=j(d+1.5,M+e,w,t),[f,m]=j(d-1.5,M+i,w,t),[x,g]=j(d+1.5,M+i,w,t);return[s,l,o,r,a,n,p,u,h,c,f,m,x,g]}function X(d=0,M=Math.PI,w=!0){w&&(M=(2*Math.PI-M)%(2*Math.PI));const y=w?-1:1,_=5*y,I=20*y,e=25*y,i=45,r=2*y,h=w?1:-1,c=5*h;let[a,n]=[0+c,0-I],[p,u]=[a+2*h,n],[f,m]=[p-0*h,u+r],[x,g]=[0-c,0-e],[k,S]=[x+0*h,g-r],b=Math.ceil(d/$),T=Math.floor(b/10);b-=8*T;const B=[],L=[];for(let st=0;st<b/2;st++,T--){T<=0&&b%2==1&&st===(b-1)/2&&(x=0,k=x+0*h,g=(g+n)/2,S=g-r);const[lt,rt]=j(x,g,M,i);if(T>0){const[_t,wt]=j(p,g,M,i),[At,kt]=j(a,n,M,i);B.push(_t),B.push(wt),B.push(lt),B.push(rt),B.push(At),B.push(kt)}else{const[_t,wt]=j(p,u,M,i),[At,kt]=j(f,m,M,i),[Pt,bt]=j(k,S,M,i);L.push(lt),L.push(rt),L.push(Pt),L.push(bt),L.push(At),L.push(kt),L.push(_t),L.push(wt)}g+=_,n+=_,u+=_,m+=_,S+=_}const[K,z]=j(0+c,0+I,M,i),J=7*h,[N,Q]=j(0+J,0+I,M,i),[W,nt]=j(0+c,0-e,M,i),[pt,ct]=j(0+J,0-e,M,i);return{pennants:B,barbs:L,shaft:[K,z,N,Q,W,nt,pt,ct]}}function j(d,M,w,A=1){const y=Math.sqrt(d*d+M*M)/A,_=(2*Math.PI+Math.atan2(M,d))%(2*Math.PI);return[y,(2*Math.PI+_-w)%(2*Math.PI)]}const V=[0,1,3,6,10,16,21,27,33,40,47,55,63],O=[0,.5,1,1.5,2],tt=[0,.25,.5,1,1.5,2,2.5,3,3.5,4];function R(d,M,w,A){const y=q(A||"knots",w);let _;for(_=1;_<M.length;_++)if(_===M.length-1){if(d<M[_]*y)break}else if(d<=M[_]*y)break;return Math.min(_-1,M.length-2)}function et(d,M,w,A,y){let _=0;switch(M){case"beaufort_kn":_=R(d,V,"knots",w);break;case"beaufort_km":_=R(d,V,"kilometer-per-hour",w);break;case"beaufort_ft":_=R(d,V,"feet-per-second",w);break;case"beaufort_m":_=R(d,V,"meter-per-second",w);break;case"classified_arrow":_=R(d,y??[],A,w);break;case"ocean_current_m":_=R(d,O,"meter-per-second",w);break;case"ocean_current_kn":_=R(d,tt,"knots",w)}return _}const U=[];function P(d,M){let A=0,y=0;const{width:_,height:I,mask:e}=d,i=d.pixels[0],t=[],s=[],l=q(xt.fromJSON(M.inputUnit),"knots"),o="wind_speed"===M.style?$:Number.MAX_VALUE;for(let r=0;r<I;r++)for(let h=0;h<_;h++){const c=i[r*_+h]*l;if((!e||e[r*_+h])&&c<o){for(let n=0;n<4;n++)t[A++]=(h+.5)/_,t[A++]=(r+.5)/I,t[A++]=n<2?-.5:.5,t[A++]=n%2==0?-.5:.5,t[A++]=0,t[A++]=c;const a=4*(A/24-1);s[y++]=a,s[y++]=a+1,s[y++]=a+2,s[y++]=a+1,s[y++]=a+2,s[y++]=a+3}}return{vertexData:new Float32Array(t),indexData:new Uint32Array(s)}}function F(d,M){return"simple_scalar"===M.style?P(d,M):"wind_speed"===M.style?function v(d,M){if(0===U.length)for(let r=0;r<30;r++)U.push(X(5*r,0,!M.invertDirection));const w=q(xt.fromJSON(M.inputUnit),"knots"),{width:A,height:y,mask:_}=d,I=d.pixels[0],e=d.pixels[1],t=[],s=[];let l=0,o=0;for(let r=0;r<y;r++)for(let h=0;h<A;h++){const c=r*A+h,a=I[c]*w;if((!_||_[r*A+h])&&a>=$){const n=(e[c]+360)%360/180*Math.PI,{pennants:p,barbs:u,shaft:f}=U[Math.min(Math.floor(a/5),29)];if(p.length+u.length===0)continue;let m=t.length/6;const x=(h+.5)/A,g=(r+.5)/y;for(let k=0;k<p.length;k+=2)t[l++]=x,t[l++]=g,t[l++]=p[k],t[l++]=p[k+1]+n,t[l++]=0,t[l++]=a;for(let k=0;k<u.length;k+=2)t[l++]=x,t[l++]=g,t[l++]=u[k],t[l++]=u[k+1]+n,t[l++]=0,t[l++]=a;for(let k=0;k<f.length;k+=2)t[l++]=x,t[l++]=g,t[l++]=f[k],t[l++]=f[k+1]+n,t[l++]=0,t[l++]=a;for(let k=0;k<p.length/6;k++)s[o++]=m,s[o++]=m+1,s[o++]=m+2,m+=3;for(let k=0;k<u.length/8;k++)s[o++]=m,s[o++]=m+1,s[o++]=m+2,s[o++]=m+1,s[o++]=m+2,s[o++]=m+3,m+=4;s[o++]=m+0,s[o++]=m+1,s[o++]=m+2,s[o++]=m+1,s[o++]=m+3,s[o++]=m+2,m+=4}}return{vertexData:new Float32Array(t),indexData:new Uint32Array(s)}}(d,M):function Y(d,M){const{style:w,inputUnit:A,outputUnit:y,breakValues:_}=M,I=xt.fromJSON(A),e=xt.fromJSON(y);let s=0,l=0;const{width:o,height:r,mask:h}=d,c=d.pixels[0],a=d.pixels[1],n=null!=h?h.filter(m=>m>0).length:o*r,p=new Float32Array(42*n),u=new Uint32Array(15*n),f=M.invertDirection?G(0,0,0,!1):D;for(let m=0;m<r;m++)for(let x=0;x<o;x++){const g=m*o+x;if(!h||h[m*o+x]){const k=(a[g]+360)%360/180*Math.PI,S=et(c[g],w,I,e,_);for(let T=0;T<f.length;T+=2)p[s++]=(x+.5)/o,p[s++]=(m+.5)/r,p[s++]=f[T],p[s++]=f[T+1]+k,p[s++]=S,p[s++]=c[g];const b=7*(s/42-1);u[l++]=b,u[l++]=b+1,u[l++]=b+2,u[l++]=b+0,u[l++]=b+4,u[l++]=b+3,u[l++]=b+0,u[l++]=b+2,u[l++]=b+3,u[l++]=b+2,u[l++]=b+5,u[l++]=b+3,u[l++]=b+5,u[l++]=b+6,u[l++]=b+3}}return{vertexData:p,indexData:u}}(d,M)}function C(d,M,w,A=[0,0],y=.5){const{width:_,height:I,mask:e}=d,[i,t]=d.pixels,[s,l]=A,o=Math.round((_-s)/w),r=Math.round((I-l)/w),h=o*r,c=new Float32Array(h),a=new Float32Array(h),n=new Uint8Array(h),p="vector-uv"===M;for(let f=0;f<r;f++)for(let m=0;m<o;m++){let x=0;const g=f*o+m,k=Math.max(0,f*w+l),S=Math.max(0,m*w+s),b=Math.min(I,k+w),T=Math.min(_,S+w);for(let B=k;B<b;B++)for(let L=S;L<T;L++){const K=B*_+L;if(!e||e[K]){x++;const z=p?[i[K],t[K]]:[i[K],(360+t[K])%360],[J,N]=p?z:ft(z);c[g]+=J,a[g]+=N}}if(x>=(b-k)*(T-S)*(1-y)){n[g]=1;const[B,L]=ot([c[g]/x,a[g]/x]);c[g]=B,a[g]=L}else n[g]=0,c[g]=0,a[g]=0}const u=new gt.A({width:o,height:r,pixels:[c,a],mask:n});return u.updateStatistics(),u}},91551:(vt,yt,H)=>{H.d(yt,{CW:()=>it,pH:()=>tt});var Z=H(10467),at=(H(21152),H(3248)),ht=H(35150),dt=H(69287),$=H(56492),xt=H(40707),q=H(58701),ut=H(28067);const ot=()=>ht.A.getLogger("esri.views.2d.engine.flow.dataUtils"),ft=10;function it(U,v,P,F){return mt.apply(this,arguments)}function mt(){return(mt=(0,Z.A)(function*(U,v,P,F){const C=performance.now(),d=function Mt(U,v){const P=function G(U,v,P,F){if(0===F)return U;const C=Math.round(3*F),d=new Array(2*C+1);let M=0;for(let y=-C;y<=C;y++){const _=Math.exp(-y*y/(F*F));d[y+C]=_,M+=_}for(let y=-C;y<=C;y++)d[y+C]/=M;const w=new Float32Array(U.length);for(let y=0;y<P;y++)for(let _=0;_<v;_++){let I=0,e=0;for(let i=-C;i<=C;i++){if(_+i<0||_+i>=v)continue;const t=d[i+C];I+=t*U[2*(y*v+(_+i))],e+=t*U[2*(y*v+(_+i))+1]}w[2*(y*v+_)]=I,w[2*(y*v+_)+1]=e}const A=new Float32Array(U.length);for(let y=0;y<v;y++)for(let _=0;_<P;_++){let I=0,e=0;for(let i=-C;i<=C;i++){if(_+i<0||_+i>=P)continue;const t=d[i+C];I+=t*w[2*((_+i)*v+y)],e+=t*w[2*((_+i)*v+y)+1]}A[2*(_*v+y)]=I,A[2*(_*v+y)+1]=e}return A}(v.data,v.width,v.height,U.smoothing);return U.interpolate?(F,C)=>{const d=Math.floor(F),M=Math.floor(C);if(d<0||d>=v.width)return[0,0];if(M<0||M>=v.height)return[0,0];const w=F-d,A=C-M,I=d<v.width-1?d+1:d,e=M<v.height-1?M+1:M;return[(P[2*(M*v.width+d)]*(1-A)+P[2*(e*v.width+d)]*A)*(1-w)+(P[2*(M*v.width+I)]*(1-A)+P[2*(e*v.width+I)]*A)*w,(P[2*(M*v.width+d)+1]*(1-A)+P[2*(e*v.width+d)+1]*A)*(1-w)+(P[2*(M*v.width+I)+1]*(1-A)+P[2*(e*v.width+I)+1]*A)*w]}:(F,C)=>{const d=Math.round(F),M=Math.round(C);return d<0||d>=v.width||M<0||M>=v.height?[0,0]:[P[2*(M*v.width+d)],P[2*(M*v.width+d)+1]]}}(v,P),M=performance.now(),w=function D(U,v,P,F){const C=[],d=new xt.A,M=1/Math.max(U.lineCollisionWidth,1),w=Math.round(P*M),A=Math.round(F*M),y=new Int32Array(w*A);for(let I=0;I<y.length;I++)y[I]=-1;const _=[];for(let I=0;I<F;I+=U.lineSpacing)for(let e=0;e<P;e+=U.lineSpacing)_.push({x:e,y:I,sort:d.getFloat()});_.sort((I,e)=>I.sort-e.sort);for(const{x:I,y:e}of _)if(d.getFloat()<U.density){const i=E(U,v,I,e,C.length,y,w,A,M);if(i.length<2)continue;C.push(i)}return C}(v,d,P.width,P.height),A=performance.now(),y=function X(U,v){const P=new xt.A,F=U.reduce((A,y)=>A+y.length,0),C=new Float32Array(4*F),d=new Array(U.length);let M=0,w=0;for(const A of U){const y=M;for(const _ of A)C[4*M]=_.x,C[4*M+1]=_.y,C[4*M+2]=_.t,C[4*M+3]=_.speed,M++;d[w++]={startVertex:y,numberOfVertices:A.length,totalTime:A[A.length-1].t,timeSeed:v?P.getFloat():0}}return{lineVertices:C,lineDescriptors:d}}(w,!0),_=performance.now(),I="Streamlines"===U?function j(U,v){const{lineVertices:F,lineDescriptors:C}=U;let d=0,M=0;for(const i of C)d+=2*i.numberOfVertices,M+=6*(i.numberOfVertices-1);const w=new Float32Array(9*d),A=new Uint32Array(M);let y=0,_=0;function e(i,t,s,l,o,r,h,c){const a=9*y;let n=0;w[a+n++]=i,w[a+n++]=t,w[a+n++]=1,w[a+n++]=s,w[a+n++]=r,w[a+n++]=h,w[a+n++]=l/2,w[a+n++]=o/2,w[a+n++]=c,y++,w[a+n++]=i,w[a+n++]=t,w[a+n++]=-1,w[a+n++]=s,w[a+n++]=r,w[a+n++]=h,w[a+n++]=-l/2,w[a+n++]=-o/2,w[a+n++]=c,y++}for(const i of C){const{totalTime:t,timeSeed:s}=i;let l=null,o=null,r=null,h=null,c=null,a=null;for(let n=0;n<i.numberOfVertices;n++){const p=F[4*(i.startVertex+n)],u=F[4*(i.startVertex+n)+1],f=F[4*(i.startVertex+n)+2],m=F[4*(i.startVertex+n)+3];let x=null,g=null,k=null,S=null;if(n>0){x=p-l,g=u-o;const b=Math.sqrt(x*x+g*g);if(x/=b,g/=b,n>1){let T=x+c,B=g+a;const L=Math.sqrt(T*T+B*B);T/=L,B/=L;const K=Math.min(1/(T*x+B*g),v);T*=K,B*=K,k=-B,S=T}else k=-g,S=x;null!==k&&null!==S&&(e(l,o,r,k,S,t,s,m),A[_++]=y-2,A[_++]=y,A[_++]=y-1,A[_++]=y,A[_++]=y+1,A[_++]=y-1)}l=p,o=u,r=f,c=x,a=g,h=m}e(l,o,r,-a,c,t,s,h)}return{vertexData:w,indexData:A}}(y,ft):function V(U){const{lineVertices:C,lineDescriptors:d}=U;let M=0,w=0;for(const b of d){const T=b.numberOfVertices-1;M+=4*T*2,w+=6*T*2}const A=new Float32Array(16*M),y=new Uint32Array(w);let _,I,e,i,t,s,l,o,r,h,c,a,n,p,u=0,f=0;function g(b,T){let B=r+c,L=h+a;const K=Math.sqrt(B*B+L*L);B/=K,L/=K;const z=r*B+h*L;B/=z,L/=z;let J=c+n,N=a+p;const Q=Math.sqrt(J*J+N*N);J/=Q,N/=Q;const W=c*J+a*N;J/=W,N/=W,function x(b,T,B,L,K,z,J,N,Q,W,nt,pt,ct,st){const lt=16*u;let rt=0;for(const _t of[1,2])for(const wt of[1,2,3,4])A[lt+rt++]=b,A[lt+rt++]=T,A[lt+rt++]=B,A[lt+rt++]=L,A[lt+rt++]=J,A[lt+rt++]=N,A[lt+rt++]=Q,A[lt+rt++]=W,A[lt+rt++]=_t,A[lt+rt++]=wt,A[lt+rt++]=ct,A[lt+rt++]=st,A[lt+rt++]=K/2,A[lt+rt++]=z/2,A[lt+rt++]=nt/2,A[lt+rt++]=pt/2,u++}(_,I,e,i,-L,B,t,s,l,o,-N,J,b,T),function m(){y[f++]=u-8,y[f++]=u-7,y[f++]=u-6,y[f++]=u-7,y[f++]=u-5,y[f++]=u-6,y[f++]=u-4,y[f++]=u-3,y[f++]=u-2,y[f++]=u-3,y[f++]=u-1,y[f++]=u-2}()}function k(b,T,B,L,K,z){if(r=c,h=a,c=n,a=p,null==r&&null==h&&(r=c,h=a),null!=t&&null!=s){n=b-t,p=T-s;const J=Math.sqrt(n*n+p*p);n/=J,p/=J}null!=r&&null!=h&&g(K,z),_=t,I=s,e=l,i=o,t=b,s=T,l=B,o=L}function S(b,T){r=c,h=a,c=n,a=p,null==r&&null==h&&(r=c,h=a),null!=r&&null!=h&&g(b,T)}for(const b of d){_=null,I=null,e=null,i=null,t=null,s=null,l=null,o=null,r=null,h=null,c=null,a=null,n=null,p=null;const{totalTime:T,timeSeed:B}=b;for(let L=0;L<b.numberOfVertices;L++)k(C[4*(b.startVertex+L)],C[4*(b.startVertex+L)+1],C[4*(b.startVertex+L)+2],C[4*(b.startVertex+L)+3],T,B);S(T,B)}return{vertexData:A,indexData:y}}(y),e=performance.now();return(0,at.A)("esri-2d-profiler")&&(ot().info("I.1","_createFlowFieldFromData (ms)",Math.round(M-C)),ot().info("I.2","_getStreamlines (ms)",Math.round(A-M)),ot().info("I.3","createAnimatedLinesData (ms)",Math.round(_-A)),ot().info("I.4","create{Streamlines|Particles}Mesh (ms)",Math.round(e-_)),ot().info("I.5","createFlowMesh (ms)",Math.round(e-C)),ot().info("I.6","Mesh size (bytes)",I.vertexData.buffer.byteLength+I.indexData.buffer.byteLength)),yield Promise.resolve(),(0,$.Te)(F),I})).apply(this,arguments)}function E(U,v,P,F,C,d,M,w,A){const y=[];let _=P,I=F,e=0,[i,t]=v(_,I);i*=U.velocityScale,t*=U.velocityScale;const s=Math.sqrt(i*i+t*t);let l,o;y.push({x:_,y:I,t:e,speed:s});for(let r=0;r<U.verticesPerLine;r++){let[h,c]=v(_,I);h*=U.velocityScale,c*=U.velocityScale;const a=Math.sqrt(h*h+c*c);if(a<U.minSpeedThreshold)return y;const n=h/a,p=c/a;if(_+=n*U.segmentLength,I+=p*U.segmentLength,e+=U.segmentLength/a,Math.acos(n*l+p*o)>U.maxTurnAngle)return y;if(U.collisions){const u=Math.round(_*A),f=Math.round(I*A);if(u<0||u>M-1||f<0||f>w-1)return y;const m=d[f*M+u];if(-1!==m&&m!==C)return y;d[f*M+u]=C}y.push({x:_,y:I,t:e,speed:a}),l=n,o=p}return y}function O(U,v){const P=v.pixels,{width:F,height:C}=v,d=new Float32Array(F*C*2),M=v.mask||new Uint8Array(F*C*2);if(v.mask||M.fill(255),"vector-uv"===U)for(let w=0;w<F*C;w++)d[2*w]=P[0][w],d[2*w+1]=-P[1][w];else if("vector-magdir"===U)for(let w=0;w<F*C;w++){const A=P[0][w],y=(0,dt.kU)(P[1][w]),_=Math.cos(y-Math.PI/2),I=Math.sin(y-Math.PI/2);d[2*w]=_*A,d[2*w+1]=I*A}return{data:d,mask:M,width:F,height:C}}function tt(U,v,P,F,C,d){return R.apply(this,arguments)}function R(){return(R=(0,Z.A)(function*(U,v,P,F,C,d){const M=performance.now(),w=(0,q.Vp)(v.spatialReference);if(!w){const c=yield et(U,v,P,F,C,d);return(0,at.A)("esri-2d-profiler")&&ot().info("I.7","loadImagery, early exit (ms)",Math.round(performance.now()-M)),(0,at.A)("esri-2d-profiler")&&ot().info("I.9","Number of parts",1),c}const[A,y]=w.valid,I=Math.ceil(v.width/(y-A)),e=v.width/I,i=Math.round(P/I);let t=v.xmin;const s=[],l=performance.now();for(let c=0;c<I;c++){const a=new ut.A({xmin:t,xmax:t+e,ymin:v.ymin,ymax:v.ymax,spatialReference:v.spatialReference});s.push(et(U,a,i,F,C,d)),t+=e}const o=yield Promise.all(s);(0,at.A)("esri-2d-profiler")&&ot().info("I.8","All calls to _fetchPart (ms)",Math.round(performance.now()-l)),(0,at.A)("esri-2d-profiler")&&ot().info("I.9","Number of parts",o.length);const r={data:new Float32Array(P*F*2),mask:new Uint8Array(P*F),width:P,height:F};let h=0;for(const c of o){for(let a=0;a<c.height;a++)for(let n=0;n<c.width;n++)h+n>=P||(r.data[2*(a*P+h+n)]=c.data[2*(a*c.width+n)],r.data[2*(a*P+h+n)+1]=c.data[2*(a*c.width+n)+1],r.mask[a*P+h+n]=c.mask[a*c.width+n]);h+=c.width}return(0,at.A)("esri-2d-profiler")&&ot().info("I.10","loadImagery, general exit (ms)",Math.round(performance.now()-M)),r})).apply(this,arguments)}function et(U,v,P,F,C,d){return Y.apply(this,arguments)}function Y(){return(Y=(0,Z.A)(function*(U,v,P,F,C,d){const M={requestProjectedLocalDirections:!0,signal:d};if(null!=C&&(M.timeExtent=C),"imagery"===U.type){yield U.load({signal:d});const y=U.rasterInfo.dataType,_=yield U.fetchImage(v,P,F,M);return null==_?.pixelData?.pixelBlock?{data:new Float32Array(P*F*2),mask:new Uint8Array(P*F),width:P,height:F}:O(y,_.pixelData.pixelBlock)}yield U.load({signal:d});const w=U.serviceRasterInfo.dataType,A=yield U.fetchPixels(v,P,F,M);return null==A?.pixelBlock?{data:new Float32Array(P*F*2),mask:new Uint8Array(P*F),width:P,height:F}:O(w,A.pixelBlock)})).apply(this,arguments)}}}]);