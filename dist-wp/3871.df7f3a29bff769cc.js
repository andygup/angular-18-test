"use strict";(self.webpackChunkangular_18_test=self.webpackChunkangular_18_test||[]).push([[3871],{86468:(V,A,e)=>{e.d(A,{T:()=>h,U:()=>g});var n=e(69287);function g(m,u,i=0){const O=(0,n.qE)(m,0,s);for(let D=0;D<4;D++)u[i+D]=Math.floor(256*d(O*p[D]))}function h(m,u=0){let i=0;for(let O=0;O<4;O++)i+=m[u+O]*l[O];return i}const p=[1,256,65536,16777216],l=[1/256,1/65536,1/16777216,1/4294967296],s=h(new Uint8ClampedArray([255,255,255,255]));function d(m){return m-Math.floor(m)}},76582:(V,A,e)=>{e.d(A,{LG:()=>O,mb:()=>E,yr:()=>D});var n=e(10467),g=e(56492),h=e(31610),p=e(12273),l=e(88532),s=e(63888),d=e(28399),m=e(50915),u=e(26136),i=e(4931);function O(x){return x&&"render"in x}function D(x){const a=document.createElement("canvas");return a.width=x.width,a.height=x.height,x.render(a.getContext("2d")),a}class E extends s.q{constructor(a=null,f=!1){super(),this.blendFunction="standard",this._sourceWidth=0,this._sourceHeight=0,this._textureInvalidated=!1,this._texture=null,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.immutable=f,this.source=a,this.requestRender=this.requestRender.bind(this)}destroy(){this._texture&&(this._texture.dispose(),this._texture=null),null!=this._uploadStatus&&(this._uploadStatus.controller.abort(),this._uploadStatus=null)}get isSourceScaled(){return this.width!==this._sourceWidth||this.height!==this._sourceHeight}get height(){return void 0!==this._height?this._height:this._sourceHeight}set height(a){this._height=a}get source(){return this._source}set source(a){null==a&&null==this._source||(this._source=a,this.invalidateTexture(),this.requestRender())}get width(){return void 0!==this._width?this._width:this._sourceWidth}set width(a){this._width=a}beforeRender(a){super.beforeRender(a),this.updateTexture(a)}setSourceAsync(a,f){var c=this;return(0,n.A)(function*(){null!=c._uploadStatus&&c._uploadStatus.controller.abort();const w=new AbortController,P=(0,g.Tw)();return(0,g.NY)(f,()=>w.abort()),(0,g.NY)(w,S=>P.reject(S)),c._uploadStatus={controller:w,resolver:P},c.source=a,P.promise})()}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this._source instanceof HTMLImageElement?(this._sourceHeight=this._source.naturalHeight,this._sourceWidth=this._source.naturalWidth):this._source&&(this._sourceHeight=this._source.height,this._sourceWidth=this._source.width))}updateTransitionProperties(a,f){a>=64&&(this.fadeTransitionEnabled=!1,this.inFadeTransition=!1),super.updateTransitionProperties(a,f)}setTransform(a){const f=(0,h.D_)(this.transforms.displayViewScreenMat3),[c,w]=a.toScreenNoRotation([0,0],[this.x,this.y]),P=this.resolution/this.pixelRatio/a.resolution,S=P*this.width,j=P*this.height,b=Math.PI*this.rotation/180;(0,h.Tl)(f,f,(0,l.fA)(c,w)),(0,h.Tl)(f,f,(0,l.fA)(S/2,j/2)),(0,h.e$)(f,f,-b),(0,h.Tl)(f,f,(0,l.fA)(-S/2,-j/2)),(0,h.Oe)(f,f,(0,l.fA)(S,j)),(0,h.lw)(this.transforms.displayViewScreenMat3,a.displayViewMat3,f)}setSamplingProfile(a){this._texture&&(a.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(a.samplingMode))}bind(a,f){this._texture&&a.bindTexture(this._texture,f)}updateTexture({context:a,painter:f}){var c=this;return(0,n.A)(function*(){if(!c._textureInvalidated)return;if(c._textureInvalidated=!1,c._texture||(c._texture=c._createTexture(a)),!c.source)return void c._texture.setData(null);c._texture.resize(c._sourceWidth,c._sourceHeight);const w=function y(x){return O(x)?x instanceof d.A?x.getRenderedRasterPixels()?.renderedRasterPixels:D(x):x}(c.source);try{if(null!=c._uploadStatus){const{controller:P,resolver:S}=c._uploadStatus,j={signal:P.signal},{width:b,height:R}=c,I=c._texture;yield f.textureUploadManager.enqueueTextureUpdate({data:w,texture:I,width:b,height:R},j),S.resolve(),c._uploadStatus=null}else c._texture.setData(w);c.ready()}catch(P){(0,g.jH)(P)}})()}onDetach(){this.destroy()}_createTransforms(){return{displayViewScreenMat3:(0,p.vt)()}}_createTexture(a){const f=this.immutable,c=new i.R;return c.internalFormat=f?m.H0.RGBA8:m.Ab.RGBA,c.wrapMode=m.pF.CLAMP_TO_EDGE,c.isImmutable=f,c.width=this._sourceWidth,c.height=this._sourceHeight,new u.g(a,c)}}},28399:(V,A,e)=>{e.d(A,{A:()=>n});class n{constructor(h,p,l){this.pixelBlock=h,this.extent=p,this.originalPixelBlock=l}get width(){return null!=this.pixelBlock?this.pixelBlock.width:0}get height(){return null!=this.pixelBlock?this.pixelBlock.height:0}render(h){const p=this.pixelBlock;if(null==p)return;const l=this.filter({extent:this.extent,pixelBlock:this.originalPixelBlock??p});if(null==l.pixelBlock)return;l.pixelBlock.maskIsAlpha&&(l.pixelBlock.premultiplyAlpha=!0);const s=l.pixelBlock.getAsRGBA(),d=h.createImageData(l.pixelBlock.width,l.pixelBlock.height);d.data.set(s),h.putImageData(d,0,0)}getRenderedRasterPixels(){const h=this.filter({extent:this.extent,pixelBlock:this.pixelBlock});return null==h.pixelBlock?null:(h.pixelBlock.maskIsAlpha&&(h.pixelBlock.premultiplyAlpha=!0),{width:h.pixelBlock.width,height:h.pixelBlock.height,renderedRasterPixels:new Uint8Array(h.pixelBlock.getAsRGBA().buffer)})}}},11393:(V,A,e)=>{e.r(A),e.d(A,{default:()=>ht});var n=e(10467),g=e(8189),h=e(77469),p=e(31178),l=e(11432),s=e(48900),d=e(45272),m=e(85211),D=(e(3248),e(35150),e(40707),e(76576)),y=e(28067),E=e(11817),x=e(32034),a=e(70264),f=e(68800),c=e(27641),w=e(76582),P=e(72663),S=e(29459),j=e(57052),b=e(13031),R=e(41474),I=e(89563),K=e(1749),C=e(40018),Y=e(91837),X=e(3276),at=e(61189),Z=e(50915),ot=e(79061),et=e(31071),lt=e(48458),it=e(26136),st=e(4931);let nt=(()=>{class o{constructor(t){if(this._ownsRctx=!1,t)this._ownsRctx=!1,this._rctx=t;else{if(o._instance)return o._instanceRefCount++,o._instance;o._instanceRefCount=1,o._instance=this,this._ownsRctx=!0;const _=document.createElement("canvas"),M=(0,at.q)(_);M.getExtension("OES_texture_float"),this._rctx=new lt.e(M,{})}const T=(0,X.p)("raster/reproject","raster/reproject",new Map([["a_position",0]]),{applyProjection:!0,bilinear:!1,bicubic:!1});this._program=this._rctx.programCache.acquire(T.shaders.vertexShader,T.shaders.fragmentShader,T.attributes),this._rctx.useProgram(this._program),this._program.setUniform1f("u_opacity",1),this._program.setUniform1i("u_image",0),this._program.setUniform1i("u_flipY",0),this._program.setUniform1i("u_transformGrid",1),this._quad=new Y.A(this._rctx,[0,0,1,0,0,1,1,1])}reprojectTexture(t,r,T=!1){const _=(0,E.project)(t.extent,r),M=new K.A({x:(t.extent.xmax-t.extent.xmin)/t.texture.descriptor.width,y:(t.extent.ymax-t.extent.ymin)/t.texture.descriptor.height,spatialReference:t.extent.spatialReference}),{x:U,y:B}=(0,C.Wo)(M,r,t.extent);let L=(U+B)/2;const N=Math.round((_.xmax-_.xmin)/L),W=Math.round((_.ymax-_.ymin)/L);L=(_.width/N+_.height/W)/2;const dt=new K.A({x:L,y:L,spatialReference:_.spatialReference}),Q=(0,C.l0)({projectedExtent:_,srcBufferExtent:t.extent,pixelSize:dt,hasWrapAround:!0,spacing:[16,16]}),k=(0,et.kc)(this._rctx,Q),$=new st.R(N,W);$.wrapMode=Z.pF.CLAMP_TO_EDGE;const G=new ot.H(this._rctx,$);this._rctx.bindFramebuffer(G),this._rctx.setViewport(0,0,N,W),this._rctx.useProgram(this._program),this._rctx.bindTexture(t.texture,0),this._rctx.bindTexture(k,1),this._quad.bind();const{width:J=0,height:q=0}=t.texture.descriptor;if(this._program.setUniform2f("u_srcImageSize",J,q),this._program.setUniform2fv("u_transformSpacing",Q.spacing),this._program.setUniform2fv("u_transformGridSize",Q.size),this._program.setUniform2f("u_targetImageSize",N,W),this._quad.draw(),this._quad.unbind(),this._rctx.useProgram(null),this._rctx.bindFramebuffer(null),k.dispose(),T){const{width:tt,height:z}=G,ut=new ImageData(tt??0,z??0);G.readPixels(0,0,tt??0,z??0,Z.Ab.RGBA,Z.ld.UNSIGNED_BYTE,ut.data);const ct=G.detachColorTexture(Z.Nm.COLOR_ATTACHMENT0);return G.dispose(),{texture:ct,extent:_,imageData:ut}}const H=G.detachColorTexture(Z.Nm.COLOR_ATTACHMENT0);return G.dispose(),{texture:H,extent:_}}reprojectBitmapData(t,r){const T=(0,w.LG)(t.bitmapData)?(0,w.yr)(t.bitmapData):t.bitmapData,_=new st.R;_.wrapMode=Z.pF.CLAMP_TO_EDGE,_.width=t.bitmapData.width,_.height=t.bitmapData.height;const M=new it.g(this._rctx,_,T),U=this.reprojectTexture({texture:M,extent:t.extent},r,!0);U.texture.dispose();const B=document.createElement("canvas"),L=U.imageData;return B.width=L.width,B.height=L.height,B.getContext("2d").putImageData(L,0,0),{bitmapData:B,extent:U.extent}}loadAndReprojectBitmapData(t,r,T){var _=this;return(0,n.A)(function*(){const M=(yield(0,I.A)(t,{responseType:"image"})).data,U=document.createElement("canvas");U.width=M.width,U.height=M.height;const B=U.getContext("2d");B.drawImage(M,0,0);const L=B.getImageData(0,0,U.width,U.height);if(r.spatialReference.equals(T))return{bitmapData:L,extent:r};const N=_.reprojectBitmapData({bitmapData:L,extent:r},T);return{bitmapData:N.bitmapData,extent:N.extent}})()}destroy(){this._ownsRctx?(o._instanceRefCount--,0===o._instanceRefCount&&(this._quad.dispose(),this._program.dispose(),this._rctx.dispose(),o._instance=null)):(this._quad.dispose(),this._program.dispose())}}return o._instanceRefCount=0,o})();class rt{constructor(){this.allSublayers=new Map,this.allPoints=[],this.allPolylines=[],this.allPolygons=[],this.allMapImages=[]}}let F=class extends((0,S.e)(R.A)){constructor(){super(...arguments),this._bitmapIndex=new Map,this._mapImageContainer=new P.l,this._kmlVisualData=new rt,this._fetchController=null,this.allVisiblePoints=new c.Y,this.allVisiblePolylines=new c.Y,this.allVisiblePolygons=new c.Y,this.allVisibleMapImages=new p.A}hitTest(o,v){var t=this;return(0,n.A)(function*(){const r=t.layer;return[t._pointsView?.hitTest(o),t._polylinesView?.hitTest(o),t._polygonsView?.hitTest(o)].flat().filter(Boolean).map(T=>(T.layer=r,T.sourceLayer=r,{type:"graphic",graphic:T,layer:r,mapPoint:o}))})()}update(o){this._polygonsView&&this._polygonsView.processUpdate(o),this._polylinesView&&this._polylinesView.processUpdate(o),this._pointsView&&this._pointsView.processUpdate(o)}attach(){this._fetchController=new AbortController,this.container.addChild(this._mapImageContainer),this._polygonsView=new b.A({view:this.view,graphics:this.allVisiblePolygons,requestUpdateCallback:()=>this.requestUpdate(),container:new j.A(this.view.featuresTilingScheme)}),this.container.addChild(this._polygonsView.container),this._polylinesView=new b.A({view:this.view,graphics:this.allVisiblePolylines,requestUpdateCallback:()=>this.requestUpdate(),container:new j.A(this.view.featuresTilingScheme)}),this.container.addChild(this._polylinesView.container),this._pointsView=new b.A({view:this.view,graphics:this.allVisiblePoints,requestUpdateCallback:()=>this.requestUpdate(),container:new j.A(this.view.featuresTilingScheme)}),this.container.addChild(this._pointsView.container),this.addAttachHandles([this.allVisibleMapImages.on("change",o=>{o.added.forEach(v=>this._addMapImage(v)),o.removed.forEach(v=>this._removeMapImage(v))}),(0,s.wB)(()=>this.layer.visibleSublayers,o=>{for(const[v,t]of this._kmlVisualData.allSublayers)t.visibility=0;for(const v of o){const t=this._kmlVisualData.allSublayers.get(v.id);t&&(t.visibility=1)}this._refreshCollections()})]),this._updatingHandles.addPromise(this._fetchService(this._fetchController.signal)),this._imageReprojector=new nt}detach(){this._fetchController=(0,l.DC)(this._fetchController),this._mapImageContainer.removeAllChildren(),this.container.removeAllChildren(),this._bitmapIndex.clear(),this._polygonsView=(0,l.pR)(this._polygonsView),this._polylinesView=(0,l.pR)(this._polylinesView),this._pointsView=(0,l.pR)(this._pointsView),this._imageReprojector=(0,l.pR)(this._imageReprojector)}viewChange(){this._polygonsView.viewChange(),this._polylinesView.viewChange(),this._pointsView.viewChange()}moveEnd(){}isUpdating(){return this._pointsView.updating||this._polygonsView.updating||this._polylinesView.updating}_addMapImage(o){(this.view.spatialReference?.isWGS84||this.view.spatialReference?.isWebMercator)&&this._imageReprojector.loadAndReprojectBitmapData(o.href,y.A.fromJSON(o.extent),this.view.spatialReference).then(v=>{const t=new w.mb(v.bitmapData);t.x=v.extent.xmin,t.y=v.extent.ymax,t.resolution=v.extent.width/v.bitmapData.width,t.rotation=o.rotation,this._mapImageContainer.addChild(t),this._bitmapIndex.set(o,t)})}_getViewDependentUrl(o,v){return(0,n.A)(function*(){const{viewFormat:t,viewBoundScale:r,httpQuery:T}=o;if(null!=t){if(null==v)throw new Error("Loading this network link requires a view state.");let _;if(yield(0,E.load)(),null!=r&&1!==r){const H=new y.A(v.extent);H.expand(r),_=H}else _=v.extent;_=(0,E.project)(_,x.A.WGS84);const M=(0,E.project)(_,x.A.WebMercator),U=_.xmin,B=_.xmax,L=_.ymin,N=_.ymax,W=v.size[0]*v.pixelRatio,dt=v.size[1]*v.pixelRatio,Q=Math.max(M.width,M.height),k={"[bboxWest]":U.toString(),"[bboxEast]":B.toString(),"[bboxSouth]":L.toString(),"[bboxNorth]":N.toString(),"[lookatLon]":_.center.x.toString(),"[lookatLat]":_.center.y.toString(),"[lookatRange]":Q.toString(),"[lookatTilt]":"0","[lookatHeading]":v.rotation.toString(),"[lookatTerrainLon]":_.center.x.toString(),"[lookatTerrainLat]":_.center.y.toString(),"[lookatTerrainAlt]":"0","[cameraLon]":_.center.x.toString(),"[cameraLat]":_.center.y.toString(),"[cameraAlt]":Q.toString(),"[horizFov]":"60","[vertFov]":"60","[horizPixels]":W.toString(),"[vertPixels]":dt.toString(),"[terrainEnabled]":"0","[clientVersion]":h.rE,"[kmlVersion]":"2.2","[clientName]":"ArcGIS API for JavaScript","[language]":"en-US"},$=H=>{for(const tt in H){let z;for(z in k)H[tt]=H[tt].replace(z,k[z])}},G=(0,d.zf)(t);$(G);let J={};null!=T&&(J=(0,d.zf)(T),$(J));const q=(0,f.Dl)(o.href);return q.query={...q.query,...G,...J},`${q.path}?${(0,d.x0)(G)}`}return o.href})()}_fetchService(o){var v=this;return(0,n.A)(function*(){const t=new rt;yield v._loadVisualData(v.layer.url,t,o),v._kmlVisualData=t,v._refreshCollections()})()}_refreshCollections(){this.allVisiblePoints.removeAll(),this.allVisiblePolylines.removeAll(),this.allVisiblePolygons.removeAll(),this.allVisibleMapImages.removeAll(),this.allVisiblePoints.addMany(this._kmlVisualData.allPoints.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisiblePolylines.addMany(this._kmlVisualData.allPolylines.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisiblePolygons.addMany(this._kmlVisualData.allPolygons.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o)),this.allVisibleMapImages.addMany(this._kmlVisualData.allMapImages.filter(o=>this._isSublayerVisible(o.sublayerId)).map(({item:o})=>o))}_isSublayerVisible(o){const v=this._kmlVisualData.allSublayers.get(o);return!!v?.visibility&&(-1===v.parentFolderId||this._isSublayerVisible(v.parentFolderId))}_loadVisualData(o,v,t){var r=this;return this._fetchParsedKML(o,t).then(function(){var T=(0,n.A)(function*(_){for(const M of _.sublayers){v.allSublayers.set(M.id,M);const U=M.points?yield(0,a.Sp)(M.points):[],B=M.polylines?yield(0,a.Sp)(M.polylines):[],L=M.polygons?yield(0,a.Sp)(M.polygons):[],N=M.mapImages||[];if(v.allPoints.push(...U.map(W=>({item:W,sublayerId:M.id}))),v.allPolylines.push(...B.map(W=>({item:W,sublayerId:M.id}))),v.allPolygons.push(...L.map(W=>({item:W,sublayerId:M.id}))),v.allMapImages.push(...N.map(W=>({item:W,sublayerId:M.id}))),M.networkLink){const W=yield r._getViewDependentUrl(M.networkLink,r.view.state);yield r._loadVisualData(W,v,t)}}});return function(_){return T.apply(this,arguments)}}())}_fetchParsedKML(o,v){return(0,a.Ox)(o,this.layer.spatialReference,this.layer.refreshInterval,v).then(t=>(0,a._4)(t.data))}_removeMapImage(o){const v=this._bitmapIndex.get(o);v&&(this._mapImageContainer.removeChild(v),this._bitmapIndex.delete(o))}};(0,g._)([(0,m.MZ)()],F.prototype,"_pointsView",void 0),(0,g._)([(0,m.MZ)()],F.prototype,"_polylinesView",void 0),(0,g._)([(0,m.MZ)()],F.prototype,"_polygonsView",void 0),(0,g._)([(0,m.MZ)()],F.prototype,"updating",void 0),F=(0,g._)([(0,D.$)("esri.views.2d.layers.KMLLayerView2D")],F);const ht=F},29459:(V,A,e)=>{e.d(A,{e:()=>j});var E,n=e(8189),g=e(31178),h=e(5605),p=e(5922),l=e(48900),s=e(85211),i=(e(3248),e(35150),e(40707),e(76576)),O=e(88766),D=e(60746),y=e(66727);let x=E=class extends y.A{constructor(b){super(b),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new E({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,n._)([(0,s.MZ)({type:[Number,String],json:{write:!0}})],x.prototype,"left",void 0),(0,n._)([(0,s.MZ)({type:[Number,String],json:{write:!0}})],x.prototype,"right",void 0),(0,n._)([(0,s.MZ)({type:[Number,String],json:{write:!0}})],x.prototype,"top",void 0),(0,n._)([(0,s.MZ)({type:[Number,String],json:{write:!0}})],x.prototype,"bottom",void 0),x=E=(0,n._)([(0,i.$)("esri.views.layers.support.ClipRect")],x);const a=x;var f=e(75644);let c=class extends y.A{constructor(b){super(b),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,n._)([(0,s.MZ)({type:[[[Number]]],json:{write:!0}})],c.prototype,"path",void 0),c=(0,n._)([(0,i.$)("esri.views.layers.support.Path")],c);const w=c;var P=e(6558);const S=g.A.ofType({key:"type",base:null,typeMap:{rect:a,path:w,geometry:f.A}}),j=b=>{let R=class extends b{constructor(){super(...arguments),this.attached=!1,this.clips=new S,this.highlightOptions=null,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this._visibleAtCurrentScale=!0}initialize(){const I=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&I&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new p.A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new O.m),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,l.wB)(()=>this.suspended,C=>{this.container&&(this.container.visible=!C)},l.pc),(0,l.wB)(()=>this.updateSuspended,C=>{this.view&&!C&&this.updateRequested&&this.view.requestUpdate()},l.pc),(0,l.wB)(()=>this.layer?.opacity??1,C=>{this.container&&(this.container.opacity=C)},l.pc),(0,l.wB)(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",C=>{this.container&&(this.container.blendMode=C)},l.pc),(0,l.wB)(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,C=>{this.container&&(this.container.effect=C)},l.pc),(0,l.wB)(()=>this.highlightOptions,C=>this.container.highlightOptions=C,l.pc),(0,l.on)(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},l.pc),(0,l.wB)(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:C,scaleRange:Y})=>{const X=(0,P.E5)(Y,C);X!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=X)},l.pc)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(C=>{C===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const I=this.view?.spatialReference;return null==I||this.supportsSpatialReference(I)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(I){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",I),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(I))):this.updateRequested=!1}hitTest(I,K){return Promise.resolve(null)}supportsSpatialReference(I){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const I=super.getSuspendInfo(),K=!this.spatialReferenceSupported;return K&&(I.spatialReferenceNotSupported=K),I}addAttachHandles(I){this.addHandles(I,"attach")}};return(0,n._)([(0,s.MZ)()],R.prototype,"attached",void 0),(0,n._)([(0,s.MZ)({type:S,set(I){const K=(0,h.V)(I,this._get("clips"),S);this._set("clips",K)}})],R.prototype,"clips",void 0),(0,n._)([(0,s.MZ)()],R.prototype,"container",void 0),(0,n._)([(0,s.MZ)({type:D.A})],R.prototype,"highlightOptions",void 0),(0,n._)([(0,s.MZ)()],R.prototype,"moving",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],R.prototype,"spatialReferenceSupported",null),(0,n._)([(0,s.MZ)({readOnly:!0})],R.prototype,"updateParameters",void 0),(0,n._)([(0,s.MZ)()],R.prototype,"updateRequested",void 0),(0,n._)([(0,s.MZ)()],R.prototype,"updating",null),(0,n._)([(0,s.MZ)()],R.prototype,"view",void 0),(0,n._)([(0,s.MZ)()],R.prototype,"_visibleAtCurrentScale",void 0),(0,n._)([(0,s.MZ)({readOnly:!0})],R.prototype,"visibleAtCurrentScale",null),R=(0,n._)([(0,i.$)("esri.views.2d.layers.LayerView2D")],R),R}},93093:(V,A,e)=>{e.d(A,{H:()=>h,Y:()=>g});const g=class n{};function h(p,...l){let s="";for(let d=0;d<l.length;d++)s+=p[d]+l[d];return s+=p[p.length-1],s}var p;(p=h||(h={})).int=function l(d){return Math.round(d).toString()},p.float=function s(d){return d.toPrecision(8)}},67496:(V,A,e)=>{var n,g,h,p,l,s,d,m,u,i;e.d(A,{Am:()=>p,C7:()=>h,ID:()=>m,JS:()=>u,Mg:()=>s,dd:()=>l,it:()=>g,s2:()=>n,sf:()=>d}),(i=n||(n={}))[i.None=0]="None",i[i.Front=1]="Front",i[i.Back=2]="Back",i[i.COUNT=3]="COUNT",function(i){i[i.Less=0]="Less",i[i.Lequal=1]="Lequal",i[i.COUNT=2]="COUNT"}(g||(g={})),function(i){i[i.BACKGROUND=0]="BACKGROUND",i[i.UPDATE=1]="UPDATE"}(h||(h={})),function(i){i[i.NOT_LOADED=0]="NOT_LOADED",i[i.LOADING=1]="LOADING",i[i.LOADED=2]="LOADED"}(p||(p={})),function(i){i[i.IntegratedMeshMaskExcluded=1]="IntegratedMeshMaskExcluded",i[i.OutlineVisualElementMask=2]="OutlineVisualElementMask"}(l||(l={})),function(i){i[i.Highlight=0]="Highlight",i[i.MaskOccludee=1]="MaskOccludee",i[i.COUNT=2]="COUNT"}(s||(s={})),function(i){i[i.Blend=0]="Blend",i[i.Opaque=1]="Opaque",i[i.Mask=2]="Mask",i[i.MaskBlend=3]="MaskBlend",i[i.COUNT=4]="COUNT"}(d||(d={})),function(i){i[i.OFF=0]="OFF",i[i.ON=1]="ON"}(m||(m={})),function(i){i.DDS_ENCODING="image/vnd-ms.dds",i.KTX2_ENCODING="image/ktx2",i.BASIS_ENCODING="image/x.basis"}(u||(u={}))},41474:(V,A,e)=>{e.d(A,{A:()=>x});var n=e(8189),g=e(98877),h=e(42425),p=e(3046),l=e(35150),s=e(11432),d=e(64261),m=e(85211),O=(e(3248),e(40707),e(76576)),D=e(56985),y=e(6558);let E=class extends((0,p.sA)((0,d.g)(h.A.EventedMixin(g.A)))){constructor(a){super(a),this._updatingHandles=new D.U,this.layer=null,this.parent=null}initialize(){this.when().catch(a=>{if("layerview:create-error"!==a.name){const f=this.layer&&this.layer.id||"no id",c=this.layer?.title||"no title";l.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${c}', id: '${f}')`,a)}})}destroy(){this._updatingHandles=(0,s.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(a){this._overrideIfSome("visible",a)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const a=this.view.timeExtent,f=this.layer?.visibilityTimeExtent;return!a||!f||!a.intersection(f).isEmpty}canResume(){const a=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,y.g7)(a)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const a=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(a.viewNotReady=!0),this.layer&&this.layer.loaded||(a.layerNotLoaded=!0),(0,y.g7)(this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null)&&this.visibleAtCurrentScale||(a.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(a.outsideVisibilityTimeExtent=!0),this.visible||(a.layerInvisible=!0),a}isUpdating(){return!1}};(0,n._)([(0,m.MZ)()],E.prototype,"view",void 0),(0,n._)([(0,m.MZ)()],E.prototype,"fullOpacity",null),(0,n._)([(0,m.MZ)()],E.prototype,"layer",void 0),(0,n._)([(0,m.MZ)()],E.prototype,"parent",void 0),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"suspended",null),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"suspendInfo",null),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"legendEnabled",null),(0,n._)([(0,m.MZ)({type:Boolean,readOnly:!0})],E.prototype,"updating",null),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"updatingProgress",null),(0,n._)([(0,m.MZ)()],E.prototype,"updateSuspended",null),(0,n._)([(0,m.MZ)()],E.prototype,"visible",null),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"visibleAtCurrentScale",null),(0,n._)([(0,m.MZ)({readOnly:!0})],E.prototype,"visibleAtCurrentTimeExtent",null),E=(0,n._)([(0,O.$)("esri.views.layers.LayerView")],E);const x=E},66727:(V,A,e)=>{e.d(A,{A:()=>u});var n=e(8189),g=e(71065),h=e(85211),d=(e(3248),e(35150),e(40707),e(76576));let m=class extends g.oY{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,n._)([(0,h.MZ)({readOnly:!0})],m.prototype,"version",null),m=(0,n._)([(0,d.$)("esri.views.layers.support.ClipArea")],m);const u=m},75644:(V,A,e)=>{e.d(A,{A:()=>a});var y,n=e(8189),h=(e(21152),e(85211)),d=(e(3248),e(35150),e(40707),e(76576)),m=e(68643),u=e(61320),i=e(66727),O=e(28067),D=e(55861);const E={base:m.A,key:"type",typeMap:{extent:O.A,polygon:D.A}};let x=y=class extends i.A{constructor(f){super(f),this.type="geometry",this.geometry=null}clone(){return new y({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,n._)([(0,h.MZ)({types:E,json:{read:u.rS,write:!0}})],x.prototype,"geometry",void 0),x=y=(0,n._)([(0,d.$)("esri.views.layers.support.Geometry")],x);const a=x},6558:(V,A,e)=>{function n(u){return u&&"function"==typeof u.highlight}function p(u,i){if(i&&u){const{minScale:O,maxScale:D}=u;if(function l(u,i){return null!=u&&u>0||null!=i&&i>0}(O,D))return function h(u,i,O){return null==u||u>=O&&(0===i||u<=i)}(i,O,D)}return!0}function s(u){return!u?.minScale||!u.maxScale||u.minScale>=u.maxScale}e.d(A,{E5:()=>p,Of:()=>n,g7:()=>s})},52274:(V,A,e)=>{e.d(A,{_:()=>g});var n=e(11432);class g{constructor(){this._result=!1}dispose(){this._program=(0,n.WD)(this._program)}get result(){return null!=this._program&&(this._result=this._test(this._program),this.dispose()),this._result}}},54949:(V,A,e)=>{e.d(A,{_R:()=>h});class n{constructor(l,s,d,m,u,i,O,D,y){this.createQuery=l,this.deleteQuery=s,this.resultAvailable=d,this.getResult=m,this.disjoint=u,this.beginTimeElapsed=i,this.endTimeElapsed=O,this.createTimestamp=D,this.timestampBits=y}}let g=!1;function h(p,l){if(l.disjointTimerQuery)return null;let s=p.getExtension("EXT_disjoint_timer_query_webgl2");return s?new n(()=>p.createQuery(),d=>{p.deleteQuery(d),g=!1},d=>p.getQueryParameter(d,p.QUERY_RESULT_AVAILABLE),d=>p.getQueryParameter(d,p.QUERY_RESULT),()=>p.getParameter(s.GPU_DISJOINT_EXT),d=>{g||(g=!0,p.beginQuery(s.TIME_ELAPSED_EXT,d))},()=>{p.endQuery(s.TIME_ELAPSED_EXT),g=!1},d=>s.queryCounterEXT(d,s.TIMESTAMP_EXT),()=>p.getQuery(s.TIMESTAMP_EXT,s.QUERY_COUNTER_BITS_EXT)):(s=p.getExtension("EXT_disjoint_timer_query"),s?new n(()=>s.createQueryEXT(),d=>{s.deleteQueryEXT(d),g=!1},d=>s.getQueryObjectEXT(d,s.QUERY_RESULT_AVAILABLE_EXT),d=>s.getQueryObjectEXT(d,s.QUERY_RESULT_EXT),()=>p.getParameter(s.GPU_DISJOINT_EXT),d=>{g||(g=!0,s.beginQueryEXT(s.TIME_ELAPSED_EXT,d))},()=>{s.endQueryEXT(s.TIME_ELAPSED_EXT),g=!1},d=>s.queryCounterEXT(d,s.TIMESTAMP_EXT),()=>s.getQueryEXT(s.TIMESTAMP_EXT,s.QUERY_COUNTER_BITS_EXT)):null)}},41396:(V,A,e)=>{e.d(A,{Ey:()=>w,Ms:()=>v,Xt:()=>d,kn:()=>m,ox:()=>h,p3:()=>p,wE:()=>u});var n=e(67496),g=e(50915);function h(t,r,T=g.Tb.ADD,_=[0,0,0,0]){return{srcRgb:t,srcAlpha:t,dstRgb:r,dstAlpha:r,opRgb:T,opAlpha:T,color:{r:_[0],g:_[1],b:_[2],a:_[3]}}}function p(t,r,T,_,M=g.Tb.ADD,U=g.Tb.ADD,B=[0,0,0,0]){return{srcRgb:t,srcAlpha:r,dstRgb:T,dstAlpha:_,opRgb:M,opAlpha:U,color:{r:B[0],g:B[1],b:B[2],a:B[3]}}}const l={face:g.Y7.BACK,mode:g.Ac.CCW},s={face:g.Y7.FRONT,mode:g.Ac.CCW},d=t=>t===n.s2.Back?l:t===n.s2.Front?s:null,m={zNear:0,zFar:1},u={r:!0,g:!0,b:!0,a:!0};function i(t){return j.intern(t)}function O(t){return R.intern(t)}function D(t){return K.intern(t)}function y(t){return Y.intern(t)}function E(t){return at.intern(t)}function x(t){return ot.intern(t)}function a(t){return lt.intern(t)}function f(t){return st.intern(t)}function c(t){return rt.intern(t)}function w(t){return ht.intern(t)}class P{constructor(r,T){this._makeKey=r,this._makeRef=T,this._interns=new Map}intern(r){if(!r)return null;const T=this._makeKey(r),_=this._interns;return _.has(T)||_.set(T,this._makeRef(r)),_.get(T)??null}}function S(t){return"["+t.join(",")+"]"}const j=new P(b,t=>({__tag:"Blending",...t}));function b(t){return t?S([t.srcRgb,t.srcAlpha,t.dstRgb,t.dstAlpha,t.opRgb,t.opAlpha,t.color.r,t.color.g,t.color.b,t.color.a]):null}const R=new P(I,t=>({__tag:"Culling",...t}));function I(t){return t?S([t.face,t.mode]):null}const K=new P(C,t=>({__tag:"PolygonOffset",...t}));function C(t){return t?S([t.factor,t.units]):null}const Y=new P(X,t=>({__tag:"DepthTest",...t}));function X(t){return t?S([t.func]):null}const at=new P(Z,t=>({__tag:"StencilTest",...t}));function Z(t){return t?S([t.function.func,t.function.ref,t.function.mask,t.operation.fail,t.operation.zFail,t.operation.zPass]):null}const ot=new P(et,t=>({__tag:"DepthWrite",...t}));function et(t){return t?S([t.zNear,t.zFar]):null}const lt=new P(it,t=>({__tag:"ColorWrite",...t}));function it(t){return t?S([t.r,t.g,t.b,t.a]):null}const st=new P(nt,t=>({__tag:"StencilWrite",...t}));function nt(t){return t?S([t.mask]):null}const rt=new P(F,t=>({__tag:"DrawBuffers",...t}));function F(t){return t?S(t.buffers):null}const ht=new P(function o(t){return t?S([b(t.blending),I(t.culling),C(t.polygonOffset),X(t.depthTest),Z(t.stencilTest),et(t.depthWrite),it(t.colorWrite),nt(t.stencilWrite),F(t.drawBuffers)]):null},t=>({blending:i(t.blending),culling:O(t.culling),polygonOffset:D(t.polygonOffset),depthTest:y(t.depthTest),stencilTest:E(t.stencilTest),depthWrite:x(t.depthWrite),colorWrite:a(t.colorWrite),stencilWrite:f(t.stencilWrite),drawBuffers:c(t.drawBuffers)}));class v{constructor(r){this._pipelineInvalid=!0,this._blendingInvalid=!0,this._cullingInvalid=!0,this._polygonOffsetInvalid=!0,this._depthTestInvalid=!0,this._stencilTestInvalid=!0,this._depthWriteInvalid=!0,this._colorWriteInvalid=!0,this._stencilWriteInvalid=!0,this._drawBuffersInvalid=!0,this._stateSetters=r}setPipeline(r){(this._pipelineInvalid||r!==this._pipeline)&&(this._setBlending(r.blending),this._setCulling(r.culling),this._setPolygonOffset(r.polygonOffset),this._setDepthTest(r.depthTest),this._setStencilTest(r.stencilTest),this._setDepthWrite(r.depthWrite),this._setColorWrite(r.colorWrite),this._setStencilWrite(r.stencilWrite),this._setDrawBuffers(r.drawBuffers),this._pipeline=r),this._pipelineInvalid=!1}invalidateBlending(){this._blendingInvalid=!0,this._pipelineInvalid=!0}invalidateCulling(){this._cullingInvalid=!0,this._pipelineInvalid=!0}invalidatePolygonOffset(){this._polygonOffsetInvalid=!0,this._pipelineInvalid=!0}invalidateDepthTest(){this._depthTestInvalid=!0,this._pipelineInvalid=!0}invalidateStencilTest(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDepthWrite(){this._depthWriteInvalid=!0,this._pipelineInvalid=!0}invalidateColorWrite(){this._colorWriteInvalid=!0,this._pipelineInvalid=!0}invalidateStencilWrite(){this._stencilTestInvalid=!0,this._pipelineInvalid=!0}invalidateDrawBuffers(){this._drawBuffersInvalid=!0,this._pipelineInvalid=!0}_setBlending(r){this._blending=this._setSubState(r,this._blending,this._blendingInvalid,this._stateSetters.setBlending),this._blendingInvalid=!1}_setCulling(r){this._culling=this._setSubState(r,this._culling,this._cullingInvalid,this._stateSetters.setCulling),this._cullingInvalid=!1}_setPolygonOffset(r){this._polygonOffset=this._setSubState(r,this._polygonOffset,this._polygonOffsetInvalid,this._stateSetters.setPolygonOffset),this._polygonOffsetInvalid=!1}_setDepthTest(r){this._depthTest=this._setSubState(r,this._depthTest,this._depthTestInvalid,this._stateSetters.setDepthTest),this._depthTestInvalid=!1}_setStencilTest(r){this._stencilTest=this._setSubState(r,this._stencilTest,this._stencilTestInvalid,this._stateSetters.setStencilTest),this._stencilTestInvalid=!1}_setDepthWrite(r){this._depthWrite=this._setSubState(r,this._depthWrite,this._depthWriteInvalid,this._stateSetters.setDepthWrite),this._depthWriteInvalid=!1}_setColorWrite(r){this._colorWrite=this._setSubState(r,this._colorWrite,this._colorWriteInvalid,this._stateSetters.setColorWrite),this._colorWriteInvalid=!1}_setStencilWrite(r){this._stencilWrite=this._setSubState(r,this._stencilWrite,this._stencilWriteInvalid,this._stateSetters.setStencilWrite),this._stencilTestInvalid=!1}_setDrawBuffers(r){this._drawBuffers=this._setSubState(r,this._drawBuffers,this._drawBuffersInvalid,this._stateSetters.setDrawBuffers),this._drawBuffersInvalid=!1}_setSubState(r,T,_,M){return(_||r!==T)&&(M(r),this._pipelineInvalid=!0),r}}},20047:(V,A,e)=>{e.d(A,{H:()=>u});var n=e(9599),g=e(32788),h=e(50915),p=e(79061),l=e(26136),s=e(4931),d=e(45513),m=e(52274);class u extends m._{constructor(D){super(),this._rctx=D,this._program=D.programCache.acquire("\n    precision highp float;\n\n    attribute vec2 a_pos;\n    varying vec2 v_uv;\n\n    void main() {\n      v_uv = a_pos;\n      gl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n    }\n    ","\n    precision highp float;\n\n    varying vec2 v_uv;\n\n    uniform sampler2D u_texture;\n\n    void main() {\n      gl_FragColor = texture2D(u_texture, v_uv);\n    }\n    ",new Map([["a_pos",0]]))}dispose(){super.dispose()}_test(D){const y=this._rctx;if(!y.gl)return D.dispose(),!0;const E=new s.R(1);E.wrapMode=h.pF.CLAMP_TO_EDGE,E.samplingMode=h.Cj.NEAREST;const x=new p.H(y,E),a=g.g.createVertex(y,h._U.STATIC_DRAW,new Uint16Array([0,0,1,0,0,1,1,1])),f=new d.Z(y,new Map([["a_pos",0]]),n.VS,{geometry:a}),c=new s.R;c.samplingMode=h.Cj.LINEAR,c.wrapMode=h.pF.CLAMP_TO_EDGE;const w=new l.g(y,c,i);y.useProgram(D),y.bindTexture(w,0),D.setUniform1i("u_texture",0);const P=y.getBoundFramebufferObject(),{x:S,y:j,width:b,height:R}=y.getViewport();y.bindFramebuffer(x),y.setViewport(0,0,1,1),y.setClearColor(0,0,0,0),y.setBlendingEnabled(!1),y.clear(h.hn.COLOR_BUFFER_BIT),y.bindVAO(f),y.drawArrays(h.WR.TRIANGLE_STRIP,0,4);const I=new Uint8Array(4);return x.readPixels(0,0,1,1,h.Ab.RGBA,h.ld.UNSIGNED_BYTE,I),f.dispose(),x.dispose(),w.dispose(),y.setViewport(S,j,b,R),y.bindFramebuffer(P),255!==I[0]}}const i=new Image;i.src="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg width='5' height='5' version='1.1' viewBox='0 0 5 5' xmlns='http://www.w3.org/2000/svg'%3E%3Crect width='5' height='5' fill='%23f00' fill-opacity='.5'/%3E%3C/svg%3E%0A",i.width=5,i.height=5,i.decode()}}]);