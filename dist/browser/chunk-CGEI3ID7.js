import{d as m}from"./chunk-ZHAVTBSG.js";import{J as u,M as o,d as v,g as a,p as d,s as p,t as f}from"./chunk-AANS6QE5.js";var h={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},S=Object.values(h),g=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${S.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),I=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${S.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),U=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function A(r){return g.test(r)}function y(r){if(r==null)return null;let e=a(r),s=e?.path.match(g)||e?.path.match(I);if(!s)return null;let[,t,n,l,i]=s,c=n.indexOf("/");return{title:w(c!==-1?n.slice(c+1):n),serverType:h[l.toLowerCase()],sublayer:i!=null&&i!==""?parseInt(i,10):null,url:{path:t}}}function b(r){let e=a(r).path.match(U);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function w(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function T(r,e){let s=[];if(r){let t=y(r);t!=null&&t.title&&s.push(t.title)}if(e){let t=w(e);s.push(t)}if(s.length===2){if(s[0].toLowerCase().includes(s[1].toLowerCase()))return s[0];if(s[1].toLowerCase().includes(s[0].toLowerCase()))return s[1]}return s.join(" - ")}function W(r){let e=f(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function j(r,e){return r&&u(o(r,e))}function O(r){let{url:e}=r;if(!e)return{url:e};e=o(e,r.logger);let s=a(e),t=y(s.path),n;if(t!=null)t.sublayer!=null&&r.layer.layerId==null&&(n=t.sublayer),e=t.url.path;else if(r.nonStandardUrlAllowed){let l=b(s.path);l!=null&&(e=l.serviceUrl,n=l.sublayerId)}return{url:u(e),layerId:n}}function x(r,e,s,t,n){m(e,t,"url",n),t.url&&r.layerId!=null&&(t.url=p(t.url,s,r.layerId.toString()))}function G(r){if(!r)return!1;let e=r.toLowerCase(),s=e.includes("/services/"),t=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),l=e.includes("/wmsserver");return s&&(t||n||l)}function N(r){if(!r)return!1;let e=new v(d(r)),s=e.authority?.toLowerCase();return s==="server.arcgisonline.com"||s==="services.arcgisonline.com"}export{A as a,y as b,b as c,w as d,T as e,W as f,j as g,O as h,x as i,G as j,N as k};
