import{a as u}from"./chunk-3M3UGV5X.js";import{Na as w,T as s,V as p,_ as l,aa as m,b as F,c as h,ea as d,ja as S}from"./chunk-6KEVGVAJ.js";import"./chunk-OCNYIIP3.js";import"./chunk-H755O6VJ.js";import{e as y,f as A}from"./chunk-IG7WMIAW.js";import{a as g}from"./chunk-MYC65FI6.js";import"./chunk-JVM3RNQL.js";import"./chunk-O5CPPU3T.js";import"./chunk-YRTOHBUA.js";import"./chunk-L2DEVDHE.js";import"./chunk-RU7UW4IO.js";import"./chunk-2ETW6ZBA.js";import"./chunk-6K7P7RRW.js";import"./chunk-7LRMKXZV.js";import"./chunk-BCREO4Q5.js";import"./chunk-BNUHB4AP.js";import"./chunk-ZGLJFDS6.js";import"./chunk-RSDQHAJX.js";import"./chunk-MMYIAMQR.js";import"./chunk-UHTPPTOJ.js";import"./chunk-LP5GLSKB.js";import"./chunk-LTDZH3EN.js";import"./chunk-3SBMUUA6.js";import"./chunk-II7TJXWX.js";import"./chunk-X7Z55FTO.js";import"./chunk-B66V4PSA.js";import"./chunk-A4HCVMB4.js";import"./chunk-AANS6QE5.js";import"./chunk-RMOOROEO.js";import"./chunk-ZP7G4HN4.js";import"./chunk-W3WDPWBE.js";import"./chunk-43GG6PFR.js";import"./chunk-MLSR6YE6.js";import"./chunk-JPDAKIWT.js";import"./chunk-D62JNIRP.js";import"./chunk-VU5W7W6Y.js";import"./chunk-3DV77WOO.js";import"./chunk-NJG4JJ4L.js";import{g as f}from"./chunk-3T7TAUC2.js";function c(a,n,t,e){return f(this,null,function*(){if(t.length===1){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(d(t[0]))return u(a,t[0].toArray(),s(t[1],-1))}else if(t.length===2){if(l(t[0]))return u(a,t[0],s(t[1],-1));if(d(t[0]))return u(a,t[0].toArray(),s(t[1],-1));if(m(t[0])){let i=yield t[0].load(),r=yield x(A.create(t[1],i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),e,n);return v(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}}else if(t.length===3&&m(t[0])){let i=yield t[0].load(),r=yield x(A.create(t[1],i.getFieldsIndex(),i.dateFieldsTimeZoneDefaultUTC),e,n);return v(n,yield t[0].calculateStatistic(a,r,s(t[2],1e3),n.abortSignal))}return u(a,t,-1)})}function v(a,n){return n instanceof y?g.fromReaderAsTimeStampOffset(n.toStorageFormat()):n instanceof Date?g.dateJSAndZoneToArcadeDate(n,w(a)):n}function x(a,n,t){return f(this,null,function*(){let e=a.getVariables();if(e.length>0){let i=[];for(let o=0;o<e.length;o++){let T={name:e[o]};i.push(yield n.evaluateIdentifier(t,T))}let r={};for(let o=0;o<e.length;o++)r[e[o]]=i[o];return a.parameters=r,a}return a})}function q(a){a.mode==="async"&&(a.functions.stdev=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("stdev",n,r,a))},a.functions.variance=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("variance",n,r,a))},a.functions.average=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.mean=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("mean",n,r,a))},a.functions.sum=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("sum",n,r,a))},a.functions.min=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("min",n,r,a))},a.functions.max=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>c("max",n,r,a))},a.functions.count=function(n,t){return a.standardFunctionAsync(n,t,(e,i,r)=>f(this,null,function*(){if(S(r,1,1,n,t),m(r[0]))return r[0].count(e.abortSignal);if(l(r[0])||p(r[0]))return r[0].length;if(d(r[0]))return r[0].length();throw new h(n,F.InvalidParameter,t)}))})}export{q as registerFunctions};
